(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      name: this.props.initialTemplateValues.name,
      body: this.props.initialTemplateValues.body,
      subject: this.props.initialTemplateValues.subject,
      editMode: this.props.initialTemplateValues.editMode
    }
  },

  componentDidMount: function() {
    console.log('did mount')
    $('.template-body').html(this.state.body)
    if(this.state.editMode) {
      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })
    }

    renderjson.set_show_to_level('all')
    prospect = _.pick(this.props.prospect, 
      'company_name', 'name', 'pos'
    )
    prospect.first_name = prospect.name.split(' ')[0]
    prospect.last_name = _.last(prospect.name.split(' '))
    prospect = _.omit(prospect, 'name')

    document.getElementById("editTemplate").appendChild(renderjson(prospect));
    $('#editTemplateOverlay').html()
    thiss = this;
    $('.renderjson').click(function() {
      thiss.props.toggleTemplateEditMenu()
    })

    $('.renderjson').css({
      'position': 'absolute',
      'z-index': '1000000000',
      'background-color':'rgba(0,0,0,0)',
      'border':'0',
      'color':'white',
      'margin-top':'0px',
      'height': '542px',
      'overflow':'auto',
      'width':'380px'
    })

    $('.key').css({
      'cursor':'pointer'
    })

    $('.timeline').css({
      '-webkit-filter': 'blur(10px)',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': 'blur(10px)',
    })
  },
  componentWillUnmount:function() {
    $('.timeline').css({
      '-webkit-filter': '',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': '',
    })
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })

      console.log('look at this')
      console.log(name)
      name = (this.props.initialTemplateValues.newTemplate) ? $('#template-name').val() : this.state.name
      this.props.saveTemplate({
        name: name,
        body: $('.summer').code(),
        subject: $('.subject').val(),
      }, this.props.initialTemplateValues.newTemplate)

      this.setState({
        name: $('#template-name').val(),
        body: $('.summer').code(),
        subject: $('.subject').val(),
        editMode: !this.state.editMode,
      })

      objId = this.props.initialTemplateValues.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+objId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),
                             subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })
    }
  },

  componentWillUpdate: function(newProps) {
    console.log('THE NEW PROPS')
    console.log(newProps)
  },

  componentDidUpdate: function() {
    /* thiss = this; */
    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.subject)
      $('#template-name').val(this.state.name)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.body)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? React.DOM.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.subject

    if(this.state.editMode){
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-save"}), "   Save Template")

       if(this.props.initialTemplateValues.newTemplate){
         the_name = React.DOM.input({className: "form-control", 
                           id: "template-name", 
                           style: {float:'left',width:200}})
       }
    } else {
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")

       the_name = React.DOM.h6({style: {float:'left'}}, 
                   React.DOM.i({className: "fa fa-file-text-o"}), " ", 
                   this.state.name
                  )
    }

    return (
      React.DOM.div({id: "editTemplate"}, 
        React.DOM.h5({className: "example-template-title"}, "Example Template Values"), 
        React.DOM.div({className: "example-template-title", 
             style: {marginLeft:215, marginTop:8}}, 
          React.DOM.a({href: "javascript:", 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-left"})), 
          React.DOM.a({href: "javascript:", 
            style: {marginLeft:5}, 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-right"}))
        ), 
        React.DOM.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
          React.DOM.div({id: "editTemplateView", 
               className: "panel panel-default", 
               style: {display:'block'}}, 
               React.DOM.div({className: "panel-heading", style: {height:50}}, 
                 the_name, 
              React.DOM.a({href: "javascript:", 
                className: "btn btn-default btn-xs", 
                style: {float:'right',marginLeft:5,marginTop:5}}, 
                React.DOM.i({className: "fa fa-trash"})
              ), 
              toggleButton
            ), 
            React.DOM.div({className: "panel-body"}, 
              React.DOM.div({className: "editTemplateTitle"}, 
                React.DOM.span(null, "Subject: "), 
                subjectPlace
              ), 
             React.DOM.br(null), 
             React.DOM.div({className: "templateDetails"}, 
               React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
                 "Created by Mark on Jul. 21, 2014"
               ), 
               React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, 
                 "last updated 7 days ago"
               )
             ), 
            React.DOM.br(null), 
            React.DOM.div({className: "panel panel-default"}, 
              React.DOM.div({className: "panel-body summer template-body"}
              )
            )
        )
      )
    )
    );
  }
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L25vZGVfbW9kdWxlcy9ndWxwLWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvZWRpdF90ZW1wbGF0ZS5qcy5taW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLm5hbWUsXG4gICAgICBib2R5OiB0aGlzLnByb3BzLmluaXRpYWxUZW1wbGF0ZVZhbHVlcy5ib2R5LFxuICAgICAgc3ViamVjdDogdGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMuc3ViamVjdCxcbiAgICAgIGVkaXRNb2RlOiB0aGlzLnByb3BzLmluaXRpYWxUZW1wbGF0ZVZhbHVlcy5lZGl0TW9kZVxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS5sb2coJ2RpZCBtb3VudCcpXG4gICAgJCgnLnRlbXBsYXRlLWJvZHknKS5odG1sKHRoaXMuc3RhdGUuYm9keSlcbiAgICBpZih0aGlzLnN0YXRlLmVkaXRNb2RlKSB7XG4gICAgICAkKCcuc3VtbWVyJykuc3VtbWVybm90ZSh7XG4gICAgICAgIGhlaWdodDogMjAwLFxuICAgICAgICB0b29sYmFyOiBbXG4gICAgICAgICAgWydzdHlsZScsIFsnYm9sZCcsICdpdGFsaWMnLCAndW5kZXJsaW5lJywgJ2NsZWFyJ11dLFxuICAgICAgICAgIFsnZm9udCcsIFsnc3RyaWtldGhyb3VnaCddXSxcbiAgICAgICAgICBbJ2ZvbnRzaXplJywgWydmb250c2l6ZSddXSxcbiAgICAgICAgICBbJ2NvbG9yJywgWydjb2xvciddXSxcbiAgICAgICAgICBbJ3BhcmEnLCBbJ3VsJywgJ29sJywgJ3BhcmFncmFwaCddXSxcbiAgICAgICAgICBbJ2hlaWdodCcsIFsnaGVpZ2h0J11dLFxuICAgICAgICBdXG4gICAgICB9KVxuICAgIH1cblxuICAgIHJlbmRlcmpzb24uc2V0X3Nob3dfdG9fbGV2ZWwoJ2FsbCcpXG4gICAgcHJvc3BlY3QgPSBfLnBpY2sodGhpcy5wcm9wcy5wcm9zcGVjdCwgXG4gICAgICAnY29tcGFueV9uYW1lJywgJ25hbWUnLCAncG9zJ1xuICAgIClcbiAgICBwcm9zcGVjdC5maXJzdF9uYW1lID0gcHJvc3BlY3QubmFtZS5zcGxpdCgnICcpWzBdXG4gICAgcHJvc3BlY3QubGFzdF9uYW1lID0gXy5sYXN0KHByb3NwZWN0Lm5hbWUuc3BsaXQoJyAnKSlcbiAgICBwcm9zcGVjdCA9IF8ub21pdChwcm9zcGVjdCwgJ25hbWUnKVxuXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0VGVtcGxhdGVcIikuYXBwZW5kQ2hpbGQocmVuZGVyanNvbihwcm9zcGVjdCkpO1xuICAgICQoJyNlZGl0VGVtcGxhdGVPdmVybGF5JykuaHRtbCgpXG4gICAgdGhpc3MgPSB0aGlzO1xuICAgICQoJy5yZW5kZXJqc29uJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzcy5wcm9wcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51KClcbiAgICB9KVxuXG4gICAgJCgnLnJlbmRlcmpzb24nKS5jc3Moe1xuICAgICAgJ3Bvc2l0aW9uJzogJ2Fic29sdXRlJyxcbiAgICAgICd6LWluZGV4JzogJzEwMDAwMDAwMDAnLFxuICAgICAgJ2JhY2tncm91bmQtY29sb3InOidyZ2JhKDAsMCwwLDApJyxcbiAgICAgICdib3JkZXInOicwJyxcbiAgICAgICdjb2xvcic6J3doaXRlJyxcbiAgICAgICdtYXJnaW4tdG9wJzonMHB4JyxcbiAgICAgICdoZWlnaHQnOiAnNTQycHgnLFxuICAgICAgJ292ZXJmbG93JzonYXV0bycsXG4gICAgICAnd2lkdGgnOiczODBweCdcbiAgICB9KVxuXG4gICAgJCgnLmtleScpLmNzcyh7XG4gICAgICAnY3Vyc29yJzoncG9pbnRlcidcbiAgICB9KVxuXG4gICAgJCgnLnRpbWVsaW5lJykuY3NzKHtcbiAgICAgICctd2Via2l0LWZpbHRlcic6ICdibHVyKDEwcHgpJyxcbiAgICB9KVxuICAgICQoJyNjYW1wYWlnbi10b3AtZGV0YWlsJykuY3NzKHtcbiAgICAgICctd2Via2l0LWZpbHRlcic6ICdibHVyKDEwcHgpJyxcbiAgICB9KVxuICB9LFxuICBjb21wb25lbnRXaWxsVW5tb3VudDpmdW5jdGlvbigpIHtcbiAgICAkKCcudGltZWxpbmUnKS5jc3Moe1xuICAgICAgJy13ZWJraXQtZmlsdGVyJzogJycsXG4gICAgfSlcbiAgICAkKCcjY2FtcGFpZ24tdG9wLWRldGFpbCcpLmNzcyh7XG4gICAgICAnLXdlYmtpdC1maWx0ZXInOiAnJyxcbiAgICB9KVxuICB9LFxuXG4gIGNsaWNrZWRPdmVybGF5OiBmdW5jdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZygnY2xpY2tlZCBvdmVybGF5JylcbiAgICB0aGlzLnByb3BzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUoKVxuICB9LFxuXG4gIGNoYW5nZU1vZGU6IGZ1bmN0aW9uKCkge1xuICAgIC8vIFVwZGF0ZSB0ZW1wbGF0ZSBodG1sIG9uIHRvZ2dsZVxuICAgIHBhcnNlX2hlYWRlcnMgPSBhcHBDb25maWcucGFyc2VIZWFkZXJzXG4gICAgaWYodGhpcy5zdGF0ZS5lZGl0TW9kZSl7XG4gICAgICAkKCcuc3VtbWVyJykuZGVzdHJveSgpO1xuICAgICAgJCgnLnRpbWVsaW5lJykuY3NzKHtcbiAgICAgICAgJy13ZWJraXQtZmlsdGVyJzogJ2JsdXIoMjBweCknLFxuICAgICAgfSlcblxuICAgICAgY29uc29sZS5sb2coJ2xvb2sgYXQgdGhpcycpXG4gICAgICBjb25zb2xlLmxvZyhuYW1lKVxuICAgICAgbmFtZSA9ICh0aGlzLnByb3BzLmluaXRpYWxUZW1wbGF0ZVZhbHVlcy5uZXdUZW1wbGF0ZSkgPyAkKCcjdGVtcGxhdGUtbmFtZScpLnZhbCgpIDogdGhpcy5zdGF0ZS5uYW1lXG4gICAgICB0aGlzLnByb3BzLnNhdmVUZW1wbGF0ZSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGJvZHk6ICQoJy5zdW1tZXInKS5jb2RlKCksXG4gICAgICAgIHN1YmplY3Q6ICQoJy5zdWJqZWN0JykudmFsKCksXG4gICAgICB9LCB0aGlzLnByb3BzLmluaXRpYWxUZW1wbGF0ZVZhbHVlcy5uZXdUZW1wbGF0ZSlcblxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIG5hbWU6ICQoJyN0ZW1wbGF0ZS1uYW1lJykudmFsKCksXG4gICAgICAgIGJvZHk6ICQoJy5zdW1tZXInKS5jb2RlKCksXG4gICAgICAgIHN1YmplY3Q6ICQoJy5zdWJqZWN0JykudmFsKCksXG4gICAgICAgIGVkaXRNb2RlOiAhdGhpcy5zdGF0ZS5lZGl0TW9kZSxcbiAgICAgIH0pXG5cbiAgICAgIG9iaklkID0gdGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMub2JqZWN0SWRcbiAgICAgICQuYWpheCh7XG4gICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9UZW1wbGF0ZXMvJytvYmpJZCxcbiAgICAgICAgdHlwZTonUFVUJyxcbiAgICAgICAgaGVhZGVyczpwYXJzZV9oZWFkZXJzLFxuICAgICAgICBkYXRhOkpTT04uc3RyaW5naWZ5KHtib2R5OiAkKCcuc3VtbWVyJykuY29kZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0OiAkKCcuc3ViamVjdCcpLnZhbCgpfSksXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBlZGl0TW9kZTogIXRoaXMuc3RhdGUuZWRpdE1vZGUgfSlcbiAgICAgICQoJy50aW1lbGluZScpLmNzcyh7XG4gICAgICAgICctd2Via2l0LWZpbHRlcic6ICdibHVyKDIwcHgpJyxcbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudFdpbGxVcGRhdGU6IGZ1bmN0aW9uKG5ld1Byb3BzKSB7XG4gICAgY29uc29sZS5sb2coJ1RIRSBORVcgUFJPUFMnKVxuICAgIGNvbnNvbGUubG9nKG5ld1Byb3BzKVxuICB9LFxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgLyogdGhpc3MgPSB0aGlzOyAqL1xuICAgIGNvbnNvbGUubG9nKCdPVEhFUicpXG4gICAgaWYodGhpcy5zdGF0ZS5lZGl0TW9kZSl7XG4gICAgICBjb25zb2xlLmxvZygnQ0FMTEVEJylcbiAgICAgIC8vIFJlcGxhY2UgU3ViamVjdCBcbiAgICAgICQoJy5zdWJqZWN0JykudmFsKHRoaXMuc3RhdGUuc3ViamVjdClcbiAgICAgICQoJyN0ZW1wbGF0ZS1uYW1lJykudmFsKHRoaXMuc3RhdGUubmFtZSlcblxuICAgICAgJCgnLnN1bW1lcicpLnN1bW1lcm5vdGUoe1xuICAgICAgICBoZWlnaHQ6IDIwMCxcbiAgICAgICAgdG9vbGJhcjogW1xuICAgICAgICAgIFsnc3R5bGUnLCBbJ2JvbGQnLCAnaXRhbGljJywgJ3VuZGVybGluZScsICdjbGVhciddXSxcbiAgICAgICAgICBbJ2ZvbnQnLCBbJ3N0cmlrZXRocm91Z2gnXV0sXG4gICAgICAgICAgWydmb250c2l6ZScsIFsnZm9udHNpemUnXV0sXG4gICAgICAgICAgWydjb2xvcicsIFsnY29sb3InXV0sXG4gICAgICAgICAgWydwYXJhJywgWyd1bCcsICdvbCcsICdwYXJhZ3JhcGgnXV0sXG4gICAgICAgICAgWydoZWlnaHQnLCBbJ2hlaWdodCddXSxcbiAgICAgICAgXVxuICAgICAgfSlcblxuICAgICAgLy8gSW5pdGlhbGl6ZSBFZGl0b3Igd2l0aCBodG1sXG4gICAgICAkKCcuc3VtbWVyJykuY29kZSh0aGlzLnN0YXRlLmJvZHkpXG4gICAgfVxuICB9LFxuXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBzdWJqZWN0UGxhY2UgPSAodGhpcy5zdGF0ZS5lZGl0TW9kZSkgPyBSZWFjdC5ET00uaW5wdXQoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lJyx3aWR0aDo0ODB9LCBjbGFzc05hbWU6IFwiZm9ybS1jb250cm9sIHN1YmplY3RcIn0pIDogdGhpcy5zdGF0ZS5zdWJqZWN0XG5cbiAgICBpZih0aGlzLnN0YXRlLmVkaXRNb2RlKXtcbiAgICAgICB0b2dnbGVCdXR0b24gPSBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLmNoYW5nZU1vZGUsIFxuICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLXN1Y2Nlc3MgYnRuLXhzXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7ZGlzcGxheTonYmxvY2snLGZsb2F0OidyaWdodCcsbWFyZ2luVG9wOjV9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXNhdmVcIn0pLCBcIiDCoCBTYXZlIFRlbXBsYXRlXCIpXG5cbiAgICAgICBpZih0aGlzLnByb3BzLmluaXRpYWxUZW1wbGF0ZVZhbHVlcy5uZXdUZW1wbGF0ZSl7XG4gICAgICAgICB0aGVfbmFtZSA9IFJlYWN0LkRPTS5pbnB1dCh7Y2xhc3NOYW1lOiBcImZvcm0tY29udHJvbFwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBcInRlbXBsYXRlLW5hbWVcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge2Zsb2F0OidsZWZ0Jyx3aWR0aDoyMDB9fSlcbiAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICB0b2dnbGVCdXR0b24gPSBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLmNoYW5nZU1vZGUsIFxuICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLXByaW1hcnkgYnRuLXhzXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7ZGlzcGxheTonYmxvY2snLGZsb2F0OidyaWdodCcsbWFyZ2luVG9wOjV9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBlbmNpbC1zcXVhcmVcIn0pLCBcIiDCoCBFZGl0IFRlbXBsYXRlXCIpXG5cbiAgICAgICB0aGVfbmFtZSA9IFJlYWN0LkRPTS5oNih7c3R5bGU6IHtmbG9hdDonbGVmdCd9fSwgXG4gICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFwiwqBcIiwgXG4gICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5uYW1lXG4gICAgICAgICAgICAgICAgICApXG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2lkOiBcImVkaXRUZW1wbGF0ZVwifSwgXG4gICAgICAgIFJlYWN0LkRPTS5oNSh7Y2xhc3NOYW1lOiBcImV4YW1wbGUtdGVtcGxhdGUtdGl0bGVcIn0sIFwiRXhhbXBsZSBUZW1wbGF0ZSBWYWx1ZXNcIiksIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiZXhhbXBsZS10ZW1wbGF0ZS10aXRsZVwiLCBcbiAgICAgICAgICAgICBzdHlsZToge21hcmdpbkxlZnQ6MjE1LCBtYXJnaW5Ub3A6OH19LCBcbiAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXCJ9LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hldnJvbi1sZWZ0XCJ9KSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgc3R5bGU6IHttYXJnaW5MZWZ0OjV9LCBcbiAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXCJ9LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hldnJvbi1yaWdodFwifSkpXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtvbkNsaWNrOiB0aGlzLmNsaWNrZWRPdmVybGF5LCBpZDogXCJlZGl0VGVtcGxhdGVPdmVybGF5XCJ9KSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7aWQ6IFwiZWRpdFRlbXBsYXRlVmlld1wiLCBcbiAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJwYW5lbCBwYW5lbC1kZWZhdWx0XCIsIFxuICAgICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidibG9jayd9fSwgXG4gICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtaGVhZGluZ1wiLCBzdHlsZToge2hlaWdodDo1MH19LCBcbiAgICAgICAgICAgICAgICAgdGhlX25hbWUsIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wiLCBcbiAgICAgICAgICAgICAgICBzdHlsZToge2Zsb2F0OidyaWdodCcsbWFyZ2luTGVmdDo1LG1hcmdpblRvcDo1fX0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdHJhc2hcIn0pXG4gICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgICB0b2dnbGVCdXR0b25cbiAgICAgICAgICAgICksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWJvZHlcIn0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiZWRpdFRlbXBsYXRlVGl0bGVcIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKG51bGwsIFwiU3ViamVjdDogXCIpLCBcbiAgICAgICAgICAgICAgICBzdWJqZWN0UGxhY2VcbiAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgUmVhY3QuRE9NLmJyKG51bGwpLCBcbiAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwidGVtcGxhdGVEZXRhaWxzXCJ9LCBcbiAgICAgICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHttYXJnaW5Cb3R0b206JzAnfSwgY2xhc3NOYW1lOiBcInRleHQtbXV0ZWRcIn0sIFxuICAgICAgICAgICAgICAgICBcIkNyZWF0ZWQgYnkgTWFyayBvbiBKdWwuIDIxLCAyMDE0XCJcbiAgICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge21hcmdpblRvcDonMCd9LCBjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgICAgICAgIFwibGFzdCB1cGRhdGVkIDcgZGF5cyBhZ29cIlxuICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmJyKG51bGwpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbCBwYW5lbC1kZWZhdWx0XCJ9LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWJvZHkgc3VtbWVyIHRlbXBsYXRlLWJvZHlcIn1cbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgKVxuICAgICk7XG4gIH1cbn0pO1xuIl19
