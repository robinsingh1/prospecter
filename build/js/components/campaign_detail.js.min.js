(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      activities: []
    }
  },

  componentDidMount: function() {
    var thiss = this;
    $.ajax({
      url: 'https://api.parse.com/1/classes/EmailEvent',
      data: {include: 'prospect,sent_email', order:'-createdAt', limit:1000},
      headers: appConfig.headers,
      success: function(res) { 
        console.log(res.results)
        thiss.setState({activities: res.results}) 
      },
      error: function() {}
    })
  },

  render: function() {
    activities = _.map(this.state.activities, function(activity) {
      return EmailActivities({activity: activity})
    })

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Sent "), 
            React.DOM.th(null, "Prospect "), 
            React.DOM.th(null, "Email "), 
            React.DOM.th(null, "Events "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons"), 
            React.DOM.th(null, "Social")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Event = React.createClass({displayName: 'Event',
  render: function() {
    event = this.props.event
    if(event == "delivered"){
      iconType = "fa fa-paper-plane"; eventName = "Delivered";
    }else if(event == "failed") {
      iconType = "fa fa-exclamation-circle"; eventName="Failed"
    }else if(event == "opened"){
      iconType = "fa fa-eye"; eventName="Opened"
    }else if(event == "replied"){
      iconType = "fa fa-mail-reply";  eventName = "Replied"
    }else if(event == "visited"){
      iconType = "fa fa-home";  eventName="Visited"
    }

    return (
      React.DOM.ul({className: "list-group email-events", style: {marginBottom:0}}, 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {paddingTop:16, height:49,textAlign:'center'}}, 
          React.DOM.i({className: iconType}), " ", React.DOM.span({style: {fontWeight:'bold'}}, eventName), " "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-home"}), " ", React.DOM.span({style: {fontWeight:'bold'}}, "Visited"), " ", 
          React.DOM.a({href: "javascript:"}, "customerohq.com/resources"), "  "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-external-link-square"}), " ", 
          React.DOM.span(null, "2:19 pm"), " ", 
          React.DOM.span({style: {fontWeight:'bold'}}, "clicked "), 
          React.DOM.a({href: "javascript:"}, "customerohq.com")
        )
      )
    )
  }
})

var EmailActivities = React.createClass({displayName: 'EmailActivities',
  render: function() {
    activity = this.props.activity
    prospect = (activity.prospect) ? activity.prospect : {}
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " ", 
              moment(activity.createdAt).fromNow()
            )
          ), 
          React.DOM.td(null, React.DOM.h6(null, prospect.name)), 
          React.DOM.td(null, React.DOM.h6(null, activity.sent_email.subject)), 
          React.DOM.td({style: {padding:0, fontSize:12}}, 
            Event({event: activity.event_type})
          ), 
          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.div({style: {display:'none'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Email"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, React.DOM.i({className: "fa fa-cloud-upload"}), " CRM"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Call")
          )
          ), 
          React.DOM.td(null, 
            "lol"
          )
      )
    )
  }
})

},{}]},{},[1])


},{}],2:[function(require,module,exports){
/** @jsx React.DOM */
var TemplatesMenu = require('./templates_menu.js.min.js');
var EditTemplateView = require('./edit_template.js.min.js');
var CreateTemplateView = require('./create_template.js.min.js');
var Timeline = require('./followup_timeline.js.min.js');
var CampaignActivityView = require('./campaign_activity_view.js.min.js')
var CampaignFollowupFeed = require('./campaign_followup_feed.js.min.js')
var CampaignSentEmail = require('./campaign_sent_email.js.min.js')
var CampaignReport = require('./campaign_report.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // Campaign Detail
  getInitialState: function() {
    return {
      selectedTemplate: 0,
      templateDetailMode: false,
      editMode: false,
      followupDay: 0,
      templates:[],
      currentTemplate:'',
      prospectListCount:'~',
      prospects:[],
      currentScreen: 'timeline',
      newProspects: [],
      bounced: '~',
      delivered: '~',
      opened: '~',
    }
  },

  changeScreen: function(e) {
    this.setState({currentScreen: $(e.target).text().toLowerCase()})
  },

  componentDidMount: function() {
    thissss = this;
    company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
    qry = 'where={"company":'+company+'}'



    $.ajax({
      url:'https://api.parse.com/1/classes/Template',
      headers: appConfig.headers,
      data: qry,
      success: function(res) { thissss.setState({templates: res.results}) },
      error: function(err) { console.log('error') }
    });

    currentList = JSON.stringify({
      '__type'    : 'Pointer', 
      'className' : 'ProspectList',
      'objectId'  : this.props.selectedCampaign.prospect_list.objectId, 
    })

    qry = 'where={"lists":'+currentList+'}&limit=1000&count=1&include=email_guesses,email_guesses.pattern'
    $.ajax({
      url: 'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      data: qry,
      success: function (res) {
        // TODO - why is this being done
        console.log('RESULTS')
        console.log(res)
        console.log(res.results)
        thissss.setState({
          prospects: res.results,
          prospectListCount: res.count 
        })

        if(res.count > 1000){
          for(i=0;i< Math.ceil(res.count/1000); i++) {
            qry = 'where={"lists":'+currentList+'}&limit=1000&count=1'
            $.ajax({
              url: 'https://api.parse.com/1/classes/Prospect',
              headers: appConfig.headers,
              data: qry,
              success: function (res) {
                prospects = thissss.state.prospects
                thissss.setState({prospects:  prospects.concat(res.results)})
              },
              error: function(err) {}
            })
          }
        }
      },
      error: function(err) { }
    })

    var thiss = this;
    selectedCampaign = this.props.selectedCampaign
    console.debug(this.props.selectedCampaign)
    console.debug('Selected Campaign Batches')
    console.debug(this.props.selectedCampaign.batches)
    batches = this.props.selectedCampaign.batches
    if(_.isEqual(batches, [])){ 
      batch_query = { $in: [false, null] }
    } else {
      qry = _.map(batches, function(batch) {
        return appConfig.pointer('ProspectBatch', batch.objectId)
      })
      batch_query = { $nin: qry }
    }
    prospect_list = thiss.props.selectedCampaign.prospect_list.objectId
    // TODO - add support for more than 1000
    $.ajax({
      url:'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      selectedCampaign: thiss.props.selectedCampaign,
      data: {
        where: JSON.stringify({
            batches: batch_query,
            lists: appConfig.pointer('ProspectList', prospect_list),
        }), limit:1000
      },
      success: function(res) { thiss.setState({newProspects: res.results}) },
      error: function(err) { console.debug(err.responseText) }
    })
    campaignId = thiss.props.selectedCampaign.objectId
    qry = {
      where: JSON.stringify({campaign: appConfig.pointer('Campaign', campaignId)}),
      limit: 1000,
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({delivered: res.count})},
      error: function(err) { console.log(err.responseText) }
    })
    qry_1 = {
      where: JSON.stringify({
        campaign: appConfig.pointer('Campaign', campaignId),
        opened: {"$gte": 0} 
      }),
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry_1,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({opened : res.count}) },
      error: function(err) { console.log(err.responseText) }
    })
    qry_2 = {
      where: JSON.stringify({
        campaign: appConfig.pointer('Campaign', campaignId),
        failed: {"$gte": 0} 
      }),
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry_2,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({bounced : res.count}) },
      error: function(err) { console.log(err.responseText) }
    })
  },

  returnToOverview: function() {
    this.props.toggleScreen('Campaigns')
  },

  render: function() {
    //console.log('campaign detail')
    console.log(this.state.currentScreen)
    console.log(this.state.currentScreen.indexOf("sent email"))
    tab_1 = "campaign-tab-link"
    tab_2 = "campaign-tab-link"
    tab_3 = "campaign-tab-link"
    tab_4 = "campaign-tab-link"
    tab_5 = "campaign-tab-link"
    if(this.state.currentScreen == "timeline"){
      //console.debug('SELECTED CAMPAIGN')
      //console.debug(this.props.selectedCampaign)
      lolscreen = FollowupTimeline({
                  templates: this.state.templates, 
                  prospects: this.state.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.state.prospectListCount, 
                  newProspects: this.state.newProspects, 
                  toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
                  initialFollowups: this.props.selectedCampaign.followups})
      tab_1 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "recent activity") {
      lolscreen = CampaignActivityView(null)
      tab_2 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "scheduled followups") {
      lolscreen = CampaignFollowupFeed({
                    batches: this.props.selectedCampaign.batches, 
                    followups: this.props.selectedCampaign.followups})
      tab_3 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "sent mail") {
      lolscreen = CampaignSentEmail({
                      selectedCampaign: this.props.selectedCampaign})
      tab_4 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "analytics") {
      lolscreen = CampaignReport(null)
      tab_5 = "active-campaign-tab campaign tab-link"
    } else{
      console.log('LOL')
      lolscreen = FollowupTimeline({
                  templates: this.state.templates, 
                  prospects: this.state.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.state.prospectListCount, 
                  newProspects: this.state.newProspects, 
                  toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
                  templates: this.state.templates, 
                  initialFollowups: this.props.selectedCampaign.followups})
    }
    //activeTab = "active-campaign-tab campaign tab-link"
      

    //list_type = this.props.selectedCampaign.prospect_list.list_type
    list_type = ""
    if(list_type == "mining_job")
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-cloud-download"}), " ")
    else if(list_type == "signal_list")
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-wifi"}), " ")
    else
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-list-alt"}), " ")

    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    console.log('BATCHES')
    console.log(batches)
    return (
      React.DOM.div({className: "container", 
           style: {width:'100%',height:'100%',paddingLeft:0,paddingRight:0}}, 
        React.DOM.div({style: {marginBottom:15}, id: "campaign-top-detail"}, 
        React.DOM.h5({style: {marginTop:20,marginLeft:20}}, 
          React.DOM.a({href: "javascript:", onClick: this.returnToOverview}, "Campaigns "), 
          React.DOM.small(null, 
            React.DOM.i({style: {marginLeft:10, marginRight:10}, 
               className: "fa fa-chevron-right"})
          ), 
          this.props.selectedCampaign.name
        ), 
        React.DOM.h6({style: {marginLeft:20,display:'inline-block',marginRight:15,marginBottom:0,fontWeight:'bold',fontSize:10}}, 
          React.DOM.span({className: "text-muted"}, "PROSPECT LIST:"), "  "
        ), 
          React.DOM.span({className: "label label-success"}, 
          list_type, 
          this.props.selectedCampaign.prospect_list.name, 
          "     ", 
        React.DOM.i({className: "fa fa-user"}), " ", this.state.prospectListCount
        ), 
        React.DOM.br(null), 
        React.DOM.h6({style: {marginLeft:20,display:'inline-block',marginRight:50,marginTop:0,fontWeight:'bold',fontSize:10}, 
            className: "text-muted"}, 
          "BATCHES:"
        ), 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-sitemap"}), " ", 
          (_.isEqual(batches, [])) ? 1 : batches.length
        ), 
        
        React.DOM.div({style: {border:'1px solid #ddd',borderRadius:5,float:'right',marginTop:-45,marginRight:100}}, 
            React.DOM.div({className: "bg-warning", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer',width:70,textAlign:'center'}}, 
              React.DOM.span({className: "text-warning"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), " ", this.state.delivered
              )
            ), 
            React.DOM.div({className: "bg-success", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer',width:70,textAlign:'center'}}, 
              React.DOM.span({className: "text-success"}, 
                React.DOM.i({className: "fa fa-eye"}), " ", this.state.opened
              )
            ), 
            React.DOM.div({className: "bg-danger", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer',width:70,textAlign:'center'}}, 
              React.DOM.span({className: "text-danger"}, 
                React.DOM.i({className: "fa fa-exclamation-circle"}), " ", this.state.bounced
              )
            )
        ), 
        
        React.DOM.a({href: "javascript:", 
           style: {float: 'right', marginTop: -35, marginRight: 30, display:'none'}, 
           className: "btn btn-success btn-sm"}, 
          React.DOM.i({className: "fa fa-envelope"}), " Send!"
        )
        
        ), 
              React.DOM.ul({className: "nav nav-tabs campaign-tabs", role: "tablist", style: {paddingRight:0}}, 
                React.DOM.li({className: "campaign-tab"}, " ", React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_1}, "TIMELINE")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_2}, "RECENT ACTIVITY")), 
                React.DOM.li({className: "campaign-tab"}, 
                  React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_3, style: {fontSize:12}}, 
                    "SCHEDULED FOLLOWUPS")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_4}, "SENT MAIL")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_5}, "ANALYTICS"))
              ), 
            lolscreen, 

          (this.state.templateDetailMode) ? EditTemplateView({
            editMode: this.state.editMode, 
            initialTemplateValues: this.state.currentTemplate, 
            saveTemplate: this.saveTemplate, 
            prospect: this.state.prospects[0], 
            toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
            followupDay: this.state.followupDay}) : ""
      )
    );
  },

  saveTemplate: function(template, newTemplate) {
    templates = this.state.templates
    for(i=0;i< this.state.templates.length; i++)
      if(this.state.templates[i].name == template.name)
        break
    
    console.log(template)
    if(newTemplate){
      template.subject = template.subject
      template.name = template.name
      template.body = template.body
      templates.push(template)

      $.ajax({
        url:'https://api.parse.com/1/classes/Template',
        headers:appConfig.headers,
        type:'POST',
        data:JSON.stringify({
          name : template.name,
          subject: template.subject,
          body: template.body,
          user:{
            __type: 'Pointer',
            className:'_User',
            objectId:JSON.parse(localStorage.currentUser).objectId,
          },
          company:JSON.parse(localStorage.currentUser).company,
        }),
        success: function(res) {
          console.log(res)
        },
        error: function() {
        }
      })
    } else {
      templates[i].subject = template.subject
      templates[i].body = template.body

      $.ajax({
        url:'https://api.parse.com/1/classes/Template/'+templates[i].objectId,
        type:'PUT',
        headers:appConfig.headers,
        data:JSON.stringify({
          name : template.name,
          subject: template.subject,
          body: template.body,
        }),
        success: function(res) {
          console.log(res)
        },
        error: function() {
        }
      })
    }

    this.setState({templates: templates })

  },

  toggleTemplateEditMenu: function(currentTemplate, editMode) {
    editMode = (editMode) ? true : false
    this.setState({
      currentTemplate: currentTemplate,
      templateDetailMode: !this.state.templateDetailMode,
    })
  }
});

var FollowupTimeline = React.createClass({displayName: 'FollowupTimeline',
  render: function() {
    return (
        React.DOM.div(null, 
          React.DOM.div({className: "col-md-8 panel panel-default", 
               style: {height:436,paddingLeft:305,paddingTop:50,overflow:'auto',borderRight:0,borderRadius:0, borderTop:0}}, 
                Timeline({
                  templates: this.props.templates, 
                  prospects: this.props.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.props.prospectListCount, 
                  newProspects: this.props.newProspects, 
                  toggleTemplateEditMenu: this.props.toggleTemplateEditMenu, 
                  initialFollowups: this.props.initialFollowups})
          ), 
          React.DOM.div({className: "col-md-4", 
               style: {paddingLeft:0,paddingRight:0,height:436}}, 
            TemplatesMenu({
              templates: this.props.templates, 
              toggleTemplateEditMenu: this.props.toggleTemplateEditMenu})
          )
        )

    )
  }
})

},{"./campaign_activity_view.js.min.js":1,"./campaign_followup_feed.js.min.js":3,"./campaign_report.js.min.js":4,"./campaign_sent_email.js.min.js":5,"./create_template.js.min.js":6,"./edit_template.js.min.js":7,"./followup_timeline.js.min.js":8,"./templates_menu.js.min.js":10}],3:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      followups: []
    }
  },

  componentDidMount: function() {
        // for each batch find followups remaining
        // sort followups by ascending followup day
        //
    // Batch Start Date
    // Current Batch Date
  },

  render: function() {
    var thiss = this;
    followups = _.map(this.props.batches, function(batch) {
      now = moment().startOf('day').valueOf()/1000
      batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
      return _.map(thiss.props.followups, function(followup) {
        followup.batch = batch
        if(followup.day >= batch.currentDay)
          return followup
      })
    })
    followups = _.sortBy(followups, function(followup){ return followup.day })

    console.debug(followups)

    activities = _.map(followups[0], function(followup) {
      return Followups({followup: followup, batch: followup.batch})
    })
    console.debug(activities)

    return (
      React.DOM.div({style: {overflow:'auto',height:436}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Scheduled for "), 
            React.DOM.th(null, "Outreach Stage "), 
            React.DOM.th(null, "Prospect List"), 
            React.DOM.th(null, "Template "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Followups = React.createClass({displayName: 'Followups',
  render: function() {
    // this.props.batch
    // this.props.followup
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " " + ' ' +
              "29 minutes ago"
            )
          ), 
          React.DOM.td(null, 
            "second"
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-list-alt"}), "  " + ' ' +
            "Boston VP Sales - Retail"
            )
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-file-text-o"}), "  " + ' ' +
            "Followup #2 - Provide Value ", React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Subject: Just wanted to followup on the last email "), React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Body: Just wanted to followup on the last email ")

            )
          ), 

          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Send Now"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Remind me in 1 hour"), React.DOM.br(null)
          )
      )
    )
  }
})

},{}],4:[function(require,module,exports){
/** @jsx React.DOM */

lol = 

module.exports = React.createClass({displayName: 'exports',
  // Campaign Report
  getInitialState: function() {
    return {
    }
  },

  componentDidMount: function() { 
    testData = this.testData()
    var industryChart   = dc.pieChart("#industry-chart"),
        spendHistChart  = dc.barChart("#chart-hist-spend"),
        spenderRowChart = dc.rowChart("#chart-row-spenders");

    // set crossfilter
    var ndx = crossfilter(spendData),
        yearDim  = ndx.dimension(function(d) {return +d.Year;}),
        spendDim = ndx.dimension(function(d) {return Math.floor(d.Spent/10);}),
        nameDim  = ndx.dimension(function(d) {return d.Name;}),
        spendPerYear = yearDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendPerName = nameDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendHist    = spendDim.group().reduceCount();

    industryChart
        .width(200).height(200)
        .dimension(yearDim)
        .group(spendPerYear)
        .innerRadius(50);

    //
    // Batch Analytics - Bubble Chart
    // Batch Block Charts
    // Pie Chart - Industry
    // Revenue - PC
    // Company Size - PC
    // Opens / Replies / Link Clicks / Bounces - Bar Chart
    // Titles - PC
    // Time / Date Email Sent - Line Chart
    // Date Prospected - BC
    //
  },
  
  render: function() {
    return (
      React.DOM.div(null, 
        "Report View", 
        React.DOM.div({id: "industry-chart"})
      )
    )
  },

  testData: function() { 
    return [{"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140218.58883.75040@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140219.50015.20571@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140219.50019.67418@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140220.58887.52484@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shadowzprotection.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.598Z", "createdAt": "2014-10-07T15:20:15.147Z", "city": "New Delhi Area, India\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "f44YU2Yrm7", "company_name": "M/S Golden Bricks Constructions Pvt. Ltd.", "mailgun_id": "<20141010140220.19960.3157@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "6B4MDqWqtw"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "e9sMFL1QWx"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:15.147Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "201-500 employees", "name": "Vivek Narang", "industry": "Security and Investigations", "linkedin_url": "in.linkedin.com/pub/vivek-narang/20/b67/39", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shangri-la.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.880Z", "createdAt": "2014-10-07T15:20:13.197Z", "city": "Brisbane, Australia\\u00a0", "archived": true, "loading": false, "objectId": "TSSDEZ3lUA", "company_name": "Shangri-La Hotels and Resorts", "mailgun_id": "<20141010140221.39548.29627@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "PIDGJPqraI"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "mG4U69xDcg"}], "email": "andy.mccutcheon@shangri-la.com", "prospect_created_at": "2014-10-07T15:20:13.197Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Andy McCutcheon", "industry": "Hospitality", "linkedin_url": "au.linkedin.com/pub/andy-mccutcheon/1a/665/650", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140813.19956.20454@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140813.58881.85733@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140814.19938.90169@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140814.77386.74943@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}]
  },

});

},{}],5:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Sent Mail
  getInitialState: function() {
    return {
      sentEmails: []
    }
  },

  componentDidMount: function() {
    thiss = this;
    qry = {
      include: 'campaign,prospect,prospect.email_guesses.pattern',
      order:'-createdAt',
      campaign: {
        __type: 'Pointer',
        className:'Campaign',
        objectId: this.props.selectedCampaign.objectId,
      }
    }
    $.ajax({
      url: 'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({sentEmails: res.results}) },
      error: function() {}
    })
  },

  render: function() {
    sentEmails = []
    for(i=0;i< this.state.sentEmails.length; i++) 
      sentEmails.push(SentEmailRow({sentEmail: this.state.sentEmails[i]}))

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th(null, "Template"), 
            React.DOM.th({style: {width:290}}, "Status")
          ), 
          React.DOM.tbody(null, 
            sentEmails
          )
        )
      )
    );
  }
});

var SentEmailRow = React.createClass({displayName: 'SentEmailRow',
  render: function() {
    sentEmail = this.props.sentEmail
    //console.log(sentEmail)

    email = sentEmail.email
    /*
    if(email == "no_email"){
      first = sentEmail.prospect.name.split(' ')[0]
      last = _.last(sentEmail.prospect.name.split(' '))

      pattern = _.findWhere(sentEmail.prospect.email_guesses, {'tried':false})
      data = {first: first, last: last, fi: first[0], li: last[0]}
      email = Mustache.render(pattern.pattern.pattern, data).toLowerCase()
    }
    */

    replied = "label label-default"
    opened = "label label-default"
    delivered = "label label-default"
    queued = "label label-default"

    if(sentEmail.replied) 
      replied = "label label-success"
    if(sentEmail.opened) 
      opened = "label label-success"
    if(sentEmail.delivered) 
      delivered = "label label-success"
    if(sentEmail.queued) 
      queued = "label label-success"

    return (
      React.DOM.tr(null, 
        React.DOM.td({style: {width:100}}, React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-clock"}), 
            moment(sentEmail.createdAt).fromNow())), 
        React.DOM.td({style: {width:200}}, 
          React.DOM.h6({style: {fontSize:14,fontWeight:'bold',marginBottom:0}}, 
            sentEmail.prospect.name), 
          React.DOM.h6({style: {fontStyle:'italic',marginTop:4,marginBottom:0}}, 
            sentEmail.prospect.pos.trim()), 
          React.DOM.h6({style: {marginTop:4,fontWeight:'bold'}}, 
            React.DOM.i({className: "fa fa-building"}), " ", 
            sentEmail.prospect.company_name)
        ), 
        React.DOM.td({style: {width:200}}, React.DOM.h6(null, email)), 
        React.DOM.td(null, 
          React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-file-text-o"}), " " + ' ' +
            "Template"
          )
        ), 
        React.DOM.td({style: {paddingTop:13}}, 
          React.DOM.span({className: queued}, "Queued"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: delivered}, "Delivered"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: opened}, "Opened"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: replied}, "Replied")
        )
      )
    )
  }
})

},{}],6:[function(require,module,exports){
/** @jsx react.dom */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      
    }
  },

  componentDidMount: function() {
    $('.template-body').html(this.state.templateBody)
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    console.log('EDIT MODE')
    console.log(this.state.editMode)
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      this.props.saveTemplate({
        name: this.state.name,
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
      })
      this.setState({
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
        editMode: !this.state.editMode,
      })
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+this.props.initialTemplateValues.objectId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
    }
  },

  componentDidUpdate: function() {
    /* thiss = this; */

    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.templateSubject)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.templateBody)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? react.dom.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.templateSubject

    if(this.state.editMode){
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-save"}), "   Save Template")
    } else {
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-pencil-square"}), "   Edit Template")
    }

    return (
      react.dom.div(null, 
      react.dom.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
      react.dom.div({id: "editTemplateView", 
           className: "panel panel-info", 
           style: {display:'block'}}, 
           react.dom.div({className: "panel-heading", style: {height:50}}, 
             react.dom.h6({style: {float:'left'}}, 
               react.dom.i({className: "fa fa-file-text-o"}), 
               "  " + this.props.initialTemplateValues.name
             ), 
          toggleButton
        ), 
        react.dom.div({className: "panel-body"}, 
          react.dom.div({className: "editTemplateTitle"}, 
            react.dom.span(null, "Subject: "), 
            subjectPlace
          ), 
         react.dom.br(null), 
         react.dom.div({className: "templateDetails"}, 
           react.dom.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
             "Created by Mark on Jul. 21, 2014"
           ), 
           react.dom.h6({style: {marginTop:'0'}, className: "text-muted"}, 
             "last updated 7 days ago"
           )
         ), 
        react.dom.br(null), 
        react.dom.div({className: "panel panel-default"}, 
          react.dom.div({className: "panel-body summer template-body"}
          )
        )
    )
)
)
    );
  }
});

},{}],7:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      name: this.props.initialTemplateValues.name,
      body: this.props.initialTemplateValues.body,
      subject: this.props.initialTemplateValues.subject,
      editMode: this.props.initialTemplateValues.editMode
    }
  },

  componentDidMount: function() {
    console.log('did mount')
    $('.template-body').html(this.state.body)
    if(this.state.editMode) {
      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })
    }

    renderjson.set_show_to_level('all')
    prospect = _.pick(this.props.prospect, 
      'company_name', 'name', 'pos'
    )
    prospect.first_name = prospect.name.split(' ')[0]
    prospect.last_name = _.last(prospect.name.split(' '))
    prospect = _.omit(prospect, 'name')

    document.getElementById("editTemplate").appendChild(renderjson(prospect));
    $('#editTemplateOverlay').html()
    thiss = this;
    $('.renderjson').click(function() {
      thiss.props.toggleTemplateEditMenu()
    })

    $('.renderjson').css({
      'position': 'absolute',
      'z-index': '1000000000',
      'background-color':'rgba(0,0,0,0)',
      'border':'0',
      'color':'white',
      'margin-top':'0px',
      'height': '542px',
      'overflow':'auto',
      'width':'380px'
    })

    $('.key').css({
      'cursor':'pointer'
    })

    $('.timeline').css({
      '-webkit-filter': 'blur(10px)',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': 'blur(10px)',
    })
  },
  componentWillUnmount:function() {
    $('.timeline').css({
      '-webkit-filter': '',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': '',
    })
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })

      console.log('look at this')
      console.log(name)
      name = (this.props.initialTemplateValues.newTemplate) ? $('#template-name').val() : this.state.name
      this.props.saveTemplate({
        name: name,
        body: $('.summer').code(),
        subject: $('.subject').val(),
      }, this.props.initialTemplateValues.newTemplate)

      this.setState({
        name: $('#template-name').val(),
        body: $('.summer').code(),
        subject: $('.subject').val(),
        editMode: !this.state.editMode,
      })

      objId = this.props.initialTemplateValues.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+objId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),
                             subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })
    }
  },

  componentWillUpdate: function(newProps) {
    console.log('THE NEW PROPS')
    console.log(newProps)
  },

  componentDidUpdate: function() {
    /* thiss = this; */
    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.subject)
      $('#template-name').val(this.state.name)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.body)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? React.DOM.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.subject

    if(this.state.editMode){
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-save"}), "   Save Template")

       if(this.props.initialTemplateValues.newTemplate){
         the_name = React.DOM.input({className: "form-control", 
                           id: "template-name", 
                           style: {float:'left',width:200}})
       }
    } else {
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")

       the_name = React.DOM.h6({style: {float:'left'}}, 
                   React.DOM.i({className: "fa fa-file-text-o"}), " ", 
                   this.state.name
                  )
    }

    return (
      React.DOM.div({id: "editTemplate"}, 
        React.DOM.h5({className: "example-template-title"}, "Example Template Values"), 
        React.DOM.div({className: "example-template-title", 
             style: {marginLeft:215, marginTop:8}}, 
          React.DOM.a({href: "javascript:", 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-left"})), 
          React.DOM.a({href: "javascript:", 
            style: {marginLeft:5}, 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-right"}))
        ), 
        React.DOM.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
          React.DOM.div({id: "editTemplateView", 
               className: "panel panel-default", 
               style: {display:'block'}}, 
               React.DOM.div({className: "panel-heading", style: {height:50}}, 
                 the_name, 
              React.DOM.a({href: "javascript:", 
                className: "btn btn-default btn-xs", 
                style: {float:'right',marginLeft:5,marginTop:5}}, 
                React.DOM.i({className: "fa fa-trash"})
              ), 
              toggleButton
            ), 
            React.DOM.div({className: "panel-body"}, 
              React.DOM.div({className: "editTemplateTitle"}, 
                React.DOM.span(null, "Subject: "), 
                subjectPlace
              ), 
             React.DOM.br(null), 
             React.DOM.div({className: "templateDetails"}, 
               React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
                 "Created by Mark on Jul. 21, 2014"
               ), 
               React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, 
                 "last updated 7 days ago"
               )
             ), 
            React.DOM.br(null), 
            React.DOM.div({className: "panel panel-default"}, 
              React.DOM.div({className: "panel-body summer template-body"}
              )
            )
        )
      )
    )
    );
  }
});

},{}],8:[function(require,module,exports){
/** @jsx React.DOM */
var SendEmailModal = require('./send_email_modal.js.min.js')
var TimelineDayElement = require('./timeline_day_element.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // FollowupTimeline
  getInitialState: function() {
    initialFollowups = this.props.initialFollowups
    initialFollowups = (initialFollowups) ? initialFollowups : []
    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    return {
      followups: _.compact(initialFollowups),
      loading: false,
      currentTemplate:'',
      currentBatch: '',
      batches : batches
    }
  },

  componentDidMount: function() {
    thiss = this;
    $('.day').tooltip({
      placement: 'right',
      title:'+ Add a follow-up'
    })

    console.log(this.props.selectedCampaign)
     company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
     currentCampaign = appConfig.pointer('Campaign', this.props.selectedCampaign.objectId)
     $.ajax({
       url:'https://api.parse.com/1/classes/Followup',
       type:'GET',
       headers: appConfig.headers,
       data: {
         where: JSON.stringify({
           campaign: currentCampaign,
           company: appConfig.company
         }),
         include:'template',
       },
       success: function(res) {
         console.log('followup timeline')
         console.log(res.results)
       },
       error: function(err) {
         console.log('error')
         console.log(err)
       }
     })
  },

  addFollowupSentToBatch: function(batch, followup) {
    batches = _.map(this.state.batches, function(_batch) {
                  if(_batch.objectId == batch.objectId) {
                    if(_batch.followups)
                      _batch.followups.push(followup)
                    else
                      _batch.followups = [followup]
                  }
                  return _batch
              })
    // Persist
  },
  
  render: function() {
    timelineElements = []
    followups = this.state.followups

    batches = _.map(this.state.batches, function(batch) {
      if(batch){
        now = moment().startOf('day').valueOf()
        batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
        return batch
      }
    })
    batches = _.compact(batches)

    for(i=0;i< 31;i++){
      followup = _.findWhere(this.state.followups, {day: i})
      var elementType = (followup) ? true : false
      var currentTemplate = (followup) ? followup.template : false
      var addTemplateMode = (followup) ? followup.addTemplateMode : true
      campaign = this.props.selectedCampaign

      currentBatch = {}
      batch_started_today = false
      alreadySent = false
      batchCount = undefined
      if(i == 0) {
        batchCount = (batches) ? this.props.newProspects.length : this.props.prospects.length
      } else {
        batch = _.findWhere(batches, {currentDay: i})
        if(batch) {
          currentBatch = batch.objectId
          console.debug(batch.objectId)
          batchCount = "~"
          if(followup) {
            _batches = followup.batches
            alreadySent = _.findWhere(_batches, _.pick(batch,'objectId'))
          }
        }
      }

      timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                    dayCount: i, 
                                    elementType: !elementType, 
                                    currentTemplate: currentTemplate, 
                                    batchCount: batchCount, 
                                    currentBatch: currentBatch, 
                                    alreadySent: alreadySent, 
                                    addTemplateMode: addTemplateMode, 
                                    templates: this.props.templates, 
                                    newProspects: this.props.newProspects, 
                                    addFollowup: this.addFollowup, 
                                    editFollowup: this.editFollowup, 
                                    saveFollowup: this.saveFollowup, 
                                    removeFollowup: this.removeFollowup, 
                                 addFollowupSentToBatch: this.addFollowupSentToBatch, 
                                    batches: this.props.selectedCampaign.batches, 
                                    prospectListCount: this.props.prospectListCount, 
                                    setCurrentBatch: this.setCurrentBatch, 
                                    setCurrentTemplate: this.setCurrentTemplate})
                                  ))

      if(i == 0 && _.findWhere(batches, {currentDay: 0})){
          currentBatch = _.findWhere(batches, {currentDay: 0}).objectId
          console.debug('0.5')
          console.debug(currentBatch)
          batchCount = "~"
          timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                  dayCount: 0.5, 
                                  batchCount: batchCount, 
                                  currentBatch: currentBatch, 
                                  newProspects: this.props.newProspects, 
                                  elementType: true, 
                                  batches: this.props.selectedCampaign.batches, 
                                  prospectListCount: this.props.prospectListCount, 
                                  setCurrentBatch: this.setCurrentBatch})
                                ))
      }
    }
    return (
      React.DOM.div(null, 
        React.DOM.div({className: "timeline", 
             style: {height:'100%',backgroundColor:'rgb(90, 107, 119)', width:5,marginTop:-35}}, 
             timelineElements
        ), 
        SendEmailModal({prospects: this.props.prospects, 
                        selectedCampaign: this.props.selectedCampaign, 
                        newProspects: this.props.newProspects, 
                        addFollowupSentToBatch: this.addFollowupSentToBatch, 
                        currentBatch: this.state.currentBatch, 
                        currentTemplate: this.state.currentTemplate})
      )
    );
  },

  createFollowup: function() {
    //
  },         

  addFollowup: function(day) {
    //console.log('called template edit menu')
    followups = this.state.followups
    followups.push({addTemplateMode: true, day: day})
    this.setState({ followups: followups })
  },

  editFollowup: function(day) {
    // find template set editmode is false
    followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){ followup.addTemplateMode = true }
      return followup
    })
    this.setState({followups: followups})
  },

  saveFollowup: function(day, chosenTemplate) {
    new_followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){
        followup.addTemplateMode = false
        followup.template = chosenTemplate
      }
      return followup
    })
    this.setState({followups: new_followups})
    followup = _.findWhere(new_followups, {day: day})

      if(followup.objectId){
        url = "/"+followup.objectId; type="PUT"
        data = {template: appConfig.pointer('Template', chosenTemplate.objectId)}
      } else {
        url = ""; type="POST";

          data = {
            day: day,
            campaign : appConfig.pointer('Campaign', 
                                         this.props.selectedCampaign.objectId),
            template: appConfig.pointer('Template', chosenTemplate.objectId),
          }
      }

    thiss = this;
    $.ajax({
      url:'https://api.parse.com/1/classes/Followup'+url,
      type:type,
      data:JSON.stringify(data),
      headers:appConfig.headers,
      success: function(res) {
        new_followups = _.map(new_followups, function(followup) {
          if(followup.day == day) { followup.objectId = false }
          return followup
        })
        thiss.setState({followups: new_followups})

        console.log(res)
        $.ajax({
          url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
          type:'PUT',
          data:JSON.stringify({followups: {
            __op: 'AddUnique',
            objects:[appConfig.pointer('Followup', res.objectId)]
          }}),
          headers:appConfig.headers,
          success: function() { },
          error: function() { }
        })
      },
      error: function() { },
    })
  },

  removeFollowup: function(day) {
    followups = []
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day != day)
        followups.push(this.state.followups[i])
      
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day == day)
        break
    
    this.setState({followups: followups}) 
    id = this.state.followups[i]

    thiss = this;
    if(id) {
      id = id.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Followup/'+id,
        headers:appConfig.headers,
        type:'DELETE',
        success: function(res) { console.log(res) }
      })

     console.log('REMOVE ARRAY')
      $.ajax({
        url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
        headers:appConfig.headers,
        type:'PUT',
        data: JSON.stringify({
          followups: {
            __op : 'Remove',
            objects: [appConfig.pointer('Followup', id)]
          }
        }),
        success: function(res){ console.log(res) },
        error: function() { }
      })
    }
  },

  setCurrentBatch: function(currentBatch) {
    this.setState({currentBatch: currentBatch})
  },

  setCurrentTemplate: function(template) {
    this.setState({currentTemplate: template })
  }
});

},{"./send_email_modal.js.min.js":9,"./timeline_day_element.js.min.js":11}],9:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      currentProspect: 0,
    }
  },

  sendEmails: function() {
    selectedCampaign = this.props.selectedCampaign
    campaign_id = selectedCampaign.objectId
    prospectlist_id = selectedCampaign.prospect_list.objectId
    template_id = this.props.currentTemplate.objectId
    
    $.ajax({
      //url:'https://nameless-retreat-3525.herokuapp.com/send_email',
      url:'http://127.0.0.1:5000/v1/campaign/email',
      data: {
        template : template_id,
        campaign : campaign_id,
        //batch: batch_id
      },
      success: function(res) { console.log(res.results) },
      error: function(err) { console.log(err) }
    })

    /* */
    // Update Followup
    // Persist Followup
    // close modal
  },

  render: function() {
    prospect = this.props.prospects[this.state.currentProspect]
    prospect = (prospect) ? prospect : {'name':'','email':''}

    var thiss = this;
    console.debug('SEND EMAIL BATCH')
    console.debug(this.props.currentBatch)
    newBatch = _.isEqual(this.props.currentBatch, {})
    prospects = (newBatch) ? this.props.newProspects : this.props.prospects
    if(newBatch){
      prospects = _.map(this.props.newProspects, function(prospect) {
          return UserPlaceHolder({prospect: prospect})
      })
    } else {
      prospects = _.map(this.props.prospects, function(prospect) {
        if(_.findWhere(prospect.batches, {objectId: thiss.props.currentBatch}))
          return UserPlaceHolder({prospect: prospect})
      })
    }
    prospects = _.compact(prospects)
    console.debug(prospects)
    console.debug(prospects.length)
    prospectCount = prospects.length
    email = (prospect.email) ? prospect.email : ""
    if(email == "no_email" || email == "") {
      console.log('GUESSING')
      if(prospect.email_guesses) {
        console.log('GUESSING EMAIL')
        guess = _.findWhere(prospect.email_guesses, {tried: false})
        name = _.title(prospect.name.trim())

        vars = {
          first: _.first(name.split(' ')).replace(/\W/g, ''),
          last: _.last(name.split(' ')).replace(/\W/g, ''),
          fi: _.first(name.split(' '))[0].replace(/\W/g, ''),
          li: _.last(name.split(' '))[0].replace(/\W/g, '')
        }
        if(guess){
          console.log(guess.pattern.pattern)
          email = Mustache.render(guess.pattern.pattern, vars)
          email = email+"@"+prospect.domain
        }
      } else {
        console.log('NO GUESSES FOUND')
      }
    }
    email = email.toLowerCase()
    email = email
    return (
      React.DOM.div({className: "modal fade bs-sendEmail-modal-lg", tabIndex: "-1", 
           role: "dialog", 'aria-labelledby': "mySmallModalLabel", 'aria-hidden': "true", 
           id: "sendEmailModal", style: {top:'10px'}}, 
            React.DOM.div({className: "modal-dialog modal-lg"}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.button({type: "button", className: "close", 'data-dismiss': "modal"}, React.DOM.span({'aria-hidden': "true"}, "×"), 
                    React.DOM.span({className: "sr-only"}, "Close")), 
        React.DOM.button({type: "button", 
                onClick: this.sendEmails, 
                style: {float:'right'}, 
                className: "btn btn-primary btn-sm"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), "  Send Email"), 
        React.DOM.button({type: "button", style: {marginRight:10, float:'right'}, 
                className: "btn btn-default btn-sm", 'data-dismiss': "modal"}, "Close"), 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    React.DOM.i({className: "fa fa-envelope"}), "  Send Email" + ' ' +
                    "  ", 
                    React.DOM.small(null, "("+prospectCount+")")
                  )
                ), 
                React.DOM.div({className: "modal-body", style: {paddingTop:5}}, 
                  React.DOM.h4(null, "People"), 
                  
                  React.DOM.div({className: "prospect-container"}, 
                    prospects
                  ), 
                  React.DOM.br(null), 
                  React.DOM.h4({style: {display:'inline-block'}}, "Emails    ", 
                  React.DOM.a({href: "javascript:", 
              className: (this.state.currentProspect == 0 ) ? "badge btn disabled" : "badge btn", 
                    onClick: this.previousProspect}, React.DOM.i({className: "fa fa-arrow-left"})), "  ", 
                    React.DOM.small(null, (this.state.currentProspect+1)+' of '+prospectCount
                  )), 
                  "   ", 
                  React.DOM.a({href: "javascript:", 
            className: (this.state.currentProspect ==  this.props.prospects.length-1) ? "btn disabled badge" : "btn badge", 
                    onClick: this.nextProspect}, React.DOM.i({className: "fa fa-arrow-right"})), 

                  React.DOM.div(null, 

React.DOM.ul({className: "list-group email-holder", style: {borderTop:'solid 1px #eee'}}, 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "To:  "), 
    
    React.DOM.span({className: "label label-primary"}, email)
  ), 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "Subject:  "), " ", React.DOM.span({className: "label label-primary"}, this.props.currentTemplate.subject)
  ), 
  React.DOM.li({className: "list-group-item body"})
)
  
                  )

                ), 

      React.DOM.div({className: "modal-footer", style: {display:'none'}}, 
        React.DOM.button({type: "button", 
                className: "btn btn-default", 'data-dismiss': "modal"}, "Close"), 
        React.DOM.button({type: "button", 
                className: "btn btn-primary"}, "Send Email")
      )
              )
            )
          )
    );
  },

  previousProspect: function() {
    this.setState({currentProspect: this.state.currentProspect-1 })
  },

  nextProspect: function() {
    this.setState({currentProspect: this.state.currentProspect+1 })
  },

  parseTemplate: function(templateBody) {
    first_name = prospect.name.split(' ')[0]
    //hiring_signal = prospect.signals

    signals = (prospect.signals) ? prospect.signals[0] : ""
    templateBody = Mustache.render(templateBody, {
      hiring_signal: signals,
      first_name: _.title(prospect.name.split(' ')[0])
    })

    //console.log(templateBody)
      
    return templateBody
  },

  componentDidUpdate: function() {
    //console.log(this.props.currentTemplate)
    parsedTemplate = this.parseTemplate(this.props.currentTemplate.body)
    
    //$('.body').html(this.props.currentTemplate.body)
    $('.body').html(parsedTemplate)
  }
});

var UserPlaceHolder = React.createClass({displayName: 'UserPlaceHolder',
  render: function() {
    return (
        React.DOM.div({className: "btn-group", style: {marginRight:5,marginBottom:5}}, 
          React.DOM.div({className: "btn-group"}, 
            React.DOM.button({type: "button", 
                    className: "btn btn-success btn-sm"}, 
              React.DOM.i({className: "fa fa-user"}), "  ", 
              (this.props.prospect) ? _.title(this.props.prospect.name) : ""
            )
          ), 
          React.DOM.button({type: "button", className: "btn btn-success btn-sm"}, 
            React.DOM.i({className: "fa fa-trash-o"})
          )
        )
    )
  }
});

},{}],10:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  //TemplatesMenu
  toggleTemplateEditMenu: function(currentTemplate) {
    this.props.toggleTemplateEditMenu(currentTemplate)
  },

  createTemplate: function() {
    this.props.toggleTemplateEditMenu({
      name: '',
      body:'',
      subject:'',
      editMode:true,
      newTemplate: true
    }, true)
  },

  render: function() {
    //console.log(this.props.templates)
    templates = []
    for(i=0;i< this.props.templates.length; i++) {
      templates.push(
        TemplateListItem({
          toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
          template: this.props.templates[i]})
      )
    }

    return (
      React.DOM.div({className: "", style: {padding:'0', height:'100%',textAlign:'center'}}, 
        React.DOM.div({className: "panel panel-default", 
             style: {borderRight:0,borderRadius:0,height:'100%', overflow:'auto'}}, 
          React.DOM.div({className: "panel-heading", style: {height:40}}, 
            React.DOM.span({style: {float:'left',fontSize:14,fontWeight:'bold'}}, 
              React.DOM.i({className: "fa fa-file-text-o"}), 
              React.DOM.span({style: {marginLeft:5}}, "Templates")
            ), 
            React.DOM.a({href: "javascript:", 
              className: "btn btn-success btn-xs", 
              onClick: this.createTemplate, 
                style: {float:'right'}}, 
              React.DOM.i({className: "fa fa-plus"}), 
              React.DOM.span({style: {marginLeft:5}}, "Create Template")
            )
          ), 
          React.DOM.ul({className: "list-group", 
              style: {textAlign:'left'}}, 
            templates
          )
        )
      )
    )
  }
});

var TemplateListItem = React.createClass({displayName: 'TemplateListItem',
  toggleTemplateEditMenu: function() {
    console.log(this.props.template)
    template = this.props.template
    template.editMode = false
    this.props.toggleTemplateEditMenu(template)
  },

  render: function() {
    return (
      React.DOM.div(null, 
        React.DOM.a({href: "javascript:", 
          style: {borderBottom: '1px solid rgb(221, 221, 221)',paddingTop:5,paddingBottom:0}, 
           onClick: this.toggleTemplateEditMenu, 
           className: "list-group-item"}, 
           React.DOM.span({className: "label label-default"}, 
             this.props.template.name
           ), 
           React.DOM.h6(null, "Subject:", React.DOM.span({className: "text text-muted"}, 
             " " + this.props.template.subject
           ))
         )
      )
    );
  }
});

},{}],11:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // TimelineDayElement
  // TODO
  // - add prospect list progression
  // - add scheduled followup
  //
  getInitialState: function() {
    // 
    return {
      followupCompleted: 0,
    }
  },

  addFollowup: function() {
    this.props.addFollowup(this.props.dayCount)
  },

  render: function() {
    if(this.props.addTemplateMode) {
      mode = EditTemplate({addFollowup: this.props.addFollowup, 
                           saveFollowup: this.props.saveFollowup, 
                           removeFollowup: this.props.removeFollowup, 
                           dayCount: this.props.dayCount, 
                           templates: this.props.templates})
    } else {
      mode = TemplateFollowup({currentTemplate: this.props.currentTemplate, 
                               editFollowup: this.props.editFollowup, 
                               dayCount: this.props.dayCount, 
                               currentBatch: this.props.currentBatch, 
                               hasBatch: typeof(this.props.batchCount) != "undefined" && this.props.batchCount > 0, 
                               setCurrentBatch: this.props.setCurrentBatch, 
                               dayCount: this.props.dayCount, 
                               removeFollowup: this.props.removeFollowup, 
                               setCurrentTemplate: this.props.setCurrentTemplate})
    }
    if(this.props.alreadySent) {
      mode = FollowupCompleted({currentTemplate: this.props.currentTemplate})
    }

    mode = (this.props.elementType) ? "" : mode
    addFollowup = (this.props.elementType) ? this.addFollowup : ""
    if(typeof(this.props.batchCount) != "undefined")
      batchStage = BatchStage({currentBatch: this.props.currentBatch, 
                               newProspects: this.props.newProspects, 
                               prospectListCount: this.props.prospectListCount, 
                               batchCount: this.props.batchCount, 
                               hasScheduledEmail: mode != "", 
                               dayCount: this.props.dayCount})
    else
      batchStage = ""

    dayCount = (this.props.dayCount != 0.5) ? "D"+this.props.dayCount : ""

    return (
      React.DOM.div(null, 
        React.DOM.div({onClick: addFollowup, className: "day", 'data-trigger': "manual"}, 
          dayCount
        ), 
        mode, batchStage
      )
    )
  },

  setCurrentTemplate: function(template) {
    this.props.setCurrentTemplate(template)
  }
});

var FollowupCompleted = React.createClass({displayName: 'FollowupCompleted',
  render: function() {
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs disabled", 
                'data-target': ".bs-sendEmail-modal-lg", 
                onClick: this.setCurrentTemplate, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-check"}), " Sent"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"}))
      )
                                         )
  }
})

var TemplateFollowup = React.createClass({displayName: 'TemplateFollowup',
  // EditMode False

  setCurrentTemplate: function() {
    this.props.setCurrentTemplate(this.props.currentTemplate)
    // setCurrentBatch
    this.props.setCurrentBatch(this.props.currentBatch)
    $('.bs-sendEmail-modal-lg').modal()
  },

  waitForBatch: function() {
    alertify.log("You must wait for a batch!");
  },

  render: function() {
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
          onClick: (this.props.hasBatch) ? this.setCurrentTemplate : this.waitForBatch, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-paper-plane"}), " Send"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        trash
      )
    );
  },

  editFollowup: function(e) { 
    e.preventDefault()
    console.log(this.props.dayCount)
    this.props.editFollowup(this.props.dayCount)
  },

  removeFollowup: function() {
    console.log('remove')
    this.props.removeFollowup(this.props.dayCount)
  }
});

var BatchStage = React.createClass({displayName: 'BatchStage',
  // Different Stages of People Added to Prospect List
  getInitialState: function() {
    return {
      initialBatchCount: this.props.batchCount
    }
  },

  componentDidMount: function() {
    // state
    //console.debug('INSIDE BATCH '+this.props.dayCount)
    console.debug(this.props.currentBatch)
    _batches = appConfig.pointer('ProspectBatch', this.props.currentBatch)
    if(this.props.batchCount == "~") {
      // Why doesnt this work 
      var thissss = this;
      console.debug('INSIDE BATCH '+thiss.props.dayCount)
      console.debug(_batches)
      $.ajax({
        url:'https://api.parse.com/1/classes/Prospect',
        batches: _batches,
        data: {
          where: JSON.stringify({
            batches: _batches
          }),
          count: true,
          limit:1000,
        },
        headers: appConfig.headers,
        success: function(res) { 
          //console.debug('SUCCESS GET COUNT ' + res.count)
          //console.debug(res.results) 
          thissss.setState({initialBatchCount: res.count})
        },
        error: function(err) { 
          thissss.setState({initialBatchCount: 0 })
        }
      })
    }
  },

  componentWillReceiveProps: function(nextProps) {
    if(this.props.dayCount == 0)
      this.setState({ initialBatchCount: nextProps.batchCount })
  },


  render: function() {
    if(this.props.hasScheduledEmail)
      batchStageStyle = {top:-42, left:6}
    else
      batchStageStyle = {}

    if(this.props.dayCount == 0.5)
      batchStageStyle.left = 7

    //console.log('BATCH STAGE')
    //console.log(this.props)
    //console.debug(this.props.currentBatch)                                                           

    return (
      React.DOM.div({className: "followup-placement arrow_box tmp", style: batchStageStyle}, 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-user"}), " ", 
          this.state.initialBatchCount
        ), " ", 
        React.DOM.h6({style: {display:'inline-block'}}, 
          "prospects in the sales cycle.")
      )
    );
  }
});

var EditTemplate = React.createClass({displayName: 'EditTemplate',
  // Edit Mode - True
  render: function() {
    options = []
    for(i=0;i< this.props.templates.length; i++) {
      options.push( React.DOM.option(null, this.props.templates[i].name))
    }
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, " ", React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:55,display:'inline-block'}, 
            className: "text-muted"}, 
          "Choose :"
        ), 
        React.DOM.select({className: "form-control input-sm", 
                id: "chooseTemplateForFollowup", 
                style: {display:'inline-block',width:127,marginRight:5}}, 
          options
        ), 

        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
                onClick: this.saveFollowup, 
                style: {marginRight:5}}, 
          React.DOM.i({className: "fa fa-check"})), 
        trash
      )
    )
  },

  saveFollowup: function(e) {
    //get template from currentTemplate
    e.preventDefault()
    chosenTemplate = $('#chooseTemplateForFollowup').val()
    console.log(chosenTemplate)
    for(i=0;i< this.props.templates.length; i++){
      if(this.props.templates[i].name == chosenTemplate){
        chosenTemplate = this.props.templates[i]
        break
      }
    }
    console.log(chosenTemplate)
    
    this.props.saveFollowup(this.props.dayCount, chosenTemplate)
  },

  removeFollowup: function(day) {
    this.props.removeFollowup(this.props.dayCount)
  },
});


},{}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L25vZGVfbW9kdWxlcy9ndWxwLWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvY2FtcGFpZ25fZGV0YWlsLmpzLm1pbi5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvY2FtcGFpZ25fZm9sbG93dXBfZmVlZC5qcy5taW4uanMiLCIvVXNlcnMvcm9iaW4vUHJvamVjdHMvcHJvc3BlY3Rlci9wcm9zcGVjdGVyLXBhcnNlL2Rldi9idWlsZC9qcy9jb21wb25lbnRzL2NhbXBhaWduX3JlcG9ydC5qcy5taW4uanMiLCIvVXNlcnMvcm9iaW4vUHJvamVjdHMvcHJvc3BlY3Rlci9wcm9zcGVjdGVyLXBhcnNlL2Rldi9idWlsZC9qcy9jb21wb25lbnRzL2NhbXBhaWduX3NlbnRfZW1haWwuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9jcmVhdGVfdGVtcGxhdGUuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9lZGl0X3RlbXBsYXRlLmpzLm1pbi5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvZm9sbG93dXBfdGltZWxpbmUuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9zZW5kX2VtYWlsX21vZGFsLmpzLm1pbi5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvdGVtcGxhdGVzX21lbnUuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy90aW1lbGluZV9kYXlfZWxlbWVudC5qcy5taW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ3JIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9PQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDelJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xudmFyIFRlbXBsYXRlc01lbnUgPSByZXF1aXJlKCcuL3RlbXBsYXRlc19tZW51LmpzLm1pbi5qcycpO1xudmFyIEVkaXRUZW1wbGF0ZVZpZXcgPSByZXF1aXJlKCcuL2VkaXRfdGVtcGxhdGUuanMubWluLmpzJyk7XG52YXIgQ3JlYXRlVGVtcGxhdGVWaWV3ID0gcmVxdWlyZSgnLi9jcmVhdGVfdGVtcGxhdGUuanMubWluLmpzJyk7XG52YXIgVGltZWxpbmUgPSByZXF1aXJlKCcuL2ZvbGxvd3VwX3RpbWVsaW5lLmpzLm1pbi5qcycpO1xudmFyIENhbXBhaWduQWN0aXZpdHlWaWV3ID0gcmVxdWlyZSgnLi9jYW1wYWlnbl9hY3Rpdml0eV92aWV3LmpzLm1pbi5qcycpXG52YXIgQ2FtcGFpZ25Gb2xsb3d1cEZlZWQgPSByZXF1aXJlKCcuL2NhbXBhaWduX2ZvbGxvd3VwX2ZlZWQuanMubWluLmpzJylcbnZhciBDYW1wYWlnblNlbnRFbWFpbCA9IHJlcXVpcmUoJy4vY2FtcGFpZ25fc2VudF9lbWFpbC5qcy5taW4uanMnKVxudmFyIENhbXBhaWduUmVwb3J0ID0gcmVxdWlyZSgnLi9jYW1wYWlnbl9yZXBvcnQuanMubWluLmpzJylcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy8gQ2FtcGFpZ24gRGV0YWlsXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNlbGVjdGVkVGVtcGxhdGU6IDAsXG4gICAgICB0ZW1wbGF0ZURldGFpbE1vZGU6IGZhbHNlLFxuICAgICAgZWRpdE1vZGU6IGZhbHNlLFxuICAgICAgZm9sbG93dXBEYXk6IDAsXG4gICAgICB0ZW1wbGF0ZXM6W10sXG4gICAgICBjdXJyZW50VGVtcGxhdGU6JycsXG4gICAgICBwcm9zcGVjdExpc3RDb3VudDonficsXG4gICAgICBwcm9zcGVjdHM6W10sXG4gICAgICBjdXJyZW50U2NyZWVuOiAndGltZWxpbmUnLFxuICAgICAgbmV3UHJvc3BlY3RzOiBbXSxcbiAgICAgIGJvdW5jZWQ6ICd+JyxcbiAgICAgIGRlbGl2ZXJlZDogJ34nLFxuICAgICAgb3BlbmVkOiAnficsXG4gICAgfVxuICB9LFxuXG4gIGNoYW5nZVNjcmVlbjogZnVuY3Rpb24oZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRTY3JlZW46ICQoZS50YXJnZXQpLnRleHQoKS50b0xvd2VyQ2FzZSgpfSlcbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpc3NzcyA9IHRoaXM7XG4gICAgY29tcGFueSA9IEpTT04uc3RyaW5naWZ5KEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKS5jb21wYW55KVxuICAgIHFyeSA9ICd3aGVyZT17XCJjb21wYW55XCI6Jytjb21wYW55Kyd9J1xuXG5cblxuICAgICQuYWpheCh7XG4gICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvVGVtcGxhdGUnLFxuICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBkYXRhOiBxcnksXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgdGhpc3Nzcy5zZXRTdGF0ZSh7dGVtcGxhdGVzOiByZXMucmVzdWx0c30pIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7IGNvbnNvbGUubG9nKCdlcnJvcicpIH1cbiAgICB9KTtcblxuICAgIGN1cnJlbnRMaXN0ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgJ19fdHlwZScgICAgOiAnUG9pbnRlcicsIFxuICAgICAgJ2NsYXNzTmFtZScgOiAnUHJvc3BlY3RMaXN0JyxcbiAgICAgICdvYmplY3RJZCcgIDogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLnByb3NwZWN0X2xpc3Qub2JqZWN0SWQsIFxuICAgIH0pXG5cbiAgICBxcnkgPSAnd2hlcmU9e1wibGlzdHNcIjonK2N1cnJlbnRMaXN0Kyd9JmxpbWl0PTEwMDAmY291bnQ9MSZpbmNsdWRlPWVtYWlsX2d1ZXNzZXMsZW1haWxfZ3Vlc3Nlcy5wYXR0ZXJuJ1xuICAgICQuYWpheCh7XG4gICAgICB1cmw6ICdodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL1Byb3NwZWN0JyxcbiAgICAgIGhlYWRlcnM6IGFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgZGF0YTogcXJ5LFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAvLyBUT0RPIC0gd2h5IGlzIHRoaXMgYmVpbmcgZG9uZVxuICAgICAgICBjb25zb2xlLmxvZygnUkVTVUxUUycpXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgY29uc29sZS5sb2cocmVzLnJlc3VsdHMpXG4gICAgICAgIHRoaXNzc3Muc2V0U3RhdGUoe1xuICAgICAgICAgIHByb3NwZWN0czogcmVzLnJlc3VsdHMsXG4gICAgICAgICAgcHJvc3BlY3RMaXN0Q291bnQ6IHJlcy5jb3VudCBcbiAgICAgICAgfSlcblxuICAgICAgICBpZihyZXMuY291bnQgPiAxMDAwKXtcbiAgICAgICAgICBmb3IoaT0wO2k8IE1hdGguY2VpbChyZXMuY291bnQvMTAwMCk7IGkrKykge1xuICAgICAgICAgICAgcXJ5ID0gJ3doZXJlPXtcImxpc3RzXCI6JytjdXJyZW50TGlzdCsnfSZsaW1pdD0xMDAwJmNvdW50PTEnXG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICB1cmw6ICdodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL1Byb3NwZWN0JyxcbiAgICAgICAgICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgICAgICAgIGRhdGE6IHFyeSxcbiAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIHByb3NwZWN0cyA9IHRoaXNzc3Muc3RhdGUucHJvc3BlY3RzXG4gICAgICAgICAgICAgICAgdGhpc3Nzcy5zZXRTdGF0ZSh7cHJvc3BlY3RzOiAgcHJvc3BlY3RzLmNvbmNhdChyZXMucmVzdWx0cyl9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7fVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7IH1cbiAgICB9KVxuXG4gICAgdmFyIHRoaXNzID0gdGhpcztcbiAgICBzZWxlY3RlZENhbXBhaWduID0gdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduXG4gICAgY29uc29sZS5kZWJ1Zyh0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24pXG4gICAgY29uc29sZS5kZWJ1ZygnU2VsZWN0ZWQgQ2FtcGFpZ24gQmF0Y2hlcycpXG4gICAgY29uc29sZS5kZWJ1Zyh0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24uYmF0Y2hlcylcbiAgICBiYXRjaGVzID0gdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmJhdGNoZXNcbiAgICBpZihfLmlzRXF1YWwoYmF0Y2hlcywgW10pKXsgXG4gICAgICBiYXRjaF9xdWVyeSA9IHsgJGluOiBbZmFsc2UsIG51bGxdIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcXJ5ID0gXy5tYXAoYmF0Y2hlcywgZnVuY3Rpb24oYmF0Y2gpIHtcbiAgICAgICAgcmV0dXJuIGFwcENvbmZpZy5wb2ludGVyKCdQcm9zcGVjdEJhdGNoJywgYmF0Y2gub2JqZWN0SWQpXG4gICAgICB9KVxuICAgICAgYmF0Y2hfcXVlcnkgPSB7ICRuaW46IHFyeSB9XG4gICAgfVxuICAgIHByb3NwZWN0X2xpc3QgPSB0aGlzcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLnByb3NwZWN0X2xpc3Qub2JqZWN0SWRcbiAgICAvLyBUT0RPIC0gYWRkIHN1cHBvcnQgZm9yIG1vcmUgdGhhbiAxMDAwXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdCcsXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHNlbGVjdGVkQ2FtcGFpZ246IHRoaXNzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24sXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHdoZXJlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBiYXRjaGVzOiBiYXRjaF9xdWVyeSxcbiAgICAgICAgICAgIGxpc3RzOiBhcHBDb25maWcucG9pbnRlcignUHJvc3BlY3RMaXN0JywgcHJvc3BlY3RfbGlzdCksXG4gICAgICAgIH0pLCBsaW1pdDoxMDAwXG4gICAgICB9LFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7IHRoaXNzLnNldFN0YXRlKHtuZXdQcm9zcGVjdHM6IHJlcy5yZXN1bHRzfSkgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHsgY29uc29sZS5kZWJ1ZyhlcnIucmVzcG9uc2VUZXh0KSB9XG4gICAgfSlcbiAgICBjYW1wYWlnbklkID0gdGhpc3MucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5vYmplY3RJZFxuICAgIHFyeSA9IHtcbiAgICAgIHdoZXJlOiBKU09OLnN0cmluZ2lmeSh7Y2FtcGFpZ246IGFwcENvbmZpZy5wb2ludGVyKCdDYW1wYWlnbicsIGNhbXBhaWduSWQpfSksXG4gICAgICBsaW1pdDogMTAwMCxcbiAgICAgIGNvdW50OiB0cnVlXG4gICAgfVxuICAgICQuYWpheCh7XG4gICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvU2VudEVtYWlsJyxcbiAgICAgIGRhdGE6IHFyeSxcbiAgICAgIGhlYWRlcnM6IGFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7IHRoaXNzLnNldFN0YXRlKHtkZWxpdmVyZWQ6IHJlcy5jb3VudH0pfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHsgY29uc29sZS5sb2coZXJyLnJlc3BvbnNlVGV4dCkgfVxuICAgIH0pXG4gICAgcXJ5XzEgPSB7XG4gICAgICB3aGVyZTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBjYW1wYWlnbjogYXBwQ29uZmlnLnBvaW50ZXIoJ0NhbXBhaWduJywgY2FtcGFpZ25JZCksXG4gICAgICAgIG9wZW5lZDoge1wiJGd0ZVwiOiAwfSBcbiAgICAgIH0pLFxuICAgICAgY291bnQ6IHRydWVcbiAgICB9XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9TZW50RW1haWwnLFxuICAgICAgZGF0YTogcXJ5XzEsXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykgeyB0aGlzcy5zZXRTdGF0ZSh7b3BlbmVkIDogcmVzLmNvdW50fSkgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHsgY29uc29sZS5sb2coZXJyLnJlc3BvbnNlVGV4dCkgfVxuICAgIH0pXG4gICAgcXJ5XzIgPSB7XG4gICAgICB3aGVyZTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBjYW1wYWlnbjogYXBwQ29uZmlnLnBvaW50ZXIoJ0NhbXBhaWduJywgY2FtcGFpZ25JZCksXG4gICAgICAgIGZhaWxlZDoge1wiJGd0ZVwiOiAwfSBcbiAgICAgIH0pLFxuICAgICAgY291bnQ6IHRydWVcbiAgICB9XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9TZW50RW1haWwnLFxuICAgICAgZGF0YTogcXJ5XzIsXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykgeyB0aGlzcy5zZXRTdGF0ZSh7Ym91bmNlZCA6IHJlcy5jb3VudH0pIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7IGNvbnNvbGUubG9nKGVyci5yZXNwb25zZVRleHQpIH1cbiAgICB9KVxuICB9LFxuXG4gIHJldHVyblRvT3ZlcnZpZXc6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHJvcHMudG9nZ2xlU2NyZWVuKCdDYW1wYWlnbnMnKVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZygnY2FtcGFpZ24gZGV0YWlsJylcbiAgICBjb25zb2xlLmxvZyh0aGlzLnN0YXRlLmN1cnJlbnRTY3JlZW4pXG4gICAgY29uc29sZS5sb2codGhpcy5zdGF0ZS5jdXJyZW50U2NyZWVuLmluZGV4T2YoXCJzZW50IGVtYWlsXCIpKVxuICAgIHRhYl8xID0gXCJjYW1wYWlnbi10YWItbGlua1wiXG4gICAgdGFiXzIgPSBcImNhbXBhaWduLXRhYi1saW5rXCJcbiAgICB0YWJfMyA9IFwiY2FtcGFpZ24tdGFiLWxpbmtcIlxuICAgIHRhYl80ID0gXCJjYW1wYWlnbi10YWItbGlua1wiXG4gICAgdGFiXzUgPSBcImNhbXBhaWduLXRhYi1saW5rXCJcbiAgICBpZih0aGlzLnN0YXRlLmN1cnJlbnRTY3JlZW4gPT0gXCJ0aW1lbGluZVwiKXtcbiAgICAgIC8vY29uc29sZS5kZWJ1ZygnU0VMRUNURUQgQ0FNUEFJR04nKVxuICAgICAgLy9jb25zb2xlLmRlYnVnKHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbilcbiAgICAgIGxvbHNjcmVlbiA9IEZvbGxvd3VwVGltZWxpbmUoe1xuICAgICAgICAgICAgICAgICAgdGVtcGxhdGVzOiB0aGlzLnN0YXRlLnRlbXBsYXRlcywgXG4gICAgICAgICAgICAgICAgICBwcm9zcGVjdHM6IHRoaXMuc3RhdGUucHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ2FtcGFpZ246IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbiwgXG4gICAgICAgICAgICAgICAgICBwcm9zcGVjdExpc3RDb3VudDogdGhpcy5zdGF0ZS5wcm9zcGVjdExpc3RDb3VudCwgXG4gICAgICAgICAgICAgICAgICBuZXdQcm9zcGVjdHM6IHRoaXMuc3RhdGUubmV3UHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IHRoaXMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSwgXG4gICAgICAgICAgICAgICAgICBpbml0aWFsRm9sbG93dXBzOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24uZm9sbG93dXBzfSlcbiAgICAgIHRhYl8xID0gXCJhY3RpdmUtY2FtcGFpZ24tdGFiIGNhbXBhaWduIHRhYi1saW5rXCJcbiAgICB9IGVsc2UgaWYodGhpcy5zdGF0ZS5jdXJyZW50U2NyZWVuID09IFwicmVjZW50IGFjdGl2aXR5XCIpIHtcbiAgICAgIGxvbHNjcmVlbiA9IENhbXBhaWduQWN0aXZpdHlWaWV3KG51bGwpXG4gICAgICB0YWJfMiA9IFwiYWN0aXZlLWNhbXBhaWduLXRhYiBjYW1wYWlnbiB0YWItbGlua1wiXG4gICAgfSBlbHNlIGlmKHRoaXMuc3RhdGUuY3VycmVudFNjcmVlbiA9PSBcInNjaGVkdWxlZCBmb2xsb3d1cHNcIikge1xuICAgICAgbG9sc2NyZWVuID0gQ2FtcGFpZ25Gb2xsb3d1cEZlZWQoe1xuICAgICAgICAgICAgICAgICAgICBiYXRjaGVzOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24uYmF0Y2hlcywgXG4gICAgICAgICAgICAgICAgICAgIGZvbGxvd3VwczogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmZvbGxvd3Vwc30pXG4gICAgICB0YWJfMyA9IFwiYWN0aXZlLWNhbXBhaWduLXRhYiBjYW1wYWlnbiB0YWItbGlua1wiXG4gICAgfSBlbHNlIGlmKHRoaXMuc3RhdGUuY3VycmVudFNjcmVlbiA9PSBcInNlbnQgbWFpbFwiKSB7XG4gICAgICBsb2xzY3JlZW4gPSBDYW1wYWlnblNlbnRFbWFpbCh7XG4gICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYW1wYWlnbjogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWdufSlcbiAgICAgIHRhYl80ID0gXCJhY3RpdmUtY2FtcGFpZ24tdGFiIGNhbXBhaWduIHRhYi1saW5rXCJcbiAgICB9IGVsc2UgaWYodGhpcy5zdGF0ZS5jdXJyZW50U2NyZWVuID09IFwiYW5hbHl0aWNzXCIpIHtcbiAgICAgIGxvbHNjcmVlbiA9IENhbXBhaWduUmVwb3J0KG51bGwpXG4gICAgICB0YWJfNSA9IFwiYWN0aXZlLWNhbXBhaWduLXRhYiBjYW1wYWlnbiB0YWItbGlua1wiXG4gICAgfSBlbHNle1xuICAgICAgY29uc29sZS5sb2coJ0xPTCcpXG4gICAgICBsb2xzY3JlZW4gPSBGb2xsb3d1cFRpbWVsaW5lKHtcbiAgICAgICAgICAgICAgICAgIHRlbXBsYXRlczogdGhpcy5zdGF0ZS50ZW1wbGF0ZXMsIFxuICAgICAgICAgICAgICAgICAgcHJvc3BlY3RzOiB0aGlzLnN0YXRlLnByb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZENhbXBhaWduOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24sIFxuICAgICAgICAgICAgICAgICAgcHJvc3BlY3RMaXN0Q291bnQ6IHRoaXMuc3RhdGUucHJvc3BlY3RMaXN0Q291bnQsIFxuICAgICAgICAgICAgICAgICAgbmV3UHJvc3BlY3RzOiB0aGlzLnN0YXRlLm5ld1Byb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICB0b2dnbGVUZW1wbGF0ZUVkaXRNZW51OiB0aGlzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUsIFxuICAgICAgICAgICAgICAgICAgdGVtcGxhdGVzOiB0aGlzLnN0YXRlLnRlbXBsYXRlcywgXG4gICAgICAgICAgICAgICAgICBpbml0aWFsRm9sbG93dXBzOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24uZm9sbG93dXBzfSlcbiAgICB9XG4gICAgLy9hY3RpdmVUYWIgPSBcImFjdGl2ZS1jYW1wYWlnbi10YWIgY2FtcGFpZ24gdGFiLWxpbmtcIlxuICAgICAgXG5cbiAgICAvL2xpc3RfdHlwZSA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5wcm9zcGVjdF9saXN0Lmxpc3RfdHlwZVxuICAgIGxpc3RfdHlwZSA9IFwiXCJcbiAgICBpZihsaXN0X3R5cGUgPT0gXCJtaW5pbmdfam9iXCIpXG4gICAgICBsaXN0X3R5cGUgPSBSZWFjdC5ET00uc3BhbihudWxsLCBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWNsb3VkLWRvd25sb2FkXCJ9KSwgXCLCoFwiKVxuICAgIGVsc2UgaWYobGlzdF90eXBlID09IFwic2lnbmFsX2xpc3RcIilcbiAgICAgIGxpc3RfdHlwZSA9IFJlYWN0LkRPTS5zcGFuKG51bGwsIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtd2lmaVwifSksIFwiwqBcIilcbiAgICBlbHNlXG4gICAgICBsaXN0X3R5cGUgPSBSZWFjdC5ET00uc3BhbihudWxsLCBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWxpc3QtYWx0XCJ9KSwgXCLCoFwiKVxuXG4gICAgYmF0Y2hlcyA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5iYXRjaGVzXG4gICAgYmF0Y2hlcyA9IChiYXRjaGVzKSA/IGJhdGNoZXMgOiBbXVxuICAgIGNvbnNvbGUubG9nKCdCQVRDSEVTJylcbiAgICBjb25zb2xlLmxvZyhiYXRjaGVzKVxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiY29udGFpbmVyXCIsIFxuICAgICAgICAgICBzdHlsZToge3dpZHRoOicxMDAlJyxoZWlnaHQ6JzEwMCUnLHBhZGRpbmdMZWZ0OjAscGFkZGluZ1JpZ2h0OjB9fSwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe3N0eWxlOiB7bWFyZ2luQm90dG9tOjE1fSwgaWQ6IFwiY2FtcGFpZ24tdG9wLWRldGFpbFwifSwgXG4gICAgICAgIFJlYWN0LkRPTS5oNSh7c3R5bGU6IHttYXJnaW5Ub3A6MjAsbWFyZ2luTGVmdDoyMH19LCBcbiAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBvbkNsaWNrOiB0aGlzLnJldHVyblRvT3ZlcnZpZXd9LCBcIkNhbXBhaWducyBcIiksIFxuICAgICAgICAgIFJlYWN0LkRPTS5zbWFsbChudWxsLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtzdHlsZToge21hcmdpbkxlZnQ6MTAsIG1hcmdpblJpZ2h0OjEwfSwgXG4gICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiZmEgZmEtY2hldnJvbi1yaWdodFwifSlcbiAgICAgICAgICApLCBcbiAgICAgICAgICB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24ubmFtZVxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge21hcmdpbkxlZnQ6MjAsZGlzcGxheTonaW5saW5lLWJsb2NrJyxtYXJnaW5SaWdodDoxNSxtYXJnaW5Cb3R0b206MCxmb250V2VpZ2h0Oidib2xkJyxmb250U2l6ZToxMH19LCBcbiAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInRleHQtbXV0ZWRcIn0sIFwiUFJPU1BFQ1QgTElTVDpcIiksIFwiIMKgXCJcbiAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1zdWNjZXNzXCJ9LCBcbiAgICAgICAgICBsaXN0X3R5cGUsIFxuICAgICAgICAgIHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5wcm9zcGVjdF9saXN0Lm5hbWUsIFxuICAgICAgICAgIFwiwqAgwqAgwqBcIiwgXG4gICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdXNlclwifSksIFwiwqBcIiwgdGhpcy5zdGF0ZS5wcm9zcGVjdExpc3RDb3VudFxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLmJyKG51bGwpLCBcbiAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge21hcmdpbkxlZnQ6MjAsZGlzcGxheTonaW5saW5lLWJsb2NrJyxtYXJnaW5SaWdodDo1MCxtYXJnaW5Ub3A6MCxmb250V2VpZ2h0Oidib2xkJyxmb250U2l6ZToxMH0sIFxuICAgICAgICAgICAgY2xhc3NOYW1lOiBcInRleHQtbXV0ZWRcIn0sIFxuICAgICAgICAgIFwiQkFUQ0hFUzpcIlxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1wcmltYXJ5XCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXNpdGVtYXBcIn0pLCBcIsKgXCIsIFxuICAgICAgICAgIChfLmlzRXF1YWwoYmF0Y2hlcywgW10pKSA/IDEgOiBiYXRjaGVzLmxlbmd0aFxuICAgICAgICApLCBcbiAgICAgICAgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe3N0eWxlOiB7Ym9yZGVyOicxcHggc29saWQgI2RkZCcsYm9yZGVyUmFkaXVzOjUsZmxvYXQ6J3JpZ2h0JyxtYXJnaW5Ub3A6LTQ1LG1hcmdpblJpZ2h0OjEwMH19LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJiZy13YXJuaW5nXCIsIHN0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyxwYWRkaW5nOjEwLGZvbnRXZWlnaHQ6J2JvbGQnLGN1cnNvcjoncG9pbnRlcicsd2lkdGg6NzAsdGV4dEFsaWduOidjZW50ZXInfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInRleHQtd2FybmluZ1wifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wYXBlci1wbGFuZVwifSksIFwiIFwiLCB0aGlzLnN0YXRlLmRlbGl2ZXJlZFxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJiZy1zdWNjZXNzXCIsIHN0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyxwYWRkaW5nOjEwLGZvbnRXZWlnaHQ6J2JvbGQnLGN1cnNvcjoncG9pbnRlcicsd2lkdGg6NzAsdGV4dEFsaWduOidjZW50ZXInfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInRleHQtc3VjY2Vzc1wifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1leWVcIn0pLCBcIiBcIiwgdGhpcy5zdGF0ZS5vcGVuZWRcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiYmctZGFuZ2VyXCIsIHN0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyxwYWRkaW5nOjEwLGZvbnRXZWlnaHQ6J2JvbGQnLGN1cnNvcjoncG9pbnRlcicsd2lkdGg6NzAsdGV4dEFsaWduOidjZW50ZXInfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInRleHQtZGFuZ2VyXCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWV4Y2xhbWF0aW9uLWNpcmNsZVwifSksIFwiIFwiLCB0aGlzLnN0YXRlLmJvdW5jZWRcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApLCBcbiAgICAgICAgXG4gICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICBzdHlsZToge2Zsb2F0OiAncmlnaHQnLCBtYXJnaW5Ub3A6IC0zNSwgbWFyZ2luUmlnaHQ6IDMwLCBkaXNwbGF5Oidub25lJ30sIFxuICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi1zbVwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1lbnZlbG9wZVwifSksIFwiIFNlbmQhXCJcbiAgICAgICAgKVxuICAgICAgICBcbiAgICAgICAgKSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS51bCh7Y2xhc3NOYW1lOiBcIm5hdiBuYXYtdGFicyBjYW1wYWlnbi10YWJzXCIsIHJvbGU6IFwidGFibGlzdFwiLCBzdHlsZToge3BhZGRpbmdSaWdodDowfX0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImNhbXBhaWduLXRhYlwifSwgXCIgXCIsIFJlYWN0LkRPTS5hKHtvbkNsaWNrOiB0aGlzLmNoYW5nZVNjcmVlbiwgaHJlZjogXCJqYXZhc2NyaXB0OlwiLCBjbGFzc05hbWU6IHRhYl8xfSwgXCJUSU1FTElORVwiKSksIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImNhbXBhaWduLXRhYlwifSwgUmVhY3QuRE9NLmEoe29uQ2xpY2s6IHRoaXMuY2hhbmdlU2NyZWVuLCBocmVmOiBcImphdmFzY3JpcHQ6XCIsIGNsYXNzTmFtZTogdGFiXzJ9LCBcIlJFQ0VOVCBBQ1RJVklUWVwiKSksIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImNhbXBhaWduLXRhYlwifSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uYSh7b25DbGljazogdGhpcy5jaGFuZ2VTY3JlZW4sIGhyZWY6IFwiamF2YXNjcmlwdDpcIiwgY2xhc3NOYW1lOiB0YWJfMywgc3R5bGU6IHtmb250U2l6ZToxMn19LCBcbiAgICAgICAgICAgICAgICAgICAgXCJTQ0hFRFVMRUQgRk9MTE9XVVBTXCIpKSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmxpKHtjbGFzc05hbWU6IFwiY2FtcGFpZ24tdGFiXCJ9LCBSZWFjdC5ET00uYSh7b25DbGljazogdGhpcy5jaGFuZ2VTY3JlZW4sIGhyZWY6IFwiamF2YXNjcmlwdDpcIiwgY2xhc3NOYW1lOiB0YWJfNH0sIFwiU0VOVCBNQUlMXCIpKSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmxpKHtjbGFzc05hbWU6IFwiY2FtcGFpZ24tdGFiXCJ9LCBSZWFjdC5ET00uYSh7b25DbGljazogdGhpcy5jaGFuZ2VTY3JlZW4sIGhyZWY6IFwiamF2YXNjcmlwdDpcIiwgY2xhc3NOYW1lOiB0YWJfNX0sIFwiQU5BTFlUSUNTXCIpKVxuICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgIGxvbHNjcmVlbiwgXG5cbiAgICAgICAgICAodGhpcy5zdGF0ZS50ZW1wbGF0ZURldGFpbE1vZGUpID8gRWRpdFRlbXBsYXRlVmlldyh7XG4gICAgICAgICAgICBlZGl0TW9kZTogdGhpcy5zdGF0ZS5lZGl0TW9kZSwgXG4gICAgICAgICAgICBpbml0aWFsVGVtcGxhdGVWYWx1ZXM6IHRoaXMuc3RhdGUuY3VycmVudFRlbXBsYXRlLCBcbiAgICAgICAgICAgIHNhdmVUZW1wbGF0ZTogdGhpcy5zYXZlVGVtcGxhdGUsIFxuICAgICAgICAgICAgcHJvc3BlY3Q6IHRoaXMuc3RhdGUucHJvc3BlY3RzWzBdLCBcbiAgICAgICAgICAgIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IHRoaXMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSwgXG4gICAgICAgICAgICBmb2xsb3d1cERheTogdGhpcy5zdGF0ZS5mb2xsb3d1cERheX0pIDogXCJcIlxuICAgICAgKVxuICAgICk7XG4gIH0sXG5cbiAgc2F2ZVRlbXBsYXRlOiBmdW5jdGlvbih0ZW1wbGF0ZSwgbmV3VGVtcGxhdGUpIHtcbiAgICB0ZW1wbGF0ZXMgPSB0aGlzLnN0YXRlLnRlbXBsYXRlc1xuICAgIGZvcihpPTA7aTwgdGhpcy5zdGF0ZS50ZW1wbGF0ZXMubGVuZ3RoOyBpKyspXG4gICAgICBpZih0aGlzLnN0YXRlLnRlbXBsYXRlc1tpXS5uYW1lID09IHRlbXBsYXRlLm5hbWUpXG4gICAgICAgIGJyZWFrXG4gICAgXG4gICAgY29uc29sZS5sb2codGVtcGxhdGUpXG4gICAgaWYobmV3VGVtcGxhdGUpe1xuICAgICAgdGVtcGxhdGUuc3ViamVjdCA9IHRlbXBsYXRlLnN1YmplY3RcbiAgICAgIHRlbXBsYXRlLm5hbWUgPSB0ZW1wbGF0ZS5uYW1lXG4gICAgICB0ZW1wbGF0ZS5ib2R5ID0gdGVtcGxhdGUuYm9keVxuICAgICAgdGVtcGxhdGVzLnB1c2godGVtcGxhdGUpXG5cbiAgICAgICQuYWpheCh7XG4gICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9UZW1wbGF0ZScsXG4gICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgIHR5cGU6J1BPU1QnLFxuICAgICAgICBkYXRhOkpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBuYW1lIDogdGVtcGxhdGUubmFtZSxcbiAgICAgICAgICBzdWJqZWN0OiB0ZW1wbGF0ZS5zdWJqZWN0LFxuICAgICAgICAgIGJvZHk6IHRlbXBsYXRlLmJvZHksXG4gICAgICAgICAgdXNlcjp7XG4gICAgICAgICAgICBfX3R5cGU6ICdQb2ludGVyJyxcbiAgICAgICAgICAgIGNsYXNzTmFtZTonX1VzZXInLFxuICAgICAgICAgICAgb2JqZWN0SWQ6SlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIpLm9iamVjdElkLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgY29tcGFueTpKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5jdXJyZW50VXNlcikuY29tcGFueSxcbiAgICAgICAgfSksXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB0ZW1wbGF0ZXNbaV0uc3ViamVjdCA9IHRlbXBsYXRlLnN1YmplY3RcbiAgICAgIHRlbXBsYXRlc1tpXS5ib2R5ID0gdGVtcGxhdGUuYm9keVxuXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvVGVtcGxhdGUvJyt0ZW1wbGF0ZXNbaV0ub2JqZWN0SWQsXG4gICAgICAgIHR5cGU6J1BVVCcsXG4gICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG5hbWUgOiB0ZW1wbGF0ZS5uYW1lLFxuICAgICAgICAgIHN1YmplY3Q6IHRlbXBsYXRlLnN1YmplY3QsXG4gICAgICAgICAgYm9keTogdGVtcGxhdGUuYm9keSxcbiAgICAgICAgfSksXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoe3RlbXBsYXRlczogdGVtcGxhdGVzIH0pXG5cbiAgfSxcblxuICB0b2dnbGVUZW1wbGF0ZUVkaXRNZW51OiBmdW5jdGlvbihjdXJyZW50VGVtcGxhdGUsIGVkaXRNb2RlKSB7XG4gICAgZWRpdE1vZGUgPSAoZWRpdE1vZGUpID8gdHJ1ZSA6IGZhbHNlXG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBjdXJyZW50VGVtcGxhdGU6IGN1cnJlbnRUZW1wbGF0ZSxcbiAgICAgIHRlbXBsYXRlRGV0YWlsTW9kZTogIXRoaXMuc3RhdGUudGVtcGxhdGVEZXRhaWxNb2RlLFxuICAgIH0pXG4gIH1cbn0pO1xuXG52YXIgRm9sbG93dXBUaW1lbGluZSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ0ZvbGxvd3VwVGltZWxpbmUnLFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICAgIFJlYWN0LkRPTS5kaXYobnVsbCwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImNvbC1tZC04IHBhbmVsIHBhbmVsLWRlZmF1bHRcIiwgXG4gICAgICAgICAgICAgICBzdHlsZToge2hlaWdodDo0MzYscGFkZGluZ0xlZnQ6MzA1LHBhZGRpbmdUb3A6NTAsb3ZlcmZsb3c6J2F1dG8nLGJvcmRlclJpZ2h0OjAsYm9yZGVyUmFkaXVzOjAsIGJvcmRlclRvcDowfX0sIFxuICAgICAgICAgICAgICAgIFRpbWVsaW5lKHtcbiAgICAgICAgICAgICAgICAgIHRlbXBsYXRlczogdGhpcy5wcm9wcy50ZW1wbGF0ZXMsIFxuICAgICAgICAgICAgICAgICAgcHJvc3BlY3RzOiB0aGlzLnByb3BzLnByb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZENhbXBhaWduOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24sIFxuICAgICAgICAgICAgICAgICAgcHJvc3BlY3RMaXN0Q291bnQ6IHRoaXMucHJvcHMucHJvc3BlY3RMaXN0Q291bnQsIFxuICAgICAgICAgICAgICAgICAgbmV3UHJvc3BlY3RzOiB0aGlzLnByb3BzLm5ld1Byb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICB0b2dnbGVUZW1wbGF0ZUVkaXRNZW51OiB0aGlzLnByb3BzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUsIFxuICAgICAgICAgICAgICAgICAgaW5pdGlhbEZvbGxvd3VwczogdGhpcy5wcm9wcy5pbml0aWFsRm9sbG93dXBzfSlcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiY29sLW1kLTRcIiwgXG4gICAgICAgICAgICAgICBzdHlsZToge3BhZGRpbmdMZWZ0OjAscGFkZGluZ1JpZ2h0OjAsaGVpZ2h0OjQzNn19LCBcbiAgICAgICAgICAgIFRlbXBsYXRlc01lbnUoe1xuICAgICAgICAgICAgICB0ZW1wbGF0ZXM6IHRoaXMucHJvcHMudGVtcGxhdGVzLCBcbiAgICAgICAgICAgICAgdG9nZ2xlVGVtcGxhdGVFZGl0TWVudTogdGhpcy5wcm9wcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51fSlcbiAgICAgICAgICApXG4gICAgICAgIClcblxuICAgIClcbiAgfVxufSlcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvLyBGb2xsb3d1cEZlZWRcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZm9sbG93dXBzOiBbXVxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGZvciBlYWNoIGJhdGNoIGZpbmQgZm9sbG93dXBzIHJlbWFpbmluZ1xuICAgICAgICAvLyBzb3J0IGZvbGxvd3VwcyBieSBhc2NlbmRpbmcgZm9sbG93dXAgZGF5XG4gICAgICAgIC8vXG4gICAgLy8gQmF0Y2ggU3RhcnQgRGF0ZVxuICAgIC8vIEN1cnJlbnQgQmF0Y2ggRGF0ZVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRoaXNzID0gdGhpcztcbiAgICBmb2xsb3d1cHMgPSBfLm1hcCh0aGlzLnByb3BzLmJhdGNoZXMsIGZ1bmN0aW9uKGJhdGNoKSB7XG4gICAgICBub3cgPSBtb21lbnQoKS5zdGFydE9mKCdkYXknKS52YWx1ZU9mKCkvMTAwMFxuICAgICAgYmF0Y2guY3VycmVudERheSA9IG1vbWVudChiYXRjaC5zdGFydGVkKS5kaWZmKG1vbWVudChub3cpLCAgJ2RheXMnKSAqIC0xXG4gICAgICByZXR1cm4gXy5tYXAodGhpc3MucHJvcHMuZm9sbG93dXBzLCBmdW5jdGlvbihmb2xsb3d1cCkge1xuICAgICAgICBmb2xsb3d1cC5iYXRjaCA9IGJhdGNoXG4gICAgICAgIGlmKGZvbGxvd3VwLmRheSA+PSBiYXRjaC5jdXJyZW50RGF5KVxuICAgICAgICAgIHJldHVybiBmb2xsb3d1cFxuICAgICAgfSlcbiAgICB9KVxuICAgIGZvbGxvd3VwcyA9IF8uc29ydEJ5KGZvbGxvd3VwcywgZnVuY3Rpb24oZm9sbG93dXApeyByZXR1cm4gZm9sbG93dXAuZGF5IH0pXG5cbiAgICBjb25zb2xlLmRlYnVnKGZvbGxvd3VwcylcblxuICAgIGFjdGl2aXRpZXMgPSBfLm1hcChmb2xsb3d1cHNbMF0sIGZ1bmN0aW9uKGZvbGxvd3VwKSB7XG4gICAgICByZXR1cm4gRm9sbG93dXBzKHtmb2xsb3d1cDogZm9sbG93dXAsIGJhdGNoOiBmb2xsb3d1cC5iYXRjaH0pXG4gICAgfSlcbiAgICBjb25zb2xlLmRlYnVnKGFjdGl2aXRpZXMpXG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7c3R5bGU6IHtvdmVyZmxvdzonYXV0bycsaGVpZ2h0OjQzNn19LCBcbiAgICAgICAgUmVhY3QuRE9NLnRhYmxlKHtjbGFzc05hbWU6IFwidGFibGVcIiwgc3R5bGU6IHttYXJnaW5Cb3R0b206MH19LCBcbiAgICAgICAgICBSZWFjdC5ET00udGhlYWQobnVsbCwgXG4gICAgICAgICAgICBSZWFjdC5ET00udGgobnVsbCksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiU2NoZWR1bGVkIGZvciBcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiT3V0cmVhY2ggU3RhZ2UgXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlByb3NwZWN0IExpc3RcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiVGVtcGxhdGUgXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aCh7c3R5bGU6IHt0ZXh0QWxpZ246J2NlbnRlcid9fSwgXCJBY3Rpb24gQnV0dG9uc1wiKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS50Ym9keShudWxsLCBcbiAgICAgICAgICAgIGFjdGl2aXRpZXNcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gIH1cbn0pXG5cbnZhciBGb2xsb3d1cHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdGb2xsb3d1cHMnLFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIC8vIHRoaXMucHJvcHMuYmF0Y2hcbiAgICAvLyB0aGlzLnByb3BzLmZvbGxvd3VwXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS50cihudWxsLCBcbiAgICAgICAgICBSZWFjdC5ET00udGQobnVsbCksIFxuICAgICAgICAgIFJlYWN0LkRPTS50ZChudWxsLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5oNihudWxsLCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jbG9ja1wifSksIFwiwqBcIiArICcgJyArXG4gICAgICAgICAgICAgIFwiMjkgbWludXRlcyBhZ29cIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS50ZChudWxsLCBcbiAgICAgICAgICAgIFwic2Vjb25kXCJcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udGQobnVsbCwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7Y3Vyc29yOidwb2ludGVyJ319LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtbGlzdC1hbHRcIn0pLCBcIiDCoFwiICsgJyAnICtcbiAgICAgICAgICAgIFwiQm9zdG9uIFZQIFNhbGVzIC0gUmV0YWlsXCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udGQobnVsbCwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7Y3Vyc29yOidwb2ludGVyJ319LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZmlsZS10ZXh0LW9cIn0pLCBcIiDCoFwiICsgJyAnICtcbiAgICAgICAgICAgIFwiRm9sbG93dXAgIzIgLSBQcm92aWRlIFZhbHVlIFwiLCBSZWFjdC5ET00uYnIobnVsbCksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcIiBTdWJqZWN0OiBKdXN0IHdhbnRlZCB0byBmb2xsb3d1cCBvbiB0aGUgbGFzdCBlbWFpbCBcIiksIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInRleHQtbXV0ZWRcIn0sIFwiIEJvZHk6IEp1c3Qgd2FudGVkIHRvIGZvbGxvd3VwIG9uIHRoZSBsYXN0IGVtYWlsIFwiKVxuXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSwgXG5cbiAgICAgICAgICBSZWFjdC5ET00udGQoe3N0eWxlOiB7dGV4dEFsaWduOidjZW50ZXInfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4teHNcIiwgc3R5bGU6IHt3aWR0aDoxNzAsZm9udFdlaWdodDonYm9sZCcsbWFyZ2luQm90dG9tOjJ9fSwgXCJTZW5kIE5vd1wiKSwgUmVhY3QuRE9NLmJyKG51bGwpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIGNsYXNzTmFtZTogXCJidG4gYnRuLXN1Y2Nlc3MgYnRuLXhzXCIsIHN0eWxlOiB7d2lkdGg6MTcwLGZvbnRXZWlnaHQ6J2JvbGQnLG1hcmdpbkJvdHRvbToyfX0sIFwiUmVtaW5kIG1lIGluIDEgaG91clwiKSwgUmVhY3QuRE9NLmJyKG51bGwpXG4gICAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgfVxufSlcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5sb2wgPSBcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy8gQ2FtcGFpZ24gUmVwb3J0XG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkgeyBcbiAgICB0ZXN0RGF0YSA9IHRoaXMudGVzdERhdGEoKVxuICAgIHZhciBpbmR1c3RyeUNoYXJ0ICAgPSBkYy5waWVDaGFydChcIiNpbmR1c3RyeS1jaGFydFwiKSxcbiAgICAgICAgc3BlbmRIaXN0Q2hhcnQgID0gZGMuYmFyQ2hhcnQoXCIjY2hhcnQtaGlzdC1zcGVuZFwiKSxcbiAgICAgICAgc3BlbmRlclJvd0NoYXJ0ID0gZGMucm93Q2hhcnQoXCIjY2hhcnQtcm93LXNwZW5kZXJzXCIpO1xuXG4gICAgLy8gc2V0IGNyb3NzZmlsdGVyXG4gICAgdmFyIG5keCA9IGNyb3NzZmlsdGVyKHNwZW5kRGF0YSksXG4gICAgICAgIHllYXJEaW0gID0gbmR4LmRpbWVuc2lvbihmdW5jdGlvbihkKSB7cmV0dXJuICtkLlllYXI7fSksXG4gICAgICAgIHNwZW5kRGltID0gbmR4LmRpbWVuc2lvbihmdW5jdGlvbihkKSB7cmV0dXJuIE1hdGguZmxvb3IoZC5TcGVudC8xMCk7fSksXG4gICAgICAgIG5hbWVEaW0gID0gbmR4LmRpbWVuc2lvbihmdW5jdGlvbihkKSB7cmV0dXJuIGQuTmFtZTt9KSxcbiAgICAgICAgc3BlbmRQZXJZZWFyID0geWVhckRpbS5ncm91cCgpLnJlZHVjZVN1bShmdW5jdGlvbihkKSB7cmV0dXJuICtkLlNwZW50O30pLFxuICAgICAgICBzcGVuZFBlck5hbWUgPSBuYW1lRGltLmdyb3VwKCkucmVkdWNlU3VtKGZ1bmN0aW9uKGQpIHtyZXR1cm4gK2QuU3BlbnQ7fSksXG4gICAgICAgIHNwZW5kSGlzdCAgICA9IHNwZW5kRGltLmdyb3VwKCkucmVkdWNlQ291bnQoKTtcblxuICAgIGluZHVzdHJ5Q2hhcnRcbiAgICAgICAgLndpZHRoKDIwMCkuaGVpZ2h0KDIwMClcbiAgICAgICAgLmRpbWVuc2lvbih5ZWFyRGltKVxuICAgICAgICAuZ3JvdXAoc3BlbmRQZXJZZWFyKVxuICAgICAgICAuaW5uZXJSYWRpdXMoNTApO1xuXG4gICAgLy9cbiAgICAvLyBCYXRjaCBBbmFseXRpY3MgLSBCdWJibGUgQ2hhcnRcbiAgICAvLyBCYXRjaCBCbG9jayBDaGFydHNcbiAgICAvLyBQaWUgQ2hhcnQgLSBJbmR1c3RyeVxuICAgIC8vIFJldmVudWUgLSBQQ1xuICAgIC8vIENvbXBhbnkgU2l6ZSAtIFBDXG4gICAgLy8gT3BlbnMgLyBSZXBsaWVzIC8gTGluayBDbGlja3MgLyBCb3VuY2VzIC0gQmFyIENoYXJ0XG4gICAgLy8gVGl0bGVzIC0gUENcbiAgICAvLyBUaW1lIC8gRGF0ZSBFbWFpbCBTZW50IC0gTGluZSBDaGFydFxuICAgIC8vIERhdGUgUHJvc3BlY3RlZCAtIEJDXG4gICAgLy9cbiAgfSxcbiAgXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYobnVsbCwgXG4gICAgICAgIFwiUmVwb3J0IFZpZXdcIiwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2lkOiBcImluZHVzdHJ5LWNoYXJ0XCJ9KVxuICAgICAgKVxuICAgIClcbiAgfSxcblxuICB0ZXN0RGF0YTogZnVuY3Rpb24oKSB7IFxuICAgIHJldHVybiBbe1wid2Vic2l0ZVwiOiBcImh0dHA6Ly93d3cudGVuY2F0ZS5jb21cIiwgXCJjYW1wYWlnblwiOiB7XCJjbGFzc05hbWVcIjogXCJDYW1wYWlnblwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm5tRWxVN3pjQmZcIn0sIFwicG9zXCI6IFwiXFxcXHUwMGEwRGlyZWN0b3IgU2FsZXMgJiBNYXJrZXRpbmcgQWVyb3NwYWNlXCIsIFwiX190eXBlXCI6IFwiT2JqZWN0XCIsIFwidXBkYXRlZEF0XCI6IFwiMjAxNC0xMC0xMFQxMzoyOToyMi41MTZaXCIsIFwiY3JlYXRlZEF0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxOC40ODFaXCIsIFwiY2l0eVwiOiBcIkNvdmVudHJ5LCBVbml0ZWQgS2luZ2RvbVxcXFx1MDBhMFwiLCBcImFyY2hpdmVkXCI6IHRydWUsIFwibG9hZGluZ1wiOiBmYWxzZSwgXCJvYmplY3RJZFwiOiBcImZ0eUtDR21SOUhcIiwgXCJjb21wYW55X25hbWVcIjogXCJUZW5jYXRlXCIsIFwibWFpbGd1bl9pZFwiOiBcIjwyMDE0MTAxMDE0MDIxOC41ODg4My43NTA0MEBjdXN0b21lcm9ocS5jb20+XCIsIFwiZW1haWxfZ3Vlc3Nlc1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInU4U2V0Q1FPSlBcIn0sIHtcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJQMEttRkc5MmRLXCJ9XSwgXCJlbWFpbFwiOiBcIm4udGlmZmluQHRlbmNhdGUuY29tXCIsIFwicHJvc3BlY3RfY3JlYXRlZF9hdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTguNDgxWlwiLCBcImNvbXBhbnlcIjoge1wiY2xhc3NOYW1lXCI6IFwiQ29tcGFueVwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImZxSFdwNU5zRnhcIn0sIFwibGlzdHNcIjogW3tcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0TGlzdFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIml6TGJWdWx5cjZcIn1dLCBcInVzZXJcIjoge1wiY2xhc3NOYW1lXCI6IFwiVXNlclwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInhXRVNpdzVTbWRcIn0sIFwiY29tcGFueV9zaXplXCI6IFwiMTAwMS01MDAwIGVtcGxveWVlc1wiLCBcIm5hbWVcIjogXCJOaWNrIFRpZmZpblwiLCBcImluZHVzdHJ5XCI6IFwiVGV4dGlsZXNcIiwgXCJsaW5rZWRpbl91cmxcIjogXCJ1ay5saW5rZWRpbi5jb20vcHViL25pY2stdGlmZmluLzUvNDM0LzI1NlwiLCBcImJhdGNoXCI6IHtcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0QmF0Y2hcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJZUGFUR2JENTZhXCJ9LCBcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0XCIsIFwicXVldWVkXCI6IHRydWV9LCB7XCJ3ZWJzaXRlXCI6IFwiaHR0cDovL3d3dy5wZWFyc29uLmNvbVwiLCBcImNhbXBhaWduXCI6IHtcImNsYXNzTmFtZVwiOiBcIkNhbXBhaWduXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibm1FbFU3emNCZlwifSwgXCJwb3NcIjogXCJcXFxcdTAwYTBEaXJlY3RvciwgU2FsZXMgUGVyZm9ybWFuY2UgTWFuYWdlbWVudFwiLCBcIl9fdHlwZVwiOiBcIk9iamVjdFwiLCBcInVwZGF0ZWRBdFwiOiBcIjIwMTQtMTAtMTBUMTM6Mjk6MjIuNzgwWlwiLCBcImNyZWF0ZWRBdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTcuODczWlwiLCBcImNpdHlcIjogXCJQaG9lbml4LCBBcml6b25hIEFyZWFcXFxcdTAwYTBcIiwgXCJhcmNoaXZlZFwiOiB0cnVlLCBcImxvYWRpbmdcIjogZmFsc2UsIFwib2JqZWN0SWRcIjogXCJMUGlFMENjRXNSXCIsIFwiY29tcGFueV9uYW1lXCI6IFwiUGVhcnNvbiBwbGNcIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwMjE5LjUwMDE1LjIwNTcxQGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiUTU3a3dOMUxRVFwifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIjUzSzBsV1k3aHZcIn1dLCBcImVtYWlsXCI6IFwiamFzb24ubGlua2VkaW5AcGVhcnNvbi5jb21cIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNy44NzNaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIxMCwwMDErIGVtcGxveWVlc1wiLCBcIm5hbWVcIjogXCJKYXNvbiBVcGFoXCIsIFwiaW5kdXN0cnlcIjogXCJFZHVjYXRpb24gTWFuYWdlbWVudFwiLCBcImxpbmtlZGluX3VybFwiOiBcInd3dy5saW5rZWRpbi5jb20vcHViL2phc29uLXVwYWgvNy8yMzMvOTQwXCIsIFwiYmF0Y2hcIjoge1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RCYXRjaFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIllQYVRHYkQ1NmFcIn0sIFwiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RcIiwgXCJxdWV1ZWRcIjogdHJ1ZX0sIHtcIndlYnNpdGVcIjogXCJodHRwOi8vd3d3LnJtd211c2ljLmNvbVwiLCBcImNhbXBhaWduXCI6IHtcImNsYXNzTmFtZVwiOiBcIkNhbXBhaWduXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibm1FbFU3emNCZlwifSwgXCJwb3NcIjogXCJcXFxcdTAwYTBEaXJlY3RvciBvZiBTYWxlcyBhbmQgTWFya2V0aW5nXCIsIFwiX190eXBlXCI6IFwiT2JqZWN0XCIsIFwidXBkYXRlZEF0XCI6IFwiMjAxNC0xMC0xMFQxMzoyOToyMy4wNDlaXCIsIFwiY3JlYXRlZEF0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNi43MzVaXCIsIFwiY2l0eVwiOiBcIlRvcm9udG8sIE9udGFyaW8sIENhbmFkYVxcXFx1MDBhMFwiLCBcImFyY2hpdmVkXCI6IHRydWUsIFwibG9hZGluZ1wiOiBmYWxzZSwgXCJvcGVuZWRcIjogdHJ1ZSwgXCJvYmplY3RJZFwiOiBcIkNPU3B5WGdzRDJcIiwgXCJjb21wYW55X25hbWVcIjogXCJSTVcgTXVzaWNcIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwMjE5LjUwMDE5LjY3NDE4QGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiM09FS3RJeElBcFwifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInh2R2JVWXBvNDNcIn1dLCBcImVtYWlsXCI6IFwibm9fZW1haWxcIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNi43MzVaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIxMS01MCBlbXBsb3llZXNcIiwgXCJuYW1lXCI6IFwiTGF1cmEgTmlrb2xpY1wiLCBcImluZHVzdHJ5XCI6IFwiTXVzaWNcIiwgXCJsaW5rZWRpbl91cmxcIjogXCJjYS5saW5rZWRpbi5jb20vcHViL2xhdXJhLW5pa29saWMvNTAvNDUwLzc3MVwiLCBcImJhdGNoXCI6IHtcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0QmF0Y2hcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJZUGFUR2JENTZhXCJ9LCBcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0XCIsIFwicXVldWVkXCI6IHRydWV9LCB7XCJ3ZWJzaXRlXCI6IFwiaHR0cDovL3d3dy5zYXVkaWFjYXJnby5jb21cIiwgXCJjYW1wYWlnblwiOiB7XCJjbGFzc05hbWVcIjogXCJDYW1wYWlnblwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm5tRWxVN3pjQmZcIn0sIFwicG9zXCI6IFwiXFxcXHUwMGEwRGlyZWN0b3IgR2xvYmFsIFNhbGVzIFN1cHBvcnRcIiwgXCJfX3R5cGVcIjogXCJPYmplY3RcIiwgXCJ1cGRhdGVkQXRcIjogXCIyMDE0LTEwLTEwVDEzOjI5OjIzLjMyN1pcIiwgXCJjcmVhdGVkQXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE2LjEyN1pcIiwgXCJjaXR5XCI6IFwiU2F1ZGkgQXJhYmlhXFxcXHUwMGEwXCIsIFwiYXJjaGl2ZWRcIjogdHJ1ZSwgXCJsb2FkaW5nXCI6IGZhbHNlLCBcIm9wZW5lZFwiOiB0cnVlLCBcIm9iamVjdElkXCI6IFwiS2UwNmc2a1NrNVwiLCBcImNvbXBhbnlfbmFtZVwiOiBcIlNhdWRpIEFpcmxpbmVzIENhcmdvIENvbXBhbnlcIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwMjIwLjU4ODg3LjUyNDg0QGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibzMzSmF2aFNweVwifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImwzdnkyVHhGNzNcIn1dLCBcImVtYWlsXCI6IFwibm9fZW1haWxcIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNi4xMjdaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIxMDAxLTUwMDAgZW1wbG95ZWVzXCIsIFwibmFtZVwiOiBcIlJhaW5lciBNdWVsbGVyXCIsIFwiaW5kdXN0cnlcIjogXCJBaXJsaW5lcy9BdmlhdGlvblwiLCBcImxpbmtlZGluX3VybFwiOiBcInNhLmxpbmtlZGluLmNvbS9wdWIvcmFpbmVyLW11ZWxsZXIvNS9hNDgvNDI4XCIsIFwiYmF0Y2hcIjoge1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RCYXRjaFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIllQYVRHYkQ1NmFcIn0sIFwiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RcIiwgXCJxdWV1ZWRcIjogdHJ1ZX0sIHtcIndlYnNpdGVcIjogXCJodHRwOi8vd3d3LnNoYWRvd3pwcm90ZWN0aW9uLmNvbVwiLCBcImNhbXBhaWduXCI6IHtcImNsYXNzTmFtZVwiOiBcIkNhbXBhaWduXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibm1FbFU3emNCZlwifSwgXCJwb3NcIjogXCJcXFxcdTAwYTBEaXJlY3RvclwiLCBcIl9fdHlwZVwiOiBcIk9iamVjdFwiLCBcInVwZGF0ZWRBdFwiOiBcIjIwMTQtMTAtMTBUMTM6Mjk6MjMuNTk4WlwiLCBcImNyZWF0ZWRBdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTUuMTQ3WlwiLCBcImNpdHlcIjogXCJOZXcgRGVsaGkgQXJlYSwgSW5kaWFcXFxcdTAwYTBcIiwgXCJhcmNoaXZlZFwiOiB0cnVlLCBcImxvYWRpbmdcIjogZmFsc2UsIFwib3BlbmVkXCI6IHRydWUsIFwib2JqZWN0SWRcIjogXCJmNDRZVTJZcm03XCIsIFwiY29tcGFueV9uYW1lXCI6IFwiTS9TIEdvbGRlbiBCcmlja3MgQ29uc3RydWN0aW9ucyBQdnQuIEx0ZC5cIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwMjIwLjE5OTYwLjMxNTdAY3VzdG9tZXJvaHEuY29tPlwiLCBcImVtYWlsX2d1ZXNzZXNcIjogW3tcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCI2QjRNRHFXcXR3XCJ9LCB7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZTlzTUZMMVFXeFwifV0sIFwiZW1haWxcIjogXCJub19lbWFpbFwiLCBcInByb3NwZWN0X2NyZWF0ZWRfYXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE1LjE0N1pcIiwgXCJjb21wYW55XCI6IHtcImNsYXNzTmFtZVwiOiBcIkNvbXBhbnlcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJmcUhXcDVOc0Z4XCJ9LCBcImxpc3RzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdExpc3RcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJpekxiVnVseXI2XCJ9XSwgXCJ1c2VyXCI6IHtcImNsYXNzTmFtZVwiOiBcIlVzZXJcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJ4V0VTaXc1U21kXCJ9LCBcImNvbXBhbnlfc2l6ZVwiOiBcIjIwMS01MDAgZW1wbG95ZWVzXCIsIFwibmFtZVwiOiBcIlZpdmVrIE5hcmFuZ1wiLCBcImluZHVzdHJ5XCI6IFwiU2VjdXJpdHkgYW5kIEludmVzdGlnYXRpb25zXCIsIFwibGlua2VkaW5fdXJsXCI6IFwiaW4ubGlua2VkaW4uY29tL3B1Yi92aXZlay1uYXJhbmcvMjAvYjY3LzM5XCIsIFwiYmF0Y2hcIjoge1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RCYXRjaFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIllQYVRHYkQ1NmFcIn0sIFwiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RcIiwgXCJxdWV1ZWRcIjogdHJ1ZX0sIHtcIndlYnNpdGVcIjogXCJodHRwOi8vd3d3LnNoYW5ncmktbGEuY29tXCIsIFwiY2FtcGFpZ25cIjoge1wiY2xhc3NOYW1lXCI6IFwiQ2FtcGFpZ25cIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJubUVsVTd6Y0JmXCJ9LCBcInBvc1wiOiBcIlxcXFx1MDBhMERpcmVjdG9yIG9mIFNhbGVzIGFuZCBNYXJrZXRpbmdcIiwgXCJfX3R5cGVcIjogXCJPYmplY3RcIiwgXCJ1cGRhdGVkQXRcIjogXCIyMDE0LTEwLTEwVDEzOjI5OjIzLjg4MFpcIiwgXCJjcmVhdGVkQXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjEzLjE5N1pcIiwgXCJjaXR5XCI6IFwiQnJpc2JhbmUsIEF1c3RyYWxpYVxcXFx1MDBhMFwiLCBcImFyY2hpdmVkXCI6IHRydWUsIFwibG9hZGluZ1wiOiBmYWxzZSwgXCJvYmplY3RJZFwiOiBcIlRTU0RFWjNsVUFcIiwgXCJjb21wYW55X25hbWVcIjogXCJTaGFuZ3JpLUxhIEhvdGVscyBhbmQgUmVzb3J0c1wiLCBcIm1haWxndW5faWRcIjogXCI8MjAxNDEwMTAxNDAyMjEuMzk1NDguMjk2MjdAY3VzdG9tZXJvaHEuY29tPlwiLCBcImVtYWlsX2d1ZXNzZXNcIjogW3tcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJQSURHSlBxcmFJXCJ9LCB7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibUc0VTY5eERjZ1wifV0sIFwiZW1haWxcIjogXCJhbmR5Lm1jY3V0Y2hlb25Ac2hhbmdyaS1sYS5jb21cIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxMy4xOTdaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIxMCwwMDErIGVtcGxveWVlc1wiLCBcIm5hbWVcIjogXCJBbmR5IE1jQ3V0Y2hlb25cIiwgXCJpbmR1c3RyeVwiOiBcIkhvc3BpdGFsaXR5XCIsIFwibGlua2VkaW5fdXJsXCI6IFwiYXUubGlua2VkaW4uY29tL3B1Yi9hbmR5LW1jY3V0Y2hlb24vMWEvNjY1LzY1MFwiLCBcImJhdGNoXCI6IHtcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0QmF0Y2hcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJZUGFUR2JENTZhXCJ9LCBcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0XCIsIFwicXVldWVkXCI6IHRydWV9LCB7XCJ3ZWJzaXRlXCI6IFwiaHR0cDovL3d3dy50ZW5jYXRlLmNvbVwiLCBcImNhbXBhaWduXCI6IHtcImNsYXNzTmFtZVwiOiBcIkNhbXBhaWduXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibm1FbFU3emNCZlwifSwgXCJwb3NcIjogXCJcXFxcdTAwYTBEaXJlY3RvciBTYWxlcyAmIE1hcmtldGluZyBBZXJvc3BhY2VcIiwgXCJfX3R5cGVcIjogXCJPYmplY3RcIiwgXCJ1cGRhdGVkQXRcIjogXCIyMDE0LTEwLTEwVDEzOjI5OjIyLjUxNlpcIiwgXCJjcmVhdGVkQXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE4LjQ4MVpcIiwgXCJjaXR5XCI6IFwiQ292ZW50cnksIFVuaXRlZCBLaW5nZG9tXFxcXHUwMGEwXCIsIFwiYXJjaGl2ZWRcIjogdHJ1ZSwgXCJsb2FkaW5nXCI6IGZhbHNlLCBcIm9iamVjdElkXCI6IFwiZnR5S0NHbVI5SFwiLCBcImNvbXBhbnlfbmFtZVwiOiBcIlRlbmNhdGVcIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwODEzLjE5OTU2LjIwNDU0QGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwidThTZXRDUU9KUFwifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIlAwS21GRzkyZEtcIn1dLCBcImVtYWlsXCI6IFwibi50aWZmaW5AdGVuY2F0ZS5jb21cIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxOC40ODFaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIxMDAxLTUwMDAgZW1wbG95ZWVzXCIsIFwibmFtZVwiOiBcIk5pY2sgVGlmZmluXCIsIFwiaW5kdXN0cnlcIjogXCJUZXh0aWxlc1wiLCBcImxpbmtlZGluX3VybFwiOiBcInVrLmxpbmtlZGluLmNvbS9wdWIvbmljay10aWZmaW4vNS80MzQvMjU2XCIsIFwiYmF0Y2hcIjoge1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RCYXRjaFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIllQYVRHYkQ1NmFcIn0sIFwiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RcIiwgXCJxdWV1ZWRcIjogdHJ1ZX0sIHtcIndlYnNpdGVcIjogXCJodHRwOi8vd3d3LnBlYXJzb24uY29tXCIsIFwiY2FtcGFpZ25cIjoge1wiY2xhc3NOYW1lXCI6IFwiQ2FtcGFpZ25cIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJubUVsVTd6Y0JmXCJ9LCBcInBvc1wiOiBcIlxcXFx1MDBhMERpcmVjdG9yLCBTYWxlcyBQZXJmb3JtYW5jZSBNYW5hZ2VtZW50XCIsIFwiX190eXBlXCI6IFwiT2JqZWN0XCIsIFwidXBkYXRlZEF0XCI6IFwiMjAxNC0xMC0xMFQxMzoyOToyMi43ODBaXCIsIFwiY3JlYXRlZEF0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNy44NzNaXCIsIFwiY2l0eVwiOiBcIlBob2VuaXgsIEFyaXpvbmEgQXJlYVxcXFx1MDBhMFwiLCBcImFyY2hpdmVkXCI6IHRydWUsIFwibG9hZGluZ1wiOiBmYWxzZSwgXCJvYmplY3RJZFwiOiBcIkxQaUUwQ2NFc1JcIiwgXCJjb21wYW55X25hbWVcIjogXCJQZWFyc29uIHBsY1wiLCBcIm1haWxndW5faWRcIjogXCI8MjAxNDEwMTAxNDA4MTMuNTg4ODEuODU3MzNAY3VzdG9tZXJvaHEuY29tPlwiLCBcImVtYWlsX2d1ZXNzZXNcIjogW3tcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJRNTdrd04xTFFUXCJ9LCB7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiNTNLMGxXWTdodlwifV0sIFwiZW1haWxcIjogXCJqYXNvbi5saW5rZWRpbkBwZWFyc29uLmNvbVwiLCBcInByb3NwZWN0X2NyZWF0ZWRfYXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE3Ljg3M1pcIiwgXCJjb21wYW55XCI6IHtcImNsYXNzTmFtZVwiOiBcIkNvbXBhbnlcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJmcUhXcDVOc0Z4XCJ9LCBcImxpc3RzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdExpc3RcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJpekxiVnVseXI2XCJ9XSwgXCJ1c2VyXCI6IHtcImNsYXNzTmFtZVwiOiBcIlVzZXJcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJ4V0VTaXc1U21kXCJ9LCBcImNvbXBhbnlfc2l6ZVwiOiBcIjEwLDAwMSsgZW1wbG95ZWVzXCIsIFwibmFtZVwiOiBcIkphc29uIFVwYWhcIiwgXCJpbmR1c3RyeVwiOiBcIkVkdWNhdGlvbiBNYW5hZ2VtZW50XCIsIFwibGlua2VkaW5fdXJsXCI6IFwid3d3LmxpbmtlZGluLmNvbS9wdWIvamFzb24tdXBhaC83LzIzMy85NDBcIiwgXCJiYXRjaFwiOiB7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdEJhdGNoXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiWVBhVEdiRDU2YVwifSwgXCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdFwiLCBcInF1ZXVlZFwiOiB0cnVlfSwge1wid2Vic2l0ZVwiOiBcImh0dHA6Ly93d3cucm13bXVzaWMuY29tXCIsIFwiY2FtcGFpZ25cIjoge1wiY2xhc3NOYW1lXCI6IFwiQ2FtcGFpZ25cIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJubUVsVTd6Y0JmXCJ9LCBcInBvc1wiOiBcIlxcXFx1MDBhMERpcmVjdG9yIG9mIFNhbGVzIGFuZCBNYXJrZXRpbmdcIiwgXCJfX3R5cGVcIjogXCJPYmplY3RcIiwgXCJ1cGRhdGVkQXRcIjogXCIyMDE0LTEwLTEwVDEzOjI5OjIzLjA0OVpcIiwgXCJjcmVhdGVkQXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE2LjczNVpcIiwgXCJjaXR5XCI6IFwiVG9yb250bywgT250YXJpbywgQ2FuYWRhXFxcXHUwMGEwXCIsIFwiYXJjaGl2ZWRcIjogdHJ1ZSwgXCJsb2FkaW5nXCI6IGZhbHNlLCBcIm9wZW5lZFwiOiB0cnVlLCBcIm9iamVjdElkXCI6IFwiQ09TcHlYZ3NEMlwiLCBcImNvbXBhbnlfbmFtZVwiOiBcIlJNVyBNdXNpY1wiLCBcIm1haWxndW5faWRcIjogXCI8MjAxNDEwMTAxNDA4MTQuMTk5MzguOTAxNjlAY3VzdG9tZXJvaHEuY29tPlwiLCBcImVtYWlsX2d1ZXNzZXNcIjogW3tcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCIzT0VLdEl4SUFwXCJ9LCB7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieHZHYlVZcG80M1wifV0sIFwiZW1haWxcIjogXCJub19lbWFpbFwiLCBcInByb3NwZWN0X2NyZWF0ZWRfYXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE2LjczNVpcIiwgXCJjb21wYW55XCI6IHtcImNsYXNzTmFtZVwiOiBcIkNvbXBhbnlcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJmcUhXcDVOc0Z4XCJ9LCBcImxpc3RzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdExpc3RcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJpekxiVnVseXI2XCJ9XSwgXCJ1c2VyXCI6IHtcImNsYXNzTmFtZVwiOiBcIlVzZXJcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJ4V0VTaXc1U21kXCJ9LCBcImNvbXBhbnlfc2l6ZVwiOiBcIjExLTUwIGVtcGxveWVlc1wiLCBcIm5hbWVcIjogXCJMYXVyYSBOaWtvbGljXCIsIFwiaW5kdXN0cnlcIjogXCJNdXNpY1wiLCBcImxpbmtlZGluX3VybFwiOiBcImNhLmxpbmtlZGluLmNvbS9wdWIvbGF1cmEtbmlrb2xpYy81MC80NTAvNzcxXCIsIFwiYmF0Y2hcIjoge1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RCYXRjaFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIllQYVRHYkQ1NmFcIn0sIFwiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RcIiwgXCJxdWV1ZWRcIjogdHJ1ZX0sIHtcIndlYnNpdGVcIjogXCJodHRwOi8vd3d3LnNhdWRpYWNhcmdvLmNvbVwiLCBcImNhbXBhaWduXCI6IHtcImNsYXNzTmFtZVwiOiBcIkNhbXBhaWduXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibm1FbFU3emNCZlwifSwgXCJwb3NcIjogXCJcXFxcdTAwYTBEaXJlY3RvciBHbG9iYWwgU2FsZXMgU3VwcG9ydFwiLCBcIl9fdHlwZVwiOiBcIk9iamVjdFwiLCBcInVwZGF0ZWRBdFwiOiBcIjIwMTQtMTAtMTBUMTM6Mjk6MjMuMzI3WlwiLCBcImNyZWF0ZWRBdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTYuMTI3WlwiLCBcImNpdHlcIjogXCJTYXVkaSBBcmFiaWFcXFxcdTAwYTBcIiwgXCJhcmNoaXZlZFwiOiB0cnVlLCBcImxvYWRpbmdcIjogZmFsc2UsIFwib3BlbmVkXCI6IHRydWUsIFwib2JqZWN0SWRcIjogXCJLZTA2ZzZrU2s1XCIsIFwiY29tcGFueV9uYW1lXCI6IFwiU2F1ZGkgQWlybGluZXMgQ2FyZ28gQ29tcGFueVwiLCBcIm1haWxndW5faWRcIjogXCI8MjAxNDEwMTAxNDA4MTQuNzczODYuNzQ5NDNAY3VzdG9tZXJvaHEuY29tPlwiLCBcImVtYWlsX2d1ZXNzZXNcIjogW3tcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJvMzNKYXZoU3B5XCJ9LCB7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibDN2eTJUeEY3M1wifV0sIFwiZW1haWxcIjogXCJub19lbWFpbFwiLCBcInByb3NwZWN0X2NyZWF0ZWRfYXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE2LjEyN1pcIiwgXCJjb21wYW55XCI6IHtcImNsYXNzTmFtZVwiOiBcIkNvbXBhbnlcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJmcUhXcDVOc0Z4XCJ9LCBcImxpc3RzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdExpc3RcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJpekxiVnVseXI2XCJ9XSwgXCJ1c2VyXCI6IHtcImNsYXNzTmFtZVwiOiBcIlVzZXJcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJ4V0VTaXc1U21kXCJ9LCBcImNvbXBhbnlfc2l6ZVwiOiBcIjEwMDEtNTAwMCBlbXBsb3llZXNcIiwgXCJuYW1lXCI6IFwiUmFpbmVyIE11ZWxsZXJcIiwgXCJpbmR1c3RyeVwiOiBcIkFpcmxpbmVzL0F2aWF0aW9uXCIsIFwibGlua2VkaW5fdXJsXCI6IFwic2EubGlua2VkaW4uY29tL3B1Yi9yYWluZXItbXVlbGxlci81L2E0OC80MjhcIiwgXCJiYXRjaFwiOiB7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdEJhdGNoXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiWVBhVEdiRDU2YVwifSwgXCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdFwiLCBcInF1ZXVlZFwiOiB0cnVlfV1cbiAgfSxcblxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy8gU2VudCBNYWlsXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNlbnRFbWFpbHM6IFtdXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzcyA9IHRoaXM7XG4gICAgcXJ5ID0ge1xuICAgICAgaW5jbHVkZTogJ2NhbXBhaWduLHByb3NwZWN0LHByb3NwZWN0LmVtYWlsX2d1ZXNzZXMucGF0dGVybicsXG4gICAgICBvcmRlcjonLWNyZWF0ZWRBdCcsXG4gICAgICBjYW1wYWlnbjoge1xuICAgICAgICBfX3R5cGU6ICdQb2ludGVyJyxcbiAgICAgICAgY2xhc3NOYW1lOidDYW1wYWlnbicsXG4gICAgICAgIG9iamVjdElkOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24ub2JqZWN0SWQsXG4gICAgICB9XG4gICAgfVxuICAgICQuYWpheCh7XG4gICAgICB1cmw6ICdodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL1NlbnRFbWFpbCcsXG4gICAgICBkYXRhOiBxcnksXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykgeyB0aGlzcy5zZXRTdGF0ZSh7c2VudEVtYWlsczogcmVzLnJlc3VsdHN9KSB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkge31cbiAgICB9KVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgc2VudEVtYWlscyA9IFtdXG4gICAgZm9yKGk9MDtpPCB0aGlzLnN0YXRlLnNlbnRFbWFpbHMubGVuZ3RoOyBpKyspIFxuICAgICAgc2VudEVtYWlscy5wdXNoKFNlbnRFbWFpbFJvdyh7c2VudEVtYWlsOiB0aGlzLnN0YXRlLnNlbnRFbWFpbHNbaV19KSlcblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtzdHlsZToge292ZXJmbG93OidhdXRvJyxoZWlnaHQ6NDE3fX0sIFxuICAgICAgICBSZWFjdC5ET00udGFibGUoe2NsYXNzTmFtZTogXCJ0YWJsZSB0YWJsZS1zdHJpcGVkXCIsIHN0eWxlOiB7bWFyZ2luQm90dG9tOjB9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnRoZWFkKG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlByb3NwZWN0IE5hbWVcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiUHJvc3BlY3QgRW1haWxcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiVGVtcGxhdGVcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKHtzdHlsZToge3dpZHRoOjI5MH19LCBcIlN0YXR1c1wiKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS50Ym9keShudWxsLCBcbiAgICAgICAgICAgIHNlbnRFbWFpbHNcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApO1xuICB9XG59KTtcblxudmFyIFNlbnRFbWFpbFJvdyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ1NlbnRFbWFpbFJvdycsXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgc2VudEVtYWlsID0gdGhpcy5wcm9wcy5zZW50RW1haWxcbiAgICAvL2NvbnNvbGUubG9nKHNlbnRFbWFpbClcblxuICAgIGVtYWlsID0gc2VudEVtYWlsLmVtYWlsXG4gICAgLypcbiAgICBpZihlbWFpbCA9PSBcIm5vX2VtYWlsXCIpe1xuICAgICAgZmlyc3QgPSBzZW50RW1haWwucHJvc3BlY3QubmFtZS5zcGxpdCgnICcpWzBdXG4gICAgICBsYXN0ID0gXy5sYXN0KHNlbnRFbWFpbC5wcm9zcGVjdC5uYW1lLnNwbGl0KCcgJykpXG5cbiAgICAgIHBhdHRlcm4gPSBfLmZpbmRXaGVyZShzZW50RW1haWwucHJvc3BlY3QuZW1haWxfZ3Vlc3Nlcywgeyd0cmllZCc6ZmFsc2V9KVxuICAgICAgZGF0YSA9IHtmaXJzdDogZmlyc3QsIGxhc3Q6IGxhc3QsIGZpOiBmaXJzdFswXSwgbGk6IGxhc3RbMF19XG4gICAgICBlbWFpbCA9IE11c3RhY2hlLnJlbmRlcihwYXR0ZXJuLnBhdHRlcm4ucGF0dGVybiwgZGF0YSkudG9Mb3dlckNhc2UoKVxuICAgIH1cbiAgICAqL1xuXG4gICAgcmVwbGllZCA9IFwibGFiZWwgbGFiZWwtZGVmYXVsdFwiXG4gICAgb3BlbmVkID0gXCJsYWJlbCBsYWJlbC1kZWZhdWx0XCJcbiAgICBkZWxpdmVyZWQgPSBcImxhYmVsIGxhYmVsLWRlZmF1bHRcIlxuICAgIHF1ZXVlZCA9IFwibGFiZWwgbGFiZWwtZGVmYXVsdFwiXG5cbiAgICBpZihzZW50RW1haWwucmVwbGllZCkgXG4gICAgICByZXBsaWVkID0gXCJsYWJlbCBsYWJlbC1zdWNjZXNzXCJcbiAgICBpZihzZW50RW1haWwub3BlbmVkKSBcbiAgICAgIG9wZW5lZCA9IFwibGFiZWwgbGFiZWwtc3VjY2Vzc1wiXG4gICAgaWYoc2VudEVtYWlsLmRlbGl2ZXJlZCkgXG4gICAgICBkZWxpdmVyZWQgPSBcImxhYmVsIGxhYmVsLXN1Y2Nlc3NcIlxuICAgIGlmKHNlbnRFbWFpbC5xdWV1ZWQpIFxuICAgICAgcXVldWVkID0gXCJsYWJlbCBsYWJlbC1zdWNjZXNzXCJcblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00udHIobnVsbCwgXG4gICAgICAgIFJlYWN0LkRPTS50ZCh7c3R5bGU6IHt3aWR0aDoxMDB9fSwgUmVhY3QuRE9NLmg2KG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jbG9ja1wifSksIFxuICAgICAgICAgICAgbW9tZW50KHNlbnRFbWFpbC5jcmVhdGVkQXQpLmZyb21Ob3coKSkpLCBcbiAgICAgICAgUmVhY3QuRE9NLnRkKHtzdHlsZToge3dpZHRoOjIwMH19LCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7Zm9udFNpemU6MTQsZm9udFdlaWdodDonYm9sZCcsbWFyZ2luQm90dG9tOjB9fSwgXG4gICAgICAgICAgICBzZW50RW1haWwucHJvc3BlY3QubmFtZSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHtmb250U3R5bGU6J2l0YWxpYycsbWFyZ2luVG9wOjQsbWFyZ2luQm90dG9tOjB9fSwgXG4gICAgICAgICAgICBzZW50RW1haWwucHJvc3BlY3QucG9zLnRyaW0oKSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHttYXJnaW5Ub3A6NCxmb250V2VpZ2h0Oidib2xkJ319LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtYnVpbGRpbmdcIn0pLCBcIsKgXCIsIFxuICAgICAgICAgICAgc2VudEVtYWlsLnByb3NwZWN0LmNvbXBhbnlfbmFtZSlcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS50ZCh7c3R5bGU6IHt3aWR0aDoyMDB9fSwgUmVhY3QuRE9NLmg2KG51bGwsIGVtYWlsKSksIFxuICAgICAgICBSZWFjdC5ET00udGQobnVsbCwgXG4gICAgICAgICAgUmVhY3QuRE9NLmg2KG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFwiwqBcIiArICcgJyArXG4gICAgICAgICAgICBcIlRlbXBsYXRlXCJcbiAgICAgICAgICApXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00udGQoe3N0eWxlOiB7cGFkZGluZ1RvcDoxM319LCBcbiAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBxdWV1ZWR9LCBcIlF1ZXVlZFwiKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGV2cm9uLWNpcmNsZS1yaWdodCB0ZXh0LW11dGVkXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7cGFkZGluZ0xlZnQ6NSxwYWRkaW5nUmlnaHQ6NX19KSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogZGVsaXZlcmVkfSwgXCJEZWxpdmVyZWRcIiksIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hldnJvbi1jaXJjbGUtcmlnaHQgdGV4dC1tdXRlZFwiLCBcbiAgICAgICAgICAgICBzdHlsZToge3BhZGRpbmdMZWZ0OjUscGFkZGluZ1JpZ2h0OjV9fSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IG9wZW5lZH0sIFwiT3BlbmVkXCIpLCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWNoZXZyb24tY2lyY2xlLXJpZ2h0IHRleHQtbXV0ZWRcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtwYWRkaW5nTGVmdDo1LHBhZGRpbmdSaWdodDo1fX0pLCBcbiAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiByZXBsaWVkfSwgXCJSZXBsaWVkXCIpXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gIH1cbn0pXG4iLCIvKiogQGpzeCByZWFjdC5kb20gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICAkKCcudGVtcGxhdGUtYm9keScpLmh0bWwodGhpcy5zdGF0ZS50ZW1wbGF0ZUJvZHkpXG4gIH0sXG5cbiAgY2xpY2tlZE92ZXJsYXk6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIG92ZXJsYXknKVxuICAgIHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSgpXG4gIH0sXG5cbiAgY2hhbmdlTW9kZTogZnVuY3Rpb24oKSB7XG4gICAgLy8gVXBkYXRlIHRlbXBsYXRlIGh0bWwgb24gdG9nZ2xlXG4gICAgY29uc29sZS5sb2coJ0VESVQgTU9ERScpXG4gICAgY29uc29sZS5sb2codGhpcy5zdGF0ZS5lZGl0TW9kZSlcbiAgICBwYXJzZV9oZWFkZXJzID0gYXBwQ29uZmlnLnBhcnNlSGVhZGVyc1xuICAgIGlmKHRoaXMuc3RhdGUuZWRpdE1vZGUpe1xuICAgICAgJCgnLnN1bW1lcicpLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMucHJvcHMuc2F2ZVRlbXBsYXRlKHtcbiAgICAgICAgbmFtZTogdGhpcy5zdGF0ZS5uYW1lLFxuICAgICAgICB0ZW1wbGF0ZUJvZHk6ICQoJy5zdW1tZXInKS5jb2RlKCksXG4gICAgICAgIHRlbXBsYXRlU3ViamVjdDogJCgnLnN1YmplY3QnKS52YWwoKSxcbiAgICAgIH0pXG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgdGVtcGxhdGVCb2R5OiAkKCcuc3VtbWVyJykuY29kZSgpLFxuICAgICAgICB0ZW1wbGF0ZVN1YmplY3Q6ICQoJy5zdWJqZWN0JykudmFsKCksXG4gICAgICAgIGVkaXRNb2RlOiAhdGhpcy5zdGF0ZS5lZGl0TW9kZSxcbiAgICAgIH0pXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvVGVtcGxhdGVzLycrdGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMub2JqZWN0SWQsXG4gICAgICAgIHR5cGU6J1BVVCcsXG4gICAgICAgIGhlYWRlcnM6cGFyc2VfaGVhZGVycyxcbiAgICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeSh7Ym9keTogJCgnLnN1bW1lcicpLmNvZGUoKSxzdWJqZWN0OiAkKCcuc3ViamVjdCcpLnZhbCgpfSksXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBlZGl0TW9kZTogIXRoaXMuc3RhdGUuZWRpdE1vZGUgfSlcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkVXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICAvKiB0aGlzcyA9IHRoaXM7ICovXG5cbiAgICBjb25zb2xlLmxvZygnT1RIRVInKVxuICAgIGlmKHRoaXMuc3RhdGUuZWRpdE1vZGUpe1xuICAgICAgY29uc29sZS5sb2coJ0NBTExFRCcpXG4gICAgICAvLyBSZXBsYWNlIFN1YmplY3QgXG4gICAgICAkKCcuc3ViamVjdCcpLnZhbCh0aGlzLnN0YXRlLnRlbXBsYXRlU3ViamVjdClcblxuICAgICAgJCgnLnN1bW1lcicpLnN1bW1lcm5vdGUoe1xuICAgICAgICBoZWlnaHQ6IDIwMCxcbiAgICAgICAgdG9vbGJhcjogW1xuICAgICAgICAgIFsnc3R5bGUnLCBbJ2JvbGQnLCAnaXRhbGljJywgJ3VuZGVybGluZScsICdjbGVhciddXSxcbiAgICAgICAgICBbJ2ZvbnQnLCBbJ3N0cmlrZXRocm91Z2gnXV0sXG4gICAgICAgICAgWydmb250c2l6ZScsIFsnZm9udHNpemUnXV0sXG4gICAgICAgICAgWydjb2xvcicsIFsnY29sb3InXV0sXG4gICAgICAgICAgWydwYXJhJywgWyd1bCcsICdvbCcsICdwYXJhZ3JhcGgnXV0sXG4gICAgICAgICAgWydoZWlnaHQnLCBbJ2hlaWdodCddXSxcbiAgICAgICAgXVxuICAgICAgfSlcblxuICAgICAgLy8gSW5pdGlhbGl6ZSBFZGl0b3Igd2l0aCBodG1sXG4gICAgICAkKCcuc3VtbWVyJykuY29kZSh0aGlzLnN0YXRlLnRlbXBsYXRlQm9keSlcbiAgICB9XG4gIH0sXG5cblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHN1YmplY3RQbGFjZSA9ICh0aGlzLnN0YXRlLmVkaXRNb2RlKSA/IHJlYWN0LmRvbS5pbnB1dCh7c3R5bGU6IHtkaXNwbGF5OidpbmxpbmUnLHdpZHRoOjQ4MH0sIGNsYXNzTmFtZTogXCJmb3JtLWNvbnRyb2wgc3ViamVjdFwifSkgOiB0aGlzLnN0YXRlLnRlbXBsYXRlU3ViamVjdFxuXG4gICAgaWYodGhpcy5zdGF0ZS5lZGl0TW9kZSl7XG4gICAgICAgdG9nZ2xlQnV0dG9uID0gcmVhY3QuZG9tLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICAgb25DbGljazogdGhpcy5jaGFuZ2VNb2RlLCBcbiAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi14c1wiLCBcbiAgICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6J2Jsb2NrJyxmbG9hdDoncmlnaHQnLG1hcmdpblRvcDo1fX0sIFxuICAgICAgICAgICAgcmVhY3QuZG9tLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1zYXZlXCJ9KSwgXCIgwqAgU2F2ZSBUZW1wbGF0ZVwiKVxuICAgIH0gZWxzZSB7XG4gICAgICAgdG9nZ2xlQnV0dG9uID0gcmVhY3QuZG9tLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICAgb25DbGljazogdGhpcy5jaGFuZ2VNb2RlLCBcbiAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi14c1wiLCBcbiAgICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6J2Jsb2NrJyxmbG9hdDoncmlnaHQnLG1hcmdpblRvcDo1fX0sIFxuICAgICAgICAgICAgcmVhY3QuZG9tLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wZW5jaWwtc3F1YXJlXCJ9KSwgXCIgwqAgRWRpdCBUZW1wbGF0ZVwiKVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICByZWFjdC5kb20uZGl2KG51bGwsIFxuICAgICAgcmVhY3QuZG9tLmRpdih7b25DbGljazogdGhpcy5jbGlja2VkT3ZlcmxheSwgaWQ6IFwiZWRpdFRlbXBsYXRlT3ZlcmxheVwifSksIFxuICAgICAgcmVhY3QuZG9tLmRpdih7aWQ6IFwiZWRpdFRlbXBsYXRlVmlld1wiLCBcbiAgICAgICAgICAgY2xhc3NOYW1lOiBcInBhbmVsIHBhbmVsLWluZm9cIiwgXG4gICAgICAgICAgIHN0eWxlOiB7ZGlzcGxheTonYmxvY2snfX0sIFxuICAgICAgICAgICByZWFjdC5kb20uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtaGVhZGluZ1wiLCBzdHlsZToge2hlaWdodDo1MH19LCBcbiAgICAgICAgICAgICByZWFjdC5kb20uaDYoe3N0eWxlOiB7ZmxvYXQ6J2xlZnQnfX0sIFxuICAgICAgICAgICAgICAgcmVhY3QuZG9tLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFxuICAgICAgICAgICAgICAgXCIgIFwiICsgdGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMubmFtZVxuICAgICAgICAgICAgICksIFxuICAgICAgICAgIHRvZ2dsZUJ1dHRvblxuICAgICAgICApLCBcbiAgICAgICAgcmVhY3QuZG9tLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWJvZHlcIn0sIFxuICAgICAgICAgIHJlYWN0LmRvbS5kaXYoe2NsYXNzTmFtZTogXCJlZGl0VGVtcGxhdGVUaXRsZVwifSwgXG4gICAgICAgICAgICByZWFjdC5kb20uc3BhbihudWxsLCBcIlN1YmplY3Q6IFwiKSwgXG4gICAgICAgICAgICBzdWJqZWN0UGxhY2VcbiAgICAgICAgICApLCBcbiAgICAgICAgIHJlYWN0LmRvbS5icihudWxsKSwgXG4gICAgICAgICByZWFjdC5kb20uZGl2KHtjbGFzc05hbWU6IFwidGVtcGxhdGVEZXRhaWxzXCJ9LCBcbiAgICAgICAgICAgcmVhY3QuZG9tLmg2KHtzdHlsZToge21hcmdpbkJvdHRvbTonMCd9LCBjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgICAgXCJDcmVhdGVkIGJ5IE1hcmsgb24gSnVsLiAyMSwgMjAxNFwiXG4gICAgICAgICAgICksIFxuICAgICAgICAgICByZWFjdC5kb20uaDYoe3N0eWxlOiB7bWFyZ2luVG9wOicwJ30sIGNsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcbiAgICAgICAgICAgICBcImxhc3QgdXBkYXRlZCA3IGRheXMgYWdvXCJcbiAgICAgICAgICAgKVxuICAgICAgICAgKSwgXG4gICAgICAgIHJlYWN0LmRvbS5icihudWxsKSwgXG4gICAgICAgIHJlYWN0LmRvbS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbCBwYW5lbC1kZWZhdWx0XCJ9LCBcbiAgICAgICAgICByZWFjdC5kb20uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtYm9keSBzdW1tZXIgdGVtcGxhdGUtYm9keVwifVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgIClcbilcbilcbiAgICApO1xuICB9XG59KTtcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLnByb3BzLmluaXRpYWxUZW1wbGF0ZVZhbHVlcy5uYW1lLFxuICAgICAgYm9keTogdGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMuYm9keSxcbiAgICAgIHN1YmplY3Q6IHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLnN1YmplY3QsXG4gICAgICBlZGl0TW9kZTogdGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMuZWRpdE1vZGVcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKCdkaWQgbW91bnQnKVxuICAgICQoJy50ZW1wbGF0ZS1ib2R5JykuaHRtbCh0aGlzLnN0YXRlLmJvZHkpXG4gICAgaWYodGhpcy5zdGF0ZS5lZGl0TW9kZSkge1xuICAgICAgJCgnLnN1bW1lcicpLnN1bW1lcm5vdGUoe1xuICAgICAgICBoZWlnaHQ6IDIwMCxcbiAgICAgICAgdG9vbGJhcjogW1xuICAgICAgICAgIFsnc3R5bGUnLCBbJ2JvbGQnLCAnaXRhbGljJywgJ3VuZGVybGluZScsICdjbGVhciddXSxcbiAgICAgICAgICBbJ2ZvbnQnLCBbJ3N0cmlrZXRocm91Z2gnXV0sXG4gICAgICAgICAgWydmb250c2l6ZScsIFsnZm9udHNpemUnXV0sXG4gICAgICAgICAgWydjb2xvcicsIFsnY29sb3InXV0sXG4gICAgICAgICAgWydwYXJhJywgWyd1bCcsICdvbCcsICdwYXJhZ3JhcGgnXV0sXG4gICAgICAgICAgWydoZWlnaHQnLCBbJ2hlaWdodCddXSxcbiAgICAgICAgXVxuICAgICAgfSlcbiAgICB9XG5cbiAgICByZW5kZXJqc29uLnNldF9zaG93X3RvX2xldmVsKCdhbGwnKVxuICAgIHByb3NwZWN0ID0gXy5waWNrKHRoaXMucHJvcHMucHJvc3BlY3QsIFxuICAgICAgJ2NvbXBhbnlfbmFtZScsICduYW1lJywgJ3BvcydcbiAgICApXG4gICAgcHJvc3BlY3QuZmlyc3RfbmFtZSA9IHByb3NwZWN0Lm5hbWUuc3BsaXQoJyAnKVswXVxuICAgIHByb3NwZWN0Lmxhc3RfbmFtZSA9IF8ubGFzdChwcm9zcGVjdC5uYW1lLnNwbGl0KCcgJykpXG4gICAgcHJvc3BlY3QgPSBfLm9taXQocHJvc3BlY3QsICduYW1lJylcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdFRlbXBsYXRlXCIpLmFwcGVuZENoaWxkKHJlbmRlcmpzb24ocHJvc3BlY3QpKTtcbiAgICAkKCcjZWRpdFRlbXBsYXRlT3ZlcmxheScpLmh0bWwoKVxuICAgIHRoaXNzID0gdGhpcztcbiAgICAkKCcucmVuZGVyanNvbicpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgdGhpc3MucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSgpXG4gICAgfSlcblxuICAgICQoJy5yZW5kZXJqc29uJykuY3NzKHtcbiAgICAgICdwb3NpdGlvbic6ICdhYnNvbHV0ZScsXG4gICAgICAnei1pbmRleCc6ICcxMDAwMDAwMDAwJyxcbiAgICAgICdiYWNrZ3JvdW5kLWNvbG9yJzoncmdiYSgwLDAsMCwwKScsXG4gICAgICAnYm9yZGVyJzonMCcsXG4gICAgICAnY29sb3InOid3aGl0ZScsXG4gICAgICAnbWFyZ2luLXRvcCc6JzBweCcsXG4gICAgICAnaGVpZ2h0JzogJzU0MnB4JyxcbiAgICAgICdvdmVyZmxvdyc6J2F1dG8nLFxuICAgICAgJ3dpZHRoJzonMzgwcHgnXG4gICAgfSlcblxuICAgICQoJy5rZXknKS5jc3Moe1xuICAgICAgJ2N1cnNvcic6J3BvaW50ZXInXG4gICAgfSlcblxuICAgICQoJy50aW1lbGluZScpLmNzcyh7XG4gICAgICAnLXdlYmtpdC1maWx0ZXInOiAnYmx1cigxMHB4KScsXG4gICAgfSlcbiAgICAkKCcjY2FtcGFpZ24tdG9wLWRldGFpbCcpLmNzcyh7XG4gICAgICAnLXdlYmtpdC1maWx0ZXInOiAnYmx1cigxMHB4KScsXG4gICAgfSlcbiAgfSxcbiAgY29tcG9uZW50V2lsbFVubW91bnQ6ZnVuY3Rpb24oKSB7XG4gICAgJCgnLnRpbWVsaW5lJykuY3NzKHtcbiAgICAgICctd2Via2l0LWZpbHRlcic6ICcnLFxuICAgIH0pXG4gICAgJCgnI2NhbXBhaWduLXRvcC1kZXRhaWwnKS5jc3Moe1xuICAgICAgJy13ZWJraXQtZmlsdGVyJzogJycsXG4gICAgfSlcbiAgfSxcblxuICBjbGlja2VkT3ZlcmxheTogZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS5sb2coJ2NsaWNrZWQgb3ZlcmxheScpXG4gICAgdGhpcy5wcm9wcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51KClcbiAgfSxcblxuICBjaGFuZ2VNb2RlOiBmdW5jdGlvbigpIHtcbiAgICAvLyBVcGRhdGUgdGVtcGxhdGUgaHRtbCBvbiB0b2dnbGVcbiAgICBwYXJzZV9oZWFkZXJzID0gYXBwQ29uZmlnLnBhcnNlSGVhZGVyc1xuICAgIGlmKHRoaXMuc3RhdGUuZWRpdE1vZGUpe1xuICAgICAgJCgnLnN1bW1lcicpLmRlc3Ryb3koKTtcbiAgICAgICQoJy50aW1lbGluZScpLmNzcyh7XG4gICAgICAgICctd2Via2l0LWZpbHRlcic6ICdibHVyKDIwcHgpJyxcbiAgICAgIH0pXG5cbiAgICAgIGNvbnNvbGUubG9nKCdsb29rIGF0IHRoaXMnKVxuICAgICAgY29uc29sZS5sb2cobmFtZSlcbiAgICAgIG5hbWUgPSAodGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMubmV3VGVtcGxhdGUpID8gJCgnI3RlbXBsYXRlLW5hbWUnKS52YWwoKSA6IHRoaXMuc3RhdGUubmFtZVxuICAgICAgdGhpcy5wcm9wcy5zYXZlVGVtcGxhdGUoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBib2R5OiAkKCcuc3VtbWVyJykuY29kZSgpLFxuICAgICAgICBzdWJqZWN0OiAkKCcuc3ViamVjdCcpLnZhbCgpLFxuICAgICAgfSwgdGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMubmV3VGVtcGxhdGUpXG5cbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBuYW1lOiAkKCcjdGVtcGxhdGUtbmFtZScpLnZhbCgpLFxuICAgICAgICBib2R5OiAkKCcuc3VtbWVyJykuY29kZSgpLFxuICAgICAgICBzdWJqZWN0OiAkKCcuc3ViamVjdCcpLnZhbCgpLFxuICAgICAgICBlZGl0TW9kZTogIXRoaXMuc3RhdGUuZWRpdE1vZGUsXG4gICAgICB9KVxuXG4gICAgICBvYmpJZCA9IHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLm9iamVjdElkXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvVGVtcGxhdGVzLycrb2JqSWQsXG4gICAgICAgIHR5cGU6J1BVVCcsXG4gICAgICAgIGhlYWRlcnM6cGFyc2VfaGVhZGVycyxcbiAgICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeSh7Ym9keTogJCgnLnN1bW1lcicpLmNvZGUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdDogJCgnLnN1YmplY3QnKS52YWwoKX0pLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgZWRpdE1vZGU6ICF0aGlzLnN0YXRlLmVkaXRNb2RlIH0pXG4gICAgICAkKCcudGltZWxpbmUnKS5jc3Moe1xuICAgICAgICAnLXdlYmtpdC1maWx0ZXInOiAnYmx1cigyMHB4KScsXG4gICAgICB9KVxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnRXaWxsVXBkYXRlOiBmdW5jdGlvbihuZXdQcm9wcykge1xuICAgIGNvbnNvbGUubG9nKCdUSEUgTkVXIFBST1BTJylcbiAgICBjb25zb2xlLmxvZyhuZXdQcm9wcylcbiAgfSxcblxuICBjb21wb25lbnREaWRVcGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgIC8qIHRoaXNzID0gdGhpczsgKi9cbiAgICBjb25zb2xlLmxvZygnT1RIRVInKVxuICAgIGlmKHRoaXMuc3RhdGUuZWRpdE1vZGUpe1xuICAgICAgY29uc29sZS5sb2coJ0NBTExFRCcpXG4gICAgICAvLyBSZXBsYWNlIFN1YmplY3QgXG4gICAgICAkKCcuc3ViamVjdCcpLnZhbCh0aGlzLnN0YXRlLnN1YmplY3QpXG4gICAgICAkKCcjdGVtcGxhdGUtbmFtZScpLnZhbCh0aGlzLnN0YXRlLm5hbWUpXG5cbiAgICAgICQoJy5zdW1tZXInKS5zdW1tZXJub3RlKHtcbiAgICAgICAgaGVpZ2h0OiAyMDAsXG4gICAgICAgIHRvb2xiYXI6IFtcbiAgICAgICAgICBbJ3N0eWxlJywgWydib2xkJywgJ2l0YWxpYycsICd1bmRlcmxpbmUnLCAnY2xlYXInXV0sXG4gICAgICAgICAgWydmb250JywgWydzdHJpa2V0aHJvdWdoJ11dLFxuICAgICAgICAgIFsnZm9udHNpemUnLCBbJ2ZvbnRzaXplJ11dLFxuICAgICAgICAgIFsnY29sb3InLCBbJ2NvbG9yJ11dLFxuICAgICAgICAgIFsncGFyYScsIFsndWwnLCAnb2wnLCAncGFyYWdyYXBoJ11dLFxuICAgICAgICAgIFsnaGVpZ2h0JywgWydoZWlnaHQnXV0sXG4gICAgICAgIF1cbiAgICAgIH0pXG5cbiAgICAgIC8vIEluaXRpYWxpemUgRWRpdG9yIHdpdGggaHRtbFxuICAgICAgJCgnLnN1bW1lcicpLmNvZGUodGhpcy5zdGF0ZS5ib2R5KVxuICAgIH1cbiAgfSxcblxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgc3ViamVjdFBsYWNlID0gKHRoaXMuc3RhdGUuZWRpdE1vZGUpID8gUmVhY3QuRE9NLmlucHV0KHtzdHlsZToge2Rpc3BsYXk6J2lubGluZScsd2lkdGg6NDgwfSwgY2xhc3NOYW1lOiBcImZvcm0tY29udHJvbCBzdWJqZWN0XCJ9KSA6IHRoaXMuc3RhdGUuc3ViamVjdFxuXG4gICAgaWYodGhpcy5zdGF0ZS5lZGl0TW9kZSl7XG4gICAgICAgdG9nZ2xlQnV0dG9uID0gUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICAgb25DbGljazogdGhpcy5jaGFuZ2VNb2RlLCBcbiAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi14c1wiLCBcbiAgICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6J2Jsb2NrJyxmbG9hdDoncmlnaHQnLG1hcmdpblRvcDo1fX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1zYXZlXCJ9KSwgXCIgwqAgU2F2ZSBUZW1wbGF0ZVwiKVxuXG4gICAgICAgaWYodGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMubmV3VGVtcGxhdGUpe1xuICAgICAgICAgdGhlX25hbWUgPSBSZWFjdC5ET00uaW5wdXQoe2NsYXNzTmFtZTogXCJmb3JtLWNvbnRyb2xcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJ0ZW1wbGF0ZS1uYW1lXCIsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtmbG9hdDonbGVmdCcsd2lkdGg6MjAwfX0pXG4gICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgdG9nZ2xlQnV0dG9uID0gUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICAgb25DbGljazogdGhpcy5jaGFuZ2VNb2RlLCBcbiAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi14c1wiLCBcbiAgICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6J2Jsb2NrJyxmbG9hdDoncmlnaHQnLG1hcmdpblRvcDo1fX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wZW5jaWwtc3F1YXJlXCJ9KSwgXCIgwqAgRWRpdCBUZW1wbGF0ZVwiKVxuXG4gICAgICAgdGhlX25hbWUgPSBSZWFjdC5ET00uaDYoe3N0eWxlOiB7ZmxvYXQ6J2xlZnQnfX0sIFxuICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZmlsZS10ZXh0LW9cIn0pLCBcIsKgXCIsIFxuICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUubmFtZVxuICAgICAgICAgICAgICAgICAgKVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtpZDogXCJlZGl0VGVtcGxhdGVcIn0sIFxuICAgICAgICBSZWFjdC5ET00uaDUoe2NsYXNzTmFtZTogXCJleGFtcGxlLXRlbXBsYXRlLXRpdGxlXCJ9LCBcIkV4YW1wbGUgVGVtcGxhdGUgVmFsdWVzXCIpLCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImV4YW1wbGUtdGVtcGxhdGUtdGl0bGVcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHttYXJnaW5MZWZ0OjIxNSwgbWFyZ2luVG9wOjh9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wifSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWNoZXZyb24tbGVmdFwifSkpLCBcbiAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgIHN0eWxlOiB7bWFyZ2luTGVmdDo1fSwgXG4gICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wifSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWNoZXZyb24tcmlnaHRcIn0pKVxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7b25DbGljazogdGhpcy5jbGlja2VkT3ZlcmxheSwgaWQ6IFwiZWRpdFRlbXBsYXRlT3ZlcmxheVwifSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2lkOiBcImVkaXRUZW1wbGF0ZVZpZXdcIiwgXG4gICAgICAgICAgICAgICBjbGFzc05hbWU6IFwicGFuZWwgcGFuZWwtZGVmYXVsdFwiLCBcbiAgICAgICAgICAgICAgIHN0eWxlOiB7ZGlzcGxheTonYmxvY2snfX0sIFxuICAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWhlYWRpbmdcIiwgc3R5bGU6IHtoZWlnaHQ6NTB9fSwgXG4gICAgICAgICAgICAgICAgIHRoZV9uYW1lLCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tZGVmYXVsdCBidG4teHNcIiwgXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtmbG9hdDoncmlnaHQnLG1hcmdpbkxlZnQ6NSxtYXJnaW5Ub3A6NX19LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoXCJ9KVxuICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICAgdG9nZ2xlQnV0dG9uXG4gICAgICAgICAgICApLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbC1ib2R5XCJ9LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImVkaXRUZW1wbGF0ZVRpdGxlXCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uc3BhbihudWxsLCBcIlN1YmplY3Q6IFwiKSwgXG4gICAgICAgICAgICAgICAgc3ViamVjdFBsYWNlXG4gICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInRlbXBsYXRlRGV0YWlsc1wifSwgXG4gICAgICAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luQm90dG9tOicwJ30sIGNsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcbiAgICAgICAgICAgICAgICAgXCJDcmVhdGVkIGJ5IE1hcmsgb24gSnVsLiAyMSwgMjAxNFwiXG4gICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHttYXJnaW5Ub3A6JzAnfSwgY2xhc3NOYW1lOiBcInRleHQtbXV0ZWRcIn0sIFxuICAgICAgICAgICAgICAgICBcImxhc3QgdXBkYXRlZCA3IGRheXMgYWdvXCJcbiAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwgcGFuZWwtZGVmYXVsdFwifSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbC1ib2R5IHN1bW1lciB0ZW1wbGF0ZS1ib2R5XCJ9XG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgICApO1xuICB9XG59KTtcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xudmFyIFNlbmRFbWFpbE1vZGFsID0gcmVxdWlyZSgnLi9zZW5kX2VtYWlsX21vZGFsLmpzLm1pbi5qcycpXG52YXIgVGltZWxpbmVEYXlFbGVtZW50ID0gcmVxdWlyZSgnLi90aW1lbGluZV9kYXlfZWxlbWVudC5qcy5taW4uanMnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvLyBGb2xsb3d1cFRpbWVsaW5lXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgaW5pdGlhbEZvbGxvd3VwcyA9IHRoaXMucHJvcHMuaW5pdGlhbEZvbGxvd3Vwc1xuICAgIGluaXRpYWxGb2xsb3d1cHMgPSAoaW5pdGlhbEZvbGxvd3VwcykgPyBpbml0aWFsRm9sbG93dXBzIDogW11cbiAgICBiYXRjaGVzID0gdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmJhdGNoZXNcbiAgICBiYXRjaGVzID0gKGJhdGNoZXMpID8gYmF0Y2hlcyA6IFtdXG4gICAgcmV0dXJuIHtcbiAgICAgIGZvbGxvd3VwczogXy5jb21wYWN0KGluaXRpYWxGb2xsb3d1cHMpLFxuICAgICAgbG9hZGluZzogZmFsc2UsXG4gICAgICBjdXJyZW50VGVtcGxhdGU6JycsXG4gICAgICBjdXJyZW50QmF0Y2g6ICcnLFxuICAgICAgYmF0Y2hlcyA6IGJhdGNoZXNcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXNzID0gdGhpcztcbiAgICAkKCcuZGF5JykudG9vbHRpcCh7XG4gICAgICBwbGFjZW1lbnQ6ICdyaWdodCcsXG4gICAgICB0aXRsZTonKyBBZGQgYSBmb2xsb3ctdXAnXG4gICAgfSlcblxuICAgIGNvbnNvbGUubG9nKHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbilcbiAgICAgY29tcGFueSA9IEpTT04uc3RyaW5naWZ5KEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKS5jb21wYW55KVxuICAgICBjdXJyZW50Q2FtcGFpZ24gPSBhcHBDb25maWcucG9pbnRlcignQ2FtcGFpZ24nLCB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24ub2JqZWN0SWQpXG4gICAgICQuYWpheCh7XG4gICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL0ZvbGxvd3VwJyxcbiAgICAgICB0eXBlOidHRVQnLFxuICAgICAgIGhlYWRlcnM6IGFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgIGRhdGE6IHtcbiAgICAgICAgIHdoZXJlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgIGNhbXBhaWduOiBjdXJyZW50Q2FtcGFpZ24sXG4gICAgICAgICAgIGNvbXBhbnk6IGFwcENvbmZpZy5jb21wYW55XG4gICAgICAgICB9KSxcbiAgICAgICAgIGluY2x1ZGU6J3RlbXBsYXRlJyxcbiAgICAgICB9LFxuICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgY29uc29sZS5sb2coJ2ZvbGxvd3VwIHRpbWVsaW5lJylcbiAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5yZXN1bHRzKVxuICAgICAgIH0sXG4gICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJylcbiAgICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICB9XG4gICAgIH0pXG4gIH0sXG5cbiAgYWRkRm9sbG93dXBTZW50VG9CYXRjaDogZnVuY3Rpb24oYmF0Y2gsIGZvbGxvd3VwKSB7XG4gICAgYmF0Y2hlcyA9IF8ubWFwKHRoaXMuc3RhdGUuYmF0Y2hlcywgZnVuY3Rpb24oX2JhdGNoKSB7XG4gICAgICAgICAgICAgICAgICBpZihfYmF0Y2gub2JqZWN0SWQgPT0gYmF0Y2gub2JqZWN0SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoX2JhdGNoLmZvbGxvd3VwcylcbiAgICAgICAgICAgICAgICAgICAgICBfYmF0Y2guZm9sbG93dXBzLnB1c2goZm9sbG93dXApXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICBfYmF0Y2guZm9sbG93dXBzID0gW2ZvbGxvd3VwXVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIF9iYXRjaFxuICAgICAgICAgICAgICB9KVxuICAgIC8vIFBlcnNpc3RcbiAgfSxcbiAgXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdGltZWxpbmVFbGVtZW50cyA9IFtdXG4gICAgZm9sbG93dXBzID0gdGhpcy5zdGF0ZS5mb2xsb3d1cHNcblxuICAgIGJhdGNoZXMgPSBfLm1hcCh0aGlzLnN0YXRlLmJhdGNoZXMsIGZ1bmN0aW9uKGJhdGNoKSB7XG4gICAgICBpZihiYXRjaCl7XG4gICAgICAgIG5vdyA9IG1vbWVudCgpLnN0YXJ0T2YoJ2RheScpLnZhbHVlT2YoKVxuICAgICAgICBiYXRjaC5jdXJyZW50RGF5ID0gbW9tZW50KGJhdGNoLnN0YXJ0ZWQpLmRpZmYobW9tZW50KG5vdyksICAnZGF5cycpICogLTFcbiAgICAgICAgcmV0dXJuIGJhdGNoXG4gICAgICB9XG4gICAgfSlcbiAgICBiYXRjaGVzID0gXy5jb21wYWN0KGJhdGNoZXMpXG5cbiAgICBmb3IoaT0wO2k8IDMxO2krKyl7XG4gICAgICBmb2xsb3d1cCA9IF8uZmluZFdoZXJlKHRoaXMuc3RhdGUuZm9sbG93dXBzLCB7ZGF5OiBpfSlcbiAgICAgIHZhciBlbGVtZW50VHlwZSA9IChmb2xsb3d1cCkgPyB0cnVlIDogZmFsc2VcbiAgICAgIHZhciBjdXJyZW50VGVtcGxhdGUgPSAoZm9sbG93dXApID8gZm9sbG93dXAudGVtcGxhdGUgOiBmYWxzZVxuICAgICAgdmFyIGFkZFRlbXBsYXRlTW9kZSA9IChmb2xsb3d1cCkgPyBmb2xsb3d1cC5hZGRUZW1wbGF0ZU1vZGUgOiB0cnVlXG4gICAgICBjYW1wYWlnbiA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnblxuXG4gICAgICBjdXJyZW50QmF0Y2ggPSB7fVxuICAgICAgYmF0Y2hfc3RhcnRlZF90b2RheSA9IGZhbHNlXG4gICAgICBhbHJlYWR5U2VudCA9IGZhbHNlXG4gICAgICBiYXRjaENvdW50ID0gdW5kZWZpbmVkXG4gICAgICBpZihpID09IDApIHtcbiAgICAgICAgYmF0Y2hDb3VudCA9IChiYXRjaGVzKSA/IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLmxlbmd0aCA6IHRoaXMucHJvcHMucHJvc3BlY3RzLmxlbmd0aFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYmF0Y2ggPSBfLmZpbmRXaGVyZShiYXRjaGVzLCB7Y3VycmVudERheTogaX0pXG4gICAgICAgIGlmKGJhdGNoKSB7XG4gICAgICAgICAgY3VycmVudEJhdGNoID0gYmF0Y2gub2JqZWN0SWRcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKGJhdGNoLm9iamVjdElkKVxuICAgICAgICAgIGJhdGNoQ291bnQgPSBcIn5cIlxuICAgICAgICAgIGlmKGZvbGxvd3VwKSB7XG4gICAgICAgICAgICBfYmF0Y2hlcyA9IGZvbGxvd3VwLmJhdGNoZXNcbiAgICAgICAgICAgIGFscmVhZHlTZW50ID0gXy5maW5kV2hlcmUoX2JhdGNoZXMsIF8ucGljayhiYXRjaCwnb2JqZWN0SWQnKSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGltZWxpbmVFbGVtZW50cy5wdXNoKFJlYWN0LkRPTS5kaXYobnVsbCwgVGltZWxpbmVEYXlFbGVtZW50KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNvdW50OiBpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRUeXBlOiAhZWxlbWVudFR5cGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRlbXBsYXRlOiBjdXJyZW50VGVtcGxhdGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hDb3VudDogYmF0Y2hDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QmF0Y2g6IGN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHJlYWR5U2VudDogYWxyZWFkeVNlbnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVGVtcGxhdGVNb2RlOiBhZGRUZW1wbGF0ZU1vZGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVzOiB0aGlzLnByb3BzLnRlbXBsYXRlcywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdQcm9zcGVjdHM6IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEZvbGxvd3VwOiB0aGlzLmFkZEZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRGb2xsb3d1cDogdGhpcy5lZGl0Rm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUZvbGxvd3VwOiB0aGlzLnNhdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVGb2xsb3d1cDogdGhpcy5yZW1vdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRGb2xsb3d1cFNlbnRUb0JhdGNoOiB0aGlzLmFkZEZvbGxvd3VwU2VudFRvQmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hlczogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmJhdGNoZXMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvc3BlY3RMaXN0Q291bnQ6IHRoaXMucHJvcHMucHJvc3BlY3RMaXN0Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudEJhdGNoOiB0aGlzLnNldEN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRDdXJyZW50VGVtcGxhdGU6IHRoaXMuc2V0Q3VycmVudFRlbXBsYXRlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApKVxuXG4gICAgICBpZihpID09IDAgJiYgXy5maW5kV2hlcmUoYmF0Y2hlcywge2N1cnJlbnREYXk6IDB9KSl7XG4gICAgICAgICAgY3VycmVudEJhdGNoID0gXy5maW5kV2hlcmUoYmF0Y2hlcywge2N1cnJlbnREYXk6IDB9KS5vYmplY3RJZFxuICAgICAgICAgIGNvbnNvbGUuZGVidWcoJzAuNScpXG4gICAgICAgICAgY29uc29sZS5kZWJ1ZyhjdXJyZW50QmF0Y2gpXG4gICAgICAgICAgYmF0Y2hDb3VudCA9IFwiflwiXG4gICAgICAgICAgdGltZWxpbmVFbGVtZW50cy5wdXNoKFJlYWN0LkRPTS5kaXYobnVsbCwgVGltZWxpbmVEYXlFbGVtZW50KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlDb3VudDogMC41LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaENvdW50OiBiYXRjaENvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QmF0Y2g6IGN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UHJvc3BlY3RzOiB0aGlzLnByb3BzLm5ld1Byb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFR5cGU6IHRydWUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoZXM6IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5iYXRjaGVzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9zcGVjdExpc3RDb3VudDogdGhpcy5wcm9wcy5wcm9zcGVjdExpc3RDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudEJhdGNoOiB0aGlzLnNldEN1cnJlbnRCYXRjaH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwidGltZWxpbmVcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtoZWlnaHQ6JzEwMCUnLGJhY2tncm91bmRDb2xvcjoncmdiKDkwLCAxMDcsIDExOSknLCB3aWR0aDo1LG1hcmdpblRvcDotMzV9fSwgXG4gICAgICAgICAgICAgdGltZWxpbmVFbGVtZW50c1xuICAgICAgICApLCBcbiAgICAgICAgU2VuZEVtYWlsTW9kYWwoe3Byb3NwZWN0czogdGhpcy5wcm9wcy5wcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYW1wYWlnbjogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb3NwZWN0czogdGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkRm9sbG93dXBTZW50VG9CYXRjaDogdGhpcy5hZGRGb2xsb3d1cFNlbnRUb0JhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCYXRjaDogdGhpcy5zdGF0ZS5jdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRlbXBsYXRlOiB0aGlzLnN0YXRlLmN1cnJlbnRUZW1wbGF0ZX0pXG4gICAgICApXG4gICAgKTtcbiAgfSxcblxuICBjcmVhdGVGb2xsb3d1cDogZnVuY3Rpb24oKSB7XG4gICAgLy9cbiAgfSwgICAgICAgICBcblxuICBhZGRGb2xsb3d1cDogZnVuY3Rpb24oZGF5KSB7XG4gICAgLy9jb25zb2xlLmxvZygnY2FsbGVkIHRlbXBsYXRlIGVkaXQgbWVudScpXG4gICAgZm9sbG93dXBzID0gdGhpcy5zdGF0ZS5mb2xsb3d1cHNcbiAgICBmb2xsb3d1cHMucHVzaCh7YWRkVGVtcGxhdGVNb2RlOiB0cnVlLCBkYXk6IGRheX0pXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGZvbGxvd3VwczogZm9sbG93dXBzIH0pXG4gIH0sXG5cbiAgZWRpdEZvbGxvd3VwOiBmdW5jdGlvbihkYXkpIHtcbiAgICAvLyBmaW5kIHRlbXBsYXRlIHNldCBlZGl0bW9kZSBpcyBmYWxzZVxuICAgIGZvbGxvd3VwcyA9IF8ubWFwKHRoaXMuc3RhdGUuZm9sbG93dXBzLCBmdW5jdGlvbihmb2xsb3d1cCkge1xuICAgICAgaWYoZm9sbG93dXAuZGF5ID09IGRheSl7IGZvbGxvd3VwLmFkZFRlbXBsYXRlTW9kZSA9IHRydWUgfVxuICAgICAgcmV0dXJuIGZvbGxvd3VwXG4gICAgfSlcbiAgICB0aGlzLnNldFN0YXRlKHtmb2xsb3d1cHM6IGZvbGxvd3Vwc30pXG4gIH0sXG5cbiAgc2F2ZUZvbGxvd3VwOiBmdW5jdGlvbihkYXksIGNob3NlblRlbXBsYXRlKSB7XG4gICAgbmV3X2ZvbGxvd3VwcyA9IF8ubWFwKHRoaXMuc3RhdGUuZm9sbG93dXBzLCBmdW5jdGlvbihmb2xsb3d1cCkge1xuICAgICAgaWYoZm9sbG93dXAuZGF5ID09IGRheSl7XG4gICAgICAgIGZvbGxvd3VwLmFkZFRlbXBsYXRlTW9kZSA9IGZhbHNlXG4gICAgICAgIGZvbGxvd3VwLnRlbXBsYXRlID0gY2hvc2VuVGVtcGxhdGVcbiAgICAgIH1cbiAgICAgIHJldHVybiBmb2xsb3d1cFxuICAgIH0pXG4gICAgdGhpcy5zZXRTdGF0ZSh7Zm9sbG93dXBzOiBuZXdfZm9sbG93dXBzfSlcbiAgICBmb2xsb3d1cCA9IF8uZmluZFdoZXJlKG5ld19mb2xsb3d1cHMsIHtkYXk6IGRheX0pXG5cbiAgICAgIGlmKGZvbGxvd3VwLm9iamVjdElkKXtcbiAgICAgICAgdXJsID0gXCIvXCIrZm9sbG93dXAub2JqZWN0SWQ7IHR5cGU9XCJQVVRcIlxuICAgICAgICBkYXRhID0ge3RlbXBsYXRlOiBhcHBDb25maWcucG9pbnRlcignVGVtcGxhdGUnLCBjaG9zZW5UZW1wbGF0ZS5vYmplY3RJZCl9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1cmwgPSBcIlwiOyB0eXBlPVwiUE9TVFwiO1xuXG4gICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgIGRheTogZGF5LFxuICAgICAgICAgICAgY2FtcGFpZ24gOiBhcHBDb25maWcucG9pbnRlcignQ2FtcGFpZ24nLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLm9iamVjdElkKSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiBhcHBDb25maWcucG9pbnRlcignVGVtcGxhdGUnLCBjaG9zZW5UZW1wbGF0ZS5vYmplY3RJZCksXG4gICAgICAgICAgfVxuICAgICAgfVxuXG4gICAgdGhpc3MgPSB0aGlzO1xuICAgICQuYWpheCh7XG4gICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvRm9sbG93dXAnK3VybCxcbiAgICAgIHR5cGU6dHlwZSxcbiAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIG5ld19mb2xsb3d1cHMgPSBfLm1hcChuZXdfZm9sbG93dXBzLCBmdW5jdGlvbihmb2xsb3d1cCkge1xuICAgICAgICAgIGlmKGZvbGxvd3VwLmRheSA9PSBkYXkpIHsgZm9sbG93dXAub2JqZWN0SWQgPSBmYWxzZSB9XG4gICAgICAgICAgcmV0dXJuIGZvbGxvd3VwXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXNzLnNldFN0YXRlKHtmb2xsb3d1cHM6IG5ld19mb2xsb3d1cHN9KVxuXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvQ2FtcGFpZ24vJyt0aGlzcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLm9iamVjdElkLFxuICAgICAgICAgIHR5cGU6J1BVVCcsXG4gICAgICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeSh7Zm9sbG93dXBzOiB7XG4gICAgICAgICAgICBfX29wOiAnQWRkVW5pcXVlJyxcbiAgICAgICAgICAgIG9iamVjdHM6W2FwcENvbmZpZy5wb2ludGVyKCdGb2xsb3d1cCcsIHJlcy5vYmplY3RJZCldXG4gICAgICAgICAgfX0pLFxuICAgICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oKSB7IH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgeyB9XG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgeyB9LFxuICAgIH0pXG4gIH0sXG5cbiAgcmVtb3ZlRm9sbG93dXA6IGZ1bmN0aW9uKGRheSkge1xuICAgIGZvbGxvd3VwcyA9IFtdXG4gICAgZm9yKGk9MDtpPCB0aGlzLnN0YXRlLmZvbGxvd3Vwcy5sZW5ndGg7aSsrKVxuICAgICAgaWYodGhpcy5zdGF0ZS5mb2xsb3d1cHNbaV0uZGF5ICE9IGRheSlcbiAgICAgICAgZm9sbG93dXBzLnB1c2godGhpcy5zdGF0ZS5mb2xsb3d1cHNbaV0pXG4gICAgICBcbiAgICBmb3IoaT0wO2k8IHRoaXMuc3RhdGUuZm9sbG93dXBzLmxlbmd0aDtpKyspXG4gICAgICBpZih0aGlzLnN0YXRlLmZvbGxvd3Vwc1tpXS5kYXkgPT0gZGF5KVxuICAgICAgICBicmVha1xuICAgIFxuICAgIHRoaXMuc2V0U3RhdGUoe2ZvbGxvd3VwczogZm9sbG93dXBzfSkgXG4gICAgaWQgPSB0aGlzLnN0YXRlLmZvbGxvd3Vwc1tpXVxuXG4gICAgdGhpc3MgPSB0aGlzO1xuICAgIGlmKGlkKSB7XG4gICAgICBpZCA9IGlkLm9iamVjdElkXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvRm9sbG93dXAvJytpZCxcbiAgICAgICAgaGVhZGVyczphcHBDb25maWcuaGVhZGVycyxcbiAgICAgICAgdHlwZTonREVMRVRFJyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7IGNvbnNvbGUubG9nKHJlcykgfVxuICAgICAgfSlcblxuICAgICBjb25zb2xlLmxvZygnUkVNT1ZFIEFSUkFZJylcbiAgICAgICQuYWpheCh7XG4gICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9DYW1wYWlnbi8nK3RoaXNzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24ub2JqZWN0SWQsXG4gICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgIHR5cGU6J1BVVCcsXG4gICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBmb2xsb3d1cHM6IHtcbiAgICAgICAgICAgIF9fb3AgOiAnUmVtb3ZlJyxcbiAgICAgICAgICAgIG9iamVjdHM6IFthcHBDb25maWcucG9pbnRlcignRm9sbG93dXAnLCBpZCldXG4gICAgICAgICAgfVxuICAgICAgICB9KSxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKXsgY29uc29sZS5sb2cocmVzKSB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7IH1cbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG4gIHNldEN1cnJlbnRCYXRjaDogZnVuY3Rpb24oY3VycmVudEJhdGNoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Y3VycmVudEJhdGNoOiBjdXJyZW50QmF0Y2h9KVxuICB9LFxuXG4gIHNldEN1cnJlbnRUZW1wbGF0ZTogZnVuY3Rpb24odGVtcGxhdGUpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50VGVtcGxhdGU6IHRlbXBsYXRlIH0pXG4gIH1cbn0pO1xuIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGN1cnJlbnRQcm9zcGVjdDogMCxcbiAgICB9XG4gIH0sXG5cbiAgc2VuZEVtYWlsczogZnVuY3Rpb24oKSB7XG4gICAgc2VsZWN0ZWRDYW1wYWlnbiA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnblxuICAgIGNhbXBhaWduX2lkID0gc2VsZWN0ZWRDYW1wYWlnbi5vYmplY3RJZFxuICAgIHByb3NwZWN0bGlzdF9pZCA9IHNlbGVjdGVkQ2FtcGFpZ24ucHJvc3BlY3RfbGlzdC5vYmplY3RJZFxuICAgIHRlbXBsYXRlX2lkID0gdGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUub2JqZWN0SWRcbiAgICBcbiAgICAkLmFqYXgoe1xuICAgICAgLy91cmw6J2h0dHBzOi8vbmFtZWxlc3MtcmV0cmVhdC0zNTI1Lmhlcm9rdWFwcC5jb20vc2VuZF9lbWFpbCcsXG4gICAgICB1cmw6J2h0dHA6Ly8xMjcuMC4wLjE6NTAwMC92MS9jYW1wYWlnbi9lbWFpbCcsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHRlbXBsYXRlIDogdGVtcGxhdGVfaWQsXG4gICAgICAgIGNhbXBhaWduIDogY2FtcGFpZ25faWQsXG4gICAgICAgIC8vYmF0Y2g6IGJhdGNoX2lkXG4gICAgICB9LFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7IGNvbnNvbGUubG9nKHJlcy5yZXN1bHRzKSB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikgeyBjb25zb2xlLmxvZyhlcnIpIH1cbiAgICB9KVxuXG4gICAgLyogKi9cbiAgICAvLyBVcGRhdGUgRm9sbG93dXBcbiAgICAvLyBQZXJzaXN0IEZvbGxvd3VwXG4gICAgLy8gY2xvc2UgbW9kYWxcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHByb3NwZWN0ID0gdGhpcy5wcm9wcy5wcm9zcGVjdHNbdGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3RdXG4gICAgcHJvc3BlY3QgPSAocHJvc3BlY3QpID8gcHJvc3BlY3QgOiB7J25hbWUnOicnLCdlbWFpbCc6Jyd9XG5cbiAgICB2YXIgdGhpc3MgPSB0aGlzO1xuICAgIGNvbnNvbGUuZGVidWcoJ1NFTkQgRU1BSUwgQkFUQ0gnKVxuICAgIGNvbnNvbGUuZGVidWcodGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gpXG4gICAgbmV3QmF0Y2ggPSBfLmlzRXF1YWwodGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gsIHt9KVxuICAgIHByb3NwZWN0cyA9IChuZXdCYXRjaCkgPyB0aGlzLnByb3BzLm5ld1Byb3NwZWN0cyA6IHRoaXMucHJvcHMucHJvc3BlY3RzXG4gICAgaWYobmV3QmF0Y2gpe1xuICAgICAgcHJvc3BlY3RzID0gXy5tYXAodGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMsIGZ1bmN0aW9uKHByb3NwZWN0KSB7XG4gICAgICAgICAgcmV0dXJuIFVzZXJQbGFjZUhvbGRlcih7cHJvc3BlY3Q6IHByb3NwZWN0fSlcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHByb3NwZWN0cyA9IF8ubWFwKHRoaXMucHJvcHMucHJvc3BlY3RzLCBmdW5jdGlvbihwcm9zcGVjdCkge1xuICAgICAgICBpZihfLmZpbmRXaGVyZShwcm9zcGVjdC5iYXRjaGVzLCB7b2JqZWN0SWQ6IHRoaXNzLnByb3BzLmN1cnJlbnRCYXRjaH0pKVxuICAgICAgICAgIHJldHVybiBVc2VyUGxhY2VIb2xkZXIoe3Byb3NwZWN0OiBwcm9zcGVjdH0pXG4gICAgICB9KVxuICAgIH1cbiAgICBwcm9zcGVjdHMgPSBfLmNvbXBhY3QocHJvc3BlY3RzKVxuICAgIGNvbnNvbGUuZGVidWcocHJvc3BlY3RzKVxuICAgIGNvbnNvbGUuZGVidWcocHJvc3BlY3RzLmxlbmd0aClcbiAgICBwcm9zcGVjdENvdW50ID0gcHJvc3BlY3RzLmxlbmd0aFxuICAgIGVtYWlsID0gKHByb3NwZWN0LmVtYWlsKSA/IHByb3NwZWN0LmVtYWlsIDogXCJcIlxuICAgIGlmKGVtYWlsID09IFwibm9fZW1haWxcIiB8fCBlbWFpbCA9PSBcIlwiKSB7XG4gICAgICBjb25zb2xlLmxvZygnR1VFU1NJTkcnKVxuICAgICAgaWYocHJvc3BlY3QuZW1haWxfZ3Vlc3Nlcykge1xuICAgICAgICBjb25zb2xlLmxvZygnR1VFU1NJTkcgRU1BSUwnKVxuICAgICAgICBndWVzcyA9IF8uZmluZFdoZXJlKHByb3NwZWN0LmVtYWlsX2d1ZXNzZXMsIHt0cmllZDogZmFsc2V9KVxuICAgICAgICBuYW1lID0gXy50aXRsZShwcm9zcGVjdC5uYW1lLnRyaW0oKSlcblxuICAgICAgICB2YXJzID0ge1xuICAgICAgICAgIGZpcnN0OiBfLmZpcnN0KG5hbWUuc3BsaXQoJyAnKSkucmVwbGFjZSgvXFxXL2csICcnKSxcbiAgICAgICAgICBsYXN0OiBfLmxhc3QobmFtZS5zcGxpdCgnICcpKS5yZXBsYWNlKC9cXFcvZywgJycpLFxuICAgICAgICAgIGZpOiBfLmZpcnN0KG5hbWUuc3BsaXQoJyAnKSlbMF0ucmVwbGFjZSgvXFxXL2csICcnKSxcbiAgICAgICAgICBsaTogXy5sYXN0KG5hbWUuc3BsaXQoJyAnKSlbMF0ucmVwbGFjZSgvXFxXL2csICcnKVxuICAgICAgICB9XG4gICAgICAgIGlmKGd1ZXNzKXtcbiAgICAgICAgICBjb25zb2xlLmxvZyhndWVzcy5wYXR0ZXJuLnBhdHRlcm4pXG4gICAgICAgICAgZW1haWwgPSBNdXN0YWNoZS5yZW5kZXIoZ3Vlc3MucGF0dGVybi5wYXR0ZXJuLCB2YXJzKVxuICAgICAgICAgIGVtYWlsID0gZW1haWwrXCJAXCIrcHJvc3BlY3QuZG9tYWluXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdOTyBHVUVTU0VTIEZPVU5EJylcbiAgICAgIH1cbiAgICB9XG4gICAgZW1haWwgPSBlbWFpbC50b0xvd2VyQ2FzZSgpXG4gICAgZW1haWwgPSBlbWFpbFxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwgZmFkZSBicy1zZW5kRW1haWwtbW9kYWwtbGdcIiwgdGFiSW5kZXg6IFwiLTFcIiwgXG4gICAgICAgICAgIHJvbGU6IFwiZGlhbG9nXCIsICdhcmlhLWxhYmVsbGVkYnknOiBcIm15U21hbGxNb2RhbExhYmVsXCIsICdhcmlhLWhpZGRlbic6IFwidHJ1ZVwiLCBcbiAgICAgICAgICAgaWQ6IFwic2VuZEVtYWlsTW9kYWxcIiwgc3R5bGU6IHt0b3A6JzEwcHgnfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWRpYWxvZyBtb2RhbC1sZ1wifSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbC1jb250ZW50XCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwtaGVhZGVyXCJ9LCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIGNsYXNzTmFtZTogXCJjbG9zZVwiLCAnZGF0YS1kaXNtaXNzJzogXCJtb2RhbFwifSwgUmVhY3QuRE9NLnNwYW4oeydhcmlhLWhpZGRlbic6IFwidHJ1ZVwifSwgXCLDl1wiKSwgXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwic3Itb25seVwifSwgXCJDbG9zZVwiKSksIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLnNlbmRFbWFpbHMsIFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7ZmxvYXQ6J3JpZ2h0J30sIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLXByaW1hcnkgYnRuLXNtXCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBhcGVyLXBsYW5lXCJ9KSwgXCLCoCBTZW5kIEVtYWlsXCIpLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgc3R5bGU6IHttYXJnaW5SaWdodDoxMCwgZmxvYXQ6J3JpZ2h0J30sIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXCIsICdkYXRhLWRpc21pc3MnOiBcIm1vZGFsXCJ9LCBcIkNsb3NlXCIpLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5oNCh7Y2xhc3NOYW1lOiBcIm1vZGFsLXRpdGxlXCIsIGlkOiBcIm15TW9kYWxMYWJlbFwifSwgXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZW52ZWxvcGVcIn0pLCBcIiDCoFNlbmQgRW1haWxcIiArICcgJyArXG4gICAgICAgICAgICAgICAgICAgIFwiwqDCoFwiLCBcbiAgICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLnNtYWxsKG51bGwsIFwiKFwiK3Byb3NwZWN0Q291bnQrXCIpXCIpXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWJvZHlcIiwgc3R5bGU6IHtwYWRkaW5nVG9wOjV9fSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uaDQobnVsbCwgXCJQZW9wbGVcIiksIFxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicHJvc3BlY3QtY29udGFpbmVyXCJ9LCBcbiAgICAgICAgICAgICAgICAgICAgcHJvc3BlY3RzXG4gICAgICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uaDQoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJ319LCBcIkVtYWlscyDCoMKgwqBcIiwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgICAgY2xhc3NOYW1lOiAodGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QgPT0gMCApID8gXCJiYWRnZSBidG4gZGlzYWJsZWRcIiA6IFwiYmFkZ2UgYnRuXCIsIFxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLnByZXZpb3VzUHJvc3BlY3R9LCBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWFycm93LWxlZnRcIn0pKSwgXCLCoMKgXCIsIFxuICAgICAgICAgICAgICAgICAgICBSZWFjdC5ET00uc21hbGwobnVsbCwgKHRoaXMuc3RhdGUuY3VycmVudFByb3NwZWN0KzEpKycgb2YgJytwcm9zcGVjdENvdW50XG4gICAgICAgICAgICAgICAgICApKSwgXG4gICAgICAgICAgICAgICAgICBcIsKgwqDCoFwiLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgY2xhc3NOYW1lOiAodGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QgPT0gIHRoaXMucHJvcHMucHJvc3BlY3RzLmxlbmd0aC0xKSA/IFwiYnRuIGRpc2FibGVkIGJhZGdlXCIgOiBcImJ0biBiYWRnZVwiLCBcbiAgICAgICAgICAgICAgICAgICAgb25DbGljazogdGhpcy5uZXh0UHJvc3BlY3R9LCBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWFycm93LXJpZ2h0XCJ9KSksIFxuXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuXG5SZWFjdC5ET00udWwoe2NsYXNzTmFtZTogXCJsaXN0LWdyb3VwIGVtYWlsLWhvbGRlclwiLCBzdHlsZToge2JvcmRlclRvcDonc29saWQgMXB4ICNlZWUnfX0sIFxuICBSZWFjdC5ET00ubGkoe2NsYXNzTmFtZTogXCJsaXN0LWdyb3VwLWl0ZW1cIn0sIFxuICAgIFJlYWN0LkRPTS5oNSh7c3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snLG1hcmdpblRvcDowLG1hcmdpbkJvdHRvbTowfX0sIFwiVG86wqDCoFwiKSwgXG4gICAgXG4gICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1wcmltYXJ5XCJ9LCBlbWFpbClcbiAgKSwgXG4gIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAtaXRlbVwifSwgXG4gICAgUmVhY3QuRE9NLmg1KHtzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jaycsbWFyZ2luVG9wOjAsbWFyZ2luQm90dG9tOjB9fSwgXCJTdWJqZWN0OsKgwqBcIiksIFwiIFwiLCBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcImxhYmVsIGxhYmVsLXByaW1hcnlcIn0sIHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLnN1YmplY3QpXG4gICksIFxuICBSZWFjdC5ET00ubGkoe2NsYXNzTmFtZTogXCJsaXN0LWdyb3VwLWl0ZW0gYm9keVwifSlcbilcbiAgXG4gICAgICAgICAgICAgICAgICApXG5cbiAgICAgICAgICAgICAgICApLCBcblxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWZvb3RlclwiLCBzdHlsZToge2Rpc3BsYXk6J25vbmUnfX0sIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1kZWZhdWx0XCIsICdkYXRhLWRpc21pc3MnOiBcIm1vZGFsXCJ9LCBcIkNsb3NlXCIpLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tcHJpbWFyeVwifSwgXCJTZW5kIEVtYWlsXCIpXG4gICAgICApXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgKTtcbiAgfSxcblxuICBwcmV2aW91c1Byb3NwZWN0OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50UHJvc3BlY3Q6IHRoaXMuc3RhdGUuY3VycmVudFByb3NwZWN0LTEgfSlcbiAgfSxcblxuICBuZXh0UHJvc3BlY3Q6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRQcm9zcGVjdDogdGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QrMSB9KVxuICB9LFxuXG4gIHBhcnNlVGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlQm9keSkge1xuICAgIGZpcnN0X25hbWUgPSBwcm9zcGVjdC5uYW1lLnNwbGl0KCcgJylbMF1cbiAgICAvL2hpcmluZ19zaWduYWwgPSBwcm9zcGVjdC5zaWduYWxzXG5cbiAgICBzaWduYWxzID0gKHByb3NwZWN0LnNpZ25hbHMpID8gcHJvc3BlY3Quc2lnbmFsc1swXSA6IFwiXCJcbiAgICB0ZW1wbGF0ZUJvZHkgPSBNdXN0YWNoZS5yZW5kZXIodGVtcGxhdGVCb2R5LCB7XG4gICAgICBoaXJpbmdfc2lnbmFsOiBzaWduYWxzLFxuICAgICAgZmlyc3RfbmFtZTogXy50aXRsZShwcm9zcGVjdC5uYW1lLnNwbGl0KCcgJylbMF0pXG4gICAgfSlcblxuICAgIC8vY29uc29sZS5sb2codGVtcGxhdGVCb2R5KVxuICAgICAgXG4gICAgcmV0dXJuIHRlbXBsYXRlQm9keVxuICB9LFxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZSlcbiAgICBwYXJzZWRUZW1wbGF0ZSA9IHRoaXMucGFyc2VUZW1wbGF0ZSh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZS5ib2R5KVxuICAgIFxuICAgIC8vJCgnLmJvZHknKS5odG1sKHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLmJvZHkpXG4gICAgJCgnLmJvZHknKS5odG1sKHBhcnNlZFRlbXBsYXRlKVxuICB9XG59KTtcblxudmFyIFVzZXJQbGFjZUhvbGRlciA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ1VzZXJQbGFjZUhvbGRlcicsXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImJ0bi1ncm91cFwiLCBzdHlsZToge21hcmdpblJpZ2h0OjUsbWFyZ2luQm90dG9tOjV9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImJ0bi1ncm91cFwifSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4tc21cIn0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXVzZXJcIn0pLCBcIsKgwqBcIiwgXG4gICAgICAgICAgICAgICh0aGlzLnByb3BzLnByb3NwZWN0KSA/IF8udGl0bGUodGhpcy5wcm9wcy5wcm9zcGVjdC5uYW1lKSA6IFwiXCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi1zbVwifSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgKVxuICB9XG59KTtcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvL1RlbXBsYXRlc01lbnVcbiAgdG9nZ2xlVGVtcGxhdGVFZGl0TWVudTogZnVuY3Rpb24oY3VycmVudFRlbXBsYXRlKSB7XG4gICAgdGhpcy5wcm9wcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51KGN1cnJlbnRUZW1wbGF0ZSlcbiAgfSxcblxuICBjcmVhdGVUZW1wbGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5wcm9wcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51KHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgYm9keTonJyxcbiAgICAgIHN1YmplY3Q6JycsXG4gICAgICBlZGl0TW9kZTp0cnVlLFxuICAgICAgbmV3VGVtcGxhdGU6IHRydWVcbiAgICB9LCB0cnVlKVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLnByb3BzLnRlbXBsYXRlcylcbiAgICB0ZW1wbGF0ZXMgPSBbXVxuICAgIGZvcihpPTA7aTwgdGhpcy5wcm9wcy50ZW1wbGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRlbXBsYXRlcy5wdXNoKFxuICAgICAgICBUZW1wbGF0ZUxpc3RJdGVtKHtcbiAgICAgICAgICB0b2dnbGVUZW1wbGF0ZUVkaXRNZW51OiB0aGlzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUsIFxuICAgICAgICAgIHRlbXBsYXRlOiB0aGlzLnByb3BzLnRlbXBsYXRlc1tpXX0pXG4gICAgICApXG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJcIiwgc3R5bGU6IHtwYWRkaW5nOicwJywgaGVpZ2h0OicxMDAlJyx0ZXh0QWxpZ246J2NlbnRlcid9fSwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbCBwYW5lbC1kZWZhdWx0XCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7Ym9yZGVyUmlnaHQ6MCxib3JkZXJSYWRpdXM6MCxoZWlnaHQ6JzEwMCUnLCBvdmVyZmxvdzonYXV0byd9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWhlYWRpbmdcIiwgc3R5bGU6IHtoZWlnaHQ6NDB9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHtmbG9hdDonbGVmdCcsZm9udFNpemU6MTQsZm9udFdlaWdodDonYm9sZCd9fSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZmlsZS10ZXh0LW9cIn0pLCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe3N0eWxlOiB7bWFyZ2luTGVmdDo1fX0sIFwiVGVtcGxhdGVzXCIpXG4gICAgICAgICAgICApLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi14c1wiLCBcbiAgICAgICAgICAgICAgb25DbGljazogdGhpcy5jcmVhdGVUZW1wbGF0ZSwgXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtmbG9hdDoncmlnaHQnfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBsdXNcIn0pLCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe3N0eWxlOiB7bWFyZ2luTGVmdDo1fX0sIFwiQ3JlYXRlIFRlbXBsYXRlXCIpXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnVsKHtjbGFzc05hbWU6IFwibGlzdC1ncm91cFwiLCBcbiAgICAgICAgICAgICAgc3R5bGU6IHt0ZXh0QWxpZ246J2xlZnQnfX0sIFxuICAgICAgICAgICAgdGVtcGxhdGVzXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgKVxuICB9XG59KTtcblxudmFyIFRlbXBsYXRlTGlzdEl0ZW0gPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdUZW1wbGF0ZUxpc3RJdGVtJyxcbiAgdG9nZ2xlVGVtcGxhdGVFZGl0TWVudTogZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS5sb2codGhpcy5wcm9wcy50ZW1wbGF0ZSlcbiAgICB0ZW1wbGF0ZSA9IHRoaXMucHJvcHMudGVtcGxhdGVcbiAgICB0ZW1wbGF0ZS5lZGl0TW9kZSA9IGZhbHNlXG4gICAgdGhpcy5wcm9wcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51KHRlbXBsYXRlKVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYobnVsbCwgXG4gICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgIHN0eWxlOiB7Ym9yZGVyQm90dG9tOiAnMXB4IHNvbGlkIHJnYigyMjEsIDIyMSwgMjIxKScscGFkZGluZ1RvcDo1LHBhZGRpbmdCb3R0b206MH0sIFxuICAgICAgICAgICBvbkNsaWNrOiB0aGlzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUsIFxuICAgICAgICAgICBjbGFzc05hbWU6IFwibGlzdC1ncm91cC1pdGVtXCJ9LCBcbiAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1kZWZhdWx0XCJ9LCBcbiAgICAgICAgICAgICB0aGlzLnByb3BzLnRlbXBsYXRlLm5hbWVcbiAgICAgICAgICAgKSwgXG4gICAgICAgICAgIFJlYWN0LkRPTS5oNihudWxsLCBcIlN1YmplY3Q6XCIsIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwidGV4dCB0ZXh0LW11dGVkXCJ9LCBcbiAgICAgICAgICAgICBcIiBcIiArIHRoaXMucHJvcHMudGVtcGxhdGUuc3ViamVjdFxuICAgICAgICAgICApKVxuICAgICAgICAgKVxuICAgICAgKVxuICAgICk7XG4gIH1cbn0pO1xuIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIC8vIFRpbWVsaW5lRGF5RWxlbWVudFxuICAvLyBUT0RPXG4gIC8vIC0gYWRkIHByb3NwZWN0IGxpc3QgcHJvZ3Jlc3Npb25cbiAgLy8gLSBhZGQgc2NoZWR1bGVkIGZvbGxvd3VwXG4gIC8vXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgLy8gXG4gICAgcmV0dXJuIHtcbiAgICAgIGZvbGxvd3VwQ29tcGxldGVkOiAwLFxuICAgIH1cbiAgfSxcblxuICBhZGRGb2xsb3d1cDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5wcm9wcy5hZGRGb2xsb3d1cCh0aGlzLnByb3BzLmRheUNvdW50KVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgaWYodGhpcy5wcm9wcy5hZGRUZW1wbGF0ZU1vZGUpIHtcbiAgICAgIG1vZGUgPSBFZGl0VGVtcGxhdGUoe2FkZEZvbGxvd3VwOiB0aGlzLnByb3BzLmFkZEZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVGb2xsb3d1cDogdGhpcy5wcm9wcy5zYXZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRm9sbG93dXA6IHRoaXMucHJvcHMucmVtb3ZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5Q291bnQ6IHRoaXMucHJvcHMuZGF5Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVzOiB0aGlzLnByb3BzLnRlbXBsYXRlc30pXG4gICAgfSBlbHNlIHtcbiAgICAgIG1vZGUgPSBUZW1wbGF0ZUZvbGxvd3VwKHtjdXJyZW50VGVtcGxhdGU6IHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0Rm9sbG93dXA6IHRoaXMucHJvcHMuZWRpdEZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlDb3VudDogdGhpcy5wcm9wcy5kYXlDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJhdGNoOiB0aGlzLnByb3BzLmN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQmF0Y2g6IHR5cGVvZih0aGlzLnByb3BzLmJhdGNoQ291bnQpICE9IFwidW5kZWZpbmVkXCIgJiYgdGhpcy5wcm9wcy5iYXRjaENvdW50ID4gMCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudEJhdGNoOiB0aGlzLnByb3BzLnNldEN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5Q291bnQ6IHRoaXMucHJvcHMuZGF5Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZvbGxvd3VwOiB0aGlzLnByb3BzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRDdXJyZW50VGVtcGxhdGU6IHRoaXMucHJvcHMuc2V0Q3VycmVudFRlbXBsYXRlfSlcbiAgICB9XG4gICAgaWYodGhpcy5wcm9wcy5hbHJlYWR5U2VudCkge1xuICAgICAgbW9kZSA9IEZvbGxvd3VwQ29tcGxldGVkKHtjdXJyZW50VGVtcGxhdGU6IHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlfSlcbiAgICB9XG5cbiAgICBtb2RlID0gKHRoaXMucHJvcHMuZWxlbWVudFR5cGUpID8gXCJcIiA6IG1vZGVcbiAgICBhZGRGb2xsb3d1cCA9ICh0aGlzLnByb3BzLmVsZW1lbnRUeXBlKSA/IHRoaXMuYWRkRm9sbG93dXAgOiBcIlwiXG4gICAgaWYodHlwZW9mKHRoaXMucHJvcHMuYmF0Y2hDb3VudCkgIT0gXCJ1bmRlZmluZWRcIilcbiAgICAgIGJhdGNoU3RhZ2UgPSBCYXRjaFN0YWdlKHtjdXJyZW50QmF0Y2g6IHRoaXMucHJvcHMuY3VycmVudEJhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdQcm9zcGVjdHM6IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9zcGVjdExpc3RDb3VudDogdGhpcy5wcm9wcy5wcm9zcGVjdExpc3RDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hDb3VudDogdGhpcy5wcm9wcy5iYXRjaENvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNTY2hlZHVsZWRFbWFpbDogbW9kZSAhPSBcIlwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlDb3VudDogdGhpcy5wcm9wcy5kYXlDb3VudH0pXG4gICAgZWxzZVxuICAgICAgYmF0Y2hTdGFnZSA9IFwiXCJcblxuICAgIGRheUNvdW50ID0gKHRoaXMucHJvcHMuZGF5Q291bnQgIT0gMC41KSA/IFwiRFwiK3RoaXMucHJvcHMuZGF5Q291bnQgOiBcIlwiXG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdihudWxsLCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7b25DbGljazogYWRkRm9sbG93dXAsIGNsYXNzTmFtZTogXCJkYXlcIiwgJ2RhdGEtdHJpZ2dlcic6IFwibWFudWFsXCJ9LCBcbiAgICAgICAgICBkYXlDb3VudFxuICAgICAgICApLCBcbiAgICAgICAgbW9kZSwgYmF0Y2hTdGFnZVxuICAgICAgKVxuICAgIClcbiAgfSxcblxuICBzZXRDdXJyZW50VGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlKSB7XG4gICAgdGhpcy5wcm9wcy5zZXRDdXJyZW50VGVtcGxhdGUodGVtcGxhdGUpXG4gIH1cbn0pO1xuXG52YXIgRm9sbG93dXBDb21wbGV0ZWQgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdGb2xsb3d1cENvbXBsZXRlZCcsXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJmb2xsb3d1cC1wbGFjZW1lbnQgYXJyb3dfYm94XzEgdG1wXzJcIn0sIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7d2lkdGg6MTMwLGRpc3BsYXk6J2lubGluZS1ibG9jayd9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFwiwqDCoFwiLCBcbiAgICAgICAgICAodGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUpID8gdGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUubmFtZSA6IFwiXCJcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe2NsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tc3VjY2VzcyBidG4teHMgZGlzYWJsZWRcIiwgXG4gICAgICAgICAgICAgICAgJ2RhdGEtdGFyZ2V0JzogXCIuYnMtc2VuZEVtYWlsLW1vZGFsLWxnXCIsIFxuICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuc2V0Q3VycmVudFRlbXBsYXRlLCBcbiAgICAgICAgICAgICAgICAnZGF0YS10b2dnbGUnOiBcIm1vZGFsXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWNoZWNrXCJ9KSwgXCLCoFNlbnRcIiksIFwiwqBcIiwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMuZWRpdEZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGRpc2FibGVkXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBlbmNpbFwifSkpLCBcIsKgXCIsIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGRpc2FibGVkXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pKVxuICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gIH1cbn0pXG5cbnZhciBUZW1wbGF0ZUZvbGxvd3VwID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnVGVtcGxhdGVGb2xsb3d1cCcsXG4gIC8vIEVkaXRNb2RlIEZhbHNlXG5cbiAgc2V0Q3VycmVudFRlbXBsYXRlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnByb3BzLnNldEN1cnJlbnRUZW1wbGF0ZSh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZSlcbiAgICAvLyBzZXRDdXJyZW50QmF0Y2hcbiAgICB0aGlzLnByb3BzLnNldEN1cnJlbnRCYXRjaCh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaClcbiAgICAkKCcuYnMtc2VuZEVtYWlsLW1vZGFsLWxnJykubW9kYWwoKVxuICB9LFxuXG4gIHdhaXRGb3JCYXRjaDogZnVuY3Rpb24oKSB7XG4gICAgYWxlcnRpZnkubG9nKFwiWW91IG11c3Qgd2FpdCBmb3IgYSBiYXRjaCFcIik7XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB0cmFzaCA9ICh0aGlzLnByb3BzLmRheUNvdW50ID09IDApID8gIFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMucmVtb3ZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHMgZGlzYWJsZWRcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdHJhc2gtb1wifSkpIDogUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5yZW1vdmVGb2xsb3d1cCwgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS10cmFzaC1vXCJ9KSkgXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJmb2xsb3d1cC1wbGFjZW1lbnQgYXJyb3dfYm94XzEgdG1wXzJcIn0sIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7d2lkdGg6MTMwLGRpc3BsYXk6J2lubGluZS1ibG9jayd9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFwiwqDCoFwiLCBcbiAgICAgICAgICAodGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUpID8gdGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUubmFtZSA6IFwiXCJcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe2NsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tc3VjY2VzcyBidG4teHNcIiwgXG4gICAgICAgICAgb25DbGljazogKHRoaXMucHJvcHMuaGFzQmF0Y2gpID8gdGhpcy5zZXRDdXJyZW50VGVtcGxhdGUgOiB0aGlzLndhaXRGb3JCYXRjaCwgXG4gICAgICAgICAgICAgICAgJ2RhdGEtdG9nZ2xlJzogXCJtb2RhbFwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wYXBlci1wbGFuZVwifSksIFwiwqBTZW5kXCIpLCBcIsKgXCIsIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLmVkaXRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wZW5jaWxcIn0pKSwgXCLCoFwiLCBcbiAgICAgICAgdHJhc2hcbiAgICAgIClcbiAgICApO1xuICB9LFxuXG4gIGVkaXRGb2xsb3d1cDogZnVuY3Rpb24oZSkgeyBcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBjb25zb2xlLmxvZyh0aGlzLnByb3BzLmRheUNvdW50KVxuICAgIHRoaXMucHJvcHMuZWRpdEZvbGxvd3VwKHRoaXMucHJvcHMuZGF5Q291bnQpXG4gIH0sXG5cbiAgcmVtb3ZlRm9sbG93dXA6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKCdyZW1vdmUnKVxuICAgIHRoaXMucHJvcHMucmVtb3ZlRm9sbG93dXAodGhpcy5wcm9wcy5kYXlDb3VudClcbiAgfVxufSk7XG5cbnZhciBCYXRjaFN0YWdlID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnQmF0Y2hTdGFnZScsXG4gIC8vIERpZmZlcmVudCBTdGFnZXMgb2YgUGVvcGxlIEFkZGVkIHRvIFByb3NwZWN0IExpc3RcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaW5pdGlhbEJhdGNoQ291bnQ6IHRoaXMucHJvcHMuYmF0Y2hDb3VudFxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgLy8gc3RhdGVcbiAgICAvL2NvbnNvbGUuZGVidWcoJ0lOU0lERSBCQVRDSCAnK3RoaXMucHJvcHMuZGF5Q291bnQpXG4gICAgY29uc29sZS5kZWJ1Zyh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaClcbiAgICBfYmF0Y2hlcyA9IGFwcENvbmZpZy5wb2ludGVyKCdQcm9zcGVjdEJhdGNoJywgdGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gpXG4gICAgaWYodGhpcy5wcm9wcy5iYXRjaENvdW50ID09IFwiflwiKSB7XG4gICAgICAvLyBXaHkgZG9lc250IHRoaXMgd29yayBcbiAgICAgIHZhciB0aGlzc3NzID0gdGhpcztcbiAgICAgIGNvbnNvbGUuZGVidWcoJ0lOU0lERSBCQVRDSCAnK3RoaXNzLnByb3BzLmRheUNvdW50KVxuICAgICAgY29uc29sZS5kZWJ1ZyhfYmF0Y2hlcylcbiAgICAgICQuYWpheCh7XG4gICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdCcsXG4gICAgICAgIGJhdGNoZXM6IF9iYXRjaGVzLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgd2hlcmU6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGJhdGNoZXM6IF9iYXRjaGVzXG4gICAgICAgICAgfSksXG4gICAgICAgICAgY291bnQ6IHRydWUsXG4gICAgICAgICAgbGltaXQ6MTAwMCxcbiAgICAgICAgfSxcbiAgICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykgeyBcbiAgICAgICAgICAvL2NvbnNvbGUuZGVidWcoJ1NVQ0NFU1MgR0VUIENPVU5UICcgKyByZXMuY291bnQpXG4gICAgICAgICAgLy9jb25zb2xlLmRlYnVnKHJlcy5yZXN1bHRzKSBcbiAgICAgICAgICB0aGlzc3NzLnNldFN0YXRlKHtpbml0aWFsQmF0Y2hDb3VudDogcmVzLmNvdW50fSlcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikgeyBcbiAgICAgICAgICB0aGlzc3NzLnNldFN0YXRlKHtpbml0aWFsQmF0Y2hDb3VudDogMCB9KVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzOiBmdW5jdGlvbihuZXh0UHJvcHMpIHtcbiAgICBpZih0aGlzLnByb3BzLmRheUNvdW50ID09IDApXG4gICAgICB0aGlzLnNldFN0YXRlKHsgaW5pdGlhbEJhdGNoQ291bnQ6IG5leHRQcm9wcy5iYXRjaENvdW50IH0pXG4gIH0sXG5cblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIGlmKHRoaXMucHJvcHMuaGFzU2NoZWR1bGVkRW1haWwpXG4gICAgICBiYXRjaFN0YWdlU3R5bGUgPSB7dG9wOi00MiwgbGVmdDo2fVxuICAgIGVsc2VcbiAgICAgIGJhdGNoU3RhZ2VTdHlsZSA9IHt9XG5cbiAgICBpZih0aGlzLnByb3BzLmRheUNvdW50ID09IDAuNSlcbiAgICAgIGJhdGNoU3RhZ2VTdHlsZS5sZWZ0ID0gN1xuXG4gICAgLy9jb25zb2xlLmxvZygnQkFUQ0ggU1RBR0UnKVxuICAgIC8vY29uc29sZS5sb2codGhpcy5wcm9wcylcbiAgICAvL2NvbnNvbGUuZGVidWcodGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiZm9sbG93dXAtcGxhY2VtZW50IGFycm93X2JveCB0bXBcIiwgc3R5bGU6IGJhdGNoU3RhZ2VTdHlsZX0sIFxuICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcImxhYmVsIGxhYmVsLXByaW1hcnlcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdXNlclwifSksIFwiwqBcIiwgXG4gICAgICAgICAgdGhpcy5zdGF0ZS5pbml0aWFsQmF0Y2hDb3VudFxuICAgICAgICApLCBcIsKgXCIsIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJ319LCBcbiAgICAgICAgICBcInByb3NwZWN0cyBpbiB0aGUgc2FsZXMgY3ljbGUuXCIpXG4gICAgICApXG4gICAgKTtcbiAgfVxufSk7XG5cbnZhciBFZGl0VGVtcGxhdGUgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdFZGl0VGVtcGxhdGUnLFxuICAvLyBFZGl0IE1vZGUgLSBUcnVlXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgb3B0aW9ucyA9IFtdXG4gICAgZm9yKGk9MDtpPCB0aGlzLnByb3BzLnRlbXBsYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgb3B0aW9ucy5wdXNoKCBSZWFjdC5ET00ub3B0aW9uKG51bGwsIHRoaXMucHJvcHMudGVtcGxhdGVzW2ldLm5hbWUpKVxuICAgIH1cbiAgICB0cmFzaCA9ICh0aGlzLnByb3BzLmRheUNvdW50ID09IDApID8gIFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMucmVtb3ZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHMgZGlzYWJsZWRcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdHJhc2gtb1wifSkpIDogUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5yZW1vdmVGb2xsb3d1cCwgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wifSwgXCIgXCIsIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdHJhc2gtb1wifSkpIFxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiZm9sbG93dXAtcGxhY2VtZW50IGFycm93X2JveF8xIHRtcF8yXCJ9LCBcbiAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge3dpZHRoOjU1LGRpc3BsYXk6J2lubGluZS1ibG9jayd9LCBcbiAgICAgICAgICAgIGNsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcbiAgICAgICAgICBcIkNob29zZSA6XCJcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS5zZWxlY3Qoe2NsYXNzTmFtZTogXCJmb3JtLWNvbnRyb2wgaW5wdXQtc21cIiwgXG4gICAgICAgICAgICAgICAgaWQ6IFwiY2hvb3NlVGVtcGxhdGVGb3JGb2xsb3d1cFwiLCBcbiAgICAgICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jaycsd2lkdGg6MTI3LG1hcmdpblJpZ2h0OjV9fSwgXG4gICAgICAgICAgb3B0aW9uc1xuICAgICAgICApLCBcblxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHtjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLXN1Y2Nlc3MgYnRuLXhzXCIsIFxuICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuc2F2ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICBzdHlsZToge21hcmdpblJpZ2h0OjV9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGVja1wifSkpLCBcbiAgICAgICAgdHJhc2hcbiAgICAgIClcbiAgICApXG4gIH0sXG5cbiAgc2F2ZUZvbGxvd3VwOiBmdW5jdGlvbihlKSB7XG4gICAgLy9nZXQgdGVtcGxhdGUgZnJvbSBjdXJyZW50VGVtcGxhdGVcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBjaG9zZW5UZW1wbGF0ZSA9ICQoJyNjaG9vc2VUZW1wbGF0ZUZvckZvbGxvd3VwJykudmFsKClcbiAgICBjb25zb2xlLmxvZyhjaG9zZW5UZW1wbGF0ZSlcbiAgICBmb3IoaT0wO2k8IHRoaXMucHJvcHMudGVtcGxhdGVzLmxlbmd0aDsgaSsrKXtcbiAgICAgIGlmKHRoaXMucHJvcHMudGVtcGxhdGVzW2ldLm5hbWUgPT0gY2hvc2VuVGVtcGxhdGUpe1xuICAgICAgICBjaG9zZW5UZW1wbGF0ZSA9IHRoaXMucHJvcHMudGVtcGxhdGVzW2ldXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGNob3NlblRlbXBsYXRlKVxuICAgIFxuICAgIHRoaXMucHJvcHMuc2F2ZUZvbGxvd3VwKHRoaXMucHJvcHMuZGF5Q291bnQsIGNob3NlblRlbXBsYXRlKVxuICB9LFxuXG4gIHJlbW92ZUZvbGxvd3VwOiBmdW5jdGlvbihkYXkpIHtcbiAgICB0aGlzLnByb3BzLnJlbW92ZUZvbGxvd3VwKHRoaXMucHJvcHMuZGF5Q291bnQpXG4gIH0sXG59KTtcblxuIl19
