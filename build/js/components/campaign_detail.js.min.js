(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      activities: []
    }
  },

  componentDidMount: function() {
    var thiss = this;
    $.ajax({
      url: 'https://api.parse.com/1/classes/EmailEvent',
      data: {include: 'prospect,sent_email', order:'-createdAt', limit:1000},
      headers: appConfig.headers,
      success: function(res) { 
        console.log(res.results)
        thiss.setState({activities: res.results}) 
      },
      error: function() {}
    })
  },

  render: function() {
    activities = _.map(this.state.activities, function(activity) {
      return EmailActivities({activity: activity})
    })

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Sent "), 
            React.DOM.th(null, "Prospect "), 
            React.DOM.th(null, "Email "), 
            React.DOM.th(null, "Events "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons"), 
            React.DOM.th(null, "Social")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Event = React.createClass({displayName: 'Event',
  render: function() {
    event = this.props.event
    if(event == "delivered"){
      iconType = "fa fa-paper-plane"; eventName = "Delivered";
    }else if(event == "failed") {
      iconType = "fa fa-exclamation-circle"; eventName="Failed"
    }else if(event == "opened"){
      iconType = "fa fa-eye"; eventName="Opened"
    }else if(event == "replied"){
      iconType = "fa fa-mail-reply";  eventName = "Replied"
    }else if(event == "visited"){
      iconType = "fa fa-home";  eventName="Visited"
    }

    return (
      React.DOM.ul({className: "list-group email-events", style: {marginBottom:0}}, 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {paddingTop:16, height:49,textAlign:'center'}}, 
          React.DOM.i({className: iconType}), " ", React.DOM.span({style: {fontWeight:'bold'}}, eventName), " "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-home"}), " ", React.DOM.span({style: {fontWeight:'bold'}}, "Visited"), " ", 
          React.DOM.a({href: "javascript:"}, "customerohq.com/resources"), "  "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-external-link-square"}), " ", 
          React.DOM.span(null, "2:19 pm"), " ", 
          React.DOM.span({style: {fontWeight:'bold'}}, "clicked "), 
          React.DOM.a({href: "javascript:"}, "customerohq.com")
        )
      )
    )
  }
})

var EmailActivities = React.createClass({displayName: 'EmailActivities',
  render: function() {
    activity = this.props.activity
    prospect = (activity.prospect) ? activity.prospect : {}
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " ", 
              moment(activity.createdAt).fromNow()
            )
          ), 
          React.DOM.td(null, React.DOM.h6(null, prospect.name)), 
          React.DOM.td(null, React.DOM.h6(null, activity.sent_email.subject)), 
          React.DOM.td({style: {padding:0, fontSize:12}}, 
            Event({event: activity.event_type})
          ), 
          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.div({style: {display:'none'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Email"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, React.DOM.i({className: "fa fa-cloud-upload"}), " CRM"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Call")
          )
          ), 
          React.DOM.td(null, 
            "lol"
          )
      )
    )
  }
})

},{}]},{},[1])


},{}],2:[function(require,module,exports){
/** @jsx React.DOM */
var TemplatesMenu = require('./templates_menu.js.min.js');
var EditTemplateView = require('./edit_template.js.min.js');
var CreateTemplateView = require('./create_template.js.min.js');
var Timeline = require('./followup_timeline.js.min.js');
var CampaignActivityView = require('./campaign_activity_view.js.min.js')
var CampaignFollowupFeed = require('./campaign_followup_feed.js.min.js')
var CampaignSentEmail = require('./campaign_sent_email.js.min.js')
var CampaignReport = require('./campaign_report.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // Campaign Detail
  getInitialState: function() {
    return {
      selectedTemplate: 0,
      templateDetailMode: false,
      editMode: false,
      followupDay: 0,
      templates:[],
      currentTemplate:'',
      prospectListCount:'~',
      prospects:[],
      currentScreen: 'timeline',
      newProspects: [],
    }
  },

  changeScreen: function(e) {
    this.setState({currentScreen: $(e.target).text().toLowerCase()})
  },

  componentDidMount: function() {
    thissss = this;
    company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
    qry = 'where={"company":'+company+'}'

    $.ajax({
      url:'https://api.parse.com/1/classes/Template',
      headers: appConfig.headers,
      data: qry,
      success: function(res) { thissss.setState({templates: res.results}) },
      error: function(err) { console.log('error') }
    });

    currentList = JSON.stringify({
      '__type'    : 'Pointer', 
      'className' : 'ProspectList',
      'objectId'  : this.props.selectedCampaign.prospect_list.objectId, 
    })

    qry = 'where={"lists":'+currentList+'}&limit=1000&count=1'
    $.ajax({
      url: 'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      data: qry,
      success: function (res) {
        // TODO - why is this being done
        console.log('RESULTS')
        console.log(res)
        console.log(res.results)
        thissss.setState({
          prospects: res.results,
          prospectListCount: res.count 
        })

        if(res.count > 1000){
          for(i=0;i< Math.ceil(res.count/1000); i++) {
            qry = 'where={"lists":'+currentList+'}&limit=1000&count=1'
            $.ajax({
              url: 'https://api.parse.com/1/classes/Prospect',
              headers: appConfig.headers,
              data: qry,
              success: function (res) {
                prospects = thissss.state.prospects
                thissss.setState({prospects:  prospects.concat(res.results)})
              },
              error: function(err) {}
            })
          }
        }
      },
      error: function(err) { }
    })

    var thiss = this;
    selectedCampaign = this.props.selectedCampaign
    console.debug(this.props.selectedCampaign)
    console.debug('Selected Campaign Batches')
    console.debug(this.props.selectedCampaign.batches)
    batches = this.props.selectedCampaign.batches
    if(_.isEqual(batches, [])){ 
      batch_query = { $in: [false, null] }
    } else {
      qry = _.map(batches, function(batch) {
        return appConfig.pointer('ProspectBatch', batch.objectId)
      })
      batch_query = { $nin: qry }
    }
    prospect_list = thiss.props.selectedCampaign.prospect_list.objectId
    $.ajax({
      url:'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      selectedCampaign: thiss.props.selectedCampaign,
      data: {
        where: JSON.stringify({
            batches: batch_query,
            lists: appConfig.pointer('ProspectList', prospect_list)
        })
      },
      success: function(res) { 
        console.debug('BATCHES QRY')
        console.debug(res.results) 
        thiss.setState({newProspects: res.results})
      },
      error: function(err) { 
        console.debug('BATCHES QRY ERROR')
        console.debug(this.selectedCampaign)
        console.debug(err.responseText) 
      }
    })
  },

  returnToOverview: function() {
    this.props.toggleScreen('Campaigns')
  },

  render: function() {
    //console.log('campaign detail')
    console.log(this.state.currentScreen)
    console.log(this.state.currentScreen.indexOf("sent email"))
    tab_1 = "campaign-tab-link"
    tab_2 = "campaign-tab-link"
    tab_3 = "campaign-tab-link"
    tab_4 = "campaign-tab-link"
    tab_5 = "campaign-tab-link"
    if(this.state.currentScreen == "timeline"){
      //console.debug('SELECTED CAMPAIGN')
      //console.debug(this.props.selectedCampaign)
      lolscreen = FollowupTimeline({
                  templates: this.state.templates, 
                  prospects: this.state.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.state.prospectListCount, 
                  newProspects: this.state.newProspects, 
                  toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
                  initialFollowups: this.props.selectedCampaign.followups})
      tab_1 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "recent activity") {
      lolscreen = CampaignActivityView(null)
      tab_2 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "scheduled followups") {
      lolscreen = CampaignFollowupFeed({
                    batches: this.props.selectedCampaign.batches, 
                    followups: this.props.selectedCampaign.followups})
      tab_3 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "sent mail") {
      lolscreen = CampaignSentEmail({
                      selectedCampaign: this.props.selectedCampaign})
      tab_4 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "analytics") {
      lolscreen = CampaignReport(null)
      tab_5 = "active-campaign-tab campaign tab-link"
    } else{
      console.log('LOL')
      lolscreen = FollowupTimeline({
                  templates: this.state.templates, 
                  prospects: this.state.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.state.prospectListCount, 
                  newProspects: this.state.newProspects, 
                  toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
                  templates: this.state.templates, 
                  initialFollowups: this.props.selectedCampaign.followups})
    }
    //activeTab = "active-campaign-tab campaign tab-link"
      

    list_type = this.props.selectedCampaign.prospect_list.list_type
    if(list_type == "mining_job")
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-cloud-download"}), " ")
    else if(list_type == "signal_list")
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-wifi"}), " ")
    else
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-list-alt"}), " ")

    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    console.log('BATCHES')
    console.log(batches)
    return (
      React.DOM.div({className: "container", 
           style: {width:'100%',height:'100%',paddingLeft:0,paddingRight:0}}, 
        React.DOM.div({style: {marginBottom:15}, id: "campaign-top-detail"}, 
        React.DOM.h5({style: {marginTop:20,marginLeft:20}}, 
          React.DOM.a({href: "javascript:", onClick: this.returnToOverview}, "Campaigns "), 
          React.DOM.small(null, 
            React.DOM.i({style: {marginLeft:10, marginRight:10}, 
               className: "fa fa-chevron-right"})
          ), 
          this.props.selectedCampaign.name
        ), 
        React.DOM.h6({style: {marginLeft:20,display:'inline-block',marginRight:15,marginBottom:0,fontWeight:'bold',fontSize:10}}, 
          React.DOM.span({className: "text-muted"}, "PROSPECT LIST:"), "  "
        ), 
          React.DOM.span({className: "label label-success"}, 
          list_type, 
          this.props.selectedCampaign.prospect_list.name, 
          "     ", 
        React.DOM.i({className: "fa fa-user"}), " ", this.state.prospectListCount
        ), 
        React.DOM.br(null), 
        React.DOM.h6({style: {marginLeft:20,display:'inline-block',marginRight:50,marginTop:0,fontWeight:'bold',fontSize:10}, 
            className: "text-muted"}, 
          "BATCHES:"
        ), 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-sitemap"}), " ", 
          (_.isEqual(batches, [])) ? 1 : batches.length
        ), 
        
        React.DOM.div({style: {border:'1px solid #ddd',borderRadius:5,float:'right',marginTop:-23,marginRight:100}}, 
            React.DOM.div({className: "bg-warning", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer'}}, 
              React.DOM.span({className: "text-warning"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), " 100%"
              )
            ), 
            React.DOM.div({className: "bg-success", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer'}}, 
              React.DOM.span({className: "text-success"}, 
                React.DOM.i({className: "fa fa-eye"}), " 100%"
              )
            ), 
            React.DOM.div({className: "bg-danger", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer'}}, 
              React.DOM.span({className: "text-danger"}, 
                React.DOM.i({className: "fa fa-exclamation-circle"}), " 100%"
              )
            )
        ), 
        
        React.DOM.a({href: "javascript:", 
           style: {float: 'right', marginTop: -35, marginRight: 30, display:'none'}, 
           className: "btn btn-success btn-sm"}, 
          React.DOM.i({className: "fa fa-envelope"}), " Send!"
        )
        
        ), 
              React.DOM.ul({className: "nav nav-tabs campaign-tabs", role: "tablist", style: {paddingRight:0}}, 
                React.DOM.li({className: "campaign-tab"}, " ", React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_1}, "TIMELINE")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_2}, "RECENT ACTIVITY")), 
                React.DOM.li({className: "campaign-tab"}, 
                  React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_3, style: {fontSize:12}}, 
                    "SCHEDULED FOLLOWUPS")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_4}, "SENT MAIL")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_5}, "ANALYTICS"))
              ), 
            lolscreen, 

          (this.state.templateDetailMode) ? EditTemplateView({
            editMode: this.state.editMode, 
            initialTemplateValues: this.state.currentTemplate, 
            saveTemplate: this.saveTemplate, 
            prospect: this.state.prospects[0], 
            toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
            followupDay: this.state.followupDay}) : ""
      )
    );
  },

  saveTemplate: function(template, newTemplate) {
    templates = this.state.templates
    for(i=0;i< this.state.templates.length; i++)
      if(this.state.templates[i].name == template.name)
        break
    
    console.log(template)
    if(newTemplate){
      template.subject = template.subject
      template.name = template.name
      template.body = template.body
      templates.push(template)

      $.ajax({
        url:'https://api.parse.com/1/classes/Template',
        headers:appConfig.headers,
        type:'POST',
        data:JSON.stringify({
          name : template.name,
          subject: template.subject,
          body: template.body,
          user:{
            __type: 'Pointer',
            className:'_User',
            objectId:JSON.parse(localStorage.currentUser).objectId,
          },
          company:JSON.parse(localStorage.currentUser).company,
        }),
        success: function(res) {
          console.log(res)
        },
        error: function() {
        }
      })
    } else {
      templates[i].subject = template.subject
      templates[i].body = template.body

      $.ajax({
        url:'https://api.parse.com/1/classes/Template/'+templates[i].objectId,
        type:'PUT',
        headers:appConfig.headers,
        data:JSON.stringify({
          name : template.name,
          subject: template.subject,
          body: template.body,
        }),
        success: function(res) {
          console.log(res)
        },
        error: function() {
        }
      })
    }

    this.setState({templates: templates })

  },

  toggleTemplateEditMenu: function(currentTemplate, editMode) {
    editMode = (editMode) ? true : false
    this.setState({
      currentTemplate: currentTemplate,
      templateDetailMode: !this.state.templateDetailMode,
    })
  }
});

var FollowupTimeline = React.createClass({displayName: 'FollowupTimeline',
  render: function() {
    return (
        React.DOM.div(null, 
          React.DOM.div({className: "col-md-8 panel panel-default", 
               style: {height:436,paddingLeft:305,paddingTop:50,overflow:'auto',borderRight:0,borderRadius:0, borderTop:0}}, 
                Timeline({
                  templates: this.props.templates, 
                  prospects: this.props.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.props.prospectListCount, 
                  newProspects: this.props.newProspects, 
                  toggleTemplateEditMenu: this.props.toggleTemplateEditMenu, 
                  initialFollowups: this.props.initialFollowups})
          ), 
          React.DOM.div({className: "col-md-4", 
               style: {paddingLeft:0,paddingRight:0,height:436}}, 
            TemplatesMenu({
              templates: this.props.templates, 
              toggleTemplateEditMenu: this.props.toggleTemplateEditMenu})
          )
        )

    )
  }
})

},{"./campaign_activity_view.js.min.js":1,"./campaign_followup_feed.js.min.js":3,"./campaign_report.js.min.js":4,"./campaign_sent_email.js.min.js":5,"./create_template.js.min.js":6,"./edit_template.js.min.js":7,"./followup_timeline.js.min.js":8,"./templates_menu.js.min.js":10}],3:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      followups: []
    }
  },

  componentDidMount: function() {
        // for each batch find followups remaining
        // sort followups by ascending followup day
        //
    // Batch Start Date
    // Current Batch Date
  },

  render: function() {
    var thiss = this;
    followups = _.map(this.props.batches, function(batch) {
      now = moment().startOf('day').valueOf()/1000
      batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
      return _.map(thiss.props.followups, function(followup) {
        followup.batch = batch
        if(followup.day >= batch.currentDay)
          return followup
      })
    })
    followups = _.sortBy(followups, function(followup){ return followup.day })

    console.debug(followups)

    activities = _.map(followups[0], function(followup) {
      return Followups({followup: followup, batch: followup.batch})
    })
    console.debug(activities)

    return (
      React.DOM.div({style: {overflow:'auto',height:436}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Scheduled for "), 
            React.DOM.th(null, "Outreach Stage "), 
            React.DOM.th(null, "Prospect List"), 
            React.DOM.th(null, "Template "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Followups = React.createClass({displayName: 'Followups',
  render: function() {
    // this.props.batch
    // this.props.followup
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " " + ' ' +
              "29 minutes ago"
            )
          ), 
          React.DOM.td(null, 
            "second"
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-list-alt"}), "  " + ' ' +
            "Boston VP Sales - Retail"
            )
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-file-text-o"}), "  " + ' ' +
            "Followup #2 - Provide Value ", React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Subject: Just wanted to followup on the last email "), React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Body: Just wanted to followup on the last email ")

            )
          ), 

          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Send Now"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Remind me in 1 hour"), React.DOM.br(null)
          )
      )
    )
  }
})

},{}],4:[function(require,module,exports){
/** @jsx React.DOM */

lol = 

module.exports = React.createClass({displayName: 'exports',
  // Campaign Report
  getInitialState: function() {
    return {
    }
  },

  componentDidMount: function() { 
    testData = this.testData()
    var industryChart   = dc.pieChart("#industry-chart"),
        spendHistChart  = dc.barChart("#chart-hist-spend"),
        spenderRowChart = dc.rowChart("#chart-row-spenders");

    // set crossfilter
    var ndx = crossfilter(spendData),
        yearDim  = ndx.dimension(function(d) {return +d.Year;}),
        spendDim = ndx.dimension(function(d) {return Math.floor(d.Spent/10);}),
        nameDim  = ndx.dimension(function(d) {return d.Name;}),
        spendPerYear = yearDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendPerName = nameDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendHist    = spendDim.group().reduceCount();

    industryChart
        .width(200).height(200)
        .dimension(yearDim)
        .group(spendPerYear)
        .innerRadius(50);

    //
    // Batch Analytics - Bubble Chart
    // Batch Block Charts
    // Pie Chart - Industry
    // Revenue - PC
    // Company Size - PC
    // Opens / Replies / Link Clicks / Bounces - Bar Chart
    // Titles - PC
    // Time / Date Email Sent - Line Chart
    // Date Prospected - BC
    //
  },
  
  render: function() {
    return (
      React.DOM.div(null, 
        "Report View", 
        React.DOM.div({id: "industry-chart"})
      )
    )
  },

  testData: function() { 
    return [{"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140218.58883.75040@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140219.50015.20571@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140219.50019.67418@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140220.58887.52484@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shadowzprotection.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.598Z", "createdAt": "2014-10-07T15:20:15.147Z", "city": "New Delhi Area, India\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "f44YU2Yrm7", "company_name": "M/S Golden Bricks Constructions Pvt. Ltd.", "mailgun_id": "<20141010140220.19960.3157@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "6B4MDqWqtw"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "e9sMFL1QWx"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:15.147Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "201-500 employees", "name": "Vivek Narang", "industry": "Security and Investigations", "linkedin_url": "in.linkedin.com/pub/vivek-narang/20/b67/39", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shangri-la.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.880Z", "createdAt": "2014-10-07T15:20:13.197Z", "city": "Brisbane, Australia\\u00a0", "archived": true, "loading": false, "objectId": "TSSDEZ3lUA", "company_name": "Shangri-La Hotels and Resorts", "mailgun_id": "<20141010140221.39548.29627@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "PIDGJPqraI"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "mG4U69xDcg"}], "email": "andy.mccutcheon@shangri-la.com", "prospect_created_at": "2014-10-07T15:20:13.197Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Andy McCutcheon", "industry": "Hospitality", "linkedin_url": "au.linkedin.com/pub/andy-mccutcheon/1a/665/650", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140813.19956.20454@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140813.58881.85733@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140814.19938.90169@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140814.77386.74943@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}]
  },

});

},{}],5:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Sent Mail
  getInitialState: function() {
    return {
      sentEmails: []
    }
  },

  componentDidMount: function() {
    thiss = this;
    qry = {
      include: 'campaign,prospect,prospect.email_guesses.pattern',
      order:'-createdAt',
      campaign: {
        __type: 'Pointer',
        className:'Campaign',
        objectId: this.props.selectedCampaign.objectId,
      }
    }
    $.ajax({
      url: 'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({sentEmails: res.results}) },
      error: function() {}
    })
  },

  render: function() {
    sentEmails = []
    for(i=0;i< this.state.sentEmails.length; i++) 
      sentEmails.push(SentEmailRow({sentEmail: this.state.sentEmails[i]}))

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th(null, "Template"), 
            React.DOM.th({style: {width:290}}, "Status")
          ), 
          React.DOM.tbody(null, 
            sentEmails
          )
        )
      )
    );
  }
});

var SentEmailRow = React.createClass({displayName: 'SentEmailRow',
  render: function() {
    sentEmail = this.props.sentEmail
    //console.log(sentEmail)

    email = sentEmail.email
    /*
    if(email == "no_email"){
      first = sentEmail.prospect.name.split(' ')[0]
      last = _.last(sentEmail.prospect.name.split(' '))

      pattern = _.findWhere(sentEmail.prospect.email_guesses, {'tried':false})
      data = {first: first, last: last, fi: first[0], li: last[0]}
      email = Mustache.render(pattern.pattern.pattern, data).toLowerCase()
    }
    */

    replied = "label label-default"
    opened = "label label-default"
    delivered = "label label-default"
    queued = "label label-default"

    if(sentEmail.replied) 
      replied = "label label-success"
    if(sentEmail.opened) 
      opened = "label label-success"
    if(sentEmail.delivered) 
      delivered = "label label-success"
    if(sentEmail.queued) 
      queued = "label label-success"

    return (
      React.DOM.tr(null, 
        React.DOM.td({style: {width:100}}, React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-clock"}), 
            moment(sentEmail.createdAt).fromNow())), 
        React.DOM.td({style: {width:200}}, 
          React.DOM.h6({style: {fontSize:14,fontWeight:'bold',marginBottom:0}}, 
            sentEmail.prospect.name), 
          React.DOM.h6({style: {fontStyle:'italic',marginTop:4,marginBottom:0}}, 
            sentEmail.prospect.pos.trim()), 
          React.DOM.h6({style: {marginTop:4,fontWeight:'bold'}}, 
            React.DOM.i({className: "fa fa-building"}), " ", 
            sentEmail.prospect.company_name)
        ), 
        React.DOM.td({style: {width:200}}, React.DOM.h6(null, email)), 
        React.DOM.td(null, 
          React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-file-text-o"}), " " + ' ' +
            "Template"
          )
        ), 
        React.DOM.td({style: {paddingTop:13}}, 
          React.DOM.span({className: queued}, "Queued"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: delivered}, "Delivered"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: opened}, "Opened"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: replied}, "Replied")
        )
      )
    )
  }
})

},{}],6:[function(require,module,exports){
/** @jsx react.dom */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      
    }
  },

  componentDidMount: function() {
    $('.template-body').html(this.state.templateBody)
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    console.log('EDIT MODE')
    console.log(this.state.editMode)
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      this.props.saveTemplate({
        name: this.state.name,
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
      })
      this.setState({
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
        editMode: !this.state.editMode,
      })
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+this.props.initialTemplateValues.objectId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
    }
  },

  componentDidUpdate: function() {
    /* thiss = this; */

    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.templateSubject)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.templateBody)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? react.dom.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.templateSubject

    if(this.state.editMode){
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-save"}), "   Save Template")
    } else {
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-pencil-square"}), "   Edit Template")
    }

    return (
      react.dom.div(null, 
      react.dom.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
      react.dom.div({id: "editTemplateView", 
           className: "panel panel-info", 
           style: {display:'block'}}, 
           react.dom.div({className: "panel-heading", style: {height:50}}, 
             react.dom.h6({style: {float:'left'}}, 
               react.dom.i({className: "fa fa-file-text-o"}), 
               "  " + this.props.initialTemplateValues.name
             ), 
          toggleButton
        ), 
        react.dom.div({className: "panel-body"}, 
          react.dom.div({className: "editTemplateTitle"}, 
            react.dom.span(null, "Subject: "), 
            subjectPlace
          ), 
         react.dom.br(null), 
         react.dom.div({className: "templateDetails"}, 
           react.dom.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
             "Created by Mark on Jul. 21, 2014"
           ), 
           react.dom.h6({style: {marginTop:'0'}, className: "text-muted"}, 
             "last updated 7 days ago"
           )
         ), 
        react.dom.br(null), 
        react.dom.div({className: "panel panel-default"}, 
          react.dom.div({className: "panel-body summer template-body"}
          )
        )
    )
)
)
    );
  }
});

},{}],7:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      name: this.props.initialTemplateValues.name,
      body: this.props.initialTemplateValues.body,
      subject: this.props.initialTemplateValues.subject,
      editMode: this.props.initialTemplateValues.editMode
    }
  },

  componentDidMount: function() {
    console.log('did mount')
    $('.template-body').html(this.state.body)
    if(this.state.editMode) {
      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })
    }

    renderjson.set_show_to_level('all')
    prospect = _.pick(this.props.prospect, 
      'company_name', 'name', 'pos'
    )
    prospect.first_name = prospect.name.split(' ')[0]
    prospect.last_name = _.last(prospect.name.split(' '))
    prospect = _.omit(prospect, 'name')

    document.getElementById("editTemplate").appendChild(renderjson(prospect));
    $('#editTemplateOverlay').html()
    thiss = this;
    $('.renderjson').click(function() {
      thiss.props.toggleTemplateEditMenu()
    })

    $('.renderjson').css({
      'position': 'absolute',
      'z-index': '1000000000',
      'background-color':'rgba(0,0,0,0)',
      'border':'0',
      'color':'white',
      'margin-top':'0px',
      'height': '542px',
      'overflow':'auto',
      'width':'380px'
    })

    $('.key').css({
      'cursor':'pointer'
    })

    $('.timeline').css({
      '-webkit-filter': 'blur(10px)',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': 'blur(10px)',
    })
  },
  componentWillUnmount:function() {
    $('.timeline').css({
      '-webkit-filter': '',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': '',
    })
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })

      console.log('look at this')
      console.log(name)
      name = (this.props.initialTemplateValues.newTemplate) ? $('#template-name').val() : this.state.name
      this.props.saveTemplate({
        name: name,
        body: $('.summer').code(),
        subject: $('.subject').val(),
      }, this.props.initialTemplateValues.newTemplate)

      this.setState({
        name: $('#template-name').val(),
        body: $('.summer').code(),
        subject: $('.subject').val(),
        editMode: !this.state.editMode,
      })

      objId = this.props.initialTemplateValues.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+objId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),
                             subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })
    }
  },

  componentWillUpdate: function(newProps) {
    console.log('THE NEW PROPS')
    console.log(newProps)
  },

  componentDidUpdate: function() {
    /* thiss = this; */
    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.subject)
      $('#template-name').val(this.state.name)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.body)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? React.DOM.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.subject

    if(this.state.editMode){
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-save"}), "   Save Template")

       if(this.props.initialTemplateValues.newTemplate){
         the_name = React.DOM.input({className: "form-control", 
                           id: "template-name", 
                           style: {float:'left',width:200}})
       }
    } else {
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")

       the_name = React.DOM.h6({style: {float:'left'}}, 
                   React.DOM.i({className: "fa fa-file-text-o"}), " ", 
                   this.state.name
                  )
    }

    return (
      React.DOM.div({id: "editTemplate"}, 
        React.DOM.h5({className: "example-template-title"}, "Example Template Values"), 
        React.DOM.div({className: "example-template-title", 
             style: {marginLeft:215, marginTop:8}}, 
          React.DOM.a({href: "javascript:", 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-left"})), 
          React.DOM.a({href: "javascript:", 
            style: {marginLeft:5}, 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-right"}))
        ), 
        React.DOM.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
          React.DOM.div({id: "editTemplateView", 
               className: "panel panel-default", 
               style: {display:'block'}}, 
               React.DOM.div({className: "panel-heading", style: {height:50}}, 
                 the_name, 
              React.DOM.a({href: "javascript:", 
                className: "btn btn-default btn-xs", 
                style: {float:'right',marginLeft:5,marginTop:5}}, 
                React.DOM.i({className: "fa fa-trash"})
              ), 
              toggleButton
            ), 
            React.DOM.div({className: "panel-body"}, 
              React.DOM.div({className: "editTemplateTitle"}, 
                React.DOM.span(null, "Subject: "), 
                subjectPlace
              ), 
             React.DOM.br(null), 
             React.DOM.div({className: "templateDetails"}, 
               React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
                 "Created by Mark on Jul. 21, 2014"
               ), 
               React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, 
                 "last updated 7 days ago"
               )
             ), 
            React.DOM.br(null), 
            React.DOM.div({className: "panel panel-default"}, 
              React.DOM.div({className: "panel-body summer template-body"}
              )
            )
        )
      )
    )
    );
  }
});

},{}],8:[function(require,module,exports){
/** @jsx React.DOM */
var SendEmailModal = require('./send_email_modal.js.min.js')
var TimelineDayElement = require('./timeline_day_element.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // FollowupTimeline
  getInitialState: function() {
    initialFollowups = this.props.initialFollowups
    initialFollowups = (initialFollowups) ? initialFollowups : []
    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    return {
      followups: _.compact(initialFollowups),
      loading: false,
      currentTemplate:'',
      currentBatch: '',
      batches : batches
    }
  },

  componentDidMount: function() {
    thiss = this;
    $('.day').tooltip({
      placement: 'right',
      title:'+ Add a follow-up'
    })

    console.log(this.props.selectedCampaign)
     company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
     currentCampaign = appConfig.pointer('Campaign', this.props.selectedCampaign.objectId)
     $.ajax({
       url:'https://api.parse.com/1/classes/Followup',
       type:'GET',
       headers: appConfig.headers,
       data: {
         where: JSON.stringify({
           campaign: currentCampaign,
           company: appConfig.company
         }),
         include:'template',
       },
       success: function(res) {
         console.log('followup timeline')
         console.log(res.results)
       },
       error: function(err) {
         console.log('error')
         console.log(err)
       }
     })
  },

  addFollowupSentToBatch: function(batch, followup) {
    batches = _.map(this.state.batches, function(_batch) {
                  if(_batch.objectId == batch.objectId) {
                    if(_batch.followups)
                      _batch.followups.push(followup)
                    else
                      _batch.followups = [followup]
                  }
                  return _batch
              })
    // Persist
  },
  
  render: function() {
    timelineElements = []
    followups = this.state.followups

    batches = _.map(this.state.batches, function(batch) {
      if(batch){
        now = moment().startOf('day').valueOf()
        batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
        return batch
      }
    })
    batches = _.compact(batches)

    for(i=0;i< 31;i++){
      followup = _.findWhere(this.state.followups, {day: i})
      var elementType = (followup) ? true : false
      var currentTemplate = (followup) ? followup.template : false
      var addTemplateMode = (followup) ? followup.addTemplateMode : true
      campaign = this.props.selectedCampaign

      currentBatch = {}
      batch_started_today = false
      alreadySent = false
      batchCount = undefined
      if(i == 0) {
        batchCount = (batches) ? this.props.newProspects.length : this.props.prospects.length
      } else {
        batch = _.findWhere(batches, {currentDay: i})
        if(batch) {
          currentBatch = batch.objectId
          console.debug(batch.objectId)
          batchCount = "~"
          if(followup) {
            _batches = followup.batches
            alreadySent = _.findWhere(_batches, _.pick(batch,'objectId'))
          }
        }
      }

      timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                    dayCount: i, 
                                    elementType: !elementType, 
                                    currentTemplate: currentTemplate, 
                                    batchCount: batchCount, 
                                    currentBatch: currentBatch, 
                                    alreadySent: alreadySent, 
                                    addTemplateMode: addTemplateMode, 
                                    templates: this.props.templates, 
                                    newProspects: this.props.newProspects, 
                                    addFollowup: this.addFollowup, 
                                    editFollowup: this.editFollowup, 
                                    saveFollowup: this.saveFollowup, 
                                    removeFollowup: this.removeFollowup, 
                                 addFollowupSentToBatch: this.addFollowupSentToBatch, 
                                    batches: this.props.selectedCampaign.batches, 
                                    prospectListCount: this.props.prospectListCount, 
                                    setCurrentBatch: this.setCurrentBatch, 
                                    setCurrentTemplate: this.setCurrentTemplate})
                                  ))

      if(i == 0 && _.findWhere(batches, {currentDay: 0})){
          currentBatch = _.findWhere(batches, {currentDay: 0}).objectId
          console.debug('0.5')
          console.debug(currentBatch)
          batchCount = "~"
          timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                  dayCount: 0.5, 
                                  batchCount: batchCount, 
                                  currentBatch: currentBatch, 
                                  newProspects: this.props.newProspects, 
                                  elementType: true, 
                                  batches: this.props.selectedCampaign.batches, 
                                  prospectListCount: this.props.prospectListCount, 
                                  setCurrentBatch: this.setCurrentBatch})
                                ))
      }
    }
    return (
      React.DOM.div(null, 
        React.DOM.div({className: "timeline", 
             style: {height:'100%',backgroundColor:'rgb(90, 107, 119)', width:5,marginTop:-35}}, 
             timelineElements
        ), 
        SendEmailModal({prospects: this.props.prospects, 
                        selectedCampaign: this.props.selectedCampaign, 
                        newProspects: this.props.newProspects, 
                        addFollowupSentToBatch: this.addFollowupSentToBatch, 
                        currentBatch: this.state.currentBatch, 
                        currentTemplate: this.state.currentTemplate})
      )
    );
  },

  createFollowup: function() {
    //
  },         

  addFollowup: function(day) {
    //console.log('called template edit menu')
    followups = this.state.followups
    followups.push({addTemplateMode: true, day: day})
    this.setState({ followups: followups })
  },

  editFollowup: function(day) {
    // find template set editmode is false
    followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){ followup.addTemplateMode = true }
      return followup
    })
    this.setState({followups: followups})
  },

  saveFollowup: function(day, chosenTemplate) {
    new_followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){
        followup.addTemplateMode = false
        followup.template = chosenTemplate
      }
      return followup
    })
    this.setState({followups: new_followups})
    followup = _.findWhere(new_followups, {day: day})

      if(followup.objectId){
        url = "/"+followup.objectId; type="PUT"
        data = {template: appConfig.pointer('Template', chosenTemplate.objectId)}
      } else {
        url = ""; type="POST";

          data = {
            day: day,
            campaign : appConfig.pointer('Campaign', 
                                         this.props.selectedCampaign.objectId),
            template: appConfig.pointer('Template', chosenTemplate.objectId),
          }
      }

    thiss = this;
    $.ajax({
      url:'https://api.parse.com/1/classes/Followup'+url,
      type:type,
      data:JSON.stringify(data),
      headers:appConfig.headers,
      success: function(res) {
        new_followups = _.map(new_followups, function(followup) {
          if(followup.day == day) { followup.objectId = false }
          return followup
        })
        thiss.setState({followups: new_followups})

        console.log(res)
        $.ajax({
          url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
          type:'PUT',
          data:JSON.stringify({followups: {
            __op: 'AddUnique',
            objects:[appConfig.pointer('Followup', res.objectId)]
          }}),
          headers:appConfig.headers,
          success: function() { },
          error: function() { }
        })
      },
      error: function() { },
    })
  },

  removeFollowup: function(day) {
    followups = []
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day != day)
        followups.push(this.state.followups[i])
      
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day == day)
        break
    
    this.setState({followups: followups}) 
    id = this.state.followups[i]

    thiss = this;
    if(id) {
      id = id.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Followup/'+id,
        headers:appConfig.headers,
        type:'DELETE',
        success: function(res) { console.log(res) }
      })

     console.log('REMOVE ARRAY')
      $.ajax({
        url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
        headers:appConfig.headers,
        type:'PUT',
        data: JSON.stringify({
          followups: {
            __op : 'Remove',
            objects: [appConfig.pointer('Followup', id)]
          }
        }),
        success: function(res){ console.log(res) },
        error: function() { }
      })
    }
  },

  setCurrentBatch: function(currentBatch) {
    this.setState({currentBatch: currentBatch})
  },

  setCurrentTemplate: function(template) {
    this.setState({currentTemplate: template })
  }
});



},{"./send_email_modal.js.min.js":9,"./timeline_day_element.js.min.js":11}],9:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      currentProspect: 0,
    }
  },

  sendEmails: function() {
    selectedCampaign = this.props.selectedCampaign
    campaign_id = selectedCampaign.objectId
    prospectlist_id = selectedCampaign.prospect_list.objectId
    template_id = this.props.currentTemplate.objectId
    
    $.ajax({
      url:'https://nameless-retreat-3525.herokuapp.com/send_email',
      //url:'http://127.0.0.1:5000/send_email',
      data: {
        template_id : template_id,
        campaign_id : campaign_id,
        prospectlist_id : prospectlist_id,
      },
      success: function(res) { console.log(res.results) },
      error: function(err) { console.log(err) }
    })

    /*
    */
    // Update Followup
    // Persist Followup
    // close modal
  },

  render: function() {
    prospect = this.props.prospects[this.state.currentProspect]
    prospect = (prospect) ? prospect : {'name':'','email':''}

    var thiss = this;
    console.debug('SEND EMAIL BATCH')
    console.debug(this.props.currentBatch)
    newBatch = _.isEqual(this.props.currentBatch, {})
    prospects = (newBatch) ? this.props.newProspects : this.props.prospects
    if(newBatch){
      prospects = _.map(this.props.newProspects, function(prospect) {
          return UserPlaceHolder({prospect: prospect})
      })
    } else {
      prospects = _.map(this.props.prospects, function(prospect) {
        if(_.findWhere(prospect.batches, {objectId: thiss.props.currentBatch}))
          return UserPlaceHolder({prospect: prospect})
      })
    }
    prospects = _.compact(prospects)
    console.debug(prospects)
    console.debug(prospects.length)
    prospectCount = prospects.length
    email = (prospect.email) ? prospect.email.toLowerCase() : ""
    return (
      React.DOM.div({className: "modal fade bs-sendEmail-modal-lg", tabIndex: "-1", 
           role: "dialog", 'aria-labelledby': "mySmallModalLabel", 'aria-hidden': "true", 
           id: "sendEmailModal", style: {top:'10px'}}, 
            React.DOM.div({className: "modal-dialog modal-lg"}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.button({type: "button", className: "close", 'data-dismiss': "modal"}, React.DOM.span({'aria-hidden': "true"}, "×"), 
                    React.DOM.span({className: "sr-only"}, "Close")), 
        React.DOM.button({type: "button", 
                onClick: this.sendEmails, 
                style: {float:'right'}, 
                className: "btn btn-primary btn-sm"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), "  Send Email"), 
        React.DOM.button({type: "button", style: {marginRight:10, float:'right'}, 
                className: "btn btn-default btn-sm", 'data-dismiss': "modal"}, "Close"), 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    React.DOM.i({className: "fa fa-envelope"}), "  Send Email" + ' ' +
                    "  ", 
                    React.DOM.small(null, "("+prospectCount+")")
                  )
                ), 
                React.DOM.div({className: "modal-body", style: {paddingTop:5}}, 
                  React.DOM.h4(null, "People"), 
                  
                  React.DOM.div({className: "prospect-container"}, 
                    prospects
                  ), 
                  React.DOM.br(null), 
                  React.DOM.h4({style: {display:'inline-block'}}, "Emails    ", 
                    React.DOM.small(null, (this.state.currentProspect+1)+' of '+prospectCount
                  )), 
                  "   ", 
                  React.DOM.a({href: "javascript:", 
              className: (this.state.currentProspect == 0 ) ? "btn disabled" : "btn", 
                    onClick: this.previousProspect}, React.DOM.i({className: "fa fa-arrow-left"})), 
                  React.DOM.a({href: "javascript:", 
            className: (this.state.currentProspect == 135 ) ? "btn disabled" : "btn", 
                    onClick: this.nextProspect}, React.DOM.i({className: "fa fa-arrow-right"})), 

                  React.DOM.div(null, 

React.DOM.ul({className: "list-group email-holder", style: {borderTop:'solid 1px #eee'}}, 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "To:  "), 
    prospect.name + " - " + email
  ), 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "Subject:  "), " ", this.props.currentTemplate.subject
  ), 
  React.DOM.li({className: "list-group-item body"})
)
  
                  )

                ), 

      React.DOM.div({className: "modal-footer", style: {display:'none'}}, 
        React.DOM.button({type: "button", 
                className: "btn btn-default", 'data-dismiss': "modal"}, "Close"), 
        React.DOM.button({type: "button", 
                className: "btn btn-primary"}, "Send Email")
      )
              )
            )
          )
    );
  },

  previousProspect: function() {
    this.setState({currentProspect: this.state.currentProspect-1 })
  },

  nextProspect: function() {
    this.setState({currentProspect: this.state.currentProspect+1 })
  },

  parseTemplate: function(templateBody) {
    first_name = prospect.name.split(' ')[0]
    //hiring_signal = prospect.signals

    signals = (prospect.signals) ? prospect.signals[0] : ""
    templateBody = Mustache.render(templateBody, {
      hiring_signal: signals,
      first_name: prospect.name.split(' ')[0]
    })

    console.log(templateBody)
      
    return templateBody
  },

  componentDidUpdate: function() {
    //console.log(this.props.currentTemplate)
    parsedTemplate = this.parseTemplate(this.props.currentTemplate.body)
    
    //$('.body').html(this.props.currentTemplate.body)
    $('.body').html(parsedTemplate)
  }
});

var UserPlaceHolder = React.createClass({displayName: 'UserPlaceHolder',
  render: function() {
    return (
        React.DOM.div({className: "btn-group", style: {marginRight:5,marginBottom:5}}, 
          React.DOM.div({className: "btn-group"}, 
            React.DOM.button({type: "button", 
                    className: "btn btn-success btn-sm"}, 
              React.DOM.i({className: "fa fa-user"}), "  ", 
              (this.props.prospect) ? this.props.prospect.name : ""
            )
          ), 
          React.DOM.button({type: "button", className: "btn btn-success btn-sm"}, 
            React.DOM.i({className: "fa fa-trash-o"})
          )
        )
    )
  }
});

},{}],10:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  //TemplatesMenu
  toggleTemplateEditMenu: function(currentTemplate) {
    this.props.toggleTemplateEditMenu(currentTemplate)
  },

  createTemplate: function() {
    this.props.toggleTemplateEditMenu({
      name: '',
      body:'',
      subject:'',
      editMode:true,
      newTemplate: true
    }, true)
  },

  render: function() {
    //console.log(this.props.templates)
    templates = []
    for(i=0;i< this.props.templates.length; i++) {
      templates.push(
        TemplateListItem({
          toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
          template: this.props.templates[i]})
      )
    }

    return (
      React.DOM.div({className: "", style: {padding:'0', height:'100%',textAlign:'center'}}, 
        React.DOM.div({className: "panel panel-default", 
             style: {borderRight:0,borderRadius:0,height:'100%', overflow:'auto'}}, 
          React.DOM.div({className: "panel-heading", style: {height:40}}, 
            React.DOM.span({style: {float:'left',fontSize:14,fontWeight:'bold'}}, 
              React.DOM.i({className: "fa fa-file-text-o"}), 
              React.DOM.span({style: {marginLeft:5}}, "Templates")
            ), 
            React.DOM.a({href: "javascript:", 
              className: "btn btn-success btn-xs", 
              onClick: this.createTemplate, 
                style: {float:'right'}}, 
              React.DOM.i({className: "fa fa-plus"}), 
              React.DOM.span({style: {marginLeft:5}}, "Create Template")
            )
          ), 
          React.DOM.ul({className: "list-group", 
              style: {textAlign:'left'}}, 
            templates
          )
        )
      )
    )
  }
});

var TemplateListItem = React.createClass({displayName: 'TemplateListItem',
  toggleTemplateEditMenu: function() {
    console.log(this.props.template)
    template = this.props.template
    template.editMode = false
    this.props.toggleTemplateEditMenu(template)
  },

  render: function() {
    return (
      React.DOM.div(null, 
        React.DOM.a({href: "javascript:", 
          style: {borderBottom: '1px solid rgb(221, 221, 221)',paddingTop:5,paddingBottom:0}, 
           onClick: this.toggleTemplateEditMenu, 
           className: "list-group-item"}, 
           React.DOM.span({className: "label label-default"}, 
             this.props.template.name
           ), 
           React.DOM.h6(null, "Subject:", React.DOM.span({className: "text text-muted"}, 
             " " + this.props.template.subject
           ))
         )
      )
    );
  }
});

},{}],11:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // TimelineDayElement
  // TODO
  // - add prospect list progression
  // - add scheduled followup
  //
  getInitialState: function() {
    // 
    return {
      followupCompleted: 0,
    }
  },

  addFollowup: function() {
    this.props.addFollowup(this.props.dayCount)
  },

  render: function() {
    if(this.props.addTemplateMode) {
      mode = EditTemplate({addFollowup: this.props.addFollowup, 
                           saveFollowup: this.props.saveFollowup, 
                           removeFollowup: this.props.removeFollowup, 
                           dayCount: this.props.dayCount, 
                           templates: this.props.templates})
    } else {
      mode = TemplateFollowup({currentTemplate: this.props.currentTemplate, 
                               editFollowup: this.props.editFollowup, 
                               dayCount: this.props.dayCount, 
                               currentBatch: this.props.currentBatch, 
                               hasBatch: typeof(this.props.batchCount) != "undefined", 
                               setCurrentBatch: this.props.setCurrentBatch, 
                               dayCount: this.props.dayCount, 
                               removeFollowup: this.props.removeFollowup, 
                               setCurrentTemplate: this.props.setCurrentTemplate})
    }
    if(this.props.alreadySent) {
      mode = FollowupCompleted({currentTemplate: this.props.currentTemplate})
    }

    mode = (this.props.elementType) ? "" : mode
    addFollowup = (this.props.elementType) ? this.addFollowup : ""
    if(typeof(this.props.batchCount) != "undefined")
      batchStage = BatchStage({currentBatch: this.props.currentBatch, 
                               newProspects: this.props.newProspects, 
                               prospectListCount: this.props.prospectListCount, 
                               batchCount: this.props.batchCount, 
                               hasScheduledEmail: mode != "", 
                               dayCount: this.props.dayCount})
    else
      batchStage = ""

    dayCount = (this.props.dayCount != 0.5) ? "D"+this.props.dayCount : ""

    return (
      React.DOM.div(null, 
        React.DOM.div({onClick: addFollowup, className: "day", 'data-trigger': "manual"}, 
          dayCount
        ), 
        mode, batchStage
      )
    )
  },

  setCurrentTemplate: function(template) {
    this.props.setCurrentTemplate(template)
  }
});

var FollowupCompleted = React.createClass({displayName: 'FollowupCompleted',
  render: function() {
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs disabled", 
                'data-target': ".bs-sendEmail-modal-lg", 
                onClick: this.setCurrentTemplate, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-check"}), " Sent"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"}))
      )
                                         )
  }
})

var TemplateFollowup = React.createClass({displayName: 'TemplateFollowup',
  // EditMode False

  setCurrentTemplate: function() {
    this.props.setCurrentTemplate(this.props.currentTemplate)
    // setCurrentBatch
    this.props.setCurrentBatch(this.props.currentBatch)
    $('.bs-sendEmail-modal-lg').modal()
  },

  waitForBatch: function() {
    alertify.log("You must wait for a batch!");
  },

  render: function() {
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
        onClick: (this.props.hasBatch) ? this.setCurrentTemplate : this.waitForBatch, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-paper-plane"}), " Send"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        trash
      )
    );
  },

  editFollowup: function(e) { 
    e.preventDefault()
    console.log(this.props.dayCount)
    this.props.editFollowup(this.props.dayCount)
  },

  removeFollowup: function() {
    console.log('remove')
    this.props.removeFollowup(this.props.dayCount)
  }
});

var BatchStage = React.createClass({displayName: 'BatchStage',
  // Different Stages of People Added to Prospect List
  getInitialState: function() {
    // 
    return {
      initialBatchCount: this.props.batchCount
    }
  },

  componentDidMount: function() {
    // state
    //console.debug('INSIDE BATCH '+this.props.dayCount)
    console.debug(this.props.currentBatch)
    _batches = appConfig.pointer('ProspectBatch', this.props.currentBatch)
    if(this.props.batchCount == "~") {
      // Why doesnt this work 
      var thissss = this;
      console.debug('INSIDE BATCH '+thiss.props.dayCount)
      console.debug(_batches)
      $.ajax({
        url:'https://api.parse.com/1/classes/Prospect',
        batches: _batches,
        data: {
          where: JSON.stringify({
            batches: _batches
          }),
          count: true,
        },
        headers: appConfig.headers,
        success: function(res) { 
          //console.debug('SUCCESS GET COUNT ' + res.count)
          //console.debug(res.results) 
          thissss.setState({initialBatchCount: res.count})
        },
        error: function(err) { 
          thissss.setState({initialBatchCount: 0 })
        }
      })
    }
  },

  componentWillReceiveProps: function(nextProps) {
    if(this.props.dayCount == 0)
      this.setState({ initialBatchCount: nextProps.batchCount })
  },


  render: function() {
    if(this.props.hasScheduledEmail)
      batchStageStyle = {top:-42, left:6}
    else
      batchStageStyle = {}

    if(this.props.dayCount == 0.5)
      batchStageStyle.left = 7

    //console.log('BATCH STAGE')
    //console.log(this.props)
    //console.debug(this.props.currentBatch)                                                           

    return (
      React.DOM.div({className: "followup-placement arrow_box tmp", style: batchStageStyle}, 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-user"}), " ", 
          this.state.initialBatchCount
        ), " ", 
        React.DOM.h6({style: {display:'inline-block'}}, 
          "prospects in the sales cycle.")
      )
    );
  }
});

var EditTemplate = React.createClass({displayName: 'EditTemplate',
  // Edit Mode - True
  render: function() {
    options = []
    for(i=0;i< this.props.templates.length; i++) {
      options.push( React.DOM.option(null, this.props.templates[i].name))
    }
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, " ", React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:55,display:'inline-block'}, 
            className: "text-muted"}, 
          "Choose :"
        ), 
        React.DOM.select({className: "form-control input-sm", 
                id: "chooseTemplateForFollowup", 
                style: {display:'inline-block',width:127,marginRight:5}}, 
          options
        ), 

        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
                onClick: this.saveFollowup, 
                style: {marginRight:5}}, 
          React.DOM.i({className: "fa fa-check"})), 
        trash
      )
    )
  },

  saveFollowup: function(e) {
    //get template from currentTemplate
    e.preventDefault()
    chosenTemplate = $('#chooseTemplateForFollowup').val()
    console.log(chosenTemplate)
    for(i=0;i< this.props.templates.length; i++){
      if(this.props.templates[i].name == chosenTemplate){
        chosenTemplate = this.props.templates[i]
        break
      }
    }
    console.log(chosenTemplate)
    
    this.props.saveFollowup(this.props.dayCount, chosenTemplate)
  },

  removeFollowup: function(day) {
    this.props.removeFollowup(this.props.dayCount)
  },
});


},{}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L25vZGVfbW9kdWxlcy9ndWxwLWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvY2FtcGFpZ25fZGV0YWlsLmpzLm1pbi5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvY2FtcGFpZ25fZm9sbG93dXBfZmVlZC5qcy5taW4uanMiLCIvVXNlcnMvcm9iaW4vUHJvamVjdHMvcHJvc3BlY3Rlci9wcm9zcGVjdGVyLXBhcnNlL2Rldi9idWlsZC9qcy9jb21wb25lbnRzL2NhbXBhaWduX3JlcG9ydC5qcy5taW4uanMiLCIvVXNlcnMvcm9iaW4vUHJvamVjdHMvcHJvc3BlY3Rlci9wcm9zcGVjdGVyLXBhcnNlL2Rldi9idWlsZC9qcy9jb21wb25lbnRzL2NhbXBhaWduX3NlbnRfZW1haWwuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9jcmVhdGVfdGVtcGxhdGUuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9lZGl0X3RlbXBsYXRlLmpzLm1pbi5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvZm9sbG93dXBfdGltZWxpbmUuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9zZW5kX2VtYWlsX21vZGFsLmpzLm1pbi5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvdGVtcGxhdGVzX21lbnUuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy90aW1lbGluZV9kYXlfZWxlbWVudC5qcy5taW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ3JIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG52YXIgVGVtcGxhdGVzTWVudSA9IHJlcXVpcmUoJy4vdGVtcGxhdGVzX21lbnUuanMubWluLmpzJyk7XG52YXIgRWRpdFRlbXBsYXRlVmlldyA9IHJlcXVpcmUoJy4vZWRpdF90ZW1wbGF0ZS5qcy5taW4uanMnKTtcbnZhciBDcmVhdGVUZW1wbGF0ZVZpZXcgPSByZXF1aXJlKCcuL2NyZWF0ZV90ZW1wbGF0ZS5qcy5taW4uanMnKTtcbnZhciBUaW1lbGluZSA9IHJlcXVpcmUoJy4vZm9sbG93dXBfdGltZWxpbmUuanMubWluLmpzJyk7XG52YXIgQ2FtcGFpZ25BY3Rpdml0eVZpZXcgPSByZXF1aXJlKCcuL2NhbXBhaWduX2FjdGl2aXR5X3ZpZXcuanMubWluLmpzJylcbnZhciBDYW1wYWlnbkZvbGxvd3VwRmVlZCA9IHJlcXVpcmUoJy4vY2FtcGFpZ25fZm9sbG93dXBfZmVlZC5qcy5taW4uanMnKVxudmFyIENhbXBhaWduU2VudEVtYWlsID0gcmVxdWlyZSgnLi9jYW1wYWlnbl9zZW50X2VtYWlsLmpzLm1pbi5qcycpXG52YXIgQ2FtcGFpZ25SZXBvcnQgPSByZXF1aXJlKCcuL2NhbXBhaWduX3JlcG9ydC5qcy5taW4uanMnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvLyBDYW1wYWlnbiBEZXRhaWxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2VsZWN0ZWRUZW1wbGF0ZTogMCxcbiAgICAgIHRlbXBsYXRlRGV0YWlsTW9kZTogZmFsc2UsXG4gICAgICBlZGl0TW9kZTogZmFsc2UsXG4gICAgICBmb2xsb3d1cERheTogMCxcbiAgICAgIHRlbXBsYXRlczpbXSxcbiAgICAgIGN1cnJlbnRUZW1wbGF0ZTonJyxcbiAgICAgIHByb3NwZWN0TGlzdENvdW50Oid+JyxcbiAgICAgIHByb3NwZWN0czpbXSxcbiAgICAgIGN1cnJlbnRTY3JlZW46ICd0aW1lbGluZScsXG4gICAgICBuZXdQcm9zcGVjdHM6IFtdLFxuICAgIH1cbiAgfSxcblxuICBjaGFuZ2VTY3JlZW46IGZ1bmN0aW9uKGUpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50U2NyZWVuOiAkKGUudGFyZ2V0KS50ZXh0KCkudG9Mb3dlckNhc2UoKX0pXG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXNzc3MgPSB0aGlzO1xuICAgIGNvbXBhbnkgPSBKU09OLnN0cmluZ2lmeShKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5jdXJyZW50VXNlcikuY29tcGFueSlcbiAgICBxcnkgPSAnd2hlcmU9e1wiY29tcGFueVwiOicrY29tcGFueSsnfSdcblxuICAgICQuYWpheCh7XG4gICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvVGVtcGxhdGUnLFxuICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBkYXRhOiBxcnksXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgdGhpc3Nzcy5zZXRTdGF0ZSh7dGVtcGxhdGVzOiByZXMucmVzdWx0c30pIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7IGNvbnNvbGUubG9nKCdlcnJvcicpIH1cbiAgICB9KTtcblxuICAgIGN1cnJlbnRMaXN0ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgJ19fdHlwZScgICAgOiAnUG9pbnRlcicsIFxuICAgICAgJ2NsYXNzTmFtZScgOiAnUHJvc3BlY3RMaXN0JyxcbiAgICAgICdvYmplY3RJZCcgIDogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLnByb3NwZWN0X2xpc3Qub2JqZWN0SWQsIFxuICAgIH0pXG5cbiAgICBxcnkgPSAnd2hlcmU9e1wibGlzdHNcIjonK2N1cnJlbnRMaXN0Kyd9JmxpbWl0PTEwMDAmY291bnQ9MSdcbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOiAnaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdCcsXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIGRhdGE6IHFyeSxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgLy8gVE9ETyAtIHdoeSBpcyB0aGlzIGJlaW5nIGRvbmVcbiAgICAgICAgY29uc29sZS5sb2coJ1JFU1VMVFMnKVxuICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcy5yZXN1bHRzKVxuICAgICAgICB0aGlzc3NzLnNldFN0YXRlKHtcbiAgICAgICAgICBwcm9zcGVjdHM6IHJlcy5yZXN1bHRzLFxuICAgICAgICAgIHByb3NwZWN0TGlzdENvdW50OiByZXMuY291bnQgXG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYocmVzLmNvdW50ID4gMTAwMCl7XG4gICAgICAgICAgZm9yKGk9MDtpPCBNYXRoLmNlaWwocmVzLmNvdW50LzEwMDApOyBpKyspIHtcbiAgICAgICAgICAgIHFyeSA9ICd3aGVyZT17XCJsaXN0c1wiOicrY3VycmVudExpc3QrJ30mbGltaXQ9MTAwMCZjb3VudD0xJ1xuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdCcsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IGFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICAgICAgICBkYXRhOiBxcnksXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBwcm9zcGVjdHMgPSB0aGlzc3NzLnN0YXRlLnByb3NwZWN0c1xuICAgICAgICAgICAgICAgIHRoaXNzc3Muc2V0U3RhdGUoe3Byb3NwZWN0czogIHByb3NwZWN0cy5jb25jYXQocmVzLnJlc3VsdHMpfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge31cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikgeyB9XG4gICAgfSlcblxuICAgIHZhciB0aGlzcyA9IHRoaXM7XG4gICAgc2VsZWN0ZWRDYW1wYWlnbiA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnblxuICAgIGNvbnNvbGUuZGVidWcodGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduKVxuICAgIGNvbnNvbGUuZGVidWcoJ1NlbGVjdGVkIENhbXBhaWduIEJhdGNoZXMnKVxuICAgIGNvbnNvbGUuZGVidWcodGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmJhdGNoZXMpXG4gICAgYmF0Y2hlcyA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5iYXRjaGVzXG4gICAgaWYoXy5pc0VxdWFsKGJhdGNoZXMsIFtdKSl7IFxuICAgICAgYmF0Y2hfcXVlcnkgPSB7ICRpbjogW2ZhbHNlLCBudWxsXSB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHFyeSA9IF8ubWFwKGJhdGNoZXMsIGZ1bmN0aW9uKGJhdGNoKSB7XG4gICAgICAgIHJldHVybiBhcHBDb25maWcucG9pbnRlcignUHJvc3BlY3RCYXRjaCcsIGJhdGNoLm9iamVjdElkKVxuICAgICAgfSlcbiAgICAgIGJhdGNoX3F1ZXJ5ID0geyAkbmluOiBxcnkgfVxuICAgIH1cbiAgICBwcm9zcGVjdF9saXN0ID0gdGhpc3MucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5wcm9zcGVjdF9saXN0Lm9iamVjdElkXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdCcsXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHNlbGVjdGVkQ2FtcGFpZ246IHRoaXNzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24sXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHdoZXJlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBiYXRjaGVzOiBiYXRjaF9xdWVyeSxcbiAgICAgICAgICAgIGxpc3RzOiBhcHBDb25maWcucG9pbnRlcignUHJvc3BlY3RMaXN0JywgcHJvc3BlY3RfbGlzdClcbiAgICAgICAgfSlcbiAgICAgIH0sXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgXG4gICAgICAgIGNvbnNvbGUuZGVidWcoJ0JBVENIRVMgUVJZJylcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhyZXMucmVzdWx0cykgXG4gICAgICAgIHRoaXNzLnNldFN0YXRlKHtuZXdQcm9zcGVjdHM6IHJlcy5yZXN1bHRzfSlcbiAgICAgIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7IFxuICAgICAgICBjb25zb2xlLmRlYnVnKCdCQVRDSEVTIFFSWSBFUlJPUicpXG4gICAgICAgIGNvbnNvbGUuZGVidWcodGhpcy5zZWxlY3RlZENhbXBhaWduKVxuICAgICAgICBjb25zb2xlLmRlYnVnKGVyci5yZXNwb25zZVRleHQpIFxuICAgICAgfVxuICAgIH0pXG4gIH0sXG5cbiAgcmV0dXJuVG9PdmVydmlldzogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5wcm9wcy50b2dnbGVTY3JlZW4oJ0NhbXBhaWducycpXG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAvL2NvbnNvbGUubG9nKCdjYW1wYWlnbiBkZXRhaWwnKVxuICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdGUuY3VycmVudFNjcmVlbilcbiAgICBjb25zb2xlLmxvZyh0aGlzLnN0YXRlLmN1cnJlbnRTY3JlZW4uaW5kZXhPZihcInNlbnQgZW1haWxcIikpXG4gICAgdGFiXzEgPSBcImNhbXBhaWduLXRhYi1saW5rXCJcbiAgICB0YWJfMiA9IFwiY2FtcGFpZ24tdGFiLWxpbmtcIlxuICAgIHRhYl8zID0gXCJjYW1wYWlnbi10YWItbGlua1wiXG4gICAgdGFiXzQgPSBcImNhbXBhaWduLXRhYi1saW5rXCJcbiAgICB0YWJfNSA9IFwiY2FtcGFpZ24tdGFiLWxpbmtcIlxuICAgIGlmKHRoaXMuc3RhdGUuY3VycmVudFNjcmVlbiA9PSBcInRpbWVsaW5lXCIpe1xuICAgICAgLy9jb25zb2xlLmRlYnVnKCdTRUxFQ1RFRCBDQU1QQUlHTicpXG4gICAgICAvL2NvbnNvbGUuZGVidWcodGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduKVxuICAgICAgbG9sc2NyZWVuID0gRm9sbG93dXBUaW1lbGluZSh7XG4gICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXM6IHRoaXMuc3RhdGUudGVtcGxhdGVzLCBcbiAgICAgICAgICAgICAgICAgIHByb3NwZWN0czogdGhpcy5zdGF0ZS5wcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYW1wYWlnbjogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLCBcbiAgICAgICAgICAgICAgICAgIHByb3NwZWN0TGlzdENvdW50OiB0aGlzLnN0YXRlLnByb3NwZWN0TGlzdENvdW50LCBcbiAgICAgICAgICAgICAgICAgIG5ld1Byb3NwZWN0czogdGhpcy5zdGF0ZS5uZXdQcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgdG9nZ2xlVGVtcGxhdGVFZGl0TWVudTogdGhpcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51LCBcbiAgICAgICAgICAgICAgICAgIGluaXRpYWxGb2xsb3d1cHM6IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5mb2xsb3d1cHN9KVxuICAgICAgdGFiXzEgPSBcImFjdGl2ZS1jYW1wYWlnbi10YWIgY2FtcGFpZ24gdGFiLWxpbmtcIlxuICAgIH0gZWxzZSBpZih0aGlzLnN0YXRlLmN1cnJlbnRTY3JlZW4gPT0gXCJyZWNlbnQgYWN0aXZpdHlcIikge1xuICAgICAgbG9sc2NyZWVuID0gQ2FtcGFpZ25BY3Rpdml0eVZpZXcobnVsbClcbiAgICAgIHRhYl8yID0gXCJhY3RpdmUtY2FtcGFpZ24tdGFiIGNhbXBhaWduIHRhYi1saW5rXCJcbiAgICB9IGVsc2UgaWYodGhpcy5zdGF0ZS5jdXJyZW50U2NyZWVuID09IFwic2NoZWR1bGVkIGZvbGxvd3Vwc1wiKSB7XG4gICAgICBsb2xzY3JlZW4gPSBDYW1wYWlnbkZvbGxvd3VwRmVlZCh7XG4gICAgICAgICAgICAgICAgICAgIGJhdGNoZXM6IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5iYXRjaGVzLCBcbiAgICAgICAgICAgICAgICAgICAgZm9sbG93dXBzOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24uZm9sbG93dXBzfSlcbiAgICAgIHRhYl8zID0gXCJhY3RpdmUtY2FtcGFpZ24tdGFiIGNhbXBhaWduIHRhYi1saW5rXCJcbiAgICB9IGVsc2UgaWYodGhpcy5zdGF0ZS5jdXJyZW50U2NyZWVuID09IFwic2VudCBtYWlsXCIpIHtcbiAgICAgIGxvbHNjcmVlbiA9IENhbXBhaWduU2VudEVtYWlsKHtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENhbXBhaWduOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ259KVxuICAgICAgdGFiXzQgPSBcImFjdGl2ZS1jYW1wYWlnbi10YWIgY2FtcGFpZ24gdGFiLWxpbmtcIlxuICAgIH0gZWxzZSBpZih0aGlzLnN0YXRlLmN1cnJlbnRTY3JlZW4gPT0gXCJhbmFseXRpY3NcIikge1xuICAgICAgbG9sc2NyZWVuID0gQ2FtcGFpZ25SZXBvcnQobnVsbClcbiAgICAgIHRhYl81ID0gXCJhY3RpdmUtY2FtcGFpZ24tdGFiIGNhbXBhaWduIHRhYi1saW5rXCJcbiAgICB9IGVsc2V7XG4gICAgICBjb25zb2xlLmxvZygnTE9MJylcbiAgICAgIGxvbHNjcmVlbiA9IEZvbGxvd3VwVGltZWxpbmUoe1xuICAgICAgICAgICAgICAgICAgdGVtcGxhdGVzOiB0aGlzLnN0YXRlLnRlbXBsYXRlcywgXG4gICAgICAgICAgICAgICAgICBwcm9zcGVjdHM6IHRoaXMuc3RhdGUucHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ2FtcGFpZ246IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbiwgXG4gICAgICAgICAgICAgICAgICBwcm9zcGVjdExpc3RDb3VudDogdGhpcy5zdGF0ZS5wcm9zcGVjdExpc3RDb3VudCwgXG4gICAgICAgICAgICAgICAgICBuZXdQcm9zcGVjdHM6IHRoaXMuc3RhdGUubmV3UHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IHRoaXMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSwgXG4gICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXM6IHRoaXMuc3RhdGUudGVtcGxhdGVzLCBcbiAgICAgICAgICAgICAgICAgIGluaXRpYWxGb2xsb3d1cHM6IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5mb2xsb3d1cHN9KVxuICAgIH1cbiAgICAvL2FjdGl2ZVRhYiA9IFwiYWN0aXZlLWNhbXBhaWduLXRhYiBjYW1wYWlnbiB0YWItbGlua1wiXG4gICAgICBcblxuICAgIGxpc3RfdHlwZSA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5wcm9zcGVjdF9saXN0Lmxpc3RfdHlwZVxuICAgIGlmKGxpc3RfdHlwZSA9PSBcIm1pbmluZ19qb2JcIilcbiAgICAgIGxpc3RfdHlwZSA9IFJlYWN0LkRPTS5zcGFuKG51bGwsIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2xvdWQtZG93bmxvYWRcIn0pLCBcIsKgXCIpXG4gICAgZWxzZSBpZihsaXN0X3R5cGUgPT0gXCJzaWduYWxfbGlzdFwiKVxuICAgICAgbGlzdF90eXBlID0gUmVhY3QuRE9NLnNwYW4obnVsbCwgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS13aWZpXCJ9KSwgXCLCoFwiKVxuICAgIGVsc2VcbiAgICAgIGxpc3RfdHlwZSA9IFJlYWN0LkRPTS5zcGFuKG51bGwsIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtbGlzdC1hbHRcIn0pLCBcIsKgXCIpXG5cbiAgICBiYXRjaGVzID0gdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmJhdGNoZXNcbiAgICBiYXRjaGVzID0gKGJhdGNoZXMpID8gYmF0Y2hlcyA6IFtdXG4gICAgY29uc29sZS5sb2coJ0JBVENIRVMnKVxuICAgIGNvbnNvbGUubG9nKGJhdGNoZXMpXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJjb250YWluZXJcIiwgXG4gICAgICAgICAgIHN0eWxlOiB7d2lkdGg6JzEwMCUnLGhlaWdodDonMTAwJScscGFkZGluZ0xlZnQ6MCxwYWRkaW5nUmlnaHQ6MH19LCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7c3R5bGU6IHttYXJnaW5Cb3R0b206MTV9LCBpZDogXCJjYW1wYWlnbi10b3AtZGV0YWlsXCJ9LCBcbiAgICAgICAgUmVhY3QuRE9NLmg1KHtzdHlsZToge21hcmdpblRvcDoyMCxtYXJnaW5MZWZ0OjIwfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIG9uQ2xpY2s6IHRoaXMucmV0dXJuVG9PdmVydmlld30sIFwiQ2FtcGFpZ25zIFwiKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNtYWxsKG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe3N0eWxlOiB7bWFyZ2luTGVmdDoxMCwgbWFyZ2luUmlnaHQ6MTB9LCBcbiAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJmYSBmYS1jaGV2cm9uLXJpZ2h0XCJ9KVxuICAgICAgICAgICksIFxuICAgICAgICAgIHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5uYW1lXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luTGVmdDoyMCxkaXNwbGF5OidpbmxpbmUtYmxvY2snLG1hcmdpblJpZ2h0OjE1LG1hcmdpbkJvdHRvbTowLGZvbnRXZWlnaHQ6J2JvbGQnLGZvbnRTaXplOjEwfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXCJQUk9TUEVDVCBMSVNUOlwiKSwgXCIgwqBcIlxuICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcImxhYmVsIGxhYmVsLXN1Y2Nlc3NcIn0sIFxuICAgICAgICAgIGxpc3RfdHlwZSwgXG4gICAgICAgICAgdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLnByb3NwZWN0X2xpc3QubmFtZSwgXG4gICAgICAgICAgXCLCoCDCoCDCoFwiLCBcbiAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS11c2VyXCJ9KSwgXCLCoFwiLCB0aGlzLnN0YXRlLnByb3NwZWN0TGlzdENvdW50XG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uYnIobnVsbCksIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luTGVmdDoyMCxkaXNwbGF5OidpbmxpbmUtYmxvY2snLG1hcmdpblJpZ2h0OjUwLG1hcmdpblRvcDowLGZvbnRXZWlnaHQ6J2JvbGQnLGZvbnRTaXplOjEwfSwgXG4gICAgICAgICAgICBjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgXCJCQVRDSEVTOlwiXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcImxhYmVsIGxhYmVsLXByaW1hcnlcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtc2l0ZW1hcFwifSksIFwiwqBcIiwgXG4gICAgICAgICAgKF8uaXNFcXVhbChiYXRjaGVzLCBbXSkpID8gMSA6IGJhdGNoZXMubGVuZ3RoXG4gICAgICAgICksIFxuICAgICAgICBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7c3R5bGU6IHtib3JkZXI6JzFweCBzb2xpZCAjZGRkJyxib3JkZXJSYWRpdXM6NSxmbG9hdDoncmlnaHQnLG1hcmdpblRvcDotMjMsbWFyZ2luUmlnaHQ6MTAwfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImJnLXdhcm5pbmdcIiwgc3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snLHBhZGRpbmc6MTAsZm9udFdlaWdodDonYm9sZCcsY3Vyc29yOidwb2ludGVyJ319LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJ0ZXh0LXdhcm5pbmdcIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGFwZXItcGxhbmVcIn0pLCBcIiAxMDAlXCJcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiYmctc3VjY2Vzc1wiLCBzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jaycscGFkZGluZzoxMCxmb250V2VpZ2h0Oidib2xkJyxjdXJzb3I6J3BvaW50ZXInfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInRleHQtc3VjY2Vzc1wifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1leWVcIn0pLCBcIiAxMDAlXCJcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiYmctZGFuZ2VyXCIsIHN0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyxwYWRkaW5nOjEwLGZvbnRXZWlnaHQ6J2JvbGQnLGN1cnNvcjoncG9pbnRlcid9fSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwidGV4dC1kYW5nZXJcIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZXhjbGFtYXRpb24tY2lyY2xlXCJ9KSwgXCIgMTAwJVwiXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgKSwgXG4gICAgICAgIFxuICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgc3R5bGU6IHtmbG9hdDogJ3JpZ2h0JywgbWFyZ2luVG9wOiAtMzUsIG1hcmdpblJpZ2h0OiAzMCwgZGlzcGxheTonbm9uZSd9LCBcbiAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4tc21cIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZW52ZWxvcGVcIn0pLCBcIiBTZW5kIVwiXG4gICAgICAgIClcbiAgICAgICAgXG4gICAgICAgICksIFxuICAgICAgICAgICAgICBSZWFjdC5ET00udWwoe2NsYXNzTmFtZTogXCJuYXYgbmF2LXRhYnMgY2FtcGFpZ24tdGFic1wiLCByb2xlOiBcInRhYmxpc3RcIiwgc3R5bGU6IHtwYWRkaW5nUmlnaHQ6MH19LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00ubGkoe2NsYXNzTmFtZTogXCJjYW1wYWlnbi10YWJcIn0sIFwiIFwiLCBSZWFjdC5ET00uYSh7b25DbGljazogdGhpcy5jaGFuZ2VTY3JlZW4sIGhyZWY6IFwiamF2YXNjcmlwdDpcIiwgY2xhc3NOYW1lOiB0YWJfMX0sIFwiVElNRUxJTkVcIikpLCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00ubGkoe2NsYXNzTmFtZTogXCJjYW1wYWlnbi10YWJcIn0sIFJlYWN0LkRPTS5hKHtvbkNsaWNrOiB0aGlzLmNoYW5nZVNjcmVlbiwgaHJlZjogXCJqYXZhc2NyaXB0OlwiLCBjbGFzc05hbWU6IHRhYl8yfSwgXCJSRUNFTlQgQUNUSVZJVFlcIikpLCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00ubGkoe2NsYXNzTmFtZTogXCJjYW1wYWlnbi10YWJcIn0sIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmEoe29uQ2xpY2s6IHRoaXMuY2hhbmdlU2NyZWVuLCBocmVmOiBcImphdmFzY3JpcHQ6XCIsIGNsYXNzTmFtZTogdGFiXzMsIHN0eWxlOiB7Zm9udFNpemU6MTJ9fSwgXG4gICAgICAgICAgICAgICAgICAgIFwiU0NIRURVTEVEIEZPTExPV1VQU1wiKSksIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImNhbXBhaWduLXRhYlwifSwgUmVhY3QuRE9NLmEoe29uQ2xpY2s6IHRoaXMuY2hhbmdlU2NyZWVuLCBocmVmOiBcImphdmFzY3JpcHQ6XCIsIGNsYXNzTmFtZTogdGFiXzR9LCBcIlNFTlQgTUFJTFwiKSksIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImNhbXBhaWduLXRhYlwifSwgUmVhY3QuRE9NLmEoe29uQ2xpY2s6IHRoaXMuY2hhbmdlU2NyZWVuLCBocmVmOiBcImphdmFzY3JpcHQ6XCIsIGNsYXNzTmFtZTogdGFiXzV9LCBcIkFOQUxZVElDU1wiKSlcbiAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBsb2xzY3JlZW4sIFxuXG4gICAgICAgICAgKHRoaXMuc3RhdGUudGVtcGxhdGVEZXRhaWxNb2RlKSA/IEVkaXRUZW1wbGF0ZVZpZXcoe1xuICAgICAgICAgICAgZWRpdE1vZGU6IHRoaXMuc3RhdGUuZWRpdE1vZGUsIFxuICAgICAgICAgICAgaW5pdGlhbFRlbXBsYXRlVmFsdWVzOiB0aGlzLnN0YXRlLmN1cnJlbnRUZW1wbGF0ZSwgXG4gICAgICAgICAgICBzYXZlVGVtcGxhdGU6IHRoaXMuc2F2ZVRlbXBsYXRlLCBcbiAgICAgICAgICAgIHByb3NwZWN0OiB0aGlzLnN0YXRlLnByb3NwZWN0c1swXSwgXG4gICAgICAgICAgICB0b2dnbGVUZW1wbGF0ZUVkaXRNZW51OiB0aGlzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUsIFxuICAgICAgICAgICAgZm9sbG93dXBEYXk6IHRoaXMuc3RhdGUuZm9sbG93dXBEYXl9KSA6IFwiXCJcbiAgICAgIClcbiAgICApO1xuICB9LFxuXG4gIHNhdmVUZW1wbGF0ZTogZnVuY3Rpb24odGVtcGxhdGUsIG5ld1RlbXBsYXRlKSB7XG4gICAgdGVtcGxhdGVzID0gdGhpcy5zdGF0ZS50ZW1wbGF0ZXNcbiAgICBmb3IoaT0wO2k8IHRoaXMuc3RhdGUudGVtcGxhdGVzLmxlbmd0aDsgaSsrKVxuICAgICAgaWYodGhpcy5zdGF0ZS50ZW1wbGF0ZXNbaV0ubmFtZSA9PSB0ZW1wbGF0ZS5uYW1lKVxuICAgICAgICBicmVha1xuICAgIFxuICAgIGNvbnNvbGUubG9nKHRlbXBsYXRlKVxuICAgIGlmKG5ld1RlbXBsYXRlKXtcbiAgICAgIHRlbXBsYXRlLnN1YmplY3QgPSB0ZW1wbGF0ZS5zdWJqZWN0XG4gICAgICB0ZW1wbGF0ZS5uYW1lID0gdGVtcGxhdGUubmFtZVxuICAgICAgdGVtcGxhdGUuYm9keSA9IHRlbXBsYXRlLmJvZHlcbiAgICAgIHRlbXBsYXRlcy5wdXNoKHRlbXBsYXRlKVxuXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvVGVtcGxhdGUnLFxuICAgICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICB0eXBlOidQT1NUJyxcbiAgICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbmFtZSA6IHRlbXBsYXRlLm5hbWUsXG4gICAgICAgICAgc3ViamVjdDogdGVtcGxhdGUuc3ViamVjdCxcbiAgICAgICAgICBib2R5OiB0ZW1wbGF0ZS5ib2R5LFxuICAgICAgICAgIHVzZXI6e1xuICAgICAgICAgICAgX190eXBlOiAnUG9pbnRlcicsXG4gICAgICAgICAgICBjbGFzc05hbWU6J19Vc2VyJyxcbiAgICAgICAgICAgIG9iamVjdElkOkpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKS5vYmplY3RJZCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbXBhbnk6SlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIpLmNvbXBhbnksXG4gICAgICAgIH0pLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGVtcGxhdGVzW2ldLnN1YmplY3QgPSB0ZW1wbGF0ZS5zdWJqZWN0XG4gICAgICB0ZW1wbGF0ZXNbaV0uYm9keSA9IHRlbXBsYXRlLmJvZHlcblxuICAgICAgJC5hamF4KHtcbiAgICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL1RlbXBsYXRlLycrdGVtcGxhdGVzW2ldLm9iamVjdElkLFxuICAgICAgICB0eXBlOidQVVQnLFxuICAgICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICBkYXRhOkpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBuYW1lIDogdGVtcGxhdGUubmFtZSxcbiAgICAgICAgICBzdWJqZWN0OiB0ZW1wbGF0ZS5zdWJqZWN0LFxuICAgICAgICAgIGJvZHk6IHRlbXBsYXRlLmJvZHksXG4gICAgICAgIH0pLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHt0ZW1wbGF0ZXM6IHRlbXBsYXRlcyB9KVxuXG4gIH0sXG5cbiAgdG9nZ2xlVGVtcGxhdGVFZGl0TWVudTogZnVuY3Rpb24oY3VycmVudFRlbXBsYXRlLCBlZGl0TW9kZSkge1xuICAgIGVkaXRNb2RlID0gKGVkaXRNb2RlKSA/IHRydWUgOiBmYWxzZVxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgY3VycmVudFRlbXBsYXRlOiBjdXJyZW50VGVtcGxhdGUsXG4gICAgICB0ZW1wbGF0ZURldGFpbE1vZGU6ICF0aGlzLnN0YXRlLnRlbXBsYXRlRGV0YWlsTW9kZSxcbiAgICB9KVxuICB9XG59KTtcblxudmFyIEZvbGxvd3VwVGltZWxpbmUgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdGb2xsb3d1cFRpbWVsaW5lJyxcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJjb2wtbWQtOCBwYW5lbCBwYW5lbC1kZWZhdWx0XCIsIFxuICAgICAgICAgICAgICAgc3R5bGU6IHtoZWlnaHQ6NDM2LHBhZGRpbmdMZWZ0OjMwNSxwYWRkaW5nVG9wOjUwLG92ZXJmbG93OidhdXRvJyxib3JkZXJSaWdodDowLGJvcmRlclJhZGl1czowLCBib3JkZXJUb3A6MH19LCBcbiAgICAgICAgICAgICAgICBUaW1lbGluZSh7XG4gICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXM6IHRoaXMucHJvcHMudGVtcGxhdGVzLCBcbiAgICAgICAgICAgICAgICAgIHByb3NwZWN0czogdGhpcy5wcm9wcy5wcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYW1wYWlnbjogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLCBcbiAgICAgICAgICAgICAgICAgIHByb3NwZWN0TGlzdENvdW50OiB0aGlzLnByb3BzLnByb3NwZWN0TGlzdENvdW50LCBcbiAgICAgICAgICAgICAgICAgIG5ld1Byb3NwZWN0czogdGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgdG9nZ2xlVGVtcGxhdGVFZGl0TWVudTogdGhpcy5wcm9wcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51LCBcbiAgICAgICAgICAgICAgICAgIGluaXRpYWxGb2xsb3d1cHM6IHRoaXMucHJvcHMuaW5pdGlhbEZvbGxvd3Vwc30pXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImNvbC1tZC00XCIsIFxuICAgICAgICAgICAgICAgc3R5bGU6IHtwYWRkaW5nTGVmdDowLHBhZGRpbmdSaWdodDowLGhlaWdodDo0MzZ9fSwgXG4gICAgICAgICAgICBUZW1wbGF0ZXNNZW51KHtcbiAgICAgICAgICAgICAgdGVtcGxhdGVzOiB0aGlzLnByb3BzLnRlbXBsYXRlcywgXG4gICAgICAgICAgICAgIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudX0pXG4gICAgICAgICAgKVxuICAgICAgICApXG5cbiAgICApXG4gIH1cbn0pXG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy8gRm9sbG93dXBGZWVkXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGZvbGxvd3VwczogW11cbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBmb3IgZWFjaCBiYXRjaCBmaW5kIGZvbGxvd3VwcyByZW1haW5pbmdcbiAgICAgICAgLy8gc29ydCBmb2xsb3d1cHMgYnkgYXNjZW5kaW5nIGZvbGxvd3VwIGRheVxuICAgICAgICAvL1xuICAgIC8vIEJhdGNoIFN0YXJ0IERhdGVcbiAgICAvLyBDdXJyZW50IEJhdGNoIERhdGVcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0aGlzcyA9IHRoaXM7XG4gICAgZm9sbG93dXBzID0gXy5tYXAodGhpcy5wcm9wcy5iYXRjaGVzLCBmdW5jdGlvbihiYXRjaCkge1xuICAgICAgbm93ID0gbW9tZW50KCkuc3RhcnRPZignZGF5JykudmFsdWVPZigpLzEwMDBcbiAgICAgIGJhdGNoLmN1cnJlbnREYXkgPSBtb21lbnQoYmF0Y2guc3RhcnRlZCkuZGlmZihtb21lbnQobm93KSwgICdkYXlzJykgKiAtMVxuICAgICAgcmV0dXJuIF8ubWFwKHRoaXNzLnByb3BzLmZvbGxvd3VwcywgZnVuY3Rpb24oZm9sbG93dXApIHtcbiAgICAgICAgZm9sbG93dXAuYmF0Y2ggPSBiYXRjaFxuICAgICAgICBpZihmb2xsb3d1cC5kYXkgPj0gYmF0Y2guY3VycmVudERheSlcbiAgICAgICAgICByZXR1cm4gZm9sbG93dXBcbiAgICAgIH0pXG4gICAgfSlcbiAgICBmb2xsb3d1cHMgPSBfLnNvcnRCeShmb2xsb3d1cHMsIGZ1bmN0aW9uKGZvbGxvd3VwKXsgcmV0dXJuIGZvbGxvd3VwLmRheSB9KVxuXG4gICAgY29uc29sZS5kZWJ1Zyhmb2xsb3d1cHMpXG5cbiAgICBhY3Rpdml0aWVzID0gXy5tYXAoZm9sbG93dXBzWzBdLCBmdW5jdGlvbihmb2xsb3d1cCkge1xuICAgICAgcmV0dXJuIEZvbGxvd3Vwcyh7Zm9sbG93dXA6IGZvbGxvd3VwLCBiYXRjaDogZm9sbG93dXAuYmF0Y2h9KVxuICAgIH0pXG4gICAgY29uc29sZS5kZWJ1ZyhhY3Rpdml0aWVzKVxuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe3N0eWxlOiB7b3ZlcmZsb3c6J2F1dG8nLGhlaWdodDo0MzZ9fSwgXG4gICAgICAgIFJlYWN0LkRPTS50YWJsZSh7Y2xhc3NOYW1lOiBcInRhYmxlXCIsIHN0eWxlOiB7bWFyZ2luQm90dG9tOjB9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnRoZWFkKG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlNjaGVkdWxlZCBmb3IgXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIk91dHJlYWNoIFN0YWdlIFwiKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00udGgobnVsbCwgXCJQcm9zcGVjdCBMaXN0XCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlRlbXBsYXRlIFwiKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00udGgoe3N0eWxlOiB7dGV4dEFsaWduOidjZW50ZXInfX0sIFwiQWN0aW9uIEJ1dHRvbnNcIilcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udGJvZHkobnVsbCwgXG4gICAgICAgICAgICBhY3Rpdml0aWVzXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgKVxuICB9XG59KVxuXG52YXIgRm9sbG93dXBzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnRm9sbG93dXBzJyxcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAvLyB0aGlzLnByb3BzLmJhdGNoXG4gICAgLy8gdGhpcy5wcm9wcy5mb2xsb3d1cFxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00udHIobnVsbCwgXG4gICAgICAgICAgUmVhY3QuRE9NLnRkKG51bGwpLCBcbiAgICAgICAgICBSZWFjdC5ET00udGQobnVsbCwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaDYobnVsbCwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2xvY2tcIn0pLCBcIsKgXCIgKyAnICcgK1xuICAgICAgICAgICAgICBcIjI5IG1pbnV0ZXMgYWdvXCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udGQobnVsbCwgXG4gICAgICAgICAgICBcInNlY29uZFwiXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnRkKG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge2N1cnNvcjoncG9pbnRlcid9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWxpc3QtYWx0XCJ9KSwgXCIgwqBcIiArICcgJyArXG4gICAgICAgICAgICBcIkJvc3RvbiBWUCBTYWxlcyAtIFJldGFpbFwiXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnRkKG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge2N1cnNvcjoncG9pbnRlcid9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWZpbGUtdGV4dC1vXCJ9KSwgXCIgwqBcIiArICcgJyArXG4gICAgICAgICAgICBcIkZvbGxvd3VwICMyIC0gUHJvdmlkZSBWYWx1ZSBcIiwgUmVhY3QuRE9NLmJyKG51bGwpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXCIgU3ViamVjdDogSnVzdCB3YW50ZWQgdG8gZm9sbG93dXAgb24gdGhlIGxhc3QgZW1haWwgXCIpLCBSZWFjdC5ET00uYnIobnVsbCksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcIiBCb2R5OiBKdXN0IHdhbnRlZCB0byBmb2xsb3d1cCBvbiB0aGUgbGFzdCBlbWFpbCBcIilcblxuICAgICAgICAgICAgKVxuICAgICAgICAgICksIFxuXG4gICAgICAgICAgUmVhY3QuRE9NLnRkKHtzdHlsZToge3RleHRBbGlnbjonY2VudGVyJ319LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIGNsYXNzTmFtZTogXCJidG4gYnRuLXN1Y2Nlc3MgYnRuLXhzXCIsIHN0eWxlOiB7d2lkdGg6MTcwLGZvbnRXZWlnaHQ6J2JvbGQnLG1hcmdpbkJvdHRvbToyfX0sIFwiU2VuZCBOb3dcIiksIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi14c1wiLCBzdHlsZToge3dpZHRoOjE3MCxmb250V2VpZ2h0Oidib2xkJyxtYXJnaW5Cb3R0b206Mn19LCBcIlJlbWluZCBtZSBpbiAxIGhvdXJcIiksIFJlYWN0LkRPTS5icihudWxsKVxuICAgICAgICAgIClcbiAgICAgIClcbiAgICApXG4gIH1cbn0pXG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubG9sID0gXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIC8vIENhbXBhaWduIFJlcG9ydFxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHsgXG4gICAgdGVzdERhdGEgPSB0aGlzLnRlc3REYXRhKClcbiAgICB2YXIgaW5kdXN0cnlDaGFydCAgID0gZGMucGllQ2hhcnQoXCIjaW5kdXN0cnktY2hhcnRcIiksXG4gICAgICAgIHNwZW5kSGlzdENoYXJ0ICA9IGRjLmJhckNoYXJ0KFwiI2NoYXJ0LWhpc3Qtc3BlbmRcIiksXG4gICAgICAgIHNwZW5kZXJSb3dDaGFydCA9IGRjLnJvd0NoYXJ0KFwiI2NoYXJ0LXJvdy1zcGVuZGVyc1wiKTtcblxuICAgIC8vIHNldCBjcm9zc2ZpbHRlclxuICAgIHZhciBuZHggPSBjcm9zc2ZpbHRlcihzcGVuZERhdGEpLFxuICAgICAgICB5ZWFyRGltICA9IG5keC5kaW1lbnNpb24oZnVuY3Rpb24oZCkge3JldHVybiArZC5ZZWFyO30pLFxuICAgICAgICBzcGVuZERpbSA9IG5keC5kaW1lbnNpb24oZnVuY3Rpb24oZCkge3JldHVybiBNYXRoLmZsb29yKGQuU3BlbnQvMTApO30pLFxuICAgICAgICBuYW1lRGltICA9IG5keC5kaW1lbnNpb24oZnVuY3Rpb24oZCkge3JldHVybiBkLk5hbWU7fSksXG4gICAgICAgIHNwZW5kUGVyWWVhciA9IHllYXJEaW0uZ3JvdXAoKS5yZWR1Y2VTdW0oZnVuY3Rpb24oZCkge3JldHVybiArZC5TcGVudDt9KSxcbiAgICAgICAgc3BlbmRQZXJOYW1lID0gbmFtZURpbS5ncm91cCgpLnJlZHVjZVN1bShmdW5jdGlvbihkKSB7cmV0dXJuICtkLlNwZW50O30pLFxuICAgICAgICBzcGVuZEhpc3QgICAgPSBzcGVuZERpbS5ncm91cCgpLnJlZHVjZUNvdW50KCk7XG5cbiAgICBpbmR1c3RyeUNoYXJ0XG4gICAgICAgIC53aWR0aCgyMDApLmhlaWdodCgyMDApXG4gICAgICAgIC5kaW1lbnNpb24oeWVhckRpbSlcbiAgICAgICAgLmdyb3VwKHNwZW5kUGVyWWVhcilcbiAgICAgICAgLmlubmVyUmFkaXVzKDUwKTtcblxuICAgIC8vXG4gICAgLy8gQmF0Y2ggQW5hbHl0aWNzIC0gQnViYmxlIENoYXJ0XG4gICAgLy8gQmF0Y2ggQmxvY2sgQ2hhcnRzXG4gICAgLy8gUGllIENoYXJ0IC0gSW5kdXN0cnlcbiAgICAvLyBSZXZlbnVlIC0gUENcbiAgICAvLyBDb21wYW55IFNpemUgLSBQQ1xuICAgIC8vIE9wZW5zIC8gUmVwbGllcyAvIExpbmsgQ2xpY2tzIC8gQm91bmNlcyAtIEJhciBDaGFydFxuICAgIC8vIFRpdGxlcyAtIFBDXG4gICAgLy8gVGltZSAvIERhdGUgRW1haWwgU2VudCAtIExpbmUgQ2hhcnRcbiAgICAvLyBEYXRlIFByb3NwZWN0ZWQgLSBCQ1xuICAgIC8vXG4gIH0sXG4gIFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICBcIlJlcG9ydCBWaWV3XCIsIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtpZDogXCJpbmR1c3RyeS1jaGFydFwifSlcbiAgICAgIClcbiAgICApXG4gIH0sXG5cbiAgdGVzdERhdGE6IGZ1bmN0aW9uKCkgeyBcbiAgICByZXR1cm4gW3tcIndlYnNpdGVcIjogXCJodHRwOi8vd3d3LnRlbmNhdGUuY29tXCIsIFwiY2FtcGFpZ25cIjoge1wiY2xhc3NOYW1lXCI6IFwiQ2FtcGFpZ25cIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJubUVsVTd6Y0JmXCJ9LCBcInBvc1wiOiBcIlxcXFx1MDBhMERpcmVjdG9yIFNhbGVzICYgTWFya2V0aW5nIEFlcm9zcGFjZVwiLCBcIl9fdHlwZVwiOiBcIk9iamVjdFwiLCBcInVwZGF0ZWRBdFwiOiBcIjIwMTQtMTAtMTBUMTM6Mjk6MjIuNTE2WlwiLCBcImNyZWF0ZWRBdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTguNDgxWlwiLCBcImNpdHlcIjogXCJDb3ZlbnRyeSwgVW5pdGVkIEtpbmdkb21cXFxcdTAwYTBcIiwgXCJhcmNoaXZlZFwiOiB0cnVlLCBcImxvYWRpbmdcIjogZmFsc2UsIFwib2JqZWN0SWRcIjogXCJmdHlLQ0dtUjlIXCIsIFwiY29tcGFueV9uYW1lXCI6IFwiVGVuY2F0ZVwiLCBcIm1haWxndW5faWRcIjogXCI8MjAxNDEwMTAxNDAyMTguNTg4ODMuNzUwNDBAY3VzdG9tZXJvaHEuY29tPlwiLCBcImVtYWlsX2d1ZXNzZXNcIjogW3tcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJ1OFNldENRT0pQXCJ9LCB7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiUDBLbUZHOTJkS1wifV0sIFwiZW1haWxcIjogXCJuLnRpZmZpbkB0ZW5jYXRlLmNvbVwiLCBcInByb3NwZWN0X2NyZWF0ZWRfYXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE4LjQ4MVpcIiwgXCJjb21wYW55XCI6IHtcImNsYXNzTmFtZVwiOiBcIkNvbXBhbnlcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJmcUhXcDVOc0Z4XCJ9LCBcImxpc3RzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdExpc3RcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJpekxiVnVseXI2XCJ9XSwgXCJ1c2VyXCI6IHtcImNsYXNzTmFtZVwiOiBcIlVzZXJcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJ4V0VTaXc1U21kXCJ9LCBcImNvbXBhbnlfc2l6ZVwiOiBcIjEwMDEtNTAwMCBlbXBsb3llZXNcIiwgXCJuYW1lXCI6IFwiTmljayBUaWZmaW5cIiwgXCJpbmR1c3RyeVwiOiBcIlRleHRpbGVzXCIsIFwibGlua2VkaW5fdXJsXCI6IFwidWsubGlua2VkaW4uY29tL3B1Yi9uaWNrLXRpZmZpbi81LzQzNC8yNTZcIiwgXCJiYXRjaFwiOiB7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdEJhdGNoXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiWVBhVEdiRDU2YVwifSwgXCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdFwiLCBcInF1ZXVlZFwiOiB0cnVlfSwge1wid2Vic2l0ZVwiOiBcImh0dHA6Ly93d3cucGVhcnNvbi5jb21cIiwgXCJjYW1wYWlnblwiOiB7XCJjbGFzc05hbWVcIjogXCJDYW1wYWlnblwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm5tRWxVN3pjQmZcIn0sIFwicG9zXCI6IFwiXFxcXHUwMGEwRGlyZWN0b3IsIFNhbGVzIFBlcmZvcm1hbmNlIE1hbmFnZW1lbnRcIiwgXCJfX3R5cGVcIjogXCJPYmplY3RcIiwgXCJ1cGRhdGVkQXRcIjogXCIyMDE0LTEwLTEwVDEzOjI5OjIyLjc4MFpcIiwgXCJjcmVhdGVkQXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE3Ljg3M1pcIiwgXCJjaXR5XCI6IFwiUGhvZW5peCwgQXJpem9uYSBBcmVhXFxcXHUwMGEwXCIsIFwiYXJjaGl2ZWRcIjogdHJ1ZSwgXCJsb2FkaW5nXCI6IGZhbHNlLCBcIm9iamVjdElkXCI6IFwiTFBpRTBDY0VzUlwiLCBcImNvbXBhbnlfbmFtZVwiOiBcIlBlYXJzb24gcGxjXCIsIFwibWFpbGd1bl9pZFwiOiBcIjwyMDE0MTAxMDE0MDIxOS41MDAxNS4yMDU3MUBjdXN0b21lcm9ocS5jb20+XCIsIFwiZW1haWxfZ3Vlc3Nlc1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIlE1N2t3TjFMUVRcIn0sIHtcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCI1M0swbFdZN2h2XCJ9XSwgXCJlbWFpbFwiOiBcImphc29uLmxpbmtlZGluQHBlYXJzb24uY29tXCIsIFwicHJvc3BlY3RfY3JlYXRlZF9hdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTcuODczWlwiLCBcImNvbXBhbnlcIjoge1wiY2xhc3NOYW1lXCI6IFwiQ29tcGFueVwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImZxSFdwNU5zRnhcIn0sIFwibGlzdHNcIjogW3tcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0TGlzdFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIml6TGJWdWx5cjZcIn1dLCBcInVzZXJcIjoge1wiY2xhc3NOYW1lXCI6IFwiVXNlclwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInhXRVNpdzVTbWRcIn0sIFwiY29tcGFueV9zaXplXCI6IFwiMTAsMDAxKyBlbXBsb3llZXNcIiwgXCJuYW1lXCI6IFwiSmFzb24gVXBhaFwiLCBcImluZHVzdHJ5XCI6IFwiRWR1Y2F0aW9uIE1hbmFnZW1lbnRcIiwgXCJsaW5rZWRpbl91cmxcIjogXCJ3d3cubGlua2VkaW4uY29tL3B1Yi9qYXNvbi11cGFoLzcvMjMzLzk0MFwiLCBcImJhdGNoXCI6IHtcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0QmF0Y2hcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJZUGFUR2JENTZhXCJ9LCBcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0XCIsIFwicXVldWVkXCI6IHRydWV9LCB7XCJ3ZWJzaXRlXCI6IFwiaHR0cDovL3d3dy5ybXdtdXNpYy5jb21cIiwgXCJjYW1wYWlnblwiOiB7XCJjbGFzc05hbWVcIjogXCJDYW1wYWlnblwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm5tRWxVN3pjQmZcIn0sIFwicG9zXCI6IFwiXFxcXHUwMGEwRGlyZWN0b3Igb2YgU2FsZXMgYW5kIE1hcmtldGluZ1wiLCBcIl9fdHlwZVwiOiBcIk9iamVjdFwiLCBcInVwZGF0ZWRBdFwiOiBcIjIwMTQtMTAtMTBUMTM6Mjk6MjMuMDQ5WlwiLCBcImNyZWF0ZWRBdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTYuNzM1WlwiLCBcImNpdHlcIjogXCJUb3JvbnRvLCBPbnRhcmlvLCBDYW5hZGFcXFxcdTAwYTBcIiwgXCJhcmNoaXZlZFwiOiB0cnVlLCBcImxvYWRpbmdcIjogZmFsc2UsIFwib3BlbmVkXCI6IHRydWUsIFwib2JqZWN0SWRcIjogXCJDT1NweVhnc0QyXCIsIFwiY29tcGFueV9uYW1lXCI6IFwiUk1XIE11c2ljXCIsIFwibWFpbGd1bl9pZFwiOiBcIjwyMDE0MTAxMDE0MDIxOS41MDAxOS42NzQxOEBjdXN0b21lcm9ocS5jb20+XCIsIFwiZW1haWxfZ3Vlc3Nlc1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIjNPRUt0SXhJQXBcIn0sIHtcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJ4dkdiVVlwbzQzXCJ9XSwgXCJlbWFpbFwiOiBcIm5vX2VtYWlsXCIsIFwicHJvc3BlY3RfY3JlYXRlZF9hdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTYuNzM1WlwiLCBcImNvbXBhbnlcIjoge1wiY2xhc3NOYW1lXCI6IFwiQ29tcGFueVwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImZxSFdwNU5zRnhcIn0sIFwibGlzdHNcIjogW3tcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0TGlzdFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIml6TGJWdWx5cjZcIn1dLCBcInVzZXJcIjoge1wiY2xhc3NOYW1lXCI6IFwiVXNlclwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInhXRVNpdzVTbWRcIn0sIFwiY29tcGFueV9zaXplXCI6IFwiMTEtNTAgZW1wbG95ZWVzXCIsIFwibmFtZVwiOiBcIkxhdXJhIE5pa29saWNcIiwgXCJpbmR1c3RyeVwiOiBcIk11c2ljXCIsIFwibGlua2VkaW5fdXJsXCI6IFwiY2EubGlua2VkaW4uY29tL3B1Yi9sYXVyYS1uaWtvbGljLzUwLzQ1MC83NzFcIiwgXCJiYXRjaFwiOiB7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdEJhdGNoXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiWVBhVEdiRDU2YVwifSwgXCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdFwiLCBcInF1ZXVlZFwiOiB0cnVlfSwge1wid2Vic2l0ZVwiOiBcImh0dHA6Ly93d3cuc2F1ZGlhY2FyZ28uY29tXCIsIFwiY2FtcGFpZ25cIjoge1wiY2xhc3NOYW1lXCI6IFwiQ2FtcGFpZ25cIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJubUVsVTd6Y0JmXCJ9LCBcInBvc1wiOiBcIlxcXFx1MDBhMERpcmVjdG9yIEdsb2JhbCBTYWxlcyBTdXBwb3J0XCIsIFwiX190eXBlXCI6IFwiT2JqZWN0XCIsIFwidXBkYXRlZEF0XCI6IFwiMjAxNC0xMC0xMFQxMzoyOToyMy4zMjdaXCIsIFwiY3JlYXRlZEF0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNi4xMjdaXCIsIFwiY2l0eVwiOiBcIlNhdWRpIEFyYWJpYVxcXFx1MDBhMFwiLCBcImFyY2hpdmVkXCI6IHRydWUsIFwibG9hZGluZ1wiOiBmYWxzZSwgXCJvcGVuZWRcIjogdHJ1ZSwgXCJvYmplY3RJZFwiOiBcIktlMDZnNmtTazVcIiwgXCJjb21wYW55X25hbWVcIjogXCJTYXVkaSBBaXJsaW5lcyBDYXJnbyBDb21wYW55XCIsIFwibWFpbGd1bl9pZFwiOiBcIjwyMDE0MTAxMDE0MDIyMC41ODg4Ny41MjQ4NEBjdXN0b21lcm9ocS5jb20+XCIsIFwiZW1haWxfZ3Vlc3Nlc1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm8zM0phdmhTcHlcIn0sIHtcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJsM3Z5MlR4RjczXCJ9XSwgXCJlbWFpbFwiOiBcIm5vX2VtYWlsXCIsIFwicHJvc3BlY3RfY3JlYXRlZF9hdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTYuMTI3WlwiLCBcImNvbXBhbnlcIjoge1wiY2xhc3NOYW1lXCI6IFwiQ29tcGFueVwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImZxSFdwNU5zRnhcIn0sIFwibGlzdHNcIjogW3tcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0TGlzdFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIml6TGJWdWx5cjZcIn1dLCBcInVzZXJcIjoge1wiY2xhc3NOYW1lXCI6IFwiVXNlclwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInhXRVNpdzVTbWRcIn0sIFwiY29tcGFueV9zaXplXCI6IFwiMTAwMS01MDAwIGVtcGxveWVlc1wiLCBcIm5hbWVcIjogXCJSYWluZXIgTXVlbGxlclwiLCBcImluZHVzdHJ5XCI6IFwiQWlybGluZXMvQXZpYXRpb25cIiwgXCJsaW5rZWRpbl91cmxcIjogXCJzYS5saW5rZWRpbi5jb20vcHViL3JhaW5lci1tdWVsbGVyLzUvYTQ4LzQyOFwiLCBcImJhdGNoXCI6IHtcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0QmF0Y2hcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJZUGFUR2JENTZhXCJ9LCBcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0XCIsIFwicXVldWVkXCI6IHRydWV9LCB7XCJ3ZWJzaXRlXCI6IFwiaHR0cDovL3d3dy5zaGFkb3d6cHJvdGVjdGlvbi5jb21cIiwgXCJjYW1wYWlnblwiOiB7XCJjbGFzc05hbWVcIjogXCJDYW1wYWlnblwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm5tRWxVN3pjQmZcIn0sIFwicG9zXCI6IFwiXFxcXHUwMGEwRGlyZWN0b3JcIiwgXCJfX3R5cGVcIjogXCJPYmplY3RcIiwgXCJ1cGRhdGVkQXRcIjogXCIyMDE0LTEwLTEwVDEzOjI5OjIzLjU5OFpcIiwgXCJjcmVhdGVkQXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE1LjE0N1pcIiwgXCJjaXR5XCI6IFwiTmV3IERlbGhpIEFyZWEsIEluZGlhXFxcXHUwMGEwXCIsIFwiYXJjaGl2ZWRcIjogdHJ1ZSwgXCJsb2FkaW5nXCI6IGZhbHNlLCBcIm9wZW5lZFwiOiB0cnVlLCBcIm9iamVjdElkXCI6IFwiZjQ0WVUyWXJtN1wiLCBcImNvbXBhbnlfbmFtZVwiOiBcIk0vUyBHb2xkZW4gQnJpY2tzIENvbnN0cnVjdGlvbnMgUHZ0LiBMdGQuXCIsIFwibWFpbGd1bl9pZFwiOiBcIjwyMDE0MTAxMDE0MDIyMC4xOTk2MC4zMTU3QGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiNkI0TURxV3F0d1wifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImU5c01GTDFRV3hcIn1dLCBcImVtYWlsXCI6IFwibm9fZW1haWxcIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNS4xNDdaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIyMDEtNTAwIGVtcGxveWVlc1wiLCBcIm5hbWVcIjogXCJWaXZlayBOYXJhbmdcIiwgXCJpbmR1c3RyeVwiOiBcIlNlY3VyaXR5IGFuZCBJbnZlc3RpZ2F0aW9uc1wiLCBcImxpbmtlZGluX3VybFwiOiBcImluLmxpbmtlZGluLmNvbS9wdWIvdml2ZWstbmFyYW5nLzIwL2I2Ny8zOVwiLCBcImJhdGNoXCI6IHtcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0QmF0Y2hcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJZUGFUR2JENTZhXCJ9LCBcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0XCIsIFwicXVldWVkXCI6IHRydWV9LCB7XCJ3ZWJzaXRlXCI6IFwiaHR0cDovL3d3dy5zaGFuZ3JpLWxhLmNvbVwiLCBcImNhbXBhaWduXCI6IHtcImNsYXNzTmFtZVwiOiBcIkNhbXBhaWduXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibm1FbFU3emNCZlwifSwgXCJwb3NcIjogXCJcXFxcdTAwYTBEaXJlY3RvciBvZiBTYWxlcyBhbmQgTWFya2V0aW5nXCIsIFwiX190eXBlXCI6IFwiT2JqZWN0XCIsIFwidXBkYXRlZEF0XCI6IFwiMjAxNC0xMC0xMFQxMzoyOToyMy44ODBaXCIsIFwiY3JlYXRlZEF0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxMy4xOTdaXCIsIFwiY2l0eVwiOiBcIkJyaXNiYW5lLCBBdXN0cmFsaWFcXFxcdTAwYTBcIiwgXCJhcmNoaXZlZFwiOiB0cnVlLCBcImxvYWRpbmdcIjogZmFsc2UsIFwib2JqZWN0SWRcIjogXCJUU1NERVozbFVBXCIsIFwiY29tcGFueV9uYW1lXCI6IFwiU2hhbmdyaS1MYSBIb3RlbHMgYW5kIFJlc29ydHNcIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwMjIxLjM5NTQ4LjI5NjI3QGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiUElER0pQcXJhSVwifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm1HNFU2OXhEY2dcIn1dLCBcImVtYWlsXCI6IFwiYW5keS5tY2N1dGNoZW9uQHNoYW5ncmktbGEuY29tXCIsIFwicHJvc3BlY3RfY3JlYXRlZF9hdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTMuMTk3WlwiLCBcImNvbXBhbnlcIjoge1wiY2xhc3NOYW1lXCI6IFwiQ29tcGFueVwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImZxSFdwNU5zRnhcIn0sIFwibGlzdHNcIjogW3tcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0TGlzdFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIml6TGJWdWx5cjZcIn1dLCBcInVzZXJcIjoge1wiY2xhc3NOYW1lXCI6IFwiVXNlclwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInhXRVNpdzVTbWRcIn0sIFwiY29tcGFueV9zaXplXCI6IFwiMTAsMDAxKyBlbXBsb3llZXNcIiwgXCJuYW1lXCI6IFwiQW5keSBNY0N1dGNoZW9uXCIsIFwiaW5kdXN0cnlcIjogXCJIb3NwaXRhbGl0eVwiLCBcImxpbmtlZGluX3VybFwiOiBcImF1LmxpbmtlZGluLmNvbS9wdWIvYW5keS1tY2N1dGNoZW9uLzFhLzY2NS82NTBcIiwgXCJiYXRjaFwiOiB7XCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdEJhdGNoXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiWVBhVEdiRDU2YVwifSwgXCJjbGFzc05hbWVcIjogXCJQcm9zcGVjdFwiLCBcInF1ZXVlZFwiOiB0cnVlfSwge1wid2Vic2l0ZVwiOiBcImh0dHA6Ly93d3cudGVuY2F0ZS5jb21cIiwgXCJjYW1wYWlnblwiOiB7XCJjbGFzc05hbWVcIjogXCJDYW1wYWlnblwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm5tRWxVN3pjQmZcIn0sIFwicG9zXCI6IFwiXFxcXHUwMGEwRGlyZWN0b3IgU2FsZXMgJiBNYXJrZXRpbmcgQWVyb3NwYWNlXCIsIFwiX190eXBlXCI6IFwiT2JqZWN0XCIsIFwidXBkYXRlZEF0XCI6IFwiMjAxNC0xMC0xMFQxMzoyOToyMi41MTZaXCIsIFwiY3JlYXRlZEF0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxOC40ODFaXCIsIFwiY2l0eVwiOiBcIkNvdmVudHJ5LCBVbml0ZWQgS2luZ2RvbVxcXFx1MDBhMFwiLCBcImFyY2hpdmVkXCI6IHRydWUsIFwibG9hZGluZ1wiOiBmYWxzZSwgXCJvYmplY3RJZFwiOiBcImZ0eUtDR21SOUhcIiwgXCJjb21wYW55X25hbWVcIjogXCJUZW5jYXRlXCIsIFwibWFpbGd1bl9pZFwiOiBcIjwyMDE0MTAxMDE0MDgxMy4xOTk1Ni4yMDQ1NEBjdXN0b21lcm9ocS5jb20+XCIsIFwiZW1haWxfZ3Vlc3Nlc1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInU4U2V0Q1FPSlBcIn0sIHtcImNsYXNzTmFtZVwiOiBcIkVtYWlsR3Vlc3NcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJQMEttRkc5MmRLXCJ9XSwgXCJlbWFpbFwiOiBcIm4udGlmZmluQHRlbmNhdGUuY29tXCIsIFwicHJvc3BlY3RfY3JlYXRlZF9hdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTguNDgxWlwiLCBcImNvbXBhbnlcIjoge1wiY2xhc3NOYW1lXCI6IFwiQ29tcGFueVwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImZxSFdwNU5zRnhcIn0sIFwibGlzdHNcIjogW3tcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0TGlzdFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIml6TGJWdWx5cjZcIn1dLCBcInVzZXJcIjoge1wiY2xhc3NOYW1lXCI6IFwiVXNlclwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInhXRVNpdzVTbWRcIn0sIFwiY29tcGFueV9zaXplXCI6IFwiMTAwMS01MDAwIGVtcGxveWVlc1wiLCBcIm5hbWVcIjogXCJOaWNrIFRpZmZpblwiLCBcImluZHVzdHJ5XCI6IFwiVGV4dGlsZXNcIiwgXCJsaW5rZWRpbl91cmxcIjogXCJ1ay5saW5rZWRpbi5jb20vcHViL25pY2stdGlmZmluLzUvNDM0LzI1NlwiLCBcImJhdGNoXCI6IHtcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0QmF0Y2hcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJZUGFUR2JENTZhXCJ9LCBcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0XCIsIFwicXVldWVkXCI6IHRydWV9LCB7XCJ3ZWJzaXRlXCI6IFwiaHR0cDovL3d3dy5wZWFyc29uLmNvbVwiLCBcImNhbXBhaWduXCI6IHtcImNsYXNzTmFtZVwiOiBcIkNhbXBhaWduXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibm1FbFU3emNCZlwifSwgXCJwb3NcIjogXCJcXFxcdTAwYTBEaXJlY3RvciwgU2FsZXMgUGVyZm9ybWFuY2UgTWFuYWdlbWVudFwiLCBcIl9fdHlwZVwiOiBcIk9iamVjdFwiLCBcInVwZGF0ZWRBdFwiOiBcIjIwMTQtMTAtMTBUMTM6Mjk6MjIuNzgwWlwiLCBcImNyZWF0ZWRBdFwiOiBcIjIwMTQtMTAtMDdUMTU6MjA6MTcuODczWlwiLCBcImNpdHlcIjogXCJQaG9lbml4LCBBcml6b25hIEFyZWFcXFxcdTAwYTBcIiwgXCJhcmNoaXZlZFwiOiB0cnVlLCBcImxvYWRpbmdcIjogZmFsc2UsIFwib2JqZWN0SWRcIjogXCJMUGlFMENjRXNSXCIsIFwiY29tcGFueV9uYW1lXCI6IFwiUGVhcnNvbiBwbGNcIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwODEzLjU4ODgxLjg1NzMzQGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiUTU3a3dOMUxRVFwifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIjUzSzBsV1k3aHZcIn1dLCBcImVtYWlsXCI6IFwiamFzb24ubGlua2VkaW5AcGVhcnNvbi5jb21cIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNy44NzNaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIxMCwwMDErIGVtcGxveWVlc1wiLCBcIm5hbWVcIjogXCJKYXNvbiBVcGFoXCIsIFwiaW5kdXN0cnlcIjogXCJFZHVjYXRpb24gTWFuYWdlbWVudFwiLCBcImxpbmtlZGluX3VybFwiOiBcInd3dy5saW5rZWRpbi5jb20vcHViL2phc29uLXVwYWgvNy8yMzMvOTQwXCIsIFwiYmF0Y2hcIjoge1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RCYXRjaFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIllQYVRHYkQ1NmFcIn0sIFwiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RcIiwgXCJxdWV1ZWRcIjogdHJ1ZX0sIHtcIndlYnNpdGVcIjogXCJodHRwOi8vd3d3LnJtd211c2ljLmNvbVwiLCBcImNhbXBhaWduXCI6IHtcImNsYXNzTmFtZVwiOiBcIkNhbXBhaWduXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibm1FbFU3emNCZlwifSwgXCJwb3NcIjogXCJcXFxcdTAwYTBEaXJlY3RvciBvZiBTYWxlcyBhbmQgTWFya2V0aW5nXCIsIFwiX190eXBlXCI6IFwiT2JqZWN0XCIsIFwidXBkYXRlZEF0XCI6IFwiMjAxNC0xMC0xMFQxMzoyOToyMy4wNDlaXCIsIFwiY3JlYXRlZEF0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNi43MzVaXCIsIFwiY2l0eVwiOiBcIlRvcm9udG8sIE9udGFyaW8sIENhbmFkYVxcXFx1MDBhMFwiLCBcImFyY2hpdmVkXCI6IHRydWUsIFwibG9hZGluZ1wiOiBmYWxzZSwgXCJvcGVuZWRcIjogdHJ1ZSwgXCJvYmplY3RJZFwiOiBcIkNPU3B5WGdzRDJcIiwgXCJjb21wYW55X25hbWVcIjogXCJSTVcgTXVzaWNcIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwODE0LjE5OTM4LjkwMTY5QGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiM09FS3RJeElBcFwifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcInh2R2JVWXBvNDNcIn1dLCBcImVtYWlsXCI6IFwibm9fZW1haWxcIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNi43MzVaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIxMS01MCBlbXBsb3llZXNcIiwgXCJuYW1lXCI6IFwiTGF1cmEgTmlrb2xpY1wiLCBcImluZHVzdHJ5XCI6IFwiTXVzaWNcIiwgXCJsaW5rZWRpbl91cmxcIjogXCJjYS5saW5rZWRpbi5jb20vcHViL2xhdXJhLW5pa29saWMvNTAvNDUwLzc3MVwiLCBcImJhdGNoXCI6IHtcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0QmF0Y2hcIiwgXCJfX3R5cGVcIjogXCJQb2ludGVyXCIsIFwib2JqZWN0SWRcIjogXCJZUGFUR2JENTZhXCJ9LCBcImNsYXNzTmFtZVwiOiBcIlByb3NwZWN0XCIsIFwicXVldWVkXCI6IHRydWV9LCB7XCJ3ZWJzaXRlXCI6IFwiaHR0cDovL3d3dy5zYXVkaWFjYXJnby5jb21cIiwgXCJjYW1wYWlnblwiOiB7XCJjbGFzc05hbWVcIjogXCJDYW1wYWlnblwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIm5tRWxVN3pjQmZcIn0sIFwicG9zXCI6IFwiXFxcXHUwMGEwRGlyZWN0b3IgR2xvYmFsIFNhbGVzIFN1cHBvcnRcIiwgXCJfX3R5cGVcIjogXCJPYmplY3RcIiwgXCJ1cGRhdGVkQXRcIjogXCIyMDE0LTEwLTEwVDEzOjI5OjIzLjMyN1pcIiwgXCJjcmVhdGVkQXRcIjogXCIyMDE0LTEwLTA3VDE1OjIwOjE2LjEyN1pcIiwgXCJjaXR5XCI6IFwiU2F1ZGkgQXJhYmlhXFxcXHUwMGEwXCIsIFwiYXJjaGl2ZWRcIjogdHJ1ZSwgXCJsb2FkaW5nXCI6IGZhbHNlLCBcIm9wZW5lZFwiOiB0cnVlLCBcIm9iamVjdElkXCI6IFwiS2UwNmc2a1NrNVwiLCBcImNvbXBhbnlfbmFtZVwiOiBcIlNhdWRpIEFpcmxpbmVzIENhcmdvIENvbXBhbnlcIiwgXCJtYWlsZ3VuX2lkXCI6IFwiPDIwMTQxMDEwMTQwODE0Ljc3Mzg2Ljc0OTQzQGN1c3RvbWVyb2hxLmNvbT5cIiwgXCJlbWFpbF9ndWVzc2VzXCI6IFt7XCJjbGFzc05hbWVcIjogXCJFbWFpbEd1ZXNzXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwibzMzSmF2aFNweVwifSwge1wiY2xhc3NOYW1lXCI6IFwiRW1haWxHdWVzc1wiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcImwzdnkyVHhGNzNcIn1dLCBcImVtYWlsXCI6IFwibm9fZW1haWxcIiwgXCJwcm9zcGVjdF9jcmVhdGVkX2F0XCI6IFwiMjAxNC0xMC0wN1QxNToyMDoxNi4xMjdaXCIsIFwiY29tcGFueVwiOiB7XCJjbGFzc05hbWVcIjogXCJDb21wYW55XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiZnFIV3A1TnNGeFwifSwgXCJsaXN0c1wiOiBbe1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RMaXN0XCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwiaXpMYlZ1bHlyNlwifV0sIFwidXNlclwiOiB7XCJjbGFzc05hbWVcIjogXCJVc2VyXCIsIFwiX190eXBlXCI6IFwiUG9pbnRlclwiLCBcIm9iamVjdElkXCI6IFwieFdFU2l3NVNtZFwifSwgXCJjb21wYW55X3NpemVcIjogXCIxMDAxLTUwMDAgZW1wbG95ZWVzXCIsIFwibmFtZVwiOiBcIlJhaW5lciBNdWVsbGVyXCIsIFwiaW5kdXN0cnlcIjogXCJBaXJsaW5lcy9BdmlhdGlvblwiLCBcImxpbmtlZGluX3VybFwiOiBcInNhLmxpbmtlZGluLmNvbS9wdWIvcmFpbmVyLW11ZWxsZXIvNS9hNDgvNDI4XCIsIFwiYmF0Y2hcIjoge1wiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RCYXRjaFwiLCBcIl9fdHlwZVwiOiBcIlBvaW50ZXJcIiwgXCJvYmplY3RJZFwiOiBcIllQYVRHYkQ1NmFcIn0sIFwiY2xhc3NOYW1lXCI6IFwiUHJvc3BlY3RcIiwgXCJxdWV1ZWRcIjogdHJ1ZX1dXG4gIH0sXG5cbn0pO1xuIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIC8vIFNlbnQgTWFpbFxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBzZW50RW1haWxzOiBbXVxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpc3MgPSB0aGlzO1xuICAgIHFyeSA9IHtcbiAgICAgIGluY2x1ZGU6ICdjYW1wYWlnbixwcm9zcGVjdCxwcm9zcGVjdC5lbWFpbF9ndWVzc2VzLnBhdHRlcm4nLFxuICAgICAgb3JkZXI6Jy1jcmVhdGVkQXQnLFxuICAgICAgY2FtcGFpZ246IHtcbiAgICAgICAgX190eXBlOiAnUG9pbnRlcicsXG4gICAgICAgIGNsYXNzTmFtZTonQ2FtcGFpZ24nLFxuICAgICAgICBvYmplY3RJZDogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLm9iamVjdElkLFxuICAgICAgfVxuICAgIH1cbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOiAnaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9TZW50RW1haWwnLFxuICAgICAgZGF0YTogcXJ5LFxuICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgdGhpc3Muc2V0U3RhdGUoe3NlbnRFbWFpbHM6IHJlcy5yZXN1bHRzfSkgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbigpIHt9XG4gICAgfSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHNlbnRFbWFpbHMgPSBbXVxuICAgIGZvcihpPTA7aTwgdGhpcy5zdGF0ZS5zZW50RW1haWxzLmxlbmd0aDsgaSsrKSBcbiAgICAgIHNlbnRFbWFpbHMucHVzaChTZW50RW1haWxSb3coe3NlbnRFbWFpbDogdGhpcy5zdGF0ZS5zZW50RW1haWxzW2ldfSkpXG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7c3R5bGU6IHtvdmVyZmxvdzonYXV0bycsaGVpZ2h0OjQxN319LCBcbiAgICAgICAgUmVhY3QuRE9NLnRhYmxlKHtjbGFzc05hbWU6IFwidGFibGUgdGFibGUtc3RyaXBlZFwiLCBzdHlsZToge21hcmdpbkJvdHRvbTowfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS50aGVhZChudWxsLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00udGgobnVsbCwgXCJQcm9zcGVjdCBOYW1lXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlByb3NwZWN0IEVtYWlsXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlRlbXBsYXRlXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aCh7c3R5bGU6IHt3aWR0aDoyOTB9fSwgXCJTdGF0dXNcIilcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udGJvZHkobnVsbCwgXG4gICAgICAgICAgICBzZW50RW1haWxzXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgKTtcbiAgfVxufSk7XG5cbnZhciBTZW50RW1haWxSb3cgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdTZW50RW1haWxSb3cnLFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHNlbnRFbWFpbCA9IHRoaXMucHJvcHMuc2VudEVtYWlsXG4gICAgLy9jb25zb2xlLmxvZyhzZW50RW1haWwpXG5cbiAgICBlbWFpbCA9IHNlbnRFbWFpbC5lbWFpbFxuICAgIC8qXG4gICAgaWYoZW1haWwgPT0gXCJub19lbWFpbFwiKXtcbiAgICAgIGZpcnN0ID0gc2VudEVtYWlsLnByb3NwZWN0Lm5hbWUuc3BsaXQoJyAnKVswXVxuICAgICAgbGFzdCA9IF8ubGFzdChzZW50RW1haWwucHJvc3BlY3QubmFtZS5zcGxpdCgnICcpKVxuXG4gICAgICBwYXR0ZXJuID0gXy5maW5kV2hlcmUoc2VudEVtYWlsLnByb3NwZWN0LmVtYWlsX2d1ZXNzZXMsIHsndHJpZWQnOmZhbHNlfSlcbiAgICAgIGRhdGEgPSB7Zmlyc3Q6IGZpcnN0LCBsYXN0OiBsYXN0LCBmaTogZmlyc3RbMF0sIGxpOiBsYXN0WzBdfVxuICAgICAgZW1haWwgPSBNdXN0YWNoZS5yZW5kZXIocGF0dGVybi5wYXR0ZXJuLnBhdHRlcm4sIGRhdGEpLnRvTG93ZXJDYXNlKClcbiAgICB9XG4gICAgKi9cblxuICAgIHJlcGxpZWQgPSBcImxhYmVsIGxhYmVsLWRlZmF1bHRcIlxuICAgIG9wZW5lZCA9IFwibGFiZWwgbGFiZWwtZGVmYXVsdFwiXG4gICAgZGVsaXZlcmVkID0gXCJsYWJlbCBsYWJlbC1kZWZhdWx0XCJcbiAgICBxdWV1ZWQgPSBcImxhYmVsIGxhYmVsLWRlZmF1bHRcIlxuXG4gICAgaWYoc2VudEVtYWlsLnJlcGxpZWQpIFxuICAgICAgcmVwbGllZCA9IFwibGFiZWwgbGFiZWwtc3VjY2Vzc1wiXG4gICAgaWYoc2VudEVtYWlsLm9wZW5lZCkgXG4gICAgICBvcGVuZWQgPSBcImxhYmVsIGxhYmVsLXN1Y2Nlc3NcIlxuICAgIGlmKHNlbnRFbWFpbC5kZWxpdmVyZWQpIFxuICAgICAgZGVsaXZlcmVkID0gXCJsYWJlbCBsYWJlbC1zdWNjZXNzXCJcbiAgICBpZihzZW50RW1haWwucXVldWVkKSBcbiAgICAgIHF1ZXVlZCA9IFwibGFiZWwgbGFiZWwtc3VjY2Vzc1wiXG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLnRyKG51bGwsIFxuICAgICAgICBSZWFjdC5ET00udGQoe3N0eWxlOiB7d2lkdGg6MTAwfX0sIFJlYWN0LkRPTS5oNihudWxsLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2xvY2tcIn0pLCBcbiAgICAgICAgICAgIG1vbWVudChzZW50RW1haWwuY3JlYXRlZEF0KS5mcm9tTm93KCkpKSwgXG4gICAgICAgIFJlYWN0LkRPTS50ZCh7c3R5bGU6IHt3aWR0aDoyMDB9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge2ZvbnRTaXplOjE0LGZvbnRXZWlnaHQ6J2JvbGQnLG1hcmdpbkJvdHRvbTowfX0sIFxuICAgICAgICAgICAgc2VudEVtYWlsLnByb3NwZWN0Lm5hbWUpLCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7Zm9udFN0eWxlOidpdGFsaWMnLG1hcmdpblRvcDo0LG1hcmdpbkJvdHRvbTowfX0sIFxuICAgICAgICAgICAgc2VudEVtYWlsLnByb3NwZWN0LnBvcy50cmltKCkpLCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luVG9wOjQsZm9udFdlaWdodDonYm9sZCd9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWJ1aWxkaW5nXCJ9KSwgXCLCoFwiLCBcbiAgICAgICAgICAgIHNlbnRFbWFpbC5wcm9zcGVjdC5jb21wYW55X25hbWUpXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00udGQoe3N0eWxlOiB7d2lkdGg6MjAwfX0sIFJlYWN0LkRPTS5oNihudWxsLCBlbWFpbCkpLCBcbiAgICAgICAgUmVhY3QuRE9NLnRkKG51bGwsIFxuICAgICAgICAgIFJlYWN0LkRPTS5oNihudWxsLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZmlsZS10ZXh0LW9cIn0pLCBcIsKgXCIgKyAnICcgK1xuICAgICAgICAgICAgXCJUZW1wbGF0ZVwiXG4gICAgICAgICAgKVxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLnRkKHtzdHlsZToge3BhZGRpbmdUb3A6MTN9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogcXVldWVkfSwgXCJRdWV1ZWRcIiksIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hldnJvbi1jaXJjbGUtcmlnaHQgdGV4dC1tdXRlZFwiLCBcbiAgICAgICAgICAgICBzdHlsZToge3BhZGRpbmdMZWZ0OjUscGFkZGluZ1JpZ2h0OjV9fSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IGRlbGl2ZXJlZH0sIFwiRGVsaXZlcmVkXCIpLCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWNoZXZyb24tY2lyY2xlLXJpZ2h0IHRleHQtbXV0ZWRcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtwYWRkaW5nTGVmdDo1LHBhZGRpbmdSaWdodDo1fX0pLCBcbiAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBvcGVuZWR9LCBcIk9wZW5lZFwiKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGV2cm9uLWNpcmNsZS1yaWdodCB0ZXh0LW11dGVkXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7cGFkZGluZ0xlZnQ6NSxwYWRkaW5nUmlnaHQ6NX19KSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogcmVwbGllZH0sIFwiUmVwbGllZFwiKVxuICAgICAgICApXG4gICAgICApXG4gICAgKVxuICB9XG59KVxuIiwiLyoqIEBqc3ggcmVhY3QuZG9tICovXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIFxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgJCgnLnRlbXBsYXRlLWJvZHknKS5odG1sKHRoaXMuc3RhdGUudGVtcGxhdGVCb2R5KVxuICB9LFxuXG4gIGNsaWNrZWRPdmVybGF5OiBmdW5jdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZygnY2xpY2tlZCBvdmVybGF5JylcbiAgICB0aGlzLnByb3BzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUoKVxuICB9LFxuXG4gIGNoYW5nZU1vZGU6IGZ1bmN0aW9uKCkge1xuICAgIC8vIFVwZGF0ZSB0ZW1wbGF0ZSBodG1sIG9uIHRvZ2dsZVxuICAgIGNvbnNvbGUubG9nKCdFRElUIE1PREUnKVxuICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdGUuZWRpdE1vZGUpXG4gICAgcGFyc2VfaGVhZGVycyA9IGFwcENvbmZpZy5wYXJzZUhlYWRlcnNcbiAgICBpZih0aGlzLnN0YXRlLmVkaXRNb2RlKXtcbiAgICAgICQoJy5zdW1tZXInKS5kZXN0cm95KCk7XG4gICAgICB0aGlzLnByb3BzLnNhdmVUZW1wbGF0ZSh7XG4gICAgICAgIG5hbWU6IHRoaXMuc3RhdGUubmFtZSxcbiAgICAgICAgdGVtcGxhdGVCb2R5OiAkKCcuc3VtbWVyJykuY29kZSgpLFxuICAgICAgICB0ZW1wbGF0ZVN1YmplY3Q6ICQoJy5zdWJqZWN0JykudmFsKCksXG4gICAgICB9KVxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIHRlbXBsYXRlQm9keTogJCgnLnN1bW1lcicpLmNvZGUoKSxcbiAgICAgICAgdGVtcGxhdGVTdWJqZWN0OiAkKCcuc3ViamVjdCcpLnZhbCgpLFxuICAgICAgICBlZGl0TW9kZTogIXRoaXMuc3RhdGUuZWRpdE1vZGUsXG4gICAgICB9KVxuICAgICAgJC5hamF4KHtcbiAgICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL1RlbXBsYXRlcy8nK3RoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLm9iamVjdElkLFxuICAgICAgICB0eXBlOidQVVQnLFxuICAgICAgICBoZWFkZXJzOnBhcnNlX2hlYWRlcnMsXG4gICAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkoe2JvZHk6ICQoJy5zdW1tZXInKS5jb2RlKCksc3ViamVjdDogJCgnLnN1YmplY3QnKS52YWwoKX0pLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgZWRpdE1vZGU6ICF0aGlzLnN0YXRlLmVkaXRNb2RlIH0pXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgLyogdGhpc3MgPSB0aGlzOyAqL1xuXG4gICAgY29uc29sZS5sb2coJ09USEVSJylcbiAgICBpZih0aGlzLnN0YXRlLmVkaXRNb2RlKXtcbiAgICAgIGNvbnNvbGUubG9nKCdDQUxMRUQnKVxuICAgICAgLy8gUmVwbGFjZSBTdWJqZWN0IFxuICAgICAgJCgnLnN1YmplY3QnKS52YWwodGhpcy5zdGF0ZS50ZW1wbGF0ZVN1YmplY3QpXG5cbiAgICAgICQoJy5zdW1tZXInKS5zdW1tZXJub3RlKHtcbiAgICAgICAgaGVpZ2h0OiAyMDAsXG4gICAgICAgIHRvb2xiYXI6IFtcbiAgICAgICAgICBbJ3N0eWxlJywgWydib2xkJywgJ2l0YWxpYycsICd1bmRlcmxpbmUnLCAnY2xlYXInXV0sXG4gICAgICAgICAgWydmb250JywgWydzdHJpa2V0aHJvdWdoJ11dLFxuICAgICAgICAgIFsnZm9udHNpemUnLCBbJ2ZvbnRzaXplJ11dLFxuICAgICAgICAgIFsnY29sb3InLCBbJ2NvbG9yJ11dLFxuICAgICAgICAgIFsncGFyYScsIFsndWwnLCAnb2wnLCAncGFyYWdyYXBoJ11dLFxuICAgICAgICAgIFsnaGVpZ2h0JywgWydoZWlnaHQnXV0sXG4gICAgICAgIF1cbiAgICAgIH0pXG5cbiAgICAgIC8vIEluaXRpYWxpemUgRWRpdG9yIHdpdGggaHRtbFxuICAgICAgJCgnLnN1bW1lcicpLmNvZGUodGhpcy5zdGF0ZS50ZW1wbGF0ZUJvZHkpXG4gICAgfVxuICB9LFxuXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBzdWJqZWN0UGxhY2UgPSAodGhpcy5zdGF0ZS5lZGl0TW9kZSkgPyByZWFjdC5kb20uaW5wdXQoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lJyx3aWR0aDo0ODB9LCBjbGFzc05hbWU6IFwiZm9ybS1jb250cm9sIHN1YmplY3RcIn0pIDogdGhpcy5zdGF0ZS50ZW1wbGF0ZVN1YmplY3RcblxuICAgIGlmKHRoaXMuc3RhdGUuZWRpdE1vZGUpe1xuICAgICAgIHRvZ2dsZUJ1dHRvbiA9IHJlYWN0LmRvbS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuY2hhbmdlTW9kZSwgXG4gICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4teHNcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidibG9jaycsZmxvYXQ6J3JpZ2h0JyxtYXJnaW5Ub3A6NX19LCBcbiAgICAgICAgICAgIHJlYWN0LmRvbS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtc2F2ZVwifSksIFwiIMKgIFNhdmUgVGVtcGxhdGVcIilcbiAgICB9IGVsc2Uge1xuICAgICAgIHRvZ2dsZUJ1dHRvbiA9IHJlYWN0LmRvbS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuY2hhbmdlTW9kZSwgXG4gICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tcHJpbWFyeSBidG4teHNcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidibG9jaycsZmxvYXQ6J3JpZ2h0JyxtYXJnaW5Ub3A6NX19LCBcbiAgICAgICAgICAgIHJlYWN0LmRvbS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGVuY2lsLXNxdWFyZVwifSksIFwiIMKgIEVkaXQgVGVtcGxhdGVcIilcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgcmVhY3QuZG9tLmRpdihudWxsLCBcbiAgICAgIHJlYWN0LmRvbS5kaXYoe29uQ2xpY2s6IHRoaXMuY2xpY2tlZE92ZXJsYXksIGlkOiBcImVkaXRUZW1wbGF0ZU92ZXJsYXlcIn0pLCBcbiAgICAgIHJlYWN0LmRvbS5kaXYoe2lkOiBcImVkaXRUZW1wbGF0ZVZpZXdcIiwgXG4gICAgICAgICAgIGNsYXNzTmFtZTogXCJwYW5lbCBwYW5lbC1pbmZvXCIsIFxuICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6J2Jsb2NrJ319LCBcbiAgICAgICAgICAgcmVhY3QuZG9tLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWhlYWRpbmdcIiwgc3R5bGU6IHtoZWlnaHQ6NTB9fSwgXG4gICAgICAgICAgICAgcmVhY3QuZG9tLmg2KHtzdHlsZToge2Zsb2F0OidsZWZ0J319LCBcbiAgICAgICAgICAgICAgIHJlYWN0LmRvbS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZmlsZS10ZXh0LW9cIn0pLCBcbiAgICAgICAgICAgICAgIFwiICBcIiArIHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLm5hbWVcbiAgICAgICAgICAgICApLCBcbiAgICAgICAgICB0b2dnbGVCdXR0b25cbiAgICAgICAgKSwgXG4gICAgICAgIHJlYWN0LmRvbS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbC1ib2R5XCJ9LCBcbiAgICAgICAgICByZWFjdC5kb20uZGl2KHtjbGFzc05hbWU6IFwiZWRpdFRlbXBsYXRlVGl0bGVcIn0sIFxuICAgICAgICAgICAgcmVhY3QuZG9tLnNwYW4obnVsbCwgXCJTdWJqZWN0OiBcIiksIFxuICAgICAgICAgICAgc3ViamVjdFBsYWNlXG4gICAgICAgICAgKSwgXG4gICAgICAgICByZWFjdC5kb20uYnIobnVsbCksIFxuICAgICAgICAgcmVhY3QuZG9tLmRpdih7Y2xhc3NOYW1lOiBcInRlbXBsYXRlRGV0YWlsc1wifSwgXG4gICAgICAgICAgIHJlYWN0LmRvbS5oNih7c3R5bGU6IHttYXJnaW5Cb3R0b206JzAnfSwgY2xhc3NOYW1lOiBcInRleHQtbXV0ZWRcIn0sIFxuICAgICAgICAgICAgIFwiQ3JlYXRlZCBieSBNYXJrIG9uIEp1bC4gMjEsIDIwMTRcIlxuICAgICAgICAgICApLCBcbiAgICAgICAgICAgcmVhY3QuZG9tLmg2KHtzdHlsZToge21hcmdpblRvcDonMCd9LCBjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgICAgXCJsYXN0IHVwZGF0ZWQgNyBkYXlzIGFnb1wiXG4gICAgICAgICAgIClcbiAgICAgICAgICksIFxuICAgICAgICByZWFjdC5kb20uYnIobnVsbCksIFxuICAgICAgICByZWFjdC5kb20uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwgcGFuZWwtZGVmYXVsdFwifSwgXG4gICAgICAgICAgcmVhY3QuZG9tLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWJvZHkgc3VtbWVyIHRlbXBsYXRlLWJvZHlcIn1cbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICApXG4pXG4pXG4gICAgKTtcbiAgfVxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5wcm9wcy5pbml0aWFsVGVtcGxhdGVWYWx1ZXMubmFtZSxcbiAgICAgIGJvZHk6IHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLmJvZHksXG4gICAgICBzdWJqZWN0OiB0aGlzLnByb3BzLmluaXRpYWxUZW1wbGF0ZVZhbHVlcy5zdWJqZWN0LFxuICAgICAgZWRpdE1vZGU6IHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLmVkaXRNb2RlXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZygnZGlkIG1vdW50JylcbiAgICAkKCcudGVtcGxhdGUtYm9keScpLmh0bWwodGhpcy5zdGF0ZS5ib2R5KVxuICAgIGlmKHRoaXMuc3RhdGUuZWRpdE1vZGUpIHtcbiAgICAgICQoJy5zdW1tZXInKS5zdW1tZXJub3RlKHtcbiAgICAgICAgaGVpZ2h0OiAyMDAsXG4gICAgICAgIHRvb2xiYXI6IFtcbiAgICAgICAgICBbJ3N0eWxlJywgWydib2xkJywgJ2l0YWxpYycsICd1bmRlcmxpbmUnLCAnY2xlYXInXV0sXG4gICAgICAgICAgWydmb250JywgWydzdHJpa2V0aHJvdWdoJ11dLFxuICAgICAgICAgIFsnZm9udHNpemUnLCBbJ2ZvbnRzaXplJ11dLFxuICAgICAgICAgIFsnY29sb3InLCBbJ2NvbG9yJ11dLFxuICAgICAgICAgIFsncGFyYScsIFsndWwnLCAnb2wnLCAncGFyYWdyYXBoJ11dLFxuICAgICAgICAgIFsnaGVpZ2h0JywgWydoZWlnaHQnXV0sXG4gICAgICAgIF1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmVuZGVyanNvbi5zZXRfc2hvd190b19sZXZlbCgnYWxsJylcbiAgICBwcm9zcGVjdCA9IF8ucGljayh0aGlzLnByb3BzLnByb3NwZWN0LCBcbiAgICAgICdjb21wYW55X25hbWUnLCAnbmFtZScsICdwb3MnXG4gICAgKVxuICAgIHByb3NwZWN0LmZpcnN0X25hbWUgPSBwcm9zcGVjdC5uYW1lLnNwbGl0KCcgJylbMF1cbiAgICBwcm9zcGVjdC5sYXN0X25hbWUgPSBfLmxhc3QocHJvc3BlY3QubmFtZS5zcGxpdCgnICcpKVxuICAgIHByb3NwZWN0ID0gXy5vbWl0KHByb3NwZWN0LCAnbmFtZScpXG5cbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXRUZW1wbGF0ZVwiKS5hcHBlbmRDaGlsZChyZW5kZXJqc29uKHByb3NwZWN0KSk7XG4gICAgJCgnI2VkaXRUZW1wbGF0ZU92ZXJsYXknKS5odG1sKClcbiAgICB0aGlzcyA9IHRoaXM7XG4gICAgJCgnLnJlbmRlcmpzb24nKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgIHRoaXNzLnByb3BzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUoKVxuICAgIH0pXG5cbiAgICAkKCcucmVuZGVyanNvbicpLmNzcyh7XG4gICAgICAncG9zaXRpb24nOiAnYWJzb2x1dGUnLFxuICAgICAgJ3otaW5kZXgnOiAnMTAwMDAwMDAwMCcsXG4gICAgICAnYmFja2dyb3VuZC1jb2xvcic6J3JnYmEoMCwwLDAsMCknLFxuICAgICAgJ2JvcmRlcic6JzAnLFxuICAgICAgJ2NvbG9yJzond2hpdGUnLFxuICAgICAgJ21hcmdpbi10b3AnOicwcHgnLFxuICAgICAgJ2hlaWdodCc6ICc1NDJweCcsXG4gICAgICAnb3ZlcmZsb3cnOidhdXRvJyxcbiAgICAgICd3aWR0aCc6JzM4MHB4J1xuICAgIH0pXG5cbiAgICAkKCcua2V5JykuY3NzKHtcbiAgICAgICdjdXJzb3InOidwb2ludGVyJ1xuICAgIH0pXG5cbiAgICAkKCcudGltZWxpbmUnKS5jc3Moe1xuICAgICAgJy13ZWJraXQtZmlsdGVyJzogJ2JsdXIoMTBweCknLFxuICAgIH0pXG4gICAgJCgnI2NhbXBhaWduLXRvcC1kZXRhaWwnKS5jc3Moe1xuICAgICAgJy13ZWJraXQtZmlsdGVyJzogJ2JsdXIoMTBweCknLFxuICAgIH0pXG4gIH0sXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50OmZ1bmN0aW9uKCkge1xuICAgICQoJy50aW1lbGluZScpLmNzcyh7XG4gICAgICAnLXdlYmtpdC1maWx0ZXInOiAnJyxcbiAgICB9KVxuICAgICQoJyNjYW1wYWlnbi10b3AtZGV0YWlsJykuY3NzKHtcbiAgICAgICctd2Via2l0LWZpbHRlcic6ICcnLFxuICAgIH0pXG4gIH0sXG5cbiAgY2xpY2tlZE92ZXJsYXk6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIG92ZXJsYXknKVxuICAgIHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSgpXG4gIH0sXG5cbiAgY2hhbmdlTW9kZTogZnVuY3Rpb24oKSB7XG4gICAgLy8gVXBkYXRlIHRlbXBsYXRlIGh0bWwgb24gdG9nZ2xlXG4gICAgcGFyc2VfaGVhZGVycyA9IGFwcENvbmZpZy5wYXJzZUhlYWRlcnNcbiAgICBpZih0aGlzLnN0YXRlLmVkaXRNb2RlKXtcbiAgICAgICQoJy5zdW1tZXInKS5kZXN0cm95KCk7XG4gICAgICAkKCcudGltZWxpbmUnKS5jc3Moe1xuICAgICAgICAnLXdlYmtpdC1maWx0ZXInOiAnYmx1cigyMHB4KScsXG4gICAgICB9KVxuXG4gICAgICBjb25zb2xlLmxvZygnbG9vayBhdCB0aGlzJylcbiAgICAgIGNvbnNvbGUubG9nKG5hbWUpXG4gICAgICBuYW1lID0gKHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLm5ld1RlbXBsYXRlKSA/ICQoJyN0ZW1wbGF0ZS1uYW1lJykudmFsKCkgOiB0aGlzLnN0YXRlLm5hbWVcbiAgICAgIHRoaXMucHJvcHMuc2F2ZVRlbXBsYXRlKHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgYm9keTogJCgnLnN1bW1lcicpLmNvZGUoKSxcbiAgICAgICAgc3ViamVjdDogJCgnLnN1YmplY3QnKS52YWwoKSxcbiAgICAgIH0sIHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLm5ld1RlbXBsYXRlKVxuXG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgbmFtZTogJCgnI3RlbXBsYXRlLW5hbWUnKS52YWwoKSxcbiAgICAgICAgYm9keTogJCgnLnN1bW1lcicpLmNvZGUoKSxcbiAgICAgICAgc3ViamVjdDogJCgnLnN1YmplY3QnKS52YWwoKSxcbiAgICAgICAgZWRpdE1vZGU6ICF0aGlzLnN0YXRlLmVkaXRNb2RlLFxuICAgICAgfSlcblxuICAgICAgb2JqSWQgPSB0aGlzLnByb3BzLmluaXRpYWxUZW1wbGF0ZVZhbHVlcy5vYmplY3RJZFxuICAgICAgJC5hamF4KHtcbiAgICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL1RlbXBsYXRlcy8nK29iaklkLFxuICAgICAgICB0eXBlOidQVVQnLFxuICAgICAgICBoZWFkZXJzOnBhcnNlX2hlYWRlcnMsXG4gICAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkoe2JvZHk6ICQoJy5zdW1tZXInKS5jb2RlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3Q6ICQoJy5zdWJqZWN0JykudmFsKCl9KSxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgY29uc29sZS5sb2cocmVzKVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGVkaXRNb2RlOiAhdGhpcy5zdGF0ZS5lZGl0TW9kZSB9KVxuICAgICAgJCgnLnRpbWVsaW5lJykuY3NzKHtcbiAgICAgICAgJy13ZWJraXQtZmlsdGVyJzogJ2JsdXIoMjBweCknLFxuICAgICAgfSlcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50V2lsbFVwZGF0ZTogZnVuY3Rpb24obmV3UHJvcHMpIHtcbiAgICBjb25zb2xlLmxvZygnVEhFIE5FVyBQUk9QUycpXG4gICAgY29uc29sZS5sb2cobmV3UHJvcHMpXG4gIH0sXG5cbiAgY29tcG9uZW50RGlkVXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICAvKiB0aGlzcyA9IHRoaXM7ICovXG4gICAgY29uc29sZS5sb2coJ09USEVSJylcbiAgICBpZih0aGlzLnN0YXRlLmVkaXRNb2RlKXtcbiAgICAgIGNvbnNvbGUubG9nKCdDQUxMRUQnKVxuICAgICAgLy8gUmVwbGFjZSBTdWJqZWN0IFxuICAgICAgJCgnLnN1YmplY3QnKS52YWwodGhpcy5zdGF0ZS5zdWJqZWN0KVxuICAgICAgJCgnI3RlbXBsYXRlLW5hbWUnKS52YWwodGhpcy5zdGF0ZS5uYW1lKVxuXG4gICAgICAkKCcuc3VtbWVyJykuc3VtbWVybm90ZSh7XG4gICAgICAgIGhlaWdodDogMjAwLFxuICAgICAgICB0b29sYmFyOiBbXG4gICAgICAgICAgWydzdHlsZScsIFsnYm9sZCcsICdpdGFsaWMnLCAndW5kZXJsaW5lJywgJ2NsZWFyJ11dLFxuICAgICAgICAgIFsnZm9udCcsIFsnc3RyaWtldGhyb3VnaCddXSxcbiAgICAgICAgICBbJ2ZvbnRzaXplJywgWydmb250c2l6ZSddXSxcbiAgICAgICAgICBbJ2NvbG9yJywgWydjb2xvciddXSxcbiAgICAgICAgICBbJ3BhcmEnLCBbJ3VsJywgJ29sJywgJ3BhcmFncmFwaCddXSxcbiAgICAgICAgICBbJ2hlaWdodCcsIFsnaGVpZ2h0J11dLFxuICAgICAgICBdXG4gICAgICB9KVxuXG4gICAgICAvLyBJbml0aWFsaXplIEVkaXRvciB3aXRoIGh0bWxcbiAgICAgICQoJy5zdW1tZXInKS5jb2RlKHRoaXMuc3RhdGUuYm9keSlcbiAgICB9XG4gIH0sXG5cblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHN1YmplY3RQbGFjZSA9ICh0aGlzLnN0YXRlLmVkaXRNb2RlKSA/IFJlYWN0LkRPTS5pbnB1dCh7c3R5bGU6IHtkaXNwbGF5OidpbmxpbmUnLHdpZHRoOjQ4MH0sIGNsYXNzTmFtZTogXCJmb3JtLWNvbnRyb2wgc3ViamVjdFwifSkgOiB0aGlzLnN0YXRlLnN1YmplY3RcblxuICAgIGlmKHRoaXMuc3RhdGUuZWRpdE1vZGUpe1xuICAgICAgIHRvZ2dsZUJ1dHRvbiA9IFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuY2hhbmdlTW9kZSwgXG4gICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4teHNcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidibG9jaycsZmxvYXQ6J3JpZ2h0JyxtYXJnaW5Ub3A6NX19LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtc2F2ZVwifSksIFwiIMKgIFNhdmUgVGVtcGxhdGVcIilcblxuICAgICAgIGlmKHRoaXMucHJvcHMuaW5pdGlhbFRlbXBsYXRlVmFsdWVzLm5ld1RlbXBsYXRlKXtcbiAgICAgICAgIHRoZV9uYW1lID0gUmVhY3QuRE9NLmlucHV0KHtjbGFzc05hbWU6IFwiZm9ybS1jb250cm9sXCIsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IFwidGVtcGxhdGUtbmFtZVwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7ZmxvYXQ6J2xlZnQnLHdpZHRoOjIwMH19KVxuICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgIHRvZ2dsZUJ1dHRvbiA9IFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuY2hhbmdlTW9kZSwgXG4gICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tcHJpbWFyeSBidG4teHNcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidibG9jaycsZmxvYXQ6J3JpZ2h0JyxtYXJnaW5Ub3A6NX19LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGVuY2lsLXNxdWFyZVwifSksIFwiIMKgIEVkaXQgVGVtcGxhdGVcIilcblxuICAgICAgIHRoZV9uYW1lID0gUmVhY3QuRE9NLmg2KHtzdHlsZToge2Zsb2F0OidsZWZ0J319LCBcbiAgICAgICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWZpbGUtdGV4dC1vXCJ9KSwgXCLCoFwiLCBcbiAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLm5hbWVcbiAgICAgICAgICAgICAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7aWQ6IFwiZWRpdFRlbXBsYXRlXCJ9LCBcbiAgICAgICAgUmVhY3QuRE9NLmg1KHtjbGFzc05hbWU6IFwiZXhhbXBsZS10ZW1wbGF0ZS10aXRsZVwifSwgXCJFeGFtcGxlIFRlbXBsYXRlIFZhbHVlc1wiKSwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJleGFtcGxlLXRlbXBsYXRlLXRpdGxlXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7bWFyZ2luTGVmdDoyMTUsIG1hcmdpblRvcDo4fX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tZGVmYXVsdCBidG4teHNcIn0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGV2cm9uLWxlZnRcIn0pKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICBzdHlsZToge21hcmdpbkxlZnQ6NX0sIFxuICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tZGVmYXVsdCBidG4teHNcIn0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGV2cm9uLXJpZ2h0XCJ9KSlcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe29uQ2xpY2s6IHRoaXMuY2xpY2tlZE92ZXJsYXksIGlkOiBcImVkaXRUZW1wbGF0ZU92ZXJsYXlcIn0pLCBcbiAgICAgICAgICBSZWFjdC5ET00uZGl2KHtpZDogXCJlZGl0VGVtcGxhdGVWaWV3XCIsIFxuICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcInBhbmVsIHBhbmVsLWRlZmF1bHRcIiwgXG4gICAgICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6J2Jsb2NrJ319LCBcbiAgICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbC1oZWFkaW5nXCIsIHN0eWxlOiB7aGVpZ2h0OjUwfX0sIFxuICAgICAgICAgICAgICAgICB0aGVfbmFtZSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXCIsIFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7ZmxvYXQ6J3JpZ2h0JyxtYXJnaW5MZWZ0OjUsbWFyZ2luVG9wOjV9fSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS10cmFzaFwifSlcbiAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgIHRvZ2dsZUJ1dHRvblxuICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtYm9keVwifSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJlZGl0VGVtcGxhdGVUaXRsZVwifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4obnVsbCwgXCJTdWJqZWN0OiBcIiksIFxuICAgICAgICAgICAgICAgIHN1YmplY3RQbGFjZVxuICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICBSZWFjdC5ET00uYnIobnVsbCksIFxuICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJ0ZW1wbGF0ZURldGFpbHNcIn0sIFxuICAgICAgICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge21hcmdpbkJvdHRvbTonMCd9LCBjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgICAgICAgIFwiQ3JlYXRlZCBieSBNYXJrIG9uIEp1bC4gMjEsIDIwMTRcIlxuICAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luVG9wOicwJ30sIGNsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcbiAgICAgICAgICAgICAgICAgXCJsYXN0IHVwZGF0ZWQgNyBkYXlzIGFnb1wiXG4gICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uYnIobnVsbCksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsIHBhbmVsLWRlZmF1bHRcIn0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtYm9keSBzdW1tZXIgdGVtcGxhdGUtYm9keVwifVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gICAgKTtcbiAgfVxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cbnZhciBTZW5kRW1haWxNb2RhbCA9IHJlcXVpcmUoJy4vc2VuZF9lbWFpbF9tb2RhbC5qcy5taW4uanMnKVxudmFyIFRpbWVsaW5lRGF5RWxlbWVudCA9IHJlcXVpcmUoJy4vdGltZWxpbmVfZGF5X2VsZW1lbnQuanMubWluLmpzJylcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy8gRm9sbG93dXBUaW1lbGluZVxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIGluaXRpYWxGb2xsb3d1cHMgPSB0aGlzLnByb3BzLmluaXRpYWxGb2xsb3d1cHNcbiAgICBpbml0aWFsRm9sbG93dXBzID0gKGluaXRpYWxGb2xsb3d1cHMpID8gaW5pdGlhbEZvbGxvd3VwcyA6IFtdXG4gICAgYmF0Y2hlcyA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5iYXRjaGVzXG4gICAgYmF0Y2hlcyA9IChiYXRjaGVzKSA/IGJhdGNoZXMgOiBbXVxuICAgIHJldHVybiB7XG4gICAgICBmb2xsb3d1cHM6IF8uY29tcGFjdChpbml0aWFsRm9sbG93dXBzKSxcbiAgICAgIGxvYWRpbmc6IGZhbHNlLFxuICAgICAgY3VycmVudFRlbXBsYXRlOicnLFxuICAgICAgY3VycmVudEJhdGNoOiAnJyxcbiAgICAgIGJhdGNoZXMgOiBiYXRjaGVzXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzcyA9IHRoaXM7XG4gICAgJCgnLmRheScpLnRvb2x0aXAoe1xuICAgICAgcGxhY2VtZW50OiAncmlnaHQnLFxuICAgICAgdGl0bGU6JysgQWRkIGEgZm9sbG93LXVwJ1xuICAgIH0pXG5cbiAgICBjb25zb2xlLmxvZyh0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24pXG4gICAgIGNvbXBhbnkgPSBKU09OLnN0cmluZ2lmeShKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5jdXJyZW50VXNlcikuY29tcGFueSlcbiAgICAgY3VycmVudENhbXBhaWduID0gYXBwQ29uZmlnLnBvaW50ZXIoJ0NhbXBhaWduJywgdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLm9iamVjdElkKVxuICAgICAkLmFqYXgoe1xuICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Gb2xsb3d1cCcsXG4gICAgICAgdHlwZTonR0VUJyxcbiAgICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgICBkYXRhOiB7XG4gICAgICAgICB3aGVyZTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICBjYW1wYWlnbjogY3VycmVudENhbXBhaWduLFxuICAgICAgICAgICBjb21wYW55OiBhcHBDb25maWcuY29tcGFueVxuICAgICAgICAgfSksXG4gICAgICAgICBpbmNsdWRlOid0ZW1wbGF0ZScsXG4gICAgICAgfSxcbiAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgIGNvbnNvbGUubG9nKCdmb2xsb3d1cCB0aW1lbGluZScpXG4gICAgICAgICBjb25zb2xlLmxvZyhyZXMucmVzdWx0cylcbiAgICAgICB9LFxuICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicpXG4gICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgfVxuICAgICB9KVxuICB9LFxuXG4gIGFkZEZvbGxvd3VwU2VudFRvQmF0Y2g6IGZ1bmN0aW9uKGJhdGNoLCBmb2xsb3d1cCkge1xuICAgIGJhdGNoZXMgPSBfLm1hcCh0aGlzLnN0YXRlLmJhdGNoZXMsIGZ1bmN0aW9uKF9iYXRjaCkge1xuICAgICAgICAgICAgICAgICAgaWYoX2JhdGNoLm9iamVjdElkID09IGJhdGNoLm9iamVjdElkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKF9iYXRjaC5mb2xsb3d1cHMpXG4gICAgICAgICAgICAgICAgICAgICAgX2JhdGNoLmZvbGxvd3Vwcy5wdXNoKGZvbGxvd3VwKVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgX2JhdGNoLmZvbGxvd3VwcyA9IFtmb2xsb3d1cF1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiBfYmF0Y2hcbiAgICAgICAgICAgICAgfSlcbiAgICAvLyBQZXJzaXN0XG4gIH0sXG4gIFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHRpbWVsaW5lRWxlbWVudHMgPSBbXVxuICAgIGZvbGxvd3VwcyA9IHRoaXMuc3RhdGUuZm9sbG93dXBzXG5cbiAgICBiYXRjaGVzID0gXy5tYXAodGhpcy5zdGF0ZS5iYXRjaGVzLCBmdW5jdGlvbihiYXRjaCkge1xuICAgICAgaWYoYmF0Y2gpe1xuICAgICAgICBub3cgPSBtb21lbnQoKS5zdGFydE9mKCdkYXknKS52YWx1ZU9mKClcbiAgICAgICAgYmF0Y2guY3VycmVudERheSA9IG1vbWVudChiYXRjaC5zdGFydGVkKS5kaWZmKG1vbWVudChub3cpLCAgJ2RheXMnKSAqIC0xXG4gICAgICAgIHJldHVybiBiYXRjaFxuICAgICAgfVxuICAgIH0pXG4gICAgYmF0Y2hlcyA9IF8uY29tcGFjdChiYXRjaGVzKVxuXG4gICAgZm9yKGk9MDtpPCAzMTtpKyspe1xuICAgICAgZm9sbG93dXAgPSBfLmZpbmRXaGVyZSh0aGlzLnN0YXRlLmZvbGxvd3Vwcywge2RheTogaX0pXG4gICAgICB2YXIgZWxlbWVudFR5cGUgPSAoZm9sbG93dXApID8gdHJ1ZSA6IGZhbHNlXG4gICAgICB2YXIgY3VycmVudFRlbXBsYXRlID0gKGZvbGxvd3VwKSA/IGZvbGxvd3VwLnRlbXBsYXRlIDogZmFsc2VcbiAgICAgIHZhciBhZGRUZW1wbGF0ZU1vZGUgPSAoZm9sbG93dXApID8gZm9sbG93dXAuYWRkVGVtcGxhdGVNb2RlIDogdHJ1ZVxuICAgICAgY2FtcGFpZ24gPSB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ25cblxuICAgICAgY3VycmVudEJhdGNoID0ge31cbiAgICAgIGJhdGNoX3N0YXJ0ZWRfdG9kYXkgPSBmYWxzZVxuICAgICAgYWxyZWFkeVNlbnQgPSBmYWxzZVxuICAgICAgYmF0Y2hDb3VudCA9IHVuZGVmaW5lZFxuICAgICAgaWYoaSA9PSAwKSB7XG4gICAgICAgIGJhdGNoQ291bnQgPSAoYmF0Y2hlcykgPyB0aGlzLnByb3BzLm5ld1Byb3NwZWN0cy5sZW5ndGggOiB0aGlzLnByb3BzLnByb3NwZWN0cy5sZW5ndGhcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJhdGNoID0gXy5maW5kV2hlcmUoYmF0Y2hlcywge2N1cnJlbnREYXk6IGl9KVxuICAgICAgICBpZihiYXRjaCkge1xuICAgICAgICAgIGN1cnJlbnRCYXRjaCA9IGJhdGNoLm9iamVjdElkXG4gICAgICAgICAgY29uc29sZS5kZWJ1ZyhiYXRjaC5vYmplY3RJZClcbiAgICAgICAgICBiYXRjaENvdW50ID0gXCJ+XCJcbiAgICAgICAgICBpZihmb2xsb3d1cCkge1xuICAgICAgICAgICAgX2JhdGNoZXMgPSBmb2xsb3d1cC5iYXRjaGVzXG4gICAgICAgICAgICBhbHJlYWR5U2VudCA9IF8uZmluZFdoZXJlKF9iYXRjaGVzLCBfLnBpY2soYmF0Y2gsJ29iamVjdElkJykpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRpbWVsaW5lRWxlbWVudHMucHVzaChSZWFjdC5ET00uZGl2KG51bGwsIFRpbWVsaW5lRGF5RWxlbWVudCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlDb3VudDogaSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50VHlwZTogIWVsZW1lbnRUeXBlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUZW1wbGF0ZTogY3VycmVudFRlbXBsYXRlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoQ291bnQ6IGJhdGNoQ291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJhdGNoOiBjdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxyZWFkeVNlbnQ6IGFscmVhZHlTZW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFRlbXBsYXRlTW9kZTogYWRkVGVtcGxhdGVNb2RlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlczogdGhpcy5wcm9wcy50ZW1wbGF0ZXMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UHJvc3BlY3RzOiB0aGlzLnByb3BzLm5ld1Byb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRGb2xsb3d1cDogdGhpcy5hZGRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0Rm9sbG93dXA6IHRoaXMuZWRpdEZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVGb2xsb3d1cDogdGhpcy5zYXZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRm9sbG93dXA6IHRoaXMucmVtb3ZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkRm9sbG93dXBTZW50VG9CYXRjaDogdGhpcy5hZGRGb2xsb3d1cFNlbnRUb0JhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoZXM6IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5iYXRjaGVzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3NwZWN0TGlzdENvdW50OiB0aGlzLnByb3BzLnByb3NwZWN0TGlzdENvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEN1cnJlbnRCYXRjaDogdGhpcy5zZXRDdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudFRlbXBsYXRlOiB0aGlzLnNldEN1cnJlbnRUZW1wbGF0ZX0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSlcblxuICAgICAgaWYoaSA9PSAwICYmIF8uZmluZFdoZXJlKGJhdGNoZXMsIHtjdXJyZW50RGF5OiAwfSkpe1xuICAgICAgICAgIGN1cnJlbnRCYXRjaCA9IF8uZmluZFdoZXJlKGJhdGNoZXMsIHtjdXJyZW50RGF5OiAwfSkub2JqZWN0SWRcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCcwLjUnKVxuICAgICAgICAgIGNvbnNvbGUuZGVidWcoY3VycmVudEJhdGNoKVxuICAgICAgICAgIGJhdGNoQ291bnQgPSBcIn5cIlxuICAgICAgICAgIHRpbWVsaW5lRWxlbWVudHMucHVzaChSZWFjdC5ET00uZGl2KG51bGwsIFRpbWVsaW5lRGF5RWxlbWVudCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5Q291bnQ6IDAuNSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hDb3VudDogYmF0Y2hDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJhdGNoOiBjdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb3NwZWN0czogdGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRUeXBlOiB0cnVlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaGVzOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24uYmF0Y2hlcywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvc3BlY3RMaXN0Q291bnQ6IHRoaXMucHJvcHMucHJvc3BlY3RMaXN0Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEN1cnJlbnRCYXRjaDogdGhpcy5zZXRDdXJyZW50QmF0Y2h9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApKVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdihudWxsLCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInRpbWVsaW5lXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7aGVpZ2h0OicxMDAlJyxiYWNrZ3JvdW5kQ29sb3I6J3JnYig5MCwgMTA3LCAxMTkpJywgd2lkdGg6NSxtYXJnaW5Ub3A6LTM1fX0sIFxuICAgICAgICAgICAgIHRpbWVsaW5lRWxlbWVudHNcbiAgICAgICAgKSwgXG4gICAgICAgIFNlbmRFbWFpbE1vZGFsKHtwcm9zcGVjdHM6IHRoaXMucHJvcHMucHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ2FtcGFpZ246IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbiwgXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdQcm9zcGVjdHM6IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEZvbGxvd3VwU2VudFRvQmF0Y2g6IHRoaXMuYWRkRm9sbG93dXBTZW50VG9CYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QmF0Y2g6IHRoaXMuc3RhdGUuY3VycmVudEJhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUZW1wbGF0ZTogdGhpcy5zdGF0ZS5jdXJyZW50VGVtcGxhdGV9KVxuICAgICAgKVxuICAgICk7XG4gIH0sXG5cbiAgY3JlYXRlRm9sbG93dXA6IGZ1bmN0aW9uKCkge1xuICAgIC8vXG4gIH0sICAgICAgICAgXG5cbiAgYWRkRm9sbG93dXA6IGZ1bmN0aW9uKGRheSkge1xuICAgIC8vY29uc29sZS5sb2coJ2NhbGxlZCB0ZW1wbGF0ZSBlZGl0IG1lbnUnKVxuICAgIGZvbGxvd3VwcyA9IHRoaXMuc3RhdGUuZm9sbG93dXBzXG4gICAgZm9sbG93dXBzLnB1c2goe2FkZFRlbXBsYXRlTW9kZTogdHJ1ZSwgZGF5OiBkYXl9KVxuICAgIHRoaXMuc2V0U3RhdGUoeyBmb2xsb3d1cHM6IGZvbGxvd3VwcyB9KVxuICB9LFxuXG4gIGVkaXRGb2xsb3d1cDogZnVuY3Rpb24oZGF5KSB7XG4gICAgLy8gZmluZCB0ZW1wbGF0ZSBzZXQgZWRpdG1vZGUgaXMgZmFsc2VcbiAgICBmb2xsb3d1cHMgPSBfLm1hcCh0aGlzLnN0YXRlLmZvbGxvd3VwcywgZnVuY3Rpb24oZm9sbG93dXApIHtcbiAgICAgIGlmKGZvbGxvd3VwLmRheSA9PSBkYXkpeyBmb2xsb3d1cC5hZGRUZW1wbGF0ZU1vZGUgPSB0cnVlIH1cbiAgICAgIHJldHVybiBmb2xsb3d1cFxuICAgIH0pXG4gICAgdGhpcy5zZXRTdGF0ZSh7Zm9sbG93dXBzOiBmb2xsb3d1cHN9KVxuICB9LFxuXG4gIHNhdmVGb2xsb3d1cDogZnVuY3Rpb24oZGF5LCBjaG9zZW5UZW1wbGF0ZSkge1xuICAgIG5ld19mb2xsb3d1cHMgPSBfLm1hcCh0aGlzLnN0YXRlLmZvbGxvd3VwcywgZnVuY3Rpb24oZm9sbG93dXApIHtcbiAgICAgIGlmKGZvbGxvd3VwLmRheSA9PSBkYXkpe1xuICAgICAgICBmb2xsb3d1cC5hZGRUZW1wbGF0ZU1vZGUgPSBmYWxzZVxuICAgICAgICBmb2xsb3d1cC50ZW1wbGF0ZSA9IGNob3NlblRlbXBsYXRlXG4gICAgICB9XG4gICAgICByZXR1cm4gZm9sbG93dXBcbiAgICB9KVxuICAgIHRoaXMuc2V0U3RhdGUoe2ZvbGxvd3VwczogbmV3X2ZvbGxvd3Vwc30pXG4gICAgZm9sbG93dXAgPSBfLmZpbmRXaGVyZShuZXdfZm9sbG93dXBzLCB7ZGF5OiBkYXl9KVxuXG4gICAgICBpZihmb2xsb3d1cC5vYmplY3RJZCl7XG4gICAgICAgIHVybCA9IFwiL1wiK2ZvbGxvd3VwLm9iamVjdElkOyB0eXBlPVwiUFVUXCJcbiAgICAgICAgZGF0YSA9IHt0ZW1wbGF0ZTogYXBwQ29uZmlnLnBvaW50ZXIoJ1RlbXBsYXRlJywgY2hvc2VuVGVtcGxhdGUub2JqZWN0SWQpfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXJsID0gXCJcIjsgdHlwZT1cIlBPU1RcIjtcblxuICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICBkYXk6IGRheSxcbiAgICAgICAgICAgIGNhbXBhaWduIDogYXBwQ29uZmlnLnBvaW50ZXIoJ0NhbXBhaWduJywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5vYmplY3RJZCksXG4gICAgICAgICAgICB0ZW1wbGF0ZTogYXBwQ29uZmlnLnBvaW50ZXIoJ1RlbXBsYXRlJywgY2hvc2VuVGVtcGxhdGUub2JqZWN0SWQpLFxuICAgICAgICAgIH1cbiAgICAgIH1cblxuICAgIHRoaXNzID0gdGhpcztcbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL0ZvbGxvd3VwJyt1cmwsXG4gICAgICB0eXBlOnR5cGUsXG4gICAgICBkYXRhOkpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgICAgaGVhZGVyczphcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBuZXdfZm9sbG93dXBzID0gXy5tYXAobmV3X2ZvbGxvd3VwcywgZnVuY3Rpb24oZm9sbG93dXApIHtcbiAgICAgICAgICBpZihmb2xsb3d1cC5kYXkgPT0gZGF5KSB7IGZvbGxvd3VwLm9iamVjdElkID0gZmFsc2UgfVxuICAgICAgICAgIHJldHVybiBmb2xsb3d1cFxuICAgICAgICB9KVxuICAgICAgICB0aGlzcy5zZXRTdGF0ZSh7Zm9sbG93dXBzOiBuZXdfZm9sbG93dXBzfSlcblxuICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL0NhbXBhaWduLycrdGhpc3MucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5vYmplY3RJZCxcbiAgICAgICAgICB0eXBlOidQVVQnLFxuICAgICAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkoe2ZvbGxvd3Vwczoge1xuICAgICAgICAgICAgX19vcDogJ0FkZFVuaXF1ZScsXG4gICAgICAgICAgICBvYmplY3RzOlthcHBDb25maWcucG9pbnRlcignRm9sbG93dXAnLCByZXMub2JqZWN0SWQpXVxuICAgICAgICAgIH19KSxcbiAgICAgICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCkgeyB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHsgfVxuICAgICAgICB9KVxuICAgICAgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbigpIHsgfSxcbiAgICB9KVxuICB9LFxuXG4gIHJlbW92ZUZvbGxvd3VwOiBmdW5jdGlvbihkYXkpIHtcbiAgICBmb2xsb3d1cHMgPSBbXVxuICAgIGZvcihpPTA7aTwgdGhpcy5zdGF0ZS5mb2xsb3d1cHMubGVuZ3RoO2krKylcbiAgICAgIGlmKHRoaXMuc3RhdGUuZm9sbG93dXBzW2ldLmRheSAhPSBkYXkpXG4gICAgICAgIGZvbGxvd3Vwcy5wdXNoKHRoaXMuc3RhdGUuZm9sbG93dXBzW2ldKVxuICAgICAgXG4gICAgZm9yKGk9MDtpPCB0aGlzLnN0YXRlLmZvbGxvd3Vwcy5sZW5ndGg7aSsrKVxuICAgICAgaWYodGhpcy5zdGF0ZS5mb2xsb3d1cHNbaV0uZGF5ID09IGRheSlcbiAgICAgICAgYnJlYWtcbiAgICBcbiAgICB0aGlzLnNldFN0YXRlKHtmb2xsb3d1cHM6IGZvbGxvd3Vwc30pIFxuICAgIGlkID0gdGhpcy5zdGF0ZS5mb2xsb3d1cHNbaV1cblxuICAgIHRoaXNzID0gdGhpcztcbiAgICBpZihpZCkge1xuICAgICAgaWQgPSBpZC5vYmplY3RJZFxuICAgICAgJC5hamF4KHtcbiAgICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL0ZvbGxvd3VwLycraWQsXG4gICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgIHR5cGU6J0RFTEVURScsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykgeyBjb25zb2xlLmxvZyhyZXMpIH1cbiAgICAgIH0pXG5cbiAgICAgY29uc29sZS5sb2coJ1JFTU9WRSBBUlJBWScpXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvQ2FtcGFpZ24vJyt0aGlzcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLm9iamVjdElkLFxuICAgICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICB0eXBlOidQVVQnLFxuICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgZm9sbG93dXBzOiB7XG4gICAgICAgICAgICBfX29wIDogJ1JlbW92ZScsXG4gICAgICAgICAgICBvYmplY3RzOiBbYXBwQ29uZmlnLnBvaW50ZXIoJ0ZvbGxvd3VwJywgaWQpXVxuICAgICAgICAgIH1cbiAgICAgICAgfSksXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcyl7IGNvbnNvbGUubG9nKHJlcykgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgeyB9XG4gICAgICB9KVxuICAgIH1cbiAgfSxcblxuICBzZXRDdXJyZW50QmF0Y2g6IGZ1bmN0aW9uKGN1cnJlbnRCYXRjaCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRCYXRjaDogY3VycmVudEJhdGNofSlcbiAgfSxcblxuICBzZXRDdXJyZW50VGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Y3VycmVudFRlbXBsYXRlOiB0ZW1wbGF0ZSB9KVxuICB9XG59KTtcblxuXG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY3VycmVudFByb3NwZWN0OiAwLFxuICAgIH1cbiAgfSxcblxuICBzZW5kRW1haWxzOiBmdW5jdGlvbigpIHtcbiAgICBzZWxlY3RlZENhbXBhaWduID0gdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduXG4gICAgY2FtcGFpZ25faWQgPSBzZWxlY3RlZENhbXBhaWduLm9iamVjdElkXG4gICAgcHJvc3BlY3RsaXN0X2lkID0gc2VsZWN0ZWRDYW1wYWlnbi5wcm9zcGVjdF9saXN0Lm9iamVjdElkXG4gICAgdGVtcGxhdGVfaWQgPSB0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZS5vYmplY3RJZFxuICAgIFxuICAgICQuYWpheCh7XG4gICAgICB1cmw6J2h0dHBzOi8vbmFtZWxlc3MtcmV0cmVhdC0zNTI1Lmhlcm9rdWFwcC5jb20vc2VuZF9lbWFpbCcsXG4gICAgICAvL3VybDonaHR0cDovLzEyNy4wLjAuMTo1MDAwL3NlbmRfZW1haWwnLFxuICAgICAgZGF0YToge1xuICAgICAgICB0ZW1wbGF0ZV9pZCA6IHRlbXBsYXRlX2lkLFxuICAgICAgICBjYW1wYWlnbl9pZCA6IGNhbXBhaWduX2lkLFxuICAgICAgICBwcm9zcGVjdGxpc3RfaWQgOiBwcm9zcGVjdGxpc3RfaWQsXG4gICAgICB9LFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7IGNvbnNvbGUubG9nKHJlcy5yZXN1bHRzKSB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikgeyBjb25zb2xlLmxvZyhlcnIpIH1cbiAgICB9KVxuXG4gICAgLypcbiAgICAqL1xuICAgIC8vIFVwZGF0ZSBGb2xsb3d1cFxuICAgIC8vIFBlcnNpc3QgRm9sbG93dXBcbiAgICAvLyBjbG9zZSBtb2RhbFxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcHJvc3BlY3QgPSB0aGlzLnByb3BzLnByb3NwZWN0c1t0aGlzLnN0YXRlLmN1cnJlbnRQcm9zcGVjdF1cbiAgICBwcm9zcGVjdCA9IChwcm9zcGVjdCkgPyBwcm9zcGVjdCA6IHsnbmFtZSc6JycsJ2VtYWlsJzonJ31cblxuICAgIHZhciB0aGlzcyA9IHRoaXM7XG4gICAgY29uc29sZS5kZWJ1ZygnU0VORCBFTUFJTCBCQVRDSCcpXG4gICAgY29uc29sZS5kZWJ1Zyh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaClcbiAgICBuZXdCYXRjaCA9IF8uaXNFcXVhbCh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaCwge30pXG4gICAgcHJvc3BlY3RzID0gKG5ld0JhdGNoKSA/IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzIDogdGhpcy5wcm9wcy5wcm9zcGVjdHNcbiAgICBpZihuZXdCYXRjaCl7XG4gICAgICBwcm9zcGVjdHMgPSBfLm1hcCh0aGlzLnByb3BzLm5ld1Byb3NwZWN0cywgZnVuY3Rpb24ocHJvc3BlY3QpIHtcbiAgICAgICAgICByZXR1cm4gVXNlclBsYWNlSG9sZGVyKHtwcm9zcGVjdDogcHJvc3BlY3R9KVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcHJvc3BlY3RzID0gXy5tYXAodGhpcy5wcm9wcy5wcm9zcGVjdHMsIGZ1bmN0aW9uKHByb3NwZWN0KSB7XG4gICAgICAgIGlmKF8uZmluZFdoZXJlKHByb3NwZWN0LmJhdGNoZXMsIHtvYmplY3RJZDogdGhpc3MucHJvcHMuY3VycmVudEJhdGNofSkpXG4gICAgICAgICAgcmV0dXJuIFVzZXJQbGFjZUhvbGRlcih7cHJvc3BlY3Q6IHByb3NwZWN0fSlcbiAgICAgIH0pXG4gICAgfVxuICAgIHByb3NwZWN0cyA9IF8uY29tcGFjdChwcm9zcGVjdHMpXG4gICAgY29uc29sZS5kZWJ1Zyhwcm9zcGVjdHMpXG4gICAgY29uc29sZS5kZWJ1Zyhwcm9zcGVjdHMubGVuZ3RoKVxuICAgIHByb3NwZWN0Q291bnQgPSBwcm9zcGVjdHMubGVuZ3RoXG4gICAgZW1haWwgPSAocHJvc3BlY3QuZW1haWwpID8gcHJvc3BlY3QuZW1haWwudG9Mb3dlckNhc2UoKSA6IFwiXCJcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsIGZhZGUgYnMtc2VuZEVtYWlsLW1vZGFsLWxnXCIsIHRhYkluZGV4OiBcIi0xXCIsIFxuICAgICAgICAgICByb2xlOiBcImRpYWxvZ1wiLCAnYXJpYS1sYWJlbGxlZGJ5JzogXCJteVNtYWxsTW9kYWxMYWJlbFwiLCAnYXJpYS1oaWRkZW4nOiBcInRydWVcIiwgXG4gICAgICAgICAgIGlkOiBcInNlbmRFbWFpbE1vZGFsXCIsIHN0eWxlOiB7dG9wOicxMHB4J319LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbC1kaWFsb2cgbW9kYWwtbGdcIn0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwtY29udGVudFwifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWhlYWRlclwifSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBjbGFzc05hbWU6IFwiY2xvc2VcIiwgJ2RhdGEtZGlzbWlzcyc6IFwibW9kYWxcIn0sIFJlYWN0LkRPTS5zcGFuKHsnYXJpYS1oaWRkZW4nOiBcInRydWVcIn0sIFwiw5dcIiksIFxuICAgICAgICAgICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInNyLW9ubHlcIn0sIFwiQ2xvc2VcIikpLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgXG4gICAgICAgICAgICAgICAgb25DbGljazogdGhpcy5zZW5kRW1haWxzLCBcbiAgICAgICAgICAgICAgICBzdHlsZToge2Zsb2F0OidyaWdodCd9LCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1zbVwifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wYXBlci1wbGFuZVwifSksIFwiwqAgU2VuZCBFbWFpbFwiKSwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIHN0eWxlOiB7bWFyZ2luUmlnaHQ6MTAsIGZsb2F0OidyaWdodCd9LCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVwiLCAnZGF0YS1kaXNtaXNzJzogXCJtb2RhbFwifSwgXCJDbG9zZVwiKSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uaDQoe2NsYXNzTmFtZTogXCJtb2RhbC10aXRsZVwiLCBpZDogXCJteU1vZGFsTGFiZWxcIn0sIFxuICAgICAgICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWVudmVsb3BlXCJ9KSwgXCIgwqBTZW5kIEVtYWlsXCIgKyAnICcgK1xuICAgICAgICAgICAgICAgICAgICBcIsKgwqBcIiwgXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5zbWFsbChudWxsLCBcIihcIitwcm9zcGVjdENvdW50K1wiKVwiKVxuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbC1ib2R5XCIsIHN0eWxlOiB7cGFkZGluZ1RvcDo1fX0sIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmg0KG51bGwsIFwiUGVvcGxlXCIpLCBcbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInByb3NwZWN0LWNvbnRhaW5lclwifSwgXG4gICAgICAgICAgICAgICAgICAgIHByb3NwZWN0c1xuICAgICAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uYnIobnVsbCksIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmg0KHtzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jayd9fSwgXCJFbWFpbHMgwqDCoMKgXCIsIFxuICAgICAgICAgICAgICAgICAgICBSZWFjdC5ET00uc21hbGwobnVsbCwgKHRoaXMuc3RhdGUuY3VycmVudFByb3NwZWN0KzEpKycgb2YgJytwcm9zcGVjdENvdW50XG4gICAgICAgICAgICAgICAgICApKSwgXG4gICAgICAgICAgICAgICAgICBcIsKgwqDCoFwiLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgICBjbGFzc05hbWU6ICh0aGlzLnN0YXRlLmN1cnJlbnRQcm9zcGVjdCA9PSAwICkgPyBcImJ0biBkaXNhYmxlZFwiIDogXCJidG5cIiwgXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMucHJldmlvdXNQcm9zcGVjdH0sIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtYXJyb3ctbGVmdFwifSkpLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgY2xhc3NOYW1lOiAodGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QgPT0gMTM1ICkgPyBcImJ0biBkaXNhYmxlZFwiIDogXCJidG5cIiwgXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMubmV4dFByb3NwZWN0fSwgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1hcnJvdy1yaWdodFwifSkpLCBcblxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdihudWxsLCBcblxuUmVhY3QuRE9NLnVsKHtjbGFzc05hbWU6IFwibGlzdC1ncm91cCBlbWFpbC1ob2xkZXJcIiwgc3R5bGU6IHtib3JkZXJUb3A6J3NvbGlkIDFweCAjZWVlJ319LCBcbiAgUmVhY3QuRE9NLmxpKHtjbGFzc05hbWU6IFwibGlzdC1ncm91cC1pdGVtXCJ9LCBcbiAgICBSZWFjdC5ET00uaDUoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyxtYXJnaW5Ub3A6MCxtYXJnaW5Cb3R0b206MH19LCBcIlRvOsKgwqBcIiksIFxuICAgIHByb3NwZWN0Lm5hbWUgKyBcIiAtIFwiICsgZW1haWxcbiAgKSwgXG4gIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAtaXRlbVwifSwgXG4gICAgUmVhY3QuRE9NLmg1KHtzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jaycsbWFyZ2luVG9wOjAsbWFyZ2luQm90dG9tOjB9fSwgXCJTdWJqZWN0OsKgwqBcIiksIFwiIFwiLCB0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZS5zdWJqZWN0XG4gICksIFxuICBSZWFjdC5ET00ubGkoe2NsYXNzTmFtZTogXCJsaXN0LWdyb3VwLWl0ZW0gYm9keVwifSlcbilcbiAgXG4gICAgICAgICAgICAgICAgICApXG5cbiAgICAgICAgICAgICAgICApLCBcblxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWZvb3RlclwiLCBzdHlsZToge2Rpc3BsYXk6J25vbmUnfX0sIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1kZWZhdWx0XCIsICdkYXRhLWRpc21pc3MnOiBcIm1vZGFsXCJ9LCBcIkNsb3NlXCIpLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tcHJpbWFyeVwifSwgXCJTZW5kIEVtYWlsXCIpXG4gICAgICApXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgKTtcbiAgfSxcblxuICBwcmV2aW91c1Byb3NwZWN0OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50UHJvc3BlY3Q6IHRoaXMuc3RhdGUuY3VycmVudFByb3NwZWN0LTEgfSlcbiAgfSxcblxuICBuZXh0UHJvc3BlY3Q6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRQcm9zcGVjdDogdGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QrMSB9KVxuICB9LFxuXG4gIHBhcnNlVGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlQm9keSkge1xuICAgIGZpcnN0X25hbWUgPSBwcm9zcGVjdC5uYW1lLnNwbGl0KCcgJylbMF1cbiAgICAvL2hpcmluZ19zaWduYWwgPSBwcm9zcGVjdC5zaWduYWxzXG5cbiAgICBzaWduYWxzID0gKHByb3NwZWN0LnNpZ25hbHMpID8gcHJvc3BlY3Quc2lnbmFsc1swXSA6IFwiXCJcbiAgICB0ZW1wbGF0ZUJvZHkgPSBNdXN0YWNoZS5yZW5kZXIodGVtcGxhdGVCb2R5LCB7XG4gICAgICBoaXJpbmdfc2lnbmFsOiBzaWduYWxzLFxuICAgICAgZmlyc3RfbmFtZTogcHJvc3BlY3QubmFtZS5zcGxpdCgnICcpWzBdXG4gICAgfSlcblxuICAgIGNvbnNvbGUubG9nKHRlbXBsYXRlQm9keSlcbiAgICAgIFxuICAgIHJldHVybiB0ZW1wbGF0ZUJvZHlcbiAgfSxcblxuICBjb21wb25lbnREaWRVcGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgIC8vY29uc29sZS5sb2codGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUpXG4gICAgcGFyc2VkVGVtcGxhdGUgPSB0aGlzLnBhcnNlVGVtcGxhdGUodGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUuYm9keSlcbiAgICBcbiAgICAvLyQoJy5ib2R5JykuaHRtbCh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZS5ib2R5KVxuICAgICQoJy5ib2R5JykuaHRtbChwYXJzZWRUZW1wbGF0ZSlcbiAgfVxufSk7XG5cbnZhciBVc2VyUGxhY2VIb2xkZXIgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdVc2VyUGxhY2VIb2xkZXInLFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJidG4tZ3JvdXBcIiwgc3R5bGU6IHttYXJnaW5SaWdodDo1LG1hcmdpbkJvdHRvbTo1fX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJidG4tZ3JvdXBcIn0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLXN1Y2Nlc3MgYnRuLXNtXCJ9LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS11c2VyXCJ9KSwgXCLCoMKgXCIsIFxuICAgICAgICAgICAgICAodGhpcy5wcm9wcy5wcm9zcGVjdCkgPyB0aGlzLnByb3BzLnByb3NwZWN0Lm5hbWUgOiBcIlwiXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4tc21cIn0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS10cmFzaC1vXCJ9KVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgIClcbiAgfVxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy9UZW1wbGF0ZXNNZW51XG4gIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IGZ1bmN0aW9uKGN1cnJlbnRUZW1wbGF0ZSkge1xuICAgIHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudShjdXJyZW50VGVtcGxhdGUpXG4gIH0sXG5cbiAgY3JlYXRlVGVtcGxhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSh7XG4gICAgICBuYW1lOiAnJyxcbiAgICAgIGJvZHk6JycsXG4gICAgICBzdWJqZWN0OicnLFxuICAgICAgZWRpdE1vZGU6dHJ1ZSxcbiAgICAgIG5ld1RlbXBsYXRlOiB0cnVlXG4gICAgfSwgdHJ1ZSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIC8vY29uc29sZS5sb2codGhpcy5wcm9wcy50ZW1wbGF0ZXMpXG4gICAgdGVtcGxhdGVzID0gW11cbiAgICBmb3IoaT0wO2k8IHRoaXMucHJvcHMudGVtcGxhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0ZW1wbGF0ZXMucHVzaChcbiAgICAgICAgVGVtcGxhdGVMaXN0SXRlbSh7XG4gICAgICAgICAgdG9nZ2xlVGVtcGxhdGVFZGl0TWVudTogdGhpcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51LCBcbiAgICAgICAgICB0ZW1wbGF0ZTogdGhpcy5wcm9wcy50ZW1wbGF0ZXNbaV19KVxuICAgICAgKVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiXCIsIHN0eWxlOiB7cGFkZGluZzonMCcsIGhlaWdodDonMTAwJScsdGV4dEFsaWduOidjZW50ZXInfX0sIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwgcGFuZWwtZGVmYXVsdFwiLCBcbiAgICAgICAgICAgICBzdHlsZToge2JvcmRlclJpZ2h0OjAsYm9yZGVyUmFkaXVzOjAsaGVpZ2h0OicxMDAlJywgb3ZlcmZsb3c6J2F1dG8nfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbC1oZWFkaW5nXCIsIHN0eWxlOiB7aGVpZ2h0OjQwfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe3N0eWxlOiB7ZmxvYXQ6J2xlZnQnLGZvbnRTaXplOjE0LGZvbnRXZWlnaHQ6J2JvbGQnfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWZpbGUtdGV4dC1vXCJ9KSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtzdHlsZToge21hcmdpbkxlZnQ6NX19LCBcIlRlbXBsYXRlc1wiKVxuICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4teHNcIiwgXG4gICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuY3JlYXRlVGVtcGxhdGUsIFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7ZmxvYXQ6J3JpZ2h0J319LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wbHVzXCJ9KSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtzdHlsZToge21hcmdpbkxlZnQ6NX19LCBcIkNyZWF0ZSBUZW1wbGF0ZVwiKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS51bCh7Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXBcIiwgXG4gICAgICAgICAgICAgIHN0eWxlOiB7dGV4dEFsaWduOidsZWZ0J319LCBcbiAgICAgICAgICAgIHRlbXBsYXRlc1xuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgfVxufSk7XG5cbnZhciBUZW1wbGF0ZUxpc3RJdGVtID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnVGVtcGxhdGVMaXN0SXRlbScsXG4gIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKHRoaXMucHJvcHMudGVtcGxhdGUpXG4gICAgdGVtcGxhdGUgPSB0aGlzLnByb3BzLnRlbXBsYXRlXG4gICAgdGVtcGxhdGUuZWRpdE1vZGUgPSBmYWxzZVxuICAgIHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSh0ZW1wbGF0ZSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICBzdHlsZToge2JvcmRlckJvdHRvbTogJzFweCBzb2xpZCByZ2IoMjIxLCAyMjEsIDIyMSknLHBhZGRpbmdUb3A6NSxwYWRkaW5nQm90dG9tOjB9LCBcbiAgICAgICAgICAgb25DbGljazogdGhpcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51LCBcbiAgICAgICAgICAgY2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAtaXRlbVwifSwgXG4gICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwibGFiZWwgbGFiZWwtZGVmYXVsdFwifSwgXG4gICAgICAgICAgICAgdGhpcy5wcm9wcy50ZW1wbGF0ZS5uYW1lXG4gICAgICAgICAgICksIFxuICAgICAgICAgICBSZWFjdC5ET00uaDYobnVsbCwgXCJTdWJqZWN0OlwiLCBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInRleHQgdGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgICAgXCIgXCIgKyB0aGlzLnByb3BzLnRlbXBsYXRlLnN1YmplY3RcbiAgICAgICAgICAgKSlcbiAgICAgICAgIClcbiAgICAgIClcbiAgICApO1xuICB9XG59KTtcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvLyBUaW1lbGluZURheUVsZW1lbnRcbiAgLy8gVE9ET1xuICAvLyAtIGFkZCBwcm9zcGVjdCBsaXN0IHByb2dyZXNzaW9uXG4gIC8vIC0gYWRkIHNjaGVkdWxlZCBmb2xsb3d1cFxuICAvL1xuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIC8vIFxuICAgIHJldHVybiB7XG4gICAgICBmb2xsb3d1cENvbXBsZXRlZDogMCxcbiAgICB9XG4gIH0sXG5cbiAgYWRkRm9sbG93dXA6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHJvcHMuYWRkRm9sbG93dXAodGhpcy5wcm9wcy5kYXlDb3VudClcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIGlmKHRoaXMucHJvcHMuYWRkVGVtcGxhdGVNb2RlKSB7XG4gICAgICBtb2RlID0gRWRpdFRlbXBsYXRlKHthZGRGb2xsb3d1cDogdGhpcy5wcm9wcy5hZGRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlRm9sbG93dXA6IHRoaXMucHJvcHMuc2F2ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZvbGxvd3VwOiB0aGlzLnByb3BzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNvdW50OiB0aGlzLnByb3BzLmRheUNvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlczogdGhpcy5wcm9wcy50ZW1wbGF0ZXN9KVxuICAgIH0gZWxzZSB7XG4gICAgICBtb2RlID0gVGVtcGxhdGVGb2xsb3d1cCh7Y3VycmVudFRlbXBsYXRlOiB0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEZvbGxvd3VwOiB0aGlzLnByb3BzLmVkaXRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5Q291bnQ6IHRoaXMucHJvcHMuZGF5Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCYXRjaDogdGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0JhdGNoOiB0eXBlb2YodGhpcy5wcm9wcy5iYXRjaENvdW50KSAhPSBcInVuZGVmaW5lZFwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRDdXJyZW50QmF0Y2g6IHRoaXMucHJvcHMuc2V0Q3VycmVudEJhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlDb3VudDogdGhpcy5wcm9wcy5kYXlDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRm9sbG93dXA6IHRoaXMucHJvcHMucmVtb3ZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEN1cnJlbnRUZW1wbGF0ZTogdGhpcy5wcm9wcy5zZXRDdXJyZW50VGVtcGxhdGV9KVxuICAgIH1cbiAgICBpZih0aGlzLnByb3BzLmFscmVhZHlTZW50KSB7XG4gICAgICBtb2RlID0gRm9sbG93dXBDb21wbGV0ZWQoe2N1cnJlbnRUZW1wbGF0ZTogdGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGV9KVxuICAgIH1cblxuICAgIG1vZGUgPSAodGhpcy5wcm9wcy5lbGVtZW50VHlwZSkgPyBcIlwiIDogbW9kZVxuICAgIGFkZEZvbGxvd3VwID0gKHRoaXMucHJvcHMuZWxlbWVudFR5cGUpID8gdGhpcy5hZGRGb2xsb3d1cCA6IFwiXCJcbiAgICBpZih0eXBlb2YodGhpcy5wcm9wcy5iYXRjaENvdW50KSAhPSBcInVuZGVmaW5lZFwiKVxuICAgICAgYmF0Y2hTdGFnZSA9IEJhdGNoU3RhZ2Uoe2N1cnJlbnRCYXRjaDogdGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb3NwZWN0czogdGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3NwZWN0TGlzdENvdW50OiB0aGlzLnByb3BzLnByb3NwZWN0TGlzdENvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaENvdW50OiB0aGlzLnByb3BzLmJhdGNoQ291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1NjaGVkdWxlZEVtYWlsOiBtb2RlICE9IFwiXCIsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNvdW50OiB0aGlzLnByb3BzLmRheUNvdW50fSlcbiAgICBlbHNlXG4gICAgICBiYXRjaFN0YWdlID0gXCJcIlxuXG4gICAgZGF5Q291bnQgPSAodGhpcy5wcm9wcy5kYXlDb3VudCAhPSAwLjUpID8gXCJEXCIrdGhpcy5wcm9wcy5kYXlDb3VudCA6IFwiXCJcblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtvbkNsaWNrOiBhZGRGb2xsb3d1cCwgY2xhc3NOYW1lOiBcImRheVwiLCAnZGF0YS10cmlnZ2VyJzogXCJtYW51YWxcIn0sIFxuICAgICAgICAgIGRheUNvdW50XG4gICAgICAgICksIFxuICAgICAgICBtb2RlLCBiYXRjaFN0YWdlXG4gICAgICApXG4gICAgKVxuICB9LFxuXG4gIHNldEN1cnJlbnRUZW1wbGF0ZTogZnVuY3Rpb24odGVtcGxhdGUpIHtcbiAgICB0aGlzLnByb3BzLnNldEN1cnJlbnRUZW1wbGF0ZSh0ZW1wbGF0ZSlcbiAgfVxufSk7XG5cbnZhciBGb2xsb3d1cENvbXBsZXRlZCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ0ZvbGxvd3VwQ29tcGxldGVkJyxcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImZvbGxvd3VwLXBsYWNlbWVudCBhcnJvd19ib3hfMSB0bXBfMlwifSwgXG4gICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHt3aWR0aDoxMzAsZGlzcGxheTonaW5saW5lLWJsb2NrJ319LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWZpbGUtdGV4dC1vXCJ9KSwgXCLCoMKgXCIsIFxuICAgICAgICAgICh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZSkgPyB0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZS5uYW1lIDogXCJcIlxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7Y2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1zdWNjZXNzIGJ0bi14cyBkaXNhYmxlZFwiLCBcbiAgICAgICAgICAgICAgICAnZGF0YS10YXJnZXQnOiBcIi5icy1zZW5kRW1haWwtbW9kYWwtbGdcIiwgXG4gICAgICAgICAgICAgICAgb25DbGljazogdGhpcy5zZXRDdXJyZW50VGVtcGxhdGUsIFxuICAgICAgICAgICAgICAgICdkYXRhLXRvZ2dsZSc6IFwibW9kYWxcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hlY2tcIn0pLCBcIsKgU2VudFwiKSwgXCLCoFwiLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5lZGl0Rm9sbG93dXAsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHMgZGlzYWJsZWRcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGVuY2lsXCJ9KSksIFwiwqBcIiwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMucmVtb3ZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHMgZGlzYWJsZWRcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdHJhc2gtb1wifSkpXG4gICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgfVxufSlcblxudmFyIFRlbXBsYXRlRm9sbG93dXAgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdUZW1wbGF0ZUZvbGxvd3VwJyxcbiAgLy8gRWRpdE1vZGUgRmFsc2VcblxuICBzZXRDdXJyZW50VGVtcGxhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHJvcHMuc2V0Q3VycmVudFRlbXBsYXRlKHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlKVxuICAgIC8vIHNldEN1cnJlbnRCYXRjaFxuICAgIHRoaXMucHJvcHMuc2V0Q3VycmVudEJhdGNoKHRoaXMucHJvcHMuY3VycmVudEJhdGNoKVxuICAgICQoJy5icy1zZW5kRW1haWwtbW9kYWwtbGcnKS5tb2RhbCgpXG4gIH0sXG5cbiAgd2FpdEZvckJhdGNoOiBmdW5jdGlvbigpIHtcbiAgICBhbGVydGlmeS5sb2coXCJZb3UgbXVzdCB3YWl0IGZvciBhIGJhdGNoIVwiKTtcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHRyYXNoID0gKHRoaXMucHJvcHMuZGF5Q291bnQgPT0gMCkgPyAgUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5yZW1vdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBkaXNhYmxlZFwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS10cmFzaC1vXCJ9KSkgOiBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLnJlbW92ZUZvbGxvd3VwLCBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pKSBcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImZvbGxvd3VwLXBsYWNlbWVudCBhcnJvd19ib3hfMSB0bXBfMlwifSwgXG4gICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHt3aWR0aDoxMzAsZGlzcGxheTonaW5saW5lLWJsb2NrJ319LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWZpbGUtdGV4dC1vXCJ9KSwgXCLCoMKgXCIsIFxuICAgICAgICAgICh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZSkgPyB0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZS5uYW1lIDogXCJcIlxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7Y2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1zdWNjZXNzIGJ0bi14c1wiLCBcbiAgICAgICAgb25DbGljazogKHRoaXMucHJvcHMuaGFzQmF0Y2gpID8gdGhpcy5zZXRDdXJyZW50VGVtcGxhdGUgOiB0aGlzLndhaXRGb3JCYXRjaCwgXG4gICAgICAgICAgICAgICAgJ2RhdGEtdG9nZ2xlJzogXCJtb2RhbFwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wYXBlci1wbGFuZVwifSksIFwiwqBTZW5kXCIpLCBcIsKgXCIsIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLmVkaXRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wZW5jaWxcIn0pKSwgXCLCoFwiLCBcbiAgICAgICAgdHJhc2hcbiAgICAgIClcbiAgICApO1xuICB9LFxuXG4gIGVkaXRGb2xsb3d1cDogZnVuY3Rpb24oZSkgeyBcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBjb25zb2xlLmxvZyh0aGlzLnByb3BzLmRheUNvdW50KVxuICAgIHRoaXMucHJvcHMuZWRpdEZvbGxvd3VwKHRoaXMucHJvcHMuZGF5Q291bnQpXG4gIH0sXG5cbiAgcmVtb3ZlRm9sbG93dXA6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKCdyZW1vdmUnKVxuICAgIHRoaXMucHJvcHMucmVtb3ZlRm9sbG93dXAodGhpcy5wcm9wcy5kYXlDb3VudClcbiAgfVxufSk7XG5cbnZhciBCYXRjaFN0YWdlID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnQmF0Y2hTdGFnZScsXG4gIC8vIERpZmZlcmVudCBTdGFnZXMgb2YgUGVvcGxlIEFkZGVkIHRvIFByb3NwZWN0IExpc3RcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICAvLyBcbiAgICByZXR1cm4ge1xuICAgICAgaW5pdGlhbEJhdGNoQ291bnQ6IHRoaXMucHJvcHMuYmF0Y2hDb3VudFxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgLy8gc3RhdGVcbiAgICAvL2NvbnNvbGUuZGVidWcoJ0lOU0lERSBCQVRDSCAnK3RoaXMucHJvcHMuZGF5Q291bnQpXG4gICAgY29uc29sZS5kZWJ1Zyh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaClcbiAgICBfYmF0Y2hlcyA9IGFwcENvbmZpZy5wb2ludGVyKCdQcm9zcGVjdEJhdGNoJywgdGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gpXG4gICAgaWYodGhpcy5wcm9wcy5iYXRjaENvdW50ID09IFwiflwiKSB7XG4gICAgICAvLyBXaHkgZG9lc250IHRoaXMgd29yayBcbiAgICAgIHZhciB0aGlzc3NzID0gdGhpcztcbiAgICAgIGNvbnNvbGUuZGVidWcoJ0lOU0lERSBCQVRDSCAnK3RoaXNzLnByb3BzLmRheUNvdW50KVxuICAgICAgY29uc29sZS5kZWJ1ZyhfYmF0Y2hlcylcbiAgICAgICQuYWpheCh7XG4gICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdCcsXG4gICAgICAgIGJhdGNoZXM6IF9iYXRjaGVzLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgd2hlcmU6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGJhdGNoZXM6IF9iYXRjaGVzXG4gICAgICAgICAgfSksXG4gICAgICAgICAgY291bnQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIGhlYWRlcnM6IGFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgXG4gICAgICAgICAgLy9jb25zb2xlLmRlYnVnKCdTVUNDRVNTIEdFVCBDT1VOVCAnICsgcmVzLmNvdW50KVxuICAgICAgICAgIC8vY29uc29sZS5kZWJ1ZyhyZXMucmVzdWx0cykgXG4gICAgICAgICAgdGhpc3Nzcy5zZXRTdGF0ZSh7aW5pdGlhbEJhdGNoQ291bnQ6IHJlcy5jb3VudH0pXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHsgXG4gICAgICAgICAgdGhpc3Nzcy5zZXRTdGF0ZSh7aW5pdGlhbEJhdGNoQ291bnQ6IDAgfSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24obmV4dFByb3BzKSB7XG4gICAgaWYodGhpcy5wcm9wcy5kYXlDb3VudCA9PSAwKVxuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGluaXRpYWxCYXRjaENvdW50OiBuZXh0UHJvcHMuYmF0Y2hDb3VudCB9KVxuICB9LFxuXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBpZih0aGlzLnByb3BzLmhhc1NjaGVkdWxlZEVtYWlsKVxuICAgICAgYmF0Y2hTdGFnZVN0eWxlID0ge3RvcDotNDIsIGxlZnQ6Nn1cbiAgICBlbHNlXG4gICAgICBiYXRjaFN0YWdlU3R5bGUgPSB7fVxuXG4gICAgaWYodGhpcy5wcm9wcy5kYXlDb3VudCA9PSAwLjUpXG4gICAgICBiYXRjaFN0YWdlU3R5bGUubGVmdCA9IDdcblxuICAgIC8vY29uc29sZS5sb2coJ0JBVENIIFNUQUdFJylcbiAgICAvL2NvbnNvbGUubG9nKHRoaXMucHJvcHMpXG4gICAgLy9jb25zb2xlLmRlYnVnKHRoaXMucHJvcHMuY3VycmVudEJhdGNoKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImZvbGxvd3VwLXBsYWNlbWVudCBhcnJvd19ib3ggdG1wXCIsIHN0eWxlOiBiYXRjaFN0YWdlU3R5bGV9LCBcbiAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1wcmltYXJ5XCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXVzZXJcIn0pLCBcIsKgXCIsIFxuICAgICAgICAgIHRoaXMuc3RhdGUuaW5pdGlhbEJhdGNoQ291bnRcbiAgICAgICAgKSwgXCLCoFwiLCBcbiAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jayd9fSwgXG4gICAgICAgICAgXCJwcm9zcGVjdHMgaW4gdGhlIHNhbGVzIGN5Y2xlLlwiKVxuICAgICAgKVxuICAgICk7XG4gIH1cbn0pO1xuXG52YXIgRWRpdFRlbXBsYXRlID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnRWRpdFRlbXBsYXRlJyxcbiAgLy8gRWRpdCBNb2RlIC0gVHJ1ZVxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIG9wdGlvbnMgPSBbXVxuICAgIGZvcihpPTA7aTwgdGhpcy5wcm9wcy50ZW1wbGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIG9wdGlvbnMucHVzaCggUmVhY3QuRE9NLm9wdGlvbihudWxsLCB0aGlzLnByb3BzLnRlbXBsYXRlc1tpXS5uYW1lKSlcbiAgICB9XG4gICAgdHJhc2ggPSAodGhpcy5wcm9wcy5kYXlDb3VudCA9PSAwKSA/ICBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGRpc2FibGVkXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pKSA6IFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMucmVtb3ZlRm9sbG93dXAsIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHNcIn0sIFwiIFwiLCBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pKSBcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImZvbGxvd3VwLXBsYWNlbWVudCBhcnJvd19ib3hfMSB0bXBfMlwifSwgXG4gICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHt3aWR0aDo1NSxkaXNwbGF5OidpbmxpbmUtYmxvY2snfSwgXG4gICAgICAgICAgICBjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgXCJDaG9vc2UgOlwiXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uc2VsZWN0KHtjbGFzc05hbWU6IFwiZm9ybS1jb250cm9sIGlucHV0LXNtXCIsIFxuICAgICAgICAgICAgICAgIGlkOiBcImNob29zZVRlbXBsYXRlRm9yRm9sbG93dXBcIiwgXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snLHdpZHRoOjEyNyxtYXJnaW5SaWdodDo1fX0sIFxuICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgKSwgXG5cbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7Y2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1zdWNjZXNzIGJ0bi14c1wiLCBcbiAgICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLnNhdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgc3R5bGU6IHttYXJnaW5SaWdodDo1fX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hlY2tcIn0pKSwgXG4gICAgICAgIHRyYXNoXG4gICAgICApXG4gICAgKVxuICB9LFxuXG4gIHNhdmVGb2xsb3d1cDogZnVuY3Rpb24oZSkge1xuICAgIC8vZ2V0IHRlbXBsYXRlIGZyb20gY3VycmVudFRlbXBsYXRlXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY2hvc2VuVGVtcGxhdGUgPSAkKCcjY2hvb3NlVGVtcGxhdGVGb3JGb2xsb3d1cCcpLnZhbCgpXG4gICAgY29uc29sZS5sb2coY2hvc2VuVGVtcGxhdGUpXG4gICAgZm9yKGk9MDtpPCB0aGlzLnByb3BzLnRlbXBsYXRlcy5sZW5ndGg7IGkrKyl7XG4gICAgICBpZih0aGlzLnByb3BzLnRlbXBsYXRlc1tpXS5uYW1lID09IGNob3NlblRlbXBsYXRlKXtcbiAgICAgICAgY2hvc2VuVGVtcGxhdGUgPSB0aGlzLnByb3BzLnRlbXBsYXRlc1tpXVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhjaG9zZW5UZW1wbGF0ZSlcbiAgICBcbiAgICB0aGlzLnByb3BzLnNhdmVGb2xsb3d1cCh0aGlzLnByb3BzLmRheUNvdW50LCBjaG9zZW5UZW1wbGF0ZSlcbiAgfSxcblxuICByZW1vdmVGb2xsb3d1cDogZnVuY3Rpb24oZGF5KSB7XG4gICAgdGhpcy5wcm9wcy5yZW1vdmVGb2xsb3d1cCh0aGlzLnByb3BzLmRheUNvdW50KVxuICB9LFxufSk7XG5cbiJdfQ==
