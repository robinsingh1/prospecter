(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      activities: []
    }
  },

  componentDidMount: function() {
    var thiss = this;
    $.ajax({
      url: 'https://api.parse.com/1/classes/EmailEvent',
      data: {include: 'prospect,sent_email', order:'-createdAt', limit:1000},
      headers: appConfig.headers,
      success: function(res) { 
        console.log(res.results)
        thiss.setState({activities: res.results}) 
      },
      error: function() {}
    })
  },

  render: function() {
    activities = _.map(this.state.activities, function(activity) {
      return EmailActivities({activity: activity})
    })

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Sent "), 
            React.DOM.th(null, "Prospect "), 
            React.DOM.th(null, "Email "), 
            React.DOM.th(null, "Events "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons"), 
            React.DOM.th(null, "Social")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Event = React.createClass({displayName: 'Event',
  render: function() {
    event = this.props.event
    if(event == "delivered"){
      iconType = "fa fa-paper-plane"; eventName = "Delivered";
    }else if(event == "failed") {
      iconType = "fa fa-exclamation-circle"; eventName="Failed"
    }else if(event == "opened"){
      iconType = "fa fa-eye"; eventName="Opened"
    }else if(event == "replied"){
      iconType = "fa fa-mail-reply";  eventName = "Replied"
    }else if(event == "visited"){
      iconType = "fa fa-home";  eventName="Visited"
    }

    return (
      React.DOM.ul({className: "list-group email-events", style: {marginBottom:0}}, 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {paddingTop:16, height:49,textAlign:'center'}}, 
          React.DOM.i({className: iconType}), " ", React.DOM.span({style: {fontWeight:'bold'}}, eventName), " "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-home"}), " ", React.DOM.span({style: {fontWeight:'bold'}}, "Visited"), " ", 
          React.DOM.a({href: "javascript:"}, "customerohq.com/resources"), "  "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-external-link-square"}), " ", 
          React.DOM.span(null, "2:19 pm"), " ", 
          React.DOM.span({style: {fontWeight:'bold'}}, "clicked "), 
          React.DOM.a({href: "javascript:"}, "customerohq.com")
        )
      )
    )
  }
})

var EmailActivities = React.createClass({displayName: 'EmailActivities',
  render: function() {
    activity = this.props.activity
    prospect = (activity.prospect) ? activity.prospect : {}
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " ", 
              moment(activity.createdAt).fromNow()
            )
          ), 
          React.DOM.td(null, React.DOM.h6(null, prospect.name)), 
          React.DOM.td(null, React.DOM.h6(null, activity.sent_email.subject)), 
          React.DOM.td({style: {padding:0, fontSize:12}}, 
            Event({event: activity.event_type})
          ), 
          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.div({style: {display:'none'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Email"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, React.DOM.i({className: "fa fa-cloud-upload"}), " CRM"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Call")
          )
          ), 
          React.DOM.td(null, 
            "lol"
          )
      )
    )
  }
})

},{}]},{},[1])


},{}],2:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      activities: []
    }
  },

  componentDidMount: function() {
    var thiss = this;
    $.ajax({
      url: 'https://api.parse.com/1/classes/EmailEvent',
      data: {include: 'prospect,sent_email', order:'-createdAt', limit:1000},
      headers: appConfig.headers,
      success: function(res) { 
        console.log(res.results)
        thiss.setState({activities: res.results}) 
      },
      error: function() {}
    })
  },

  render: function() {
    activities = _.map(this.state.activities, function(activity) {
      return EmailActivities({activity: activity})
    })

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Sent "), 
            React.DOM.th(null, "Prospect "), 
            React.DOM.th(null, "Email "), 
            React.DOM.th(null, "Events "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons"), 
            React.DOM.th(null, "Social")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Event = React.createClass({displayName: 'Event',
  render: function() {
    event = this.props.event
    if(event == "delivered"){
      iconType = "fa fa-paper-plane"; eventName = "Delivered";
    }else if(event == "failed") {
      iconType = "fa fa-exclamation-circle"; eventName="Failed"
    }else if(event == "opened"){
      iconType = "fa fa-eye"; eventName="Opened"
    }else if(event == "replied"){
      iconType = "fa fa-mail-reply";  eventName = "Replied"
    }else if(event == "visited"){
      iconType = "fa fa-home";  eventName="Visited"
    }

    return (
      React.DOM.ul({className: "list-group email-events", style: {marginBottom:0}}, 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {paddingTop:16, height:49,textAlign:'center'}}, 
          React.DOM.i({className: iconType}), " ", React.DOM.span({style: {fontWeight:'bold'}}, eventName), " "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-home"}), " ", React.DOM.span({style: {fontWeight:'bold'}}, "Visited"), " ", 
          React.DOM.a({href: "javascript:"}, "customerohq.com/resources"), "  "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-external-link-square"}), " ", 
          React.DOM.span(null, "2:19 pm"), " ", 
          React.DOM.span({style: {fontWeight:'bold'}}, "clicked "), 
          React.DOM.a({href: "javascript:"}, "customerohq.com")
        )
      )
    )
  }
})

var EmailActivities = React.createClass({displayName: 'EmailActivities',
  render: function() {
    activity = this.props.activity
    prospect = (activity.prospect) ? activity.prospect : {}
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " ", 
              moment(activity.createdAt).fromNow()
            )
          ), 
          React.DOM.td(null, React.DOM.h6(null, prospect.name)), 
          React.DOM.td(null, React.DOM.h6(null, activity.sent_email.subject)), 
          React.DOM.td({style: {padding:0, fontSize:12}}, 
            Event({event: activity.event_type})
          ), 
          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.div({style: {display:'none'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Email"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, React.DOM.i({className: "fa fa-cloud-upload"}), " CRM"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Call")
          )
          ), 
          React.DOM.td(null, 
            "lol"
          )
      )
    )
  }
})

},{}]},{},[1])


},{}],2:[function(require,module,exports){
/** @jsx React.DOM */
var TemplatesMenu = require('./templates_menu.js.min.js');
var EditTemplateView = require('./edit_template.js.min.js');
var CreateTemplateView = require('./create_template.js.min.js');
var Timeline = require('./followup_timeline.js.min.js');
var CampaignActivityView = require('./campaign_activity_view.js.min.js')
var CampaignFollowupFeed = require('./campaign_followup_feed.js.min.js')
var CampaignSentEmail = require('./campaign_sent_email.js.min.js')
var CampaignReport = require('./campaign_report.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // Campaign Detail
  getInitialState: function() {
    return {
      selectedTemplate: 0,
      templateDetailMode: false,
      editMode: false,
      followupDay: 0,
      templates:[],
      currentTemplate:'',
      prospectListCount:'~',
      prospects:[],
      currentScreen: 'timeline',
      newProspects: [],
    }
  },

  changeScreen: function(e) {
    this.setState({currentScreen: $(e.target).text().toLowerCase()})
  },

  componentDidMount: function() {
    thissss = this;
    company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
    qry = 'where={"company":'+company+'}'

    $.ajax({
      url:'https://api.parse.com/1/classes/Template',
      headers: appConfig.headers,
      data: qry,
      success: function(res) { thissss.setState({templates: res.results}) },
      error: function(err) { console.log('error') }
    });

    currentList = JSON.stringify({
      '__type'    : 'Pointer', 
      'className' : 'ProspectList',
      'objectId'  : this.props.selectedCampaign.prospect_list.objectId, 
    })

    qry = 'where={"lists":'+currentList+'}&limit=1000&count=1'
    $.ajax({
      url: 'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      data: qry,
      success: function (res) {
        // TODO - why is this being done
        console.log('RESULTS')
        console.log(res)
        console.log(res.results)
        thissss.setState({
          prospects: res.results,
          prospectListCount: res.count 
        })

        if(res.count > 1000){
          for(i=0;i< Math.ceil(res.count/1000); i++) {
            qry = 'where={"lists":'+currentList+'}&limit=1000&count=1'
            $.ajax({
              url: 'https://api.parse.com/1/classes/Prospect',
              headers: appConfig.headers,
              data: qry,
              success: function (res) {
                prospects = thissss.state.prospects
                thissss.setState({prospects:  prospects.concat(res.results)})
              },
              error: function(err) {}
            })
          }
        }
      },
      error: function(err) { }
    })

    var thiss = this;
    selectedCampaign = this.props.selectedCampaign
    console.debug(this.props.selectedCampaign)
    console.debug('Selected Campaign Batches')
    console.debug(this.props.selectedCampaign.batches)
    batches = this.props.selectedCampaign.batches
    if(_.isEqual(batches, [])){ 
      batch_query = { $in: [false, null] }
    } else {
      qry = _.map(batches, function(batch) {
        return appConfig.pointer('ProspectBatch', batch.objectId)
      })
      batch_query = { $nin: qry }
    }
    prospect_list = thiss.props.selectedCampaign.prospect_list.objectId
    $.ajax({
      url:'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      selectedCampaign: thiss.props.selectedCampaign,
      data: {
        where: JSON.stringify({
            batches: batch_query,
            lists: appConfig.pointer('ProspectList', prospect_list)
        })
      },
      success: function(res) { 
        console.debug('BATCHES QRY')
        console.debug(res.results) 
        thiss.setState({newProspects: res.results})
      },
      error: function(err) { 
        console.debug('BATCHES QRY ERROR')
        console.debug(this.selectedCampaign)
        console.debug(err.responseText) 
      }
    })
  },

  returnToOverview: function() {
    this.props.toggleScreen('Campaigns')
  },

  render: function() {
    //console.log('campaign detail')
    console.log(this.state.currentScreen)
    console.log(this.state.currentScreen.indexOf("sent email"))
    tab_1 = "campaign-tab-link"
    tab_2 = "campaign-tab-link"
    tab_3 = "campaign-tab-link"
    tab_4 = "campaign-tab-link"
    tab_5 = "campaign-tab-link"
    if(this.state.currentScreen == "timeline"){
      //console.debug('SELECTED CAMPAIGN')
      //console.debug(this.props.selectedCampaign)
      lolscreen = FollowupTimeline({
                  templates: this.state.templates, 
                  prospects: this.state.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.state.prospectListCount, 
                  newProspects: this.state.newProspects, 
                  toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
                  initialFollowups: this.props.selectedCampaign.followups})
      tab_1 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "recent activity") {
      lolscreen = CampaignActivityView(null)
      tab_2 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "scheduled followups") {
      lolscreen = CampaignFollowupFeed({
                    batches: this.props.selectedCampaign.batches, 
                    followups: this.props.selectedCampaign.followups})
      tab_3 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "sent mail") {
      lolscreen = CampaignSentEmail({
                      selectedCampaign: this.props.selectedCampaign})
      tab_4 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "analytics") {
      lolscreen = CampaignReport(null)
      tab_5 = "active-campaign-tab campaign tab-link"
    } else{
      console.log('LOL')
      lolscreen = FollowupTimeline({
                  templates: this.state.templates, 
                  prospects: this.state.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.state.prospectListCount, 
                  newProspects: this.state.newProspects, 
                  toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
                  templates: this.state.templates, 
                  initialFollowups: this.props.selectedCampaign.followups})
    }
    //activeTab = "active-campaign-tab campaign tab-link"
      

    list_type = this.props.selectedCampaign.prospect_list.list_type
    if(list_type == "mining_job")
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-cloud-download"}), " ")
    else if(list_type == "signal_list")
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-wifi"}), " ")
    else
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-list-alt"}), " ")

    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    console.log('BATCHES')
    console.log(batches)
    return (
      React.DOM.div({className: "container", 
           style: {width:'100%',height:'100%',paddingLeft:0,paddingRight:0}}, 
        React.DOM.div({style: {marginBottom:15}, id: "campaign-top-detail"}, 
        React.DOM.h5({style: {marginTop:20,marginLeft:20}}, 
          React.DOM.a({href: "javascript:", onClick: this.returnToOverview}, "Campaigns "), 
          React.DOM.small(null, 
            React.DOM.i({style: {marginLeft:10, marginRight:10}, 
               className: "fa fa-chevron-right"})
          ), 
          this.props.selectedCampaign.name
        ), 
        React.DOM.h6({style: {marginLeft:20,display:'inline-block',marginRight:15,marginBottom:0,fontWeight:'bold',fontSize:10}}, 
          React.DOM.span({className: "text-muted"}, "PROSPECT LIST:"), "  "
        ), 
          React.DOM.span({className: "label label-success"}, 
          list_type, 
          this.props.selectedCampaign.prospect_list.name, 
          "     ", 
        React.DOM.i({className: "fa fa-user"}), " ", this.state.prospectListCount
        ), 
        React.DOM.br(null), 
        React.DOM.h6({style: {marginLeft:20,display:'inline-block',marginRight:50,marginTop:0,fontWeight:'bold',fontSize:10}, 
            className: "text-muted"}, 
          "BATCHES:"
        ), 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-sitemap"}), " ", 
          (_.isEqual(batches, [])) ? 1 : batches.length
        ), 
        
        React.DOM.div({style: {border:'1px solid #ddd',borderRadius:5,float:'right',marginTop:-23,marginRight:100}}, 
            React.DOM.div({className: "bg-warning", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer'}}, 
              React.DOM.span({className: "text-warning"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), " 100%"
              )
            ), 
            React.DOM.div({className: "bg-success", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer'}}, 
              React.DOM.span({className: "text-success"}, 
                React.DOM.i({className: "fa fa-eye"}), " 100%"
              )
            ), 
            React.DOM.div({className: "bg-danger", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer'}}, 
              React.DOM.span({className: "text-danger"}, 
                React.DOM.i({className: "fa fa-exclamation-circle"}), " 100%"
              )
            )
        ), 
        
        React.DOM.a({href: "javascript:", 
           style: {float: 'right', marginTop: -35, marginRight: 30, display:'none'}, 
           className: "btn btn-success btn-sm"}, 
          React.DOM.i({className: "fa fa-envelope"}), " Send!"
        )
        
        ), 
              React.DOM.ul({className: "nav nav-tabs campaign-tabs", role: "tablist", style: {paddingRight:0}}, 
                React.DOM.li({className: "campaign-tab"}, " ", React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_1}, "TIMELINE")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_2}, "RECENT ACTIVITY")), 
                React.DOM.li({className: "campaign-tab"}, 
                  React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_3, style: {fontSize:12}}, 
                    "SCHEDULED FOLLOWUPS")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_4}, "SENT MAIL")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_5}, "ANALYTICS"))
              ), 
            lolscreen, 

          (this.state.templateDetailMode) ? EditTemplateView({
            editMode: this.state.editMode, 
            initialTemplateValues: this.state.currentTemplate, 
            saveTemplate: this.saveTemplate, 
            prospect: this.state.prospects[0], 
            toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
            followupDay: this.state.followupDay}) : ""
      )
    );
  },

  saveTemplate: function(template, newTemplate) {
    templates = this.state.templates
    for(i=0;i< this.state.templates.length; i++)
      if(this.state.templates[i].name == template.name)
        break
    
    console.log(template)
    if(newTemplate){
      template.subject = template.subject
      template.name = template.name
      template.body = template.body
      templates.push(template)

      $.ajax({
        url:'https://api.parse.com/1/classes/Template',
        headers:appConfig.headers,
        type:'POST',
        data:JSON.stringify({
          name : template.name,
          subject: template.subject,
          body: template.body,
          user:{
            __type: 'Pointer',
            className:'_User',
            objectId:JSON.parse(localStorage.currentUser).objectId,
          },
          company:JSON.parse(localStorage.currentUser).company,
        }),
        success: function(res) {
          console.log(res)
        },
        error: function() {
        }
      })
    } else {
      templates[i].subject = template.subject
      templates[i].body = template.body

      $.ajax({
        url:'https://api.parse.com/1/classes/Template/'+templates[i].objectId,
        type:'PUT',
        headers:appConfig.headers,
        data:JSON.stringify({
          name : template.name,
          subject: template.subject,
          body: template.body,
        }),
        success: function(res) {
          console.log(res)
        },
        error: function() {
        }
      })
    }

    this.setState({templates: templates })

  },

  toggleTemplateEditMenu: function(currentTemplate, editMode) {
    editMode = (editMode) ? true : false
    this.setState({
      currentTemplate: currentTemplate,
      templateDetailMode: !this.state.templateDetailMode,
    })
  }
});

var FollowupTimeline = React.createClass({displayName: 'FollowupTimeline',
  render: function() {
    return (
        React.DOM.div(null, 
          React.DOM.div({className: "col-md-8 panel panel-default", 
               style: {height:436,paddingLeft:305,paddingTop:50,overflow:'auto',borderRight:0,borderRadius:0, borderTop:0}}, 
                Timeline({
                  templates: this.props.templates, 
                  prospects: this.props.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.props.prospectListCount, 
                  newProspects: this.props.newProspects, 
                  toggleTemplateEditMenu: this.props.toggleTemplateEditMenu, 
                  initialFollowups: this.props.initialFollowups})
          ), 
          React.DOM.div({className: "col-md-4", 
               style: {paddingLeft:0,paddingRight:0,height:436}}, 
            TemplatesMenu({
              templates: this.props.templates, 
              toggleTemplateEditMenu: this.props.toggleTemplateEditMenu})
          )
        )

    )
  }
})

},{"./campaign_activity_view.js.min.js":1,"./campaign_followup_feed.js.min.js":3,"./campaign_report.js.min.js":4,"./campaign_sent_email.js.min.js":5,"./create_template.js.min.js":6,"./edit_template.js.min.js":7,"./followup_timeline.js.min.js":8,"./templates_menu.js.min.js":10}],3:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      followups: []
    }
  },

  componentDidMount: function() {
        // for each batch find followups remaining
        // sort followups by ascending followup day
        //
    // Batch Start Date
    // Current Batch Date
  },

  render: function() {
    var thiss = this;
    followups = _.map(this.props.batches, function(batch) {
      now = moment().startOf('day').valueOf()/1000
      batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
      return _.map(thiss.props.followups, function(followup) {
        followup.batch = batch
        if(followup.day >= batch.currentDay)
          return followup
      })
    })
    followups = _.sortBy(followups, function(followup){ return followup.day })

    console.debug(followups)

    activities = _.map(followups[0], function(followup) {
      return Followups({followup: followup, batch: followup.batch})
    })
    console.debug(activities)

    return (
      React.DOM.div({style: {overflow:'auto',height:436}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Scheduled for "), 
            React.DOM.th(null, "Outreach Stage "), 
            React.DOM.th(null, "Prospect List"), 
            React.DOM.th(null, "Template "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Followups = React.createClass({displayName: 'Followups',
  render: function() {
    // this.props.batch
    // this.props.followup
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " " + ' ' +
              "29 minutes ago"
            )
          ), 
          React.DOM.td(null, 
            "second"
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-list-alt"}), "  " + ' ' +
            "Boston VP Sales - Retail"
            )
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-file-text-o"}), "  " + ' ' +
            "Followup #2 - Provide Value ", React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Subject: Just wanted to followup on the last email "), React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Body: Just wanted to followup on the last email ")

            )
          ), 

          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Send Now"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Remind me in 1 hour"), React.DOM.br(null)
          )
      )
    )
  }
})

},{}],4:[function(require,module,exports){
/** @jsx React.DOM */

lol = 

module.exports = React.createClass({displayName: 'exports',
  // Campaign Report
  getInitialState: function() {
    return {
    }
  },

  componentDidMount: function() { 
    testData = this.testData()
    var industryChart   = dc.pieChart("#industry-chart"),
        spendHistChart  = dc.barChart("#chart-hist-spend"),
        spenderRowChart = dc.rowChart("#chart-row-spenders");

    // set crossfilter
    var ndx = crossfilter(spendData),
        yearDim  = ndx.dimension(function(d) {return +d.Year;}),
        spendDim = ndx.dimension(function(d) {return Math.floor(d.Spent/10);}),
        nameDim  = ndx.dimension(function(d) {return d.Name;}),
        spendPerYear = yearDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendPerName = nameDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendHist    = spendDim.group().reduceCount();

    industryChart
        .width(200).height(200)
        .dimension(yearDim)
        .group(spendPerYear)
        .innerRadius(50);

    //
    // Batch Analytics - Bubble Chart
    // Batch Block Charts
    // Pie Chart - Industry
    // Revenue - PC
    // Company Size - PC
    // Opens / Replies / Link Clicks / Bounces - Bar Chart
    // Titles - PC
    // Time / Date Email Sent - Line Chart
    // Date Prospected - BC
    //
  },
  
  render: function() {
    return (
      React.DOM.div(null, 
        "Report View", 
        React.DOM.div({id: "industry-chart"})
      )
    )
  },

  testData: function() { 
    return [{"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140218.58883.75040@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140219.50015.20571@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140219.50019.67418@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140220.58887.52484@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shadowzprotection.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.598Z", "createdAt": "2014-10-07T15:20:15.147Z", "city": "New Delhi Area, India\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "f44YU2Yrm7", "company_name": "M/S Golden Bricks Constructions Pvt. Ltd.", "mailgun_id": "<20141010140220.19960.3157@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "6B4MDqWqtw"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "e9sMFL1QWx"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:15.147Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "201-500 employees", "name": "Vivek Narang", "industry": "Security and Investigations", "linkedin_url": "in.linkedin.com/pub/vivek-narang/20/b67/39", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shangri-la.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.880Z", "createdAt": "2014-10-07T15:20:13.197Z", "city": "Brisbane, Australia\\u00a0", "archived": true, "loading": false, "objectId": "TSSDEZ3lUA", "company_name": "Shangri-La Hotels and Resorts", "mailgun_id": "<20141010140221.39548.29627@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "PIDGJPqraI"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "mG4U69xDcg"}], "email": "andy.mccutcheon@shangri-la.com", "prospect_created_at": "2014-10-07T15:20:13.197Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Andy McCutcheon", "industry": "Hospitality", "linkedin_url": "au.linkedin.com/pub/andy-mccutcheon/1a/665/650", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140813.19956.20454@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140813.58881.85733@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140814.19938.90169@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140814.77386.74943@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}]
  },

});

},{}],5:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Sent Mail
  getInitialState: function() {
    return {
      sentEmails: []
    }
  },

  componentDidMount: function() {
    thiss = this;
    qry = {
      include: 'campaign,prospect,prospect.email_guesses.pattern',
      order:'-createdAt',
      campaign: {
        __type: 'Pointer',
        className:'Campaign',
        objectId: this.props.selectedCampaign.objectId,
      }
    }
    $.ajax({
      url: 'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({sentEmails: res.results}) },
      error: function() {}
    })
  },

  render: function() {
    sentEmails = []
    for(i=0;i< this.state.sentEmails.length; i++) 
      sentEmails.push(SentEmailRow({sentEmail: this.state.sentEmails[i]}))

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th(null, "Template"), 
            React.DOM.th({style: {width:290}}, "Status")
          ), 
          React.DOM.tbody(null, 
            sentEmails
          )
        )
      )
    );
  }
});

var SentEmailRow = React.createClass({displayName: 'SentEmailRow',
  render: function() {
    sentEmail = this.props.sentEmail
    //console.log(sentEmail)

    email = sentEmail.email
    /*
    if(email == "no_email"){
      first = sentEmail.prospect.name.split(' ')[0]
      last = _.last(sentEmail.prospect.name.split(' '))

      pattern = _.findWhere(sentEmail.prospect.email_guesses, {'tried':false})
      data = {first: first, last: last, fi: first[0], li: last[0]}
      email = Mustache.render(pattern.pattern.pattern, data).toLowerCase()
    }
    */

    replied = "label label-default"
    opened = "label label-default"
    delivered = "label label-default"
    queued = "label label-default"

    if(sentEmail.replied) 
      replied = "label label-success"
    if(sentEmail.opened) 
      opened = "label label-success"
    if(sentEmail.delivered) 
      delivered = "label label-success"
    if(sentEmail.queued) 
      queued = "label label-success"

    return (
      React.DOM.tr(null, 
        React.DOM.td({style: {width:100}}, React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-clock"}), 
            moment(sentEmail.createdAt).fromNow())), 
        React.DOM.td({style: {width:200}}, 
          React.DOM.h6({style: {fontSize:14,fontWeight:'bold',marginBottom:0}}, 
            sentEmail.prospect.name), 
          React.DOM.h6({style: {fontStyle:'italic',marginTop:4,marginBottom:0}}, 
            sentEmail.prospect.pos.trim()), 
          React.DOM.h6({style: {marginTop:4,fontWeight:'bold'}}, 
            React.DOM.i({className: "fa fa-building"}), " ", 
            sentEmail.prospect.company_name)
        ), 
        React.DOM.td({style: {width:200}}, React.DOM.h6(null, email)), 
        React.DOM.td(null, 
          React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-file-text-o"}), " " + ' ' +
            "Template"
          )
        ), 
        React.DOM.td({style: {paddingTop:13}}, 
          React.DOM.span({className: queued}, "Queued"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: delivered}, "Delivered"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: opened}, "Opened"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: replied}, "Replied")
        )
      )
    )
  }
})

},{}],6:[function(require,module,exports){
/** @jsx react.dom */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      
    }
  },

  componentDidMount: function() {
    $('.template-body').html(this.state.templateBody)
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    console.log('EDIT MODE')
    console.log(this.state.editMode)
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      this.props.saveTemplate({
        name: this.state.name,
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
      })
      this.setState({
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
        editMode: !this.state.editMode,
      })
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+this.props.initialTemplateValues.objectId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
    }
  },

  componentDidUpdate: function() {
    /* thiss = this; */

    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.templateSubject)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.templateBody)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? react.dom.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.templateSubject

    if(this.state.editMode){
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-save"}), "   Save Template")
    } else {
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-pencil-square"}), "   Edit Template")
    }

    return (
      react.dom.div(null, 
      react.dom.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
      react.dom.div({id: "editTemplateView", 
           className: "panel panel-info", 
           style: {display:'block'}}, 
           react.dom.div({className: "panel-heading", style: {height:50}}, 
             react.dom.h6({style: {float:'left'}}, 
               react.dom.i({className: "fa fa-file-text-o"}), 
               "  " + this.props.initialTemplateValues.name
             ), 
          toggleButton
        ), 
        react.dom.div({className: "panel-body"}, 
          react.dom.div({className: "editTemplateTitle"}, 
            react.dom.span(null, "Subject: "), 
            subjectPlace
          ), 
         react.dom.br(null), 
         react.dom.div({className: "templateDetails"}, 
           react.dom.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
             "Created by Mark on Jul. 21, 2014"
           ), 
           react.dom.h6({style: {marginTop:'0'}, className: "text-muted"}, 
             "last updated 7 days ago"
           )
         ), 
        react.dom.br(null), 
        react.dom.div({className: "panel panel-default"}, 
          react.dom.div({className: "panel-body summer template-body"}
          )
        )
    )
)
)
    );
  }
});

},{}],7:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      name: this.props.initialTemplateValues.name,
      body: this.props.initialTemplateValues.body,
      subject: this.props.initialTemplateValues.subject,
      editMode: this.props.initialTemplateValues.editMode
    }
  },

  componentDidMount: function() {
    console.log('did mount')
    $('.template-body').html(this.state.body)
    if(this.state.editMode) {
      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })
    }

    renderjson.set_show_to_level('all')
    prospect = _.pick(this.props.prospect, 
      'company_name', 'name', 'pos'
    )
    prospect.first_name = prospect.name.split(' ')[0]
    prospect.last_name = _.last(prospect.name.split(' '))
    prospect = _.omit(prospect, 'name')

    document.getElementById("editTemplate").appendChild(renderjson(prospect));
    $('#editTemplateOverlay').html()
    thiss = this;
    $('.renderjson').click(function() {
      thiss.props.toggleTemplateEditMenu()
    })

    $('.renderjson').css({
      'position': 'absolute',
      'z-index': '1000000000',
      'background-color':'rgba(0,0,0,0)',
      'border':'0',
      'color':'white',
      'margin-top':'0px',
      'height': '542px',
      'overflow':'auto',
      'width':'380px'
    })

    $('.key').css({
      'cursor':'pointer'
    })

    $('.timeline').css({
      '-webkit-filter': 'blur(10px)',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': 'blur(10px)',
    })
  },
  componentWillUnmount:function() {
    $('.timeline').css({
      '-webkit-filter': '',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': '',
    })
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })

      console.log('look at this')
      console.log(name)
      name = (this.props.initialTemplateValues.newTemplate) ? $('#template-name').val() : this.state.name
      this.props.saveTemplate({
        name: name,
        body: $('.summer').code(),
        subject: $('.subject').val(),
      }, this.props.initialTemplateValues.newTemplate)

      this.setState({
        name: $('#template-name').val(),
        body: $('.summer').code(),
        subject: $('.subject').val(),
        editMode: !this.state.editMode,
      })

      objId = this.props.initialTemplateValues.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+objId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),
                             subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })
    }
  },

  componentWillUpdate: function(newProps) {
    console.log('THE NEW PROPS')
    console.log(newProps)
  },

  componentDidUpdate: function() {
    /* thiss = this; */
    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.subject)
      $('#template-name').val(this.state.name)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.body)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? React.DOM.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.subject

    if(this.state.editMode){
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-save"}), "   Save Template")

       if(this.props.initialTemplateValues.newTemplate){
         the_name = React.DOM.input({className: "form-control", 
                           id: "template-name", 
                           style: {float:'left',width:200}})
       }
    } else {
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")

       the_name = React.DOM.h6({style: {float:'left'}}, 
                   React.DOM.i({className: "fa fa-file-text-o"}), " ", 
                   this.state.name
                  )
    }

    return (
      React.DOM.div({id: "editTemplate"}, 
        React.DOM.h5({className: "example-template-title"}, "Example Template Values"), 
        React.DOM.div({className: "example-template-title", 
             style: {marginLeft:215, marginTop:8}}, 
          React.DOM.a({href: "javascript:", 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-left"})), 
          React.DOM.a({href: "javascript:", 
            style: {marginLeft:5}, 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-right"}))
        ), 
        React.DOM.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
          React.DOM.div({id: "editTemplateView", 
               className: "panel panel-default", 
               style: {display:'block'}}, 
               React.DOM.div({className: "panel-heading", style: {height:50}}, 
                 the_name, 
              React.DOM.a({href: "javascript:", 
                className: "btn btn-default btn-xs", 
                style: {float:'right',marginLeft:5,marginTop:5}}, 
                React.DOM.i({className: "fa fa-trash"})
              ), 
              toggleButton
            ), 
            React.DOM.div({className: "panel-body"}, 
              React.DOM.div({className: "editTemplateTitle"}, 
                React.DOM.span(null, "Subject: "), 
                subjectPlace
              ), 
             React.DOM.br(null), 
             React.DOM.div({className: "templateDetails"}, 
               React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
                 "Created by Mark on Jul. 21, 2014"
               ), 
               React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, 
                 "last updated 7 days ago"
               )
             ), 
            React.DOM.br(null), 
            React.DOM.div({className: "panel panel-default"}, 
              React.DOM.div({className: "panel-body summer template-body"}
              )
            )
        )
      )
    )
    );
  }
});

},{}],8:[function(require,module,exports){
/** @jsx React.DOM */
var SendEmailModal = require('./send_email_modal.js.min.js')
var TimelineDayElement = require('./timeline_day_element.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // FollowupTimeline
  getInitialState: function() {
    initialFollowups = this.props.initialFollowups
    initialFollowups = (initialFollowups) ? initialFollowups : []
    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    return {
      followups: _.compact(initialFollowups),
      loading: false,
      currentTemplate:'',
      currentBatch: '',
      batches : batches
    }
  },

  componentDidMount: function() {
    thiss = this;
    $('.day').tooltip({
      placement: 'right',
      title:'+ Add a follow-up'
    })

    console.log(this.props.selectedCampaign)
     company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
     currentCampaign = appConfig.pointer('Campaign', this.props.selectedCampaign.objectId)
     $.ajax({
       url:'https://api.parse.com/1/classes/Followup',
       type:'GET',
       headers: appConfig.headers,
       data: {
         where: JSON.stringify({
           campaign: currentCampaign,
           company: appConfig.company
         }),
         include:'template',
       },
       success: function(res) {
         console.log('followup timeline')
         console.log(res.results)
       },
       error: function(err) {
         console.log('error')
         console.log(err)
       }
     })
  },

  addFollowupSentToBatch: function(batch, followup) {
    batches = _.map(this.state.batches, function(_batch) {
                  if(_batch.objectId == batch.objectId) {
                    if(_batch.followups)
                      _batch.followups.push(followup)
                    else
                      _batch.followups = [followup]
                  }
                  return _batch
              })
    // Persist
  },
  
  render: function() {
    timelineElements = []
    followups = this.state.followups

    batches = _.map(this.state.batches, function(batch) {
      if(batch){
        now = moment().startOf('day').valueOf()
        batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
        return batch
      }
    })
    batches = _.compact(batches)

    for(i=0;i< 31;i++){
      followup = _.findWhere(this.state.followups, {day: i})
      var elementType = (followup) ? true : false
      var currentTemplate = (followup) ? followup.template : false
      var addTemplateMode = (followup) ? followup.addTemplateMode : true
      campaign = this.props.selectedCampaign

      currentBatch = {}
      batch_started_today = false
      alreadySent = false
      batchCount = undefined
      if(i == 0) {
        batchCount = (batches) ? this.props.newProspects.length : this.props.prospects.length
      } else {
        batch = _.findWhere(batches, {currentDay: i})
        if(batch) {
          currentBatch = batch.objectId
          console.debug(batch.objectId)
          batchCount = "~"
          if(followup) {
            _batches = followup.batches
            alreadySent = _.findWhere(_batches, _.pick(batch,'objectId'))
          }
        }
      }

      timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                    dayCount: i, 
                                    elementType: !elementType, 
                                    currentTemplate: currentTemplate, 
                                    batchCount: batchCount, 
                                    currentBatch: currentBatch, 
                                    alreadySent: alreadySent, 
                                    addTemplateMode: addTemplateMode, 
                                    templates: this.props.templates, 
                                    newProspects: this.props.newProspects, 
                                    addFollowup: this.addFollowup, 
                                    editFollowup: this.editFollowup, 
                                    saveFollowup: this.saveFollowup, 
                                    removeFollowup: this.removeFollowup, 
                                 addFollowupSentToBatch: this.addFollowupSentToBatch, 
                                    batches: this.props.selectedCampaign.batches, 
                                    prospectListCount: this.props.prospectListCount, 
                                    setCurrentBatch: this.setCurrentBatch, 
                                    setCurrentTemplate: this.setCurrentTemplate})
                                  ))

      if(i == 0 && _.findWhere(batches, {currentDay: 0})){
          currentBatch = _.findWhere(batches, {currentDay: 0}).objectId
          console.debug('0.5')
          console.debug(currentBatch)
          batchCount = "~"
          timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                  dayCount: 0.5, 
                                  batchCount: batchCount, 
                                  currentBatch: currentBatch, 
                                  newProspects: this.props.newProspects, 
                                  elementType: true, 
                                  batches: this.props.selectedCampaign.batches, 
                                  prospectListCount: this.props.prospectListCount, 
                                  setCurrentBatch: this.setCurrentBatch})
                                ))
      }
    }
    return (
      React.DOM.div(null, 
        React.DOM.div({className: "timeline", 
             style: {height:'100%',backgroundColor:'rgb(90, 107, 119)', width:5,marginTop:-35}}, 
             timelineElements
        ), 
        SendEmailModal({prospects: this.props.prospects, 
                        selectedCampaign: this.props.selectedCampaign, 
                        newProspects: this.props.newProspects, 
                        addFollowupSentToBatch: this.addFollowupSentToBatch, 
                        currentBatch: this.state.currentBatch, 
                        currentTemplate: this.state.currentTemplate})
      )
    );
  },

  createFollowup: function() {
    //
  },         

  addFollowup: function(day) {
    //console.log('called template edit menu')
    followups = this.state.followups
    followups.push({addTemplateMode: true, day: day})
    this.setState({ followups: followups })
  },

  editFollowup: function(day) {
    // find template set editmode is false
    followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){ followup.addTemplateMode = true }
      return followup
    })
    this.setState({followups: followups})
  },

  saveFollowup: function(day, chosenTemplate) {
    new_followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){
        followup.addTemplateMode = false
        followup.template = chosenTemplate
      }
      return followup
    })
    this.setState({followups: new_followups})
    followup = _.findWhere(new_followups, {day: day})

      if(followup.objectId){
        url = "/"+followup.objectId; type="PUT"
        data = {template: appConfig.pointer('Template', chosenTemplate.objectId)}
      } else {
        url = ""; type="POST";

          data = {
            day: day,
            campaign : appConfig.pointer('Campaign', 
                                         this.props.selectedCampaign.objectId),
            template: appConfig.pointer('Template', chosenTemplate.objectId),
          }
      }

    thiss = this;
    $.ajax({
      url:'https://api.parse.com/1/classes/Followup'+url,
      type:type,
      data:JSON.stringify(data),
      headers:appConfig.headers,
      success: function(res) {
        new_followups = _.map(new_followups, function(followup) {
          if(followup.day == day) { followup.objectId = false }
          return followup
        })
        thiss.setState({followups: new_followups})

        console.log(res)
        $.ajax({
          url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
          type:'PUT',
          data:JSON.stringify({followups: {
            __op: 'AddUnique',
            objects:[appConfig.pointer('Followup', res.objectId)]
          }}),
          headers:appConfig.headers,
          success: function() { },
          error: function() { }
        })
      },
      error: function() { },
    })
  },

  removeFollowup: function(day) {
    followups = []
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day != day)
        followups.push(this.state.followups[i])
      
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day == day)
        break
    
    this.setState({followups: followups}) 
    id = this.state.followups[i]

    thiss = this;
    if(id) {
      id = id.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Followup/'+id,
        headers:appConfig.headers,
        type:'DELETE',
        success: function(res) { console.log(res) }
      })

     console.log('REMOVE ARRAY')
      $.ajax({
        url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
        headers:appConfig.headers,
        type:'PUT',
        data: JSON.stringify({
          followups: {
            __op : 'Remove',
            objects: [appConfig.pointer('Followup', id)]
          }
        }),
        success: function(res){ console.log(res) },
        error: function() { }
      })
    }
  },

  setCurrentBatch: function(currentBatch) {
    this.setState({currentBatch: currentBatch})
  },

  setCurrentTemplate: function(template) {
    this.setState({currentTemplate: template })
  }
});



},{"./send_email_modal.js.min.js":9,"./timeline_day_element.js.min.js":11}],9:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      currentProspect: 0,
    }
  },

  sendEmails: function() {
    selectedCampaign = this.props.selectedCampaign
    campaign_id = selectedCampaign.objectId
    prospectlist_id = selectedCampaign.prospect_list.objectId
    template_id = this.props.currentTemplate.objectId
    
    $.ajax({
      url:'https://nameless-retreat-3525.herokuapp.com/send_email',
      //url:'http://127.0.0.1:5000/send_email',
      data: {
        template_id : template_id,
        campaign_id : campaign_id,
        prospectlist_id : prospectlist_id,
      },
      success: function(res) { console.log(res.results) },
      error: function(err) { console.log(err) }
    })

    /*
    */
    // Update Followup
    // Persist Followup
    // close modal
  },

  render: function() {
    prospect = this.props.prospects[this.state.currentProspect]
    prospect = (prospect) ? prospect : {'name':'','email':''}

    var thiss = this;
    console.debug('SEND EMAIL BATCH')
    console.debug(this.props.currentBatch)
    newBatch = _.isEqual(this.props.currentBatch, {})
    prospects = (newBatch) ? this.props.newProspects : this.props.prospects
    if(newBatch){
      prospects = _.map(this.props.newProspects, function(prospect) {
          return UserPlaceHolder({prospect: prospect})
      })
    } else {
      prospects = _.map(this.props.prospects, function(prospect) {
        if(_.findWhere(prospect.batches, {objectId: thiss.props.currentBatch}))
          return UserPlaceHolder({prospect: prospect})
      })
    }
    prospects = _.compact(prospects)
    console.debug(prospects)
    console.debug(prospects.length)
    prospectCount = prospects.length
    email = (prospect.email) ? prospect.email.toLowerCase() : ""
    return (
      React.DOM.div({className: "modal fade bs-sendEmail-modal-lg", tabIndex: "-1", 
           role: "dialog", 'aria-labelledby': "mySmallModalLabel", 'aria-hidden': "true", 
           id: "sendEmailModal", style: {top:'10px'}}, 
            React.DOM.div({className: "modal-dialog modal-lg"}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.button({type: "button", className: "close", 'data-dismiss': "modal"}, React.DOM.span({'aria-hidden': "true"}, "×"), 
                    React.DOM.span({className: "sr-only"}, "Close")), 
        React.DOM.button({type: "button", 
                onClick: this.sendEmails, 
                style: {float:'right'}, 
                className: "btn btn-primary btn-sm"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), "  Send Email"), 
        React.DOM.button({type: "button", style: {marginRight:10, float:'right'}, 
                className: "btn btn-default btn-sm", 'data-dismiss': "modal"}, "Close"), 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    React.DOM.i({className: "fa fa-envelope"}), "  Send Email" + ' ' +
                    "  ", 
                    React.DOM.small(null, "("+prospectCount+")")
                  )
                ), 
                React.DOM.div({className: "modal-body", style: {paddingTop:5}}, 
                  React.DOM.h4(null, "People"), 
                  
                  React.DOM.div({className: "prospect-container"}, 
                    prospects
                  ), 
                  React.DOM.br(null), 
                  React.DOM.h4({style: {display:'inline-block'}}, "Emails    ", 
                    React.DOM.small(null, (this.state.currentProspect+1)+' of '+prospectCount
                  )), 
                  "   ", 
                  React.DOM.a({href: "javascript:", 
              className: (this.state.currentProspect == 0 ) ? "btn disabled" : "btn", 
                    onClick: this.previousProspect}, React.DOM.i({className: "fa fa-arrow-left"})), 
                  React.DOM.a({href: "javascript:", 
            className: (this.state.currentProspect == 135 ) ? "btn disabled" : "btn", 
                    onClick: this.nextProspect}, React.DOM.i({className: "fa fa-arrow-right"})), 

                  React.DOM.div(null, 

React.DOM.ul({className: "list-group email-holder", style: {borderTop:'solid 1px #eee'}}, 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "To:  "), 
    prospect.name + " - " + email
  ), 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "Subject:  "), " ", this.props.currentTemplate.subject
  ), 
  React.DOM.li({className: "list-group-item body"})
)
  
                  )

                ), 

      React.DOM.div({className: "modal-footer", style: {display:'none'}}, 
        React.DOM.button({type: "button", 
                className: "btn btn-default", 'data-dismiss': "modal"}, "Close"), 
        React.DOM.button({type: "button", 
                className: "btn btn-primary"}, "Send Email")
      )
              )
            )
          )
    );
  },

  previousProspect: function() {
    this.setState({currentProspect: this.state.currentProspect-1 })
  },

  nextProspect: function() {
    this.setState({currentProspect: this.state.currentProspect+1 })
  },

  parseTemplate: function(templateBody) {
    first_name = prospect.name.split(' ')[0]
    //hiring_signal = prospect.signals

    signals = (prospect.signals) ? prospect.signals[0] : ""
    templateBody = Mustache.render(templateBody, {
      hiring_signal: signals,
      first_name: prospect.name.split(' ')[0]
    })

    console.log(templateBody)
      
    return templateBody
  },

  componentDidUpdate: function() {
    //console.log(this.props.currentTemplate)
    parsedTemplate = this.parseTemplate(this.props.currentTemplate.body)
    
    //$('.body').html(this.props.currentTemplate.body)
    $('.body').html(parsedTemplate)
  }
});

var UserPlaceHolder = React.createClass({displayName: 'UserPlaceHolder',
  render: function() {
    return (
        React.DOM.div({className: "btn-group", style: {marginRight:5,marginBottom:5}}, 
          React.DOM.div({className: "btn-group"}, 
            React.DOM.button({type: "button", 
                    className: "btn btn-success btn-sm"}, 
              React.DOM.i({className: "fa fa-user"}), "  ", 
              (this.props.prospect) ? this.props.prospect.name : ""
            )
          ), 
          React.DOM.button({type: "button", className: "btn btn-success btn-sm"}, 
            React.DOM.i({className: "fa fa-trash-o"})
          )
        )
    )
  }
});

},{}],10:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  //TemplatesMenu
  toggleTemplateEditMenu: function(currentTemplate) {
    this.props.toggleTemplateEditMenu(currentTemplate)
  },

  createTemplate: function() {
    this.props.toggleTemplateEditMenu({
      name: '',
      body:'',
      subject:'',
      editMode:true,
      newTemplate: true
    }, true)
  },

  render: function() {
    //console.log(this.props.templates)
    templates = []
    for(i=0;i< this.props.templates.length; i++) {
      templates.push(
        TemplateListItem({
          toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
          template: this.props.templates[i]})
      )
    }

    return (
      React.DOM.div({className: "", style: {padding:'0', height:'100%',textAlign:'center'}}, 
        React.DOM.div({className: "panel panel-default", 
             style: {borderRight:0,borderRadius:0,height:'100%', overflow:'auto'}}, 
          React.DOM.div({className: "panel-heading", style: {height:40}}, 
            React.DOM.span({style: {float:'left',fontSize:14,fontWeight:'bold'}}, 
              React.DOM.i({className: "fa fa-file-text-o"}), 
              React.DOM.span({style: {marginLeft:5}}, "Templates")
            ), 
            React.DOM.a({href: "javascript:", 
              className: "btn btn-success btn-xs", 
              onClick: this.createTemplate, 
                style: {float:'right'}}, 
              React.DOM.i({className: "fa fa-plus"}), 
              React.DOM.span({style: {marginLeft:5}}, "Create Template")
            )
          ), 
          React.DOM.ul({className: "list-group", 
              style: {textAlign:'left'}}, 
            templates
          )
        )
      )
    )
  }
});

var TemplateListItem = React.createClass({displayName: 'TemplateListItem',
  toggleTemplateEditMenu: function() {
    console.log(this.props.template)
    template = this.props.template
    template.editMode = false
    this.props.toggleTemplateEditMenu(template)
  },

  render: function() {
    return (
      React.DOM.div(null, 
        React.DOM.a({href: "javascript:", 
          style: {borderBottom: '1px solid rgb(221, 221, 221)',paddingTop:5,paddingBottom:0}, 
           onClick: this.toggleTemplateEditMenu, 
           className: "list-group-item"}, 
           React.DOM.span({className: "label label-default"}, 
             this.props.template.name
           ), 
           React.DOM.h6(null, "Subject:", React.DOM.span({className: "text text-muted"}, 
             " " + this.props.template.subject
           ))
         )
      )
    );
  }
});

},{}],11:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // TimelineDayElement
  // TODO
  // - add prospect list progression
  // - add scheduled followup
  //
  getInitialState: function() {
    // 
    return {
      followupCompleted: 0,
    }
  },

  addFollowup: function() {
    this.props.addFollowup(this.props.dayCount)
  },

  render: function() {
    if(this.props.addTemplateMode) {
      mode = EditTemplate({addFollowup: this.props.addFollowup, 
                           saveFollowup: this.props.saveFollowup, 
                           removeFollowup: this.props.removeFollowup, 
                           dayCount: this.props.dayCount, 
                           templates: this.props.templates})
    } else {
      mode = TemplateFollowup({currentTemplate: this.props.currentTemplate, 
                               editFollowup: this.props.editFollowup, 
                               dayCount: this.props.dayCount, 
                               currentBatch: this.props.currentBatch, 
                               hasBatch: typeof(this.props.batchCount) != "undefined", 
                               setCurrentBatch: this.props.setCurrentBatch, 
                               dayCount: this.props.dayCount, 
                               removeFollowup: this.props.removeFollowup, 
                               setCurrentTemplate: this.props.setCurrentTemplate})
    }
    if(this.props.alreadySent) {
      mode = FollowupCompleted({currentTemplate: this.props.currentTemplate})
    }

    mode = (this.props.elementType) ? "" : mode
    addFollowup = (this.props.elementType) ? this.addFollowup : ""
    if(typeof(this.props.batchCount) != "undefined")
      batchStage = BatchStage({currentBatch: this.props.currentBatch, 
                               newProspects: this.props.newProspects, 
                               prospectListCount: this.props.prospectListCount, 
                               batchCount: this.props.batchCount, 
                               hasScheduledEmail: mode != "", 
                               dayCount: this.props.dayCount})
    else
      batchStage = ""

    dayCount = (this.props.dayCount != 0.5) ? "D"+this.props.dayCount : ""

    return (
      React.DOM.div(null, 
        React.DOM.div({onClick: addFollowup, className: "day", 'data-trigger': "manual"}, 
          dayCount
        ), 
        mode, batchStage
      )
    )
  },

  setCurrentTemplate: function(template) {
    this.props.setCurrentTemplate(template)
  }
});

var FollowupCompleted = React.createClass({displayName: 'FollowupCompleted',
  render: function() {
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs disabled", 
                'data-target': ".bs-sendEmail-modal-lg", 
                onClick: this.setCurrentTemplate, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-check"}), " Sent"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"}))
      )
                                         )
  }
})

var TemplateFollowup = React.createClass({displayName: 'TemplateFollowup',
  // EditMode False

  setCurrentTemplate: function() {
    this.props.setCurrentTemplate(this.props.currentTemplate)
    // setCurrentBatch
    this.props.setCurrentBatch(this.props.currentBatch)
    $('.bs-sendEmail-modal-lg').modal()
  },

  waitForBatch: function() {
    alertify.log("You must wait for a batch!");
  },

  render: function() {
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
        onClick: (this.props.hasBatch) ? this.setCurrentTemplate : this.waitForBatch, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-paper-plane"}), " Send"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        trash
      )
    );
  },

  editFollowup: function(e) { 
    e.preventDefault()
    console.log(this.props.dayCount)
    this.props.editFollowup(this.props.dayCount)
  },

  removeFollowup: function() {
    console.log('remove')
    this.props.removeFollowup(this.props.dayCount)
  }
});

var BatchStage = React.createClass({displayName: 'BatchStage',
  // Different Stages of People Added to Prospect List
  getInitialState: function() {
    // 
    return {
      initialBatchCount: this.props.batchCount
    }
  },

  componentDidMount: function() {
    // state
    //console.debug('INSIDE BATCH '+this.props.dayCount)
    console.debug(this.props.currentBatch)
    _batches = appConfig.pointer('ProspectBatch', this.props.currentBatch)
    if(this.props.batchCount == "~") {
      // Why doesnt this work 
      var thissss = this;
      console.debug('INSIDE BATCH '+thiss.props.dayCount)
      console.debug(_batches)
      $.ajax({
        url:'https://api.parse.com/1/classes/Prospect',
        batches: _batches,
        data: {
          where: JSON.stringify({
            batches: _batches
          }),
          count: true,
        },
        headers: appConfig.headers,
        success: function(res) { 
          //console.debug('SUCCESS GET COUNT ' + res.count)
          //console.debug(res.results) 
          thissss.setState({initialBatchCount: res.count})
        },
        error: function(err) { 
          thissss.setState({initialBatchCount: 0 })
        }
      })
    }
  },

  componentWillReceiveProps: function(nextProps) {
    if(this.props.dayCount == 0)
      this.setState({ initialBatchCount: nextProps.batchCount })
  },


  render: function() {
    if(this.props.hasScheduledEmail)
      batchStageStyle = {top:-42, left:6}
    else
      batchStageStyle = {}

    if(this.props.dayCount == 0.5)
      batchStageStyle.left = 7

    //console.log('BATCH STAGE')
    //console.log(this.props)
    //console.debug(this.props.currentBatch)                                                           

    return (
      React.DOM.div({className: "followup-placement arrow_box tmp", style: batchStageStyle}, 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-user"}), " ", 
          this.state.initialBatchCount
        ), " ", 
        React.DOM.h6({style: {display:'inline-block'}}, 
          "prospects in the sales cycle.")
      )
    );
  }
});

var EditTemplate = React.createClass({displayName: 'EditTemplate',
  // Edit Mode - True
  render: function() {
    options = []
    for(i=0;i< this.props.templates.length; i++) {
      options.push( React.DOM.option(null, this.props.templates[i].name))
    }
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, " ", React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:55,display:'inline-block'}, 
            className: "text-muted"}, 
          "Choose :"
        ), 
        React.DOM.select({className: "form-control input-sm", 
                id: "chooseTemplateForFollowup", 
                style: {display:'inline-block',width:127,marginRight:5}}, 
          options
        ), 

        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
                onClick: this.saveFollowup, 
                style: {marginRight:5}}, 
          React.DOM.i({className: "fa fa-check"})), 
        trash
      )
    )
  },

  saveFollowup: function(e) {
    //get template from currentTemplate
    e.preventDefault()
    chosenTemplate = $('#chooseTemplateForFollowup').val()
    console.log(chosenTemplate)
    for(i=0;i< this.props.templates.length; i++){
      if(this.props.templates[i].name == chosenTemplate){
        chosenTemplate = this.props.templates[i]
        break
      }
    }
    console.log(chosenTemplate)
    
    this.props.saveFollowup(this.props.dayCount, chosenTemplate)
  },

  removeFollowup: function(day) {
    this.props.removeFollowup(this.props.dayCount)
  },
});


},{}]},{},[2])


},{"./campaign_activity_view.js.min.js":1,"./campaign_followup_feed.js.min.js":3,"./campaign_report.js.min.js":4,"./campaign_sent_email.js.min.js":5,"./create_template.js.min.js":8,"./edit_template.js.min.js":9,"./followup_timeline.js.min.js":12,"./send_email_modal.js.min.js":14,"./templates_menu.js.min.js":17,"./timeline_day_element.js.min.js":18}],3:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      followups: []
    }
  },

  componentDidMount: function() {
        // for each batch find followups remaining
        // sort followups by ascending followup day
        //
    // Batch Start Date
    // Current Batch Date
  },

  render: function() {
    var thiss = this;
    followups = _.map(this.props.batches, function(batch) {
      now = moment().startOf('day').valueOf()/1000
      batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
      return _.map(thiss.props.followups, function(followup) {
        followup.batch = batch
        if(followup.day >= batch.currentDay)
          return followup
      })
    })
    followups = _.sortBy(followups, function(followup){ return followup.day })

    console.debug(followups)

    activities = _.map(followups[0], function(followup) {
      return Followups({followup: followup, batch: followup.batch})
    })
    console.debug(activities)

    return (
      React.DOM.div({style: {overflow:'auto',height:436}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Scheduled for "), 
            React.DOM.th(null, "Outreach Stage "), 
            React.DOM.th(null, "Prospect List"), 
            React.DOM.th(null, "Template "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Followups = React.createClass({displayName: 'Followups',
  render: function() {
    // this.props.batch
    // this.props.followup
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " " + ' ' +
              "29 minutes ago"
            )
          ), 
          React.DOM.td(null, 
            "second"
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-list-alt"}), "  " + ' ' +
            "Boston VP Sales - Retail"
            )
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-file-text-o"}), "  " + ' ' +
            "Followup #2 - Provide Value ", React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Subject: Just wanted to followup on the last email "), React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Body: Just wanted to followup on the last email ")

            )
          ), 

          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Send Now"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Remind me in 1 hour"), React.DOM.br(null)
          )
      )
    )
  }
})

},{}]},{},[1])


},{}],4:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

lol = 

module.exports = React.createClass({displayName: 'exports',
  // Campaign Report
  getInitialState: function() {
    return {
    }
  },

  componentDidMount: function() { 
    testData = this.testData()
    var industryChart   = dc.pieChart("#industry-chart"),
        spendHistChart  = dc.barChart("#chart-hist-spend"),
        spenderRowChart = dc.rowChart("#chart-row-spenders");

    // set crossfilter
    var ndx = crossfilter(spendData),
        yearDim  = ndx.dimension(function(d) {return +d.Year;}),
        spendDim = ndx.dimension(function(d) {return Math.floor(d.Spent/10);}),
        nameDim  = ndx.dimension(function(d) {return d.Name;}),
        spendPerYear = yearDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendPerName = nameDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendHist    = spendDim.group().reduceCount();

    industryChart
        .width(200).height(200)
        .dimension(yearDim)
        .group(spendPerYear)
        .innerRadius(50);

    //
    // Batch Analytics - Bubble Chart
    // Batch Block Charts
    // Pie Chart - Industry
    // Revenue - PC
    // Company Size - PC
    // Opens / Replies / Link Clicks / Bounces - Bar Chart
    // Titles - PC
    // Time / Date Email Sent - Line Chart
    // Date Prospected - BC
    //
  },
  
  render: function() {
    return (
      React.DOM.div(null, 
        "Report View", 
        React.DOM.div({id: "industry-chart"})
      )
    )
  },

  testData: function() { 
    return [{"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140218.58883.75040@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140219.50015.20571@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140219.50019.67418@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140220.58887.52484@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shadowzprotection.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.598Z", "createdAt": "2014-10-07T15:20:15.147Z", "city": "New Delhi Area, India\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "f44YU2Yrm7", "company_name": "M/S Golden Bricks Constructions Pvt. Ltd.", "mailgun_id": "<20141010140220.19960.3157@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "6B4MDqWqtw"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "e9sMFL1QWx"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:15.147Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "201-500 employees", "name": "Vivek Narang", "industry": "Security and Investigations", "linkedin_url": "in.linkedin.com/pub/vivek-narang/20/b67/39", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shangri-la.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.880Z", "createdAt": "2014-10-07T15:20:13.197Z", "city": "Brisbane, Australia\\u00a0", "archived": true, "loading": false, "objectId": "TSSDEZ3lUA", "company_name": "Shangri-La Hotels and Resorts", "mailgun_id": "<20141010140221.39548.29627@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "PIDGJPqraI"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "mG4U69xDcg"}], "email": "andy.mccutcheon@shangri-la.com", "prospect_created_at": "2014-10-07T15:20:13.197Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Andy McCutcheon", "industry": "Hospitality", "linkedin_url": "au.linkedin.com/pub/andy-mccutcheon/1a/665/650", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140813.19956.20454@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140813.58881.85733@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140814.19938.90169@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140814.77386.74943@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}]
  },

});

},{}]},{},[1])


},{}],5:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Sent Mail
  getInitialState: function() {
    return {
      sentEmails: []
    }
  },

  componentDidMount: function() {
    thiss = this;
    qry = {
      include: 'campaign,prospect,prospect.email_guesses.pattern',
      order:'-createdAt',
      campaign: {
        __type: 'Pointer',
        className:'Campaign',
        objectId: this.props.selectedCampaign.objectId,
      }
    }
    $.ajax({
      url: 'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({sentEmails: res.results}) },
      error: function() {}
    })
  },

  render: function() {
    sentEmails = []
    for(i=0;i< this.state.sentEmails.length; i++) 
      sentEmails.push(SentEmailRow({sentEmail: this.state.sentEmails[i]}))

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th(null, "Template"), 
            React.DOM.th({style: {width:290}}, "Status")
          ), 
          React.DOM.tbody(null, 
            sentEmails
          )
        )
      )
    );
  }
});

var SentEmailRow = React.createClass({displayName: 'SentEmailRow',
  render: function() {
    sentEmail = this.props.sentEmail
    //console.log(sentEmail)

    email = sentEmail.email
    /*
    if(email == "no_email"){
      first = sentEmail.prospect.name.split(' ')[0]
      last = _.last(sentEmail.prospect.name.split(' '))

      pattern = _.findWhere(sentEmail.prospect.email_guesses, {'tried':false})
      data = {first: first, last: last, fi: first[0], li: last[0]}
      email = Mustache.render(pattern.pattern.pattern, data).toLowerCase()
    }
    */

    replied = "label label-default"
    opened = "label label-default"
    delivered = "label label-default"
    queued = "label label-default"

    if(sentEmail.replied) 
      replied = "label label-success"
    if(sentEmail.opened) 
      opened = "label label-success"
    if(sentEmail.delivered) 
      delivered = "label label-success"
    if(sentEmail.queued) 
      queued = "label label-success"

    return (
      React.DOM.tr(null, 
        React.DOM.td({style: {width:100}}, React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-clock"}), 
            moment(sentEmail.createdAt).fromNow())), 
        React.DOM.td({style: {width:200}}, 
          React.DOM.h6({style: {fontSize:14,fontWeight:'bold',marginBottom:0}}, 
            sentEmail.prospect.name), 
          React.DOM.h6({style: {fontStyle:'italic',marginTop:4,marginBottom:0}}, 
            sentEmail.prospect.pos.trim()), 
          React.DOM.h6({style: {marginTop:4,fontWeight:'bold'}}, 
            React.DOM.i({className: "fa fa-building"}), " ", 
            sentEmail.prospect.company_name)
        ), 
        React.DOM.td({style: {width:200}}, React.DOM.h6(null, email)), 
        React.DOM.td(null, 
          React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-file-text-o"}), " " + ' ' +
            "Template"
          )
        ), 
        React.DOM.td({style: {paddingTop:13}}, 
          React.DOM.span({className: queued}, "Queued"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: delivered}, "Delivered"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: opened}, "Opened"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: replied}, "Replied")
        )
      )
    )
  }
})

},{}]},{},[1])


},{}],6:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Campaigns
  getInitialState: function() {
    return {
      selectedScreen: 'Overview',
    }
  },

  changeSelectedCampaign: function(campaign) {
    //this.props.toggleScreen('CampaignDetail')
    this.props.changeSelectedCampaign('CampaignDetail', campaign)
  },

  render: function() {
    campaigns = []
    console.log(this.props)
    for(i=0;i< this.props.campaigns.length; i++){ 
      campaigns.push(CampaignRow({
                        toggleScreen: this.toggleScreen, 
                        deleteCampaign: this.props.deleteCampaign, 
                        changeSelectedCampaign: this.changeSelectedCampaign, 
                        campaign: this.props.campaigns[i]}) )
    }
    return (
      React.DOM.div({style: {overflow:'auto',height:550}}, 
        React.DOM.table({className: "table table-striped"}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Campaign Name"), 
            React.DOM.th(null, "Prospect List"), 
            React.DOM.th({style: {textAlign:'center'}}, "Delivered"), 
            React.DOM.th({style: {textAlign:'center'}}, "Opened"), 
            React.DOM.th({style: {textAlign:'center',display:'none'}}, "Replied"), 
            React.DOM.th({style: {textAlign:'center',display:'none'}}, "Link Clicks"), 
            React.DOM.th({style: {textAlign:'center'}}, "Bounces"), 
            React.DOM.th({style: {width:150,textAlign:'center'}}, " ")
          ), 
          React.DOM.tbody(null, 
            campaigns
          )
        )
      )
    );
  },
});

var CampaignRow = React.createClass({displayName: 'CampaignRow',
  DeleteCampaign: function(e) {
    var thiss = this;
    console.log('DELETE CAMPAIGN')
    e.stopPropagation()
    swal({   
      title: "Are you sure?",   
      text: "You will not be able to recover this Campaign!",
      type: "warning",   
      showCancelButton: true,   
      confirmButtonColor: "#DD6B55",   
      confirmButtonText: "Yes, delete it!",   
      closeOnConfirm: false }, 
      function(){   
        swal("Deleted!", "Your campaign has been deleted.", "success"); 
        console.log('deleted')
        thiss.props.deleteCampaign(thiss.props.campaign.objectId)
      });
  },

  toggleScreen: function() {
    //this.props.toggleScreen()
    this.props.changeSelectedCampaign(this.props.campaign)
  },

  render: function() {
    prospect_list = (this.props.campaign.prospect_list) ? this.props.campaign.prospect_list : {list_type:"", name:""}
    if(prospect_list.list_type == "signal_list")
        iconType = React.DOM.i({className: "fa fa-wifi", style: {marginRight:5}})
    else if(prospect_list.list_type == "mining_job")
        iconType = React.DOM.i({className: "fa fa-cloud-download", style: {marginRight:5}})
    else 
        iconType =""
    return (
      React.DOM.tr({style: {cursor:'pointer'}, onClick: this.toggleScreen}, 
        React.DOM.td(null), 
        React.DOM.td(null, " ", React.DOM.h6(null, 
            this.props.campaign.name
        ), " "), 
        React.DOM.td(null, " ", React.DOM.h6(null, 
            iconType, 
            prospect_list.name
        ), " "), 
        React.DOM.td({style: {textAlign:'center',padding:12}}, 
          React.DOM.span({className: "badge", style: {backgroundColor:'#f0ad4e'}}, 
            React.DOM.i({className: "fa fa-paper-plane"}), "  " + ' ' +
            "100%"
          )
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12}}, 
          React.DOM.span({className: "label label-success"}, 
            React.DOM.i({className: "fa fa-eye"}), "  " + ' ' +
            "100%")
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12,display:'none'}}, 
          React.DOM.span({className: "label label-primary"}, 
            React.DOM.i({className: "fa fa-mail-reply"}), "  " + ' ' +
            "100%")
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12,display:'none'}}, 
          React.DOM.span({className: "label label-info"}, 
            React.DOM.i({className: "fa fa-external-link-square"}), "  " + ' ' +
            "18%")
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12}}, 
          React.DOM.span({className: "label label-default"}, 
            React.DOM.i({className: "fa fa-exclamation-circle"}), "  " + ' ' +
            "11%")
        ), 
        React.DOM.td({style: {textAlign:'center',paddingTop:12}}, 
          React.DOM.a({href: "javascript:", className: "btn btn-primary btn-xs", 
            style: {backgroundImage: 'linear-gradient(180deg, #0096ff 0%, #005dff 100%) !important;',display:'none'}}, 
            React.DOM.i({className: "fa fa-copy", style: {fontWeight:'bold'}}), "  Clone"), 

          React.DOM.a({href: "javascript:", 
             className: "btn-default", 
             onClick: this.DeleteCampaign, 
             style: {marginLeft:5}}, " ", React.DOM.i({className: "fa fa-trash-o"}))
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12,display:'none'}}, 
          React.DOM.h4({style: {margin:0}}, 
            React.DOM.span({className: "label label-success"}, "Ready")
          )
        )
      )
    )
  }
});

},{}]},{},[1])


},{}],7:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // createListModal
  createCampaign: function(e) {
    e.preventDefault()
    //console.log($('#newListName').val())
    newCampaignName = $('#newCampaignName').val()
    prospectListName = $('#prospect_lists').val()
    thiss = this
    for(i=0;i< this.props.prospectLists.length; i++){
      if(this.props.prospectLists[i].name == prospectListName){
        prospect_list = this.props.prospectLists[i]; 
        break;
      }
    }
    if(newCampaignName.trim() != "")
      this.props.createCampaign({
        name: newCampaignName,
        prospect_list: prospect_list
      })
    // Disable Modal
    $('.modal-backdrop').click()
    $('.fade').click()
    $('#newCampaignName').val('')
  },

  render: function() {
    prospect_lists = []
    for(i=0;i< this.props.prospectLists.length; i++) {
      prospect_lists.push( React.DOM.option(null, this.props.prospectLists[i].name))
    }

    return (
      React.DOM.div({className: "modal fade bs-createCampaign-modal-sm", 
           tabIndex: "-1", role: "dialog", 'aria-labelledby': "mySmallModalLabel", 
           'aria-hidden': "true", id: "createListModal", style: {top:'200px'}}, 
            React.DOM.div({className: "modal-dialog modal-sm"}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.button({type: "button", className: "close", 'data-dismiss': "modal"}, React.DOM.span({'aria-hidden': "true"}, "×"), 
                    React.DOM.span({className: "sr-only"}, "Close")), 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    React.DOM.i({className: "fa fa-envelope"}), "  Create Campaign")
                ), 

                React.DOM.div({className: "modal-body"}, 
                  React.DOM.form({onSubmit: this.createCampaign}, 
                    React.DOM.input({id: "newCampaignName", 
                           type: "text", 
                           placeholder: "Enter Campaign Name...", 
                           className: "form-control"}), 

                    React.DOM.select({className: "form-control", 
                            id: "prospect_lists", 
                            style: {marginTop:20,marginBottom:20}}, 
                      prospect_lists
                    ), 

                    React.DOM.a({href: "javascript:", 
                      onClick: this.createCampaign, 
                      className: "btn btn-success", 
                      style: {display:'block', width:'100%'}}, 
                      "Create Campaign"
                    )
                  )
                )
              )
            )
          )
    );
  }
});


},{}]},{},[1])


},{}],8:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx react.dom */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      
    }
  },

  componentDidMount: function() {
    $('.template-body').html(this.state.templateBody)
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    console.log('EDIT MODE')
    console.log(this.state.editMode)
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      this.props.saveTemplate({
        name: this.state.name,
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
      })
      this.setState({
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
        editMode: !this.state.editMode,
      })
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+this.props.initialTemplateValues.objectId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
    }
  },

  componentDidUpdate: function() {
    /* thiss = this; */

    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.templateSubject)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.templateBody)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? react.dom.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.templateSubject

    if(this.state.editMode){
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-save"}), "   Save Template")
    } else {
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-pencil-square"}), "   Edit Template")
    }

    return (
      react.dom.div(null, 
      react.dom.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
      react.dom.div({id: "editTemplateView", 
           className: "panel panel-info", 
           style: {display:'block'}}, 
           react.dom.div({className: "panel-heading", style: {height:50}}, 
             react.dom.h6({style: {float:'left'}}, 
               react.dom.i({className: "fa fa-file-text-o"}), 
               "  " + this.props.initialTemplateValues.name
             ), 
          toggleButton
        ), 
        react.dom.div({className: "panel-body"}, 
          react.dom.div({className: "editTemplateTitle"}, 
            react.dom.span(null, "Subject: "), 
            subjectPlace
          ), 
         react.dom.br(null), 
         react.dom.div({className: "templateDetails"}, 
           react.dom.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
             "Created by Mark on Jul. 21, 2014"
           ), 
           react.dom.h6({style: {marginTop:'0'}, className: "text-muted"}, 
             "last updated 7 days ago"
           )
         ), 
        react.dom.br(null), 
        react.dom.div({className: "panel panel-default"}, 
          react.dom.div({className: "panel-body summer template-body"}
          )
        )
    )
)
)
    );
  }
});

},{}]},{},[1])


},{}],9:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      name: this.props.initialTemplateValues.name,
      body: this.props.initialTemplateValues.body,
      subject: this.props.initialTemplateValues.subject,
      editMode: this.props.initialTemplateValues.editMode
    }
  },

  componentDidMount: function() {
    console.log('did mount')
    $('.template-body').html(this.state.body)
    if(this.state.editMode) {
      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })
    }

    renderjson.set_show_to_level('all')
    prospect = _.pick(this.props.prospect, 
      'company_name', 'name', 'pos'
    )
    prospect.first_name = prospect.name.split(' ')[0]
    prospect.last_name = _.last(prospect.name.split(' '))
    prospect = _.omit(prospect, 'name')

    document.getElementById("editTemplate").appendChild(renderjson(prospect));
    $('#editTemplateOverlay').html()
    thiss = this;
    $('.renderjson').click(function() {
      thiss.props.toggleTemplateEditMenu()
    })

    $('.renderjson').css({
      'position': 'absolute',
      'z-index': '1000000000',
      'background-color':'rgba(0,0,0,0)',
      'border':'0',
      'color':'white',
      'margin-top':'0px',
      'height': '542px',
      'overflow':'auto',
      'width':'380px'
    })

    $('.key').css({
      'cursor':'pointer'
    })

    $('.timeline').css({
      '-webkit-filter': 'blur(10px)',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': 'blur(10px)',
    })
  },
  componentWillUnmount:function() {
    $('.timeline').css({
      '-webkit-filter': '',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': '',
    })
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })

      console.log('look at this')
      console.log(name)
      name = (this.props.initialTemplateValues.newTemplate) ? $('#template-name').val() : this.state.name
      this.props.saveTemplate({
        name: name,
        body: $('.summer').code(),
        subject: $('.subject').val(),
      }, this.props.initialTemplateValues.newTemplate)

      this.setState({
        name: $('#template-name').val(),
        body: $('.summer').code(),
        subject: $('.subject').val(),
        editMode: !this.state.editMode,
      })

      objId = this.props.initialTemplateValues.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+objId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),
                             subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })
    }
  },

  componentWillUpdate: function(newProps) {
    console.log('THE NEW PROPS')
    console.log(newProps)
  },

  componentDidUpdate: function() {
    /* thiss = this; */
    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.subject)
      $('#template-name').val(this.state.name)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.body)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? React.DOM.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.subject

    if(this.state.editMode){
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-save"}), "   Save Template")

       if(this.props.initialTemplateValues.newTemplate){
         the_name = React.DOM.input({className: "form-control", 
                           id: "template-name", 
                           style: {float:'left',width:200}})
       }
    } else {
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")

       the_name = React.DOM.h6({style: {float:'left'}}, 
                   React.DOM.i({className: "fa fa-file-text-o"}), " ", 
                   this.state.name
                  )
    }

    return (
      React.DOM.div({id: "editTemplate"}, 
        React.DOM.h5({className: "example-template-title"}, "Example Template Values"), 
        React.DOM.div({className: "example-template-title", 
             style: {marginLeft:215, marginTop:8}}, 
          React.DOM.a({href: "javascript:", 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-left"})), 
          React.DOM.a({href: "javascript:", 
            style: {marginLeft:5}, 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-right"}))
        ), 
        React.DOM.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
          React.DOM.div({id: "editTemplateView", 
               className: "panel panel-default", 
               style: {display:'block'}}, 
               React.DOM.div({className: "panel-heading", style: {height:50}}, 
                 the_name, 
              React.DOM.a({href: "javascript:", 
                className: "btn btn-default btn-xs", 
                style: {float:'right',marginLeft:5,marginTop:5}}, 
                React.DOM.i({className: "fa fa-trash"})
              ), 
              toggleButton
            ), 
            React.DOM.div({className: "panel-body"}, 
              React.DOM.div({className: "editTemplateTitle"}, 
                React.DOM.span(null, "Subject: "), 
                subjectPlace
              ), 
             React.DOM.br(null), 
             React.DOM.div({className: "templateDetails"}, 
               React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
                 "Created by Mark on Jul. 21, 2014"
               ), 
               React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, 
                 "last updated 7 days ago"
               )
             ), 
            React.DOM.br(null), 
            React.DOM.div({className: "panel panel-default"}, 
              React.DOM.div({className: "panel-body summer template-body"}
              )
            )
        )
      )
    )
    );
  }
});

},{}]},{},[1])


},{}],10:[function(require,module,exports){
/** @jsx React.DOM */

var Templates = require('./templates.js.min.js');
var Schedules = require('./schedule.js.min.js');
var Campaigns = require('./campaigns.js.min.js');
var SentMail = require('./sent_mail.js.min.js');
var FollowupFeed = require('./followup_feed.js.min.js');
var CampaignDetail = require('./campaign_detail.js.min.js');
var CreateCampaignModal = require('./create_campaign.js.min.js');

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      selectedScreen: 'Campaigns',
      selectedCampaign:'',
      prospectLists: [],
      campaigns: []
    }
  },

  deleteCampaign: function(objectId) {
    // sweetAlert
    console.log(this.state.campaigns)
    campaigns = _.filter(this.state.campaigns, function(campaign) {
      return campaign.objectId != objectId
    })
    console.log(campaigns)
    this.setState({campaigns: campaigns})
    $.ajax({
      url:'https://api.parse.com/1/classes/Campaign/'+objectId,
      type:'DELETE',
      headers:appConfig.headers,
      success: function(res) { console.log(res) },
      error: function(err) { console.log(err) }
    })
    // persist
    // error log
  },

  componentDidMount: function() {
    thiss = this;
     company = JSON.parse(localStorage.currentUser).company
     //qry = 'where={"company":'+company+'}&include=prospect_list,followups,followups.template&order=-createdAt'
     qry = {
       where : JSON.stringify({
         company: company
       }),
       include: 'prospect_list,followups,followups.template,batches',
       order: '-createdAt'
     }
     $.ajax({
       url:'https://api.parse.com/1/classes/Campaign',
      headers: appConfig.headers,
      data: qry,
      success: function(res) {
        console.log(res.results)
        thiss.setState({campaigns: res.results})
        // Find All Prospects In ProspectList that are not in any batches
      },
      error: function(err) {
        console.log('error')
        console.log(err)
      }
     });
    $.ajax({
      url: 'https://api.parse.com/1/classes/ProspectList',
      data: {
        order: '-createdAt',
        where : JSON.stringify({
          user: appConfig.user,
          company: appConfig.company,
        })
      },
      headers: appConfig.headers,
      success: function(res) {
        console.log('PROSPECT LISTS')
        console.log(res.results)
        thiss.setState({prospectLists: res.results})
      },
      error: function(err) {

      }
    })


  },
  
  toggleScreen: function(screen) {
    this.setState({selectedScreen : screen})
  },

  changeSelectedCampaign: function(screen, selectedCampaign) {
    console.log(selectedCampaign)
    this.setState({
      selectedCampaign : selectedCampaign,
      selectedScreen: screen,
    })
  },

  render: function() {
    thiss = this
    console.log(this.state.selectedCampaign)
    console.log(this.state.selectedScreen)
    console.log(this.state.campaigns)
    switch (this.state.selectedScreen){
      case 'Campaigns':
        CurrentScreen = Campaigns({campaigns: thiss.state.campaigns, 
                            changeSelectedCampaign: thiss.changeSelectedCampaign, 
                            deleteCampaign: this.deleteCampaign, 
                            toggleScreen: thiss.toggleScreen})
        break;
      case 'CampaignDetail':
        CurrentScreen = CampaignDetail({
                        selectedCampaign: thiss.state.selectedCampaign, 
                      selectedCampaignObjectId: thiss.state.selectedCampaginObjectId, 
                        toggleScreen: thiss.toggleScreen})
        break;
      case 'Templates':
        CurrentScreen = Templates(null)
        break;
      case 'Overview':
        CurrentScreen = Campaigns({campaigns: thiss.state.campaigns, 
                            changeSelectedCampaign: thiss.changeSelectedCampaign, 
                            toggleScreen: thiss.toggleScreen})
        break;
      case 'Sent Mail':
        CurrentScreen = SentMail(null)
        break;
      case 'Followup Feed':
        CurrentScreen = FollowupFeed(null)
        break;
      case 'Schedules':
        CurrentScreen = Schedules(null)
        break;
    }

    return (
      React.DOM.div({className: "", style: {height:'550px'}}, 
        React.DOM.div({className: "container", style: {padding:'0',width:'100%',height:'100%'}}, 
          SideMenu({
                createCampaign: this.createCampaign, 
                prospectLists: this.state.prospectLists, 
                toggleScreen: this.toggleScreen}), 
              React.DOM.div({className: "col-md-10", 
                   style: {padding:'0',height:'100%'}}, 
            CurrentScreen
          )
        )
      )
    );
  },

  persistCampaign: function(newCampaign) {
    Campaign = {}
    Campaign.name = newCampaign.name
    Campaign.company = JSON.parse(localStorage.currentUser).company
    thiss = this;

    $.ajax({
      url:'https://api.parse.com/1/classes/Campaign',
      type:'POST',
      headers:appConfig.headers,
      data:JSON.stringify(Campaign),
      success: function(res) {
        the_campaign = _.find(thiss.state.campaigns, function(campaign){
          first = campaign.name == newCampaign.name 
          second = campaign.prospect_list == newCampaign.prospect_list
          return first && second
        })
        console.log(res)
        console.log(res.objectId)

        the_campaign.objectId = res.objectId
        campaigns = _.filter(thiss.state.campaigns, function(campaign){
          first = campaign.name == newCampaign.name 
          second = campaign.prospect_list == newCampaign.prospect_list
          return !(first && second)
        })
        campaigns.push(the_campaign)
        console.log(campaigns)

        thiss.setState({campaigns:  campaigns})

        $.ajax({
          url:'https://api.parse.com/1/classes/Campaign/'+res.objectId,
          type:'PUT',
          data: JSON.stringify({prospect_list:{
            '__type':'Pointer',
            'className':'ProspectList',
            'objectId':newCampaign.prospect_list.objectId,
          }}),
          headers:appConfig.headers,
          success: function(res){
          },
          error: function() {

          }
        })
      },
      error: function(err) {
        console.log(err)
      }
    });
  },

  createCampaign: function(newCampaign) {
    campaigns = this.state.campaigns
    campaigns.push(newCampaign)
    this.setState({campaigns: campaigns})
    console.log(newCampaign)

    $('.modal').click()
    $('.modal-backdrop').click()

    this.persistCampaign(newCampaign)
  }
});

var SideMenu = React.createClass({displayName: 'SideMenu',
  toggleScreen: function(e) {
    this.props.toggleScreen($(e.target).text().trim())
  },

  /*
    <button type="button" className="sharp btn btn-default" onClick={this.toggleScreen}>
      <i className="fa fa-file-text" /> &nbsp; Templates
    </button>
    <button type="button" className="sharp btn btn-default" onClick={this.toggleScreen}>
      <i className="fa fa-clock-o" /> &nbsp; Schedules
    </button>
  */
  createCampaignModal: function() {

  },

  render: function() {
    return (
      React.DOM.div({className: "col-md-2", 
        style: {padding:'0',height:'100%', backgroundColor:'rgb(90, 107, 119)',borderBottomLeftRadius:'3px'}}, 
        React.DOM.div({className: "btn-group-vertical", style: {width:'100%'}}, 
          React.DOM.button({type: "button", 
                  className: "sharp btn btn-default", 
                  onClick: this.toggleScreen}, 
            React.DOM.span({style: {marginLeft:'27px'}}, "Overview")
          ), 
          React.DOM.button({type: "button", 
                  className: "sharp btn btn-default", 
                  onClick: this.toggleScreen}, 
            React.DOM.i({className: "fa fa-newspaper-o"}), "  ",  
            React.DOM.span({style: {marginLeft:'4px'}}, "Followup Feed")
          ), 
          React.DOM.button({type: "button", style: {display:'none'}, 
                  className: "sharp btn btn-default"}, 
            React.DOM.i({className: "fa fa-code-fork"}), "  ",  
            React.DOM.span({style: {marginLeft:'4px'}}, "Rules")
          ), 
          React.DOM.button({type: "button", style: {display:'none'}, 
                  className: "sharp btn btn-default", onClick: this.toggleScreen}, 
            React.DOM.i({className: "fa fa-pie-chart"}), "   Analytics"
          ), 
          React.DOM.button({type: "button", 
                  className: "sharp btn btn-default", 
                  onClick: this.toggleScreen}, 
            React.DOM.i({className: "fa fa-paper-plane"}), "   Sent Mail"
          )
        ), 

        React.DOM.div({className: "", style: {width:'100%',textAlign:'center',marginTop:100}}, 
          React.DOM.a({href: "javascript:", className: "btn btn-primary new-list-btn", 
                'data-toggle': "modal", 'data-target': ".bs-createCampaign-modal-sm", 
                style: { backgroundImage: 'linear-gradient(180deg, #0096ff 0%, #005dff 100%)'}}, 
            React.DOM.i({className: "fa fa-plus-circle"}), "  New Campaign"
          )
        ), 
        CreateCampaignModal({prospectLists: this.props.prospectLists, 
                             createCampaign: this.createCampaign})
      )
    );
  },

  createCampaign: function(newCampaign) {
    this.props.createCampaign(newCampaign)
  }
});

},{"./campaign_detail.js.min.js":2,"./campaigns.js.min.js":6,"./create_campaign.js.min.js":7,"./followup_feed.js.min.js":11,"./schedule.js.min.js":13,"./sent_mail.js.min.js":15,"./templates.js.min.js":16}],11:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      scheduledFollowups: []
    }
  },


  render: function() {
    scheduledFollowups = []
    for(i=0;i< this.state.scheduledFollowups.length; i++){ 
      scheduledFollowups.push(ScheduledFollowupRow(null))
    }

    return (
      React.DOM.div({style: {overflow:'auto', height:550}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th({style: {textAlign:'center'}}, "Status")
          ), 
          React.DOM.tbody(null, 
            scheduledFollowups
          )
        )
      )
    );
  }
});

var ScheduledFollowupRow = React.createClass({displayName: 'ScheduledFollowupRow',
  render: function() {
    return (
      React.DOM.tr(null

      )
    );
  }
})

},{}],12:[function(require,module,exports){
/** @jsx React.DOM */
var SendEmailModal = require('./send_email_modal.js.min.js')
var TimelineDayElement = require('./timeline_day_element.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // FollowupTimeline
  getInitialState: function() {
    initialFollowups = this.props.initialFollowups
    initialFollowups = (initialFollowups) ? initialFollowups : []
    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    return {
      followups: _.compact(initialFollowups),
      loading: false,
      currentTemplate:'',
      currentBatch: '',
      batches : batches
    }
  },

  componentDidMount: function() {
    thiss = this;
    $('.day').tooltip({
      placement: 'right',
      title:'+ Add a follow-up'
    })

    console.log(this.props.selectedCampaign)
     company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
     currentCampaign = appConfig.pointer('Campaign', this.props.selectedCampaign.objectId)
     $.ajax({
       url:'https://api.parse.com/1/classes/Followup',
       type:'GET',
       headers: appConfig.headers,
       data: {
         where: JSON.stringify({
           campaign: currentCampaign,
           company: appConfig.company
         }),
         include:'template',
       },
       success: function(res) {
         console.log('followup timeline')
         console.log(res.results)
       },
       error: function(err) {
         console.log('error')
         console.log(err)
       }
     })
  },

  addFollowupSentToBatch: function(batch, followup) {
    batches = _.map(this.state.batches, function(_batch) {
                  if(_batch.objectId == batch.objectId) {
                    if(_batch.followups)
                      _batch.followups.push(followup)
                    else
                      _batch.followups = [followup]
                  }
                  return _batch
              })
    // Persist
  },
  
  render: function() {
    timelineElements = []
    followups = this.state.followups

    batches = _.map(this.state.batches, function(batch) {
      if(batch){
        now = moment().startOf('day').valueOf()
        batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
        return batch
      }
    })
    batches = _.compact(batches)

    for(i=0;i< 31;i++){
      followup = _.findWhere(this.state.followups, {day: i})
      var elementType = (followup) ? true : false
      var currentTemplate = (followup) ? followup.template : false
      var addTemplateMode = (followup) ? followup.addTemplateMode : true
      campaign = this.props.selectedCampaign

      currentBatch = {}
      batch_started_today = false
      alreadySent = false
      batchCount = undefined
      if(i == 0) {
        batchCount = (batches) ? this.props.newProspects.length : this.props.prospects.length
      } else {
        batch = _.findWhere(batches, {currentDay: i})
        if(batch) {
          currentBatch = batch.objectId
          console.debug(batch.objectId)
          batchCount = "~"
          if(followup) {
            _batches = followup.batches
            alreadySent = _.findWhere(_batches, _.pick(batch,'objectId'))
          }
        }
      }

      timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                    dayCount: i, 
                                    elementType: !elementType, 
                                    currentTemplate: currentTemplate, 
                                    batchCount: batchCount, 
                                    currentBatch: currentBatch, 
                                    alreadySent: alreadySent, 
                                    addTemplateMode: addTemplateMode, 
                                    templates: this.props.templates, 
                                    newProspects: this.props.newProspects, 
                                    addFollowup: this.addFollowup, 
                                    editFollowup: this.editFollowup, 
                                    saveFollowup: this.saveFollowup, 
                                    removeFollowup: this.removeFollowup, 
                                 addFollowupSentToBatch: this.addFollowupSentToBatch, 
                                    batches: this.props.selectedCampaign.batches, 
                                    prospectListCount: this.props.prospectListCount, 
                                    setCurrentBatch: this.setCurrentBatch, 
                                    setCurrentTemplate: this.setCurrentTemplate})
                                  ))

      if(i == 0 && _.findWhere(batches, {currentDay: 0})){
          currentBatch = _.findWhere(batches, {currentDay: 0}).objectId
          console.debug('0.5')
          console.debug(currentBatch)
          batchCount = "~"
          timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                  dayCount: 0.5, 
                                  batchCount: batchCount, 
                                  currentBatch: currentBatch, 
                                  newProspects: this.props.newProspects, 
                                  elementType: true, 
                                  batches: this.props.selectedCampaign.batches, 
                                  prospectListCount: this.props.prospectListCount, 
                                  setCurrentBatch: this.setCurrentBatch})
                                ))
      }
    }
    return (
      React.DOM.div(null, 
        React.DOM.div({className: "timeline", 
             style: {height:'100%',backgroundColor:'rgb(90, 107, 119)', width:5,marginTop:-35}}, 
             timelineElements
        ), 
        SendEmailModal({prospects: this.props.prospects, 
                        selectedCampaign: this.props.selectedCampaign, 
                        newProspects: this.props.newProspects, 
                        addFollowupSentToBatch: this.addFollowupSentToBatch, 
                        currentBatch: this.state.currentBatch, 
                        currentTemplate: this.state.currentTemplate})
      )
    );
  },

  createFollowup: function() {
    //
  },         

  addFollowup: function(day) {
    //console.log('called template edit menu')
    followups = this.state.followups
    followups.push({addTemplateMode: true, day: day})
    this.setState({ followups: followups })
  },

  editFollowup: function(day) {
    // find template set editmode is false
    followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){ followup.addTemplateMode = true }
      return followup
    })
    this.setState({followups: followups})
  },

  saveFollowup: function(day, chosenTemplate) {
    new_followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){
        followup.addTemplateMode = false
        followup.template = chosenTemplate
      }
      return followup
    })
    this.setState({followups: new_followups})
    followup = _.findWhere(new_followups, {day: day})

      if(followup.objectId){
        url = "/"+followup.objectId; type="PUT"
        data = {template: appConfig.pointer('Template', chosenTemplate.objectId)}
      } else {
        url = ""; type="POST";

          data = {
            day: day,
            campaign : appConfig.pointer('Campaign', 
                                         this.props.selectedCampaign.objectId),
            template: appConfig.pointer('Template', chosenTemplate.objectId),
          }
      }

    thiss = this;
    $.ajax({
      url:'https://api.parse.com/1/classes/Followup'+url,
      type:type,
      data:JSON.stringify(data),
      headers:appConfig.headers,
      success: function(res) {
        new_followups = _.map(new_followups, function(followup) {
          if(followup.day == day) { followup.objectId = false }
          return followup
        })
        thiss.setState({followups: new_followups})

        console.log(res)
        $.ajax({
          url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
          type:'PUT',
          data:JSON.stringify({followups: {
            __op: 'AddUnique',
            objects:[appConfig.pointer('Followup', res.objectId)]
          }}),
          headers:appConfig.headers,
          success: function() { },
          error: function() { }
        })
      },
      error: function() { },
    })
  },

  removeFollowup: function(day) {
    followups = []
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day != day)
        followups.push(this.state.followups[i])
      
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day == day)
        break
    
    this.setState({followups: followups}) 
    id = this.state.followups[i]

    thiss = this;
    if(id) {
      id = id.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Followup/'+id,
        headers:appConfig.headers,
        type:'DELETE',
        success: function(res) { console.log(res) }
      })

     console.log('REMOVE ARRAY')
      $.ajax({
        url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
        headers:appConfig.headers,
        type:'PUT',
        data: JSON.stringify({
          followups: {
            __op : 'Remove',
            objects: [appConfig.pointer('Followup', id)]
          }
        }),
        success: function(res){ console.log(res) },
        error: function() { }
      })
    }
  },

  setCurrentBatch: function(currentBatch) {
    this.setState({currentBatch: currentBatch})
  },

  setCurrentTemplate: function(template) {
    this.setState({currentTemplate: template })
  }
});



},{"./send_email_modal.js.min.js":14,"./timeline_day_element.js.min.js":18}],13:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  render: function() {
    return (
      React.DOM.div(null, 
        "Scheduls"
      )
    );
  }
});

},{}],14:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      currentProspect: 0,
    }
  },

  sendEmails: function() {
    selectedCampaign = this.props.selectedCampaign
    campaign_id = selectedCampaign.objectId
    prospectlist_id = selectedCampaign.prospect_list.objectId
    template_id = this.props.currentTemplate.objectId
    
    $.ajax({
      url:'https://nameless-retreat-3525.herokuapp.com/send_email',
      //url:'http://127.0.0.1:5000/send_email',
      data: {
        template_id : template_id,
        campaign_id : campaign_id,
        prospectlist_id : prospectlist_id,
      },
      success: function(res) { console.log(res.results) },
      error: function(err) { console.log(err) }
    })

    /*
    */
    // Update Followup
    // Persist Followup
    // close modal
  },

  render: function() {
    prospect = this.props.prospects[this.state.currentProspect]
    prospect = (prospect) ? prospect : {'name':'','email':''}

    var thiss = this;
    console.debug('SEND EMAIL BATCH')
    console.debug(this.props.currentBatch)
    newBatch = _.isEqual(this.props.currentBatch, {})
    prospects = (newBatch) ? this.props.newProspects : this.props.prospects
    if(newBatch){
      prospects = _.map(this.props.newProspects, function(prospect) {
          return UserPlaceHolder({prospect: prospect})
      })
    } else {
      prospects = _.map(this.props.prospects, function(prospect) {
        if(_.findWhere(prospect.batches, {objectId: thiss.props.currentBatch}))
          return UserPlaceHolder({prospect: prospect})
      })
    }
    prospects = _.compact(prospects)
    console.debug(prospects)
    console.debug(prospects.length)
    prospectCount = prospects.length
    email = (prospect.email) ? prospect.email.toLowerCase() : ""
    return (
      React.DOM.div({className: "modal fade bs-sendEmail-modal-lg", tabIndex: "-1", 
           role: "dialog", 'aria-labelledby': "mySmallModalLabel", 'aria-hidden': "true", 
           id: "sendEmailModal", style: {top:'10px'}}, 
            React.DOM.div({className: "modal-dialog modal-lg"}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.button({type: "button", className: "close", 'data-dismiss': "modal"}, React.DOM.span({'aria-hidden': "true"}, "×"), 
                    React.DOM.span({className: "sr-only"}, "Close")), 
        React.DOM.button({type: "button", 
                onClick: this.sendEmails, 
                style: {float:'right'}, 
                className: "btn btn-primary btn-sm"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), "  Send Email"), 
        React.DOM.button({type: "button", style: {marginRight:10, float:'right'}, 
                className: "btn btn-default btn-sm", 'data-dismiss': "modal"}, "Close"), 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    React.DOM.i({className: "fa fa-envelope"}), "  Send Email" + ' ' +
                    "  ", 
                    React.DOM.small(null, "("+prospectCount+")")
                  )
                ), 
                React.DOM.div({className: "modal-body", style: {paddingTop:5}}, 
                  React.DOM.h4(null, "People"), 
                  
                  React.DOM.div({className: "prospect-container"}, 
                    prospects
                  ), 
                  React.DOM.br(null), 
                  React.DOM.h4({style: {display:'inline-block'}}, "Emails    ", 
                    React.DOM.small(null, (this.state.currentProspect+1)+' of '+prospectCount
                  )), 
                  "   ", 
                  React.DOM.a({href: "javascript:", 
              className: (this.state.currentProspect == 0 ) ? "btn disabled" : "btn", 
                    onClick: this.previousProspect}, React.DOM.i({className: "fa fa-arrow-left"})), 
                  React.DOM.a({href: "javascript:", 
            className: (this.state.currentProspect == 135 ) ? "btn disabled" : "btn", 
                    onClick: this.nextProspect}, React.DOM.i({className: "fa fa-arrow-right"})), 

                  React.DOM.div(null, 

React.DOM.ul({className: "list-group email-holder", style: {borderTop:'solid 1px #eee'}}, 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "To:  "), 
    prospect.name + " - " + email
  ), 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "Subject:  "), " ", this.props.currentTemplate.subject
  ), 
  React.DOM.li({className: "list-group-item body"})
)
  
                  )

                ), 

      React.DOM.div({className: "modal-footer", style: {display:'none'}}, 
        React.DOM.button({type: "button", 
                className: "btn btn-default", 'data-dismiss': "modal"}, "Close"), 
        React.DOM.button({type: "button", 
                className: "btn btn-primary"}, "Send Email")
      )
              )
            )
          )
    );
  },

  previousProspect: function() {
    this.setState({currentProspect: this.state.currentProspect-1 })
  },

  nextProspect: function() {
    this.setState({currentProspect: this.state.currentProspect+1 })
  },

  parseTemplate: function(templateBody) {
    first_name = prospect.name.split(' ')[0]
    //hiring_signal = prospect.signals

    signals = (prospect.signals) ? prospect.signals[0] : ""
    templateBody = Mustache.render(templateBody, {
      hiring_signal: signals,
      first_name: prospect.name.split(' ')[0]
    })

    console.log(templateBody)
      
    return templateBody
  },

  componentDidUpdate: function() {
    //console.log(this.props.currentTemplate)
    parsedTemplate = this.parseTemplate(this.props.currentTemplate.body)
    
    //$('.body').html(this.props.currentTemplate.body)
    $('.body').html(parsedTemplate)
  }
});

var UserPlaceHolder = React.createClass({displayName: 'UserPlaceHolder',
  render: function() {
    return (
        React.DOM.div({className: "btn-group", style: {marginRight:5,marginBottom:5}}, 
          React.DOM.div({className: "btn-group"}, 
            React.DOM.button({type: "button", 
                    className: "btn btn-success btn-sm"}, 
              React.DOM.i({className: "fa fa-user"}), "  ", 
              (this.props.prospect) ? this.props.prospect.name : ""
            )
          ), 
          React.DOM.button({type: "button", className: "btn btn-success btn-sm"}, 
            React.DOM.i({className: "fa fa-trash-o"})
          )
        )
    )
  }
});

},{}],15:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Sent Mail
  getInitialState: function() {
    return {
      sentEmails: []
    }
  },

  componentDidMount: function() {
    thiss = this;
    $.ajax({
      url: 'https://api.parse.com/1/classes/SentEmail',
      data:{include: 'campaign,prospect,prospect.email_guesses.pattern'},
      headers: appConfig.headers,
      success: function(res) { thiss.setState({sentEmails: res.results}) },
      error: function() {}
    })
  },

  render: function() {
    sentEmails = []
    for(i=0;i< this.state.sentEmails.length; i++) 
      sentEmails.push(SentEmailRow({sentEmail: this.state.sentEmails[i]}))

    return (
      React.DOM.div({style: {overflow:'auto',height:550}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th({style: {width:290}}, "Status"), 
            React.DOM.th(null, "Campaign"), 
            React.DOM.th(null, "Template")
          ), 
          React.DOM.tbody(null, 
            sentEmails
          )
        )
      )
    );
  }
});

var SentEmailRow = React.createClass({displayName: 'SentEmailRow',
  render: function() {
    sentEmail = this.props.sentEmail
    //console.log(sentEmail)

    email = sentEmail.email
    if(email == "no_email"){
      first = sentEmail.prospect.name.split(' ')[0]
      last = _.last(sentEmail.prospect.name.split(' '))

      pattern = _.findWhere(sentEmail.prospect.email_guesses, {'tried':false})
      data = {first: first, last: last, fi: first[0], li: last[0]}
      email = Mustache.render(pattern.pattern.pattern, data).toLowerCase()
    }

    return (
      React.DOM.tr(null, 
        React.DOM.td(null, React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-clock"}), 
            moment(sentEmail.createdAt).fromNow())), 
        React.DOM.td(null, 
          React.DOM.h6({style: {fontSize:14,fontWeight:'bold',marginBottom:0}}, sentEmail.prospect.name), 
          React.DOM.h6({style: {marginTop:4,marginBottom:0}}, sentEmail.prospect.pos.trim()), 
          React.DOM.h6({style: {marginTop:4}}, sentEmail.prospect.company_name)
        ), 
        React.DOM.td(null, React.DOM.h6(null, email)), 
        React.DOM.td({style: {paddingTop:13}}, 
          React.DOM.span({className: "label label-default"}, "Queued"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: "label label-success"}, "Opened"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: "label label-default"}, "Delivered"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: "label label-default"}, "Replied")
        ), 
        React.DOM.td(null, 
          React.DOM.h6({style: {cursor:'pointer'}}, 
          React.DOM.i({className: "fa fa-list-alt"}), "  " + ' ' +
          "Boston VP Sales - Retail"
          )
        ), 
        React.DOM.td(null, 
          React.DOM.h6({style: {cursor:'pointer'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  " + ' ' +
          "Followup #2 - Provide Value ", React.DOM.br(null), 
          React.DOM.span({className: "text-muted"}, " Subject: Just wanted to followup on the last email "), React.DOM.br(null), 
          React.DOM.span({className: "text-muted"}, " Body: Just wanted to followup on the last email ")

          )
        )
      )
    )
  }
})

},{}],16:[function(require,module,exports){
/** @jsx React.DOM */

var EditTemplateView = require('./edit_template.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  //Templates
  getInitialState: function() {
    return {
      selectedTemplate: 0,
      editMode: false
    }
  },

  changeMode: function() {
    this.setState({editMode: !this.state.editeMode})
  },

  render: function() {
    templateView = (!this.state.editMode) ? TemplateView({changeMode: this.changeMode}) : EditTemplateView(null)
    return (
      React.DOM.div(null, 
        React.DOM.div({style: {height:'100%'}}, 
          TemplateSideMenu(null), 
          React.DOM.div({className: "col-md-9", style: {padding:0,height:'100%'}}, 
              templateView
          )
        )
      )
    );
  }
});


var TemplateView = React.createClass({displayName: 'TemplateView',
  changeMode: function() {
    this.props.changeMode()
  },
  render: function() {
    return (
      React.DOM.div({className: "panel panel-info", style: {width:'100%',height:'100%',border:0}}, 
        React.DOM.div({className: "panel-heading"}, 
          "Template Name",  
          React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:'0px'}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")
        ), 
        React.DOM.div({className: "panel-body"}, 
        React.DOM.h4(null, "Followup - Prospecting SAAS Outreach"), 
        React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, "Created by Mark on Jul. 21, 2014"), 
        React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, "last updated 7 days ago"), 
        React.DOM.br(null), 
        React.DOM.br(null), 

        React.DOM.div({className: "panel panel-default"}, 

          React.DOM.div({className: "panel-body"}, 
          "15 minutes to get company_name more customers" + ' ' +
          "Hey first_name," + ' ' +

          "Would you like to hear an idea for a 15 minute hack that could significantly increase the number of prospects your sales people have access to ?" + ' ' +
           
          "Recently one of our B2B clients saw a huge increase in trial sign ups after working with us. first_name, lets schedule a 15 minute call this week to see if this would be a good fit for both of us." + ' ' +
           
          "What the best time for you this week ?" + ' ' +
           
          "--" + ' ' +
          "Mark" + ' ' + 
          "Customero" + ' ' +
          "mark@customerohq.com"
          
          )
        )
      )
    )
    );
  },
});

var TemplateSideMenu = React.createClass({displayName: 'TemplateSideMenu',
  getInitialState: function() {
    return {
      templates: [],
    }
  },

  componentDidMount: function() {
    //Ajax Request For Templates
    /*
     $.ajax({
      url:'',
      headers: "",
      data: "",
      success: function() {
      },
      error: function() {
      }
     });
    */
  },

  render: function() {
    templates = []
    for(i=0;i< this.state.templates.length; i++)
      templates.push(React.DOM.a({href: "javascript:", className: "list-group-item"}, "templates[i].name"))
    return (
      React.DOM.div({className: "col-md-3", style: {padding:'0', borderRight:'1px solid #ddd',height:'100%',textAlign:'center'}}, 
        React.DOM.div({className: "panel panel-default", style: {border:0}}, 
          React.DOM.div({className: "panel-heading", style: {height:60}}, 
            React.DOM.span({style: {float:'left',fontSize:20,fontWeight:'bold'}}, 
              "Templates"
            ), 
            React.DOM.a({href: "javascript:", className: "btn btn-success ", 
                style: {float:'right'}}, 
              React.DOM.i({className: "fa fa-plus"})
            )
          ), 
          React.DOM.ul({className: "list-group", style: {textAlign:'left'}}, 
            templates
          )
        )
      )
    )
  }
});

},{"./edit_template.js.min.js":9}],17:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  //TemplatesMenu
  toggleTemplateEditMenu: function(currentTemplate) {
    this.props.toggleTemplateEditMenu(currentTemplate)
  },

  createTemplate: function() {
    this.props.toggleTemplateEditMenu({
      name: '',
      body:'',
      subject:'',
      editMode:true,
      newTemplate: true
    }, true)
  },

  render: function() {
    //console.log(this.props.templates)
    templates = []
    for(i=0;i< this.props.templates.length; i++) {
      templates.push(
        TemplateListItem({
          toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
          template: this.props.templates[i]})
      )
    }

    return (
      React.DOM.div({className: "", style: {padding:'0', height:'100%',textAlign:'center'}}, 
        React.DOM.div({className: "panel panel-default", 
             style: {borderRight:0,borderRadius:0,height:'100%', overflow:'auto'}}, 
          React.DOM.div({className: "panel-heading", style: {height:40}}, 
            React.DOM.span({style: {float:'left',fontSize:14,fontWeight:'bold'}}, 
              React.DOM.i({className: "fa fa-file-text-o"}), 
              React.DOM.span({style: {marginLeft:5}}, "Templates")
            ), 
            React.DOM.a({href: "javascript:", 
              className: "btn btn-success btn-xs", 
              onClick: this.createTemplate, 
                style: {float:'right'}}, 
              React.DOM.i({className: "fa fa-plus"}), 
              React.DOM.span({style: {marginLeft:5}}, "Create Template")
            )
          ), 
          React.DOM.ul({className: "list-group", 
              style: {textAlign:'left'}}, 
            templates
          )
        )
      )
    )
  }
});

var TemplateListItem = React.createClass({displayName: 'TemplateListItem',
  toggleTemplateEditMenu: function() {
    console.log(this.props.template)
    template = this.props.template
    template.editMode = false
    this.props.toggleTemplateEditMenu(template)
  },

  render: function() {
    return (
      React.DOM.div(null, 
        React.DOM.a({href: "javascript:", 
          style: {borderBottom: '1px solid rgb(221, 221, 221)',paddingTop:5,paddingBottom:0}, 
           onClick: this.toggleTemplateEditMenu, 
           className: "list-group-item"}, 
           React.DOM.span({className: "label label-default"}, 
             this.props.template.name
           ), 
           React.DOM.h6(null, "Subject:", React.DOM.span({className: "text text-muted"}, 
             " " + this.props.template.subject
           ))
         )
      )
    );
  }
});

},{}],18:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // TimelineDayElement
  // TODO
  // - add prospect list progression
  // - add scheduled followup
  //
  getInitialState: function() {
    // 
    return {
      followupCompleted: 0,
    }
  },

  addFollowup: function() {
    this.props.addFollowup(this.props.dayCount)
  },

  render: function() {
    if(this.props.addTemplateMode) {
      mode = EditTemplate({addFollowup: this.props.addFollowup, 
                           saveFollowup: this.props.saveFollowup, 
                           removeFollowup: this.props.removeFollowup, 
                           dayCount: this.props.dayCount, 
                           templates: this.props.templates})
    } else {
      mode = TemplateFollowup({currentTemplate: this.props.currentTemplate, 
                               editFollowup: this.props.editFollowup, 
                               dayCount: this.props.dayCount, 
                               currentBatch: this.props.currentBatch, 
                               hasBatch: typeof(this.props.batchCount) != "undefined", 
                               setCurrentBatch: this.props.setCurrentBatch, 
                               dayCount: this.props.dayCount, 
                               removeFollowup: this.props.removeFollowup, 
                               setCurrentTemplate: this.props.setCurrentTemplate})
    }
    if(this.props.alreadySent) {
      mode = FollowupCompleted({currentTemplate: this.props.currentTemplate})
    }

    mode = (this.props.elementType) ? "" : mode
    addFollowup = (this.props.elementType) ? this.addFollowup : ""
    if(typeof(this.props.batchCount) != "undefined")
      batchStage = BatchStage({currentBatch: this.props.currentBatch, 
                               newProspects: this.props.newProspects, 
                               prospectListCount: this.props.prospectListCount, 
                               batchCount: this.props.batchCount, 
                               hasScheduledEmail: mode != "", 
                               dayCount: this.props.dayCount})
    else
      batchStage = ""

    dayCount = (this.props.dayCount != 0.5) ? "D"+this.props.dayCount : ""

    return (
      React.DOM.div(null, 
        React.DOM.div({onClick: addFollowup, className: "day", 'data-trigger': "manual"}, 
          dayCount
        ), 
        mode, batchStage
      )
    )
  },

  setCurrentTemplate: function(template) {
    this.props.setCurrentTemplate(template)
  }
});

var FollowupCompleted = React.createClass({displayName: 'FollowupCompleted',
  render: function() {
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs disabled", 
                'data-target': ".bs-sendEmail-modal-lg", 
                onClick: this.setCurrentTemplate, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-check"}), " Sent"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"}))
      )
                                         )
  }
})

var TemplateFollowup = React.createClass({displayName: 'TemplateFollowup',
  // EditMode False

  setCurrentTemplate: function() {
    this.props.setCurrentTemplate(this.props.currentTemplate)
    // setCurrentBatch
    this.props.setCurrentBatch(this.props.currentBatch)
    $('.bs-sendEmail-modal-lg').modal()
  },

  waitForBatch: function() {
    alertify.log("You must wait for a batch!");
  },

  render: function() {
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
        onClick: (this.props.hasBatch) ? this.setCurrentTemplate : this.waitForBatch, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-paper-plane"}), " Send"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        trash
      )
    );
  },

  editFollowup: function(e) { 
    e.preventDefault()
    console.log(this.props.dayCount)
    this.props.editFollowup(this.props.dayCount)
  },

  removeFollowup: function() {
    console.log('remove')
    this.props.removeFollowup(this.props.dayCount)
  }
});

var BatchStage = React.createClass({displayName: 'BatchStage',
  // Different Stages of People Added to Prospect List
  getInitialState: function() {
    // 
    return {
      initialBatchCount: this.props.batchCount
    }
  },

  componentDidMount: function() {
    // state
    //console.debug('INSIDE BATCH '+this.props.dayCount)
    console.debug(this.props.currentBatch)
    _batches = appConfig.pointer('ProspectBatch', this.props.currentBatch)
    if(this.props.batchCount == "~") {
      // Why doesnt this work 
      var thissss = this;
      console.debug('INSIDE BATCH '+thiss.props.dayCount)
      console.debug(_batches)
      $.ajax({
        url:'https://api.parse.com/1/classes/Prospect',
        batches: _batches,
        data: {
          where: JSON.stringify({
            batches: _batches
          }),
          count: true,
        },
        headers: appConfig.headers,
        success: function(res) { 
          //console.debug('SUCCESS GET COUNT ' + res.count)
          //console.debug(res.results) 
          thissss.setState({initialBatchCount: res.count})
        },
        error: function(err) { 
          thissss.setState({initialBatchCount: 0 })
        }
      })
    }
  },

  componentWillReceiveProps: function(nextProps) {
    if(this.props.dayCount == 0)
      this.setState({ initialBatchCount: nextProps.batchCount })
  },


  render: function() {
    if(this.props.hasScheduledEmail)
      batchStageStyle = {top:-42, left:6}
    else
      batchStageStyle = {}

    if(this.props.dayCount == 0.5)
      batchStageStyle.left = 7

    //console.log('BATCH STAGE')
    //console.log(this.props)
    //console.debug(this.props.currentBatch)                                                           

    return (
      React.DOM.div({className: "followup-placement arrow_box tmp", style: batchStageStyle}, 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-user"}), " ", 
          this.state.initialBatchCount
        ), " ", 
        React.DOM.h6({style: {display:'inline-block'}}, 
          "prospects in the sales cycle.")
      )
    );
  }
});

var EditTemplate = React.createClass({displayName: 'EditTemplate',
  // Edit Mode - True
  render: function() {
    options = []
    for(i=0;i< this.props.templates.length; i++) {
      options.push( React.DOM.option(null, this.props.templates[i].name))
    }
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, " ", React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:55,display:'inline-block'}, 
            className: "text-muted"}, 
          "Choose :"
        ), 
        React.DOM.select({className: "form-control input-sm", 
                id: "chooseTemplateForFollowup", 
                style: {display:'inline-block',width:127,marginRight:5}}, 
          options
        ), 

        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
                onClick: this.saveFollowup, 
                style: {marginRight:5}}, 
          React.DOM.i({className: "fa fa-check"})), 
        trash
      )
    )
  },

  saveFollowup: function(e) {
    //get template from currentTemplate
    e.preventDefault()
    chosenTemplate = $('#chooseTemplateForFollowup').val()
    console.log(chosenTemplate)
    for(i=0;i< this.props.templates.length; i++){
      if(this.props.templates[i].name == chosenTemplate){
        chosenTemplate = this.props.templates[i]
        break
      }
    }
    console.log(chosenTemplate)
    
    this.props.saveFollowup(this.props.dayCount, chosenTemplate)
  },

  removeFollowup: function(day) {
    this.props.removeFollowup(this.props.dayCount)
  },
});


},{}]},{},[10])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L25vZGVfbW9kdWxlcy9ndWxwLWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvZW1haWwuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9mb2xsb3d1cF9mZWVkLmpzLm1pbi5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvZm9sbG93dXBfdGltZWxpbmUuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9zY2hlZHVsZS5qcy5taW4uanMiLCIvVXNlcnMvcm9iaW4vUHJvamVjdHMvcHJvc3BlY3Rlci9wcm9zcGVjdGVyLXBhcnNlL2Rldi9idWlsZC9qcy9jb21wb25lbnRzL3NlbmRfZW1haWxfbW9kYWwuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9zZW50X21haWwuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy90ZW1wbGF0ZXMuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy90ZW1wbGF0ZXNfbWVudS5qcy5taW4uanMiLCIvVXNlcnMvcm9iaW4vUHJvamVjdHMvcHJvc3BlY3Rlci9wcm9zcGVjdGVyLXBhcnNlL2Rldi9idWlsZC9qcy9jb21wb25lbnRzL3RpbWVsaW5lX2RheV9lbGVtZW50LmpzLm1pbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBckhBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFySEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUF6V0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQWxHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUExSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQXRJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBL09BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBM1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQWpMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQWxGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQTVRQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFsR0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBM0RBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQTFIQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBeElBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQTFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUF0SUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDL09BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1UkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG52YXIgVGVtcGxhdGVzID0gcmVxdWlyZSgnLi90ZW1wbGF0ZXMuanMubWluLmpzJyk7XG52YXIgU2NoZWR1bGVzID0gcmVxdWlyZSgnLi9zY2hlZHVsZS5qcy5taW4uanMnKTtcbnZhciBDYW1wYWlnbnMgPSByZXF1aXJlKCcuL2NhbXBhaWducy5qcy5taW4uanMnKTtcbnZhciBTZW50TWFpbCA9IHJlcXVpcmUoJy4vc2VudF9tYWlsLmpzLm1pbi5qcycpO1xudmFyIEZvbGxvd3VwRmVlZCA9IHJlcXVpcmUoJy4vZm9sbG93dXBfZmVlZC5qcy5taW4uanMnKTtcbnZhciBDYW1wYWlnbkRldGFpbCA9IHJlcXVpcmUoJy4vY2FtcGFpZ25fZGV0YWlsLmpzLm1pbi5qcycpO1xudmFyIENyZWF0ZUNhbXBhaWduTW9kYWwgPSByZXF1aXJlKCcuL2NyZWF0ZV9jYW1wYWlnbi5qcy5taW4uanMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2VsZWN0ZWRTY3JlZW46ICdDYW1wYWlnbnMnLFxuICAgICAgc2VsZWN0ZWRDYW1wYWlnbjonJyxcbiAgICAgIHByb3NwZWN0TGlzdHM6IFtdLFxuICAgICAgY2FtcGFpZ25zOiBbXVxuICAgIH1cbiAgfSxcblxuICBkZWxldGVDYW1wYWlnbjogZnVuY3Rpb24ob2JqZWN0SWQpIHtcbiAgICAvLyBzd2VldEFsZXJ0XG4gICAgY29uc29sZS5sb2codGhpcy5zdGF0ZS5jYW1wYWlnbnMpXG4gICAgY2FtcGFpZ25zID0gXy5maWx0ZXIodGhpcy5zdGF0ZS5jYW1wYWlnbnMsIGZ1bmN0aW9uKGNhbXBhaWduKSB7XG4gICAgICByZXR1cm4gY2FtcGFpZ24ub2JqZWN0SWQgIT0gb2JqZWN0SWRcbiAgICB9KVxuICAgIGNvbnNvbGUubG9nKGNhbXBhaWducylcbiAgICB0aGlzLnNldFN0YXRlKHtjYW1wYWlnbnM6IGNhbXBhaWduc30pXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9DYW1wYWlnbi8nK29iamVjdElkLFxuICAgICAgdHlwZTonREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgY29uc29sZS5sb2cocmVzKSB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikgeyBjb25zb2xlLmxvZyhlcnIpIH1cbiAgICB9KVxuICAgIC8vIHBlcnNpc3RcbiAgICAvLyBlcnJvciBsb2dcbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpc3MgPSB0aGlzO1xuICAgICBjb21wYW55ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIpLmNvbXBhbnlcbiAgICAgLy9xcnkgPSAnd2hlcmU9e1wiY29tcGFueVwiOicrY29tcGFueSsnfSZpbmNsdWRlPXByb3NwZWN0X2xpc3QsZm9sbG93dXBzLGZvbGxvd3Vwcy50ZW1wbGF0ZSZvcmRlcj0tY3JlYXRlZEF0J1xuICAgICBxcnkgPSB7XG4gICAgICAgd2hlcmUgOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICBjb21wYW55OiBjb21wYW55XG4gICAgICAgfSksXG4gICAgICAgaW5jbHVkZTogJ3Byb3NwZWN0X2xpc3QsZm9sbG93dXBzLGZvbGxvd3Vwcy50ZW1wbGF0ZSxiYXRjaGVzJyxcbiAgICAgICBvcmRlcjogJy1jcmVhdGVkQXQnXG4gICAgIH1cbiAgICAgJC5hamF4KHtcbiAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvQ2FtcGFpZ24nLFxuICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBkYXRhOiBxcnksXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzLnJlc3VsdHMpXG4gICAgICAgIHRoaXNzLnNldFN0YXRlKHtjYW1wYWlnbnM6IHJlcy5yZXN1bHRzfSlcbiAgICAgICAgLy8gRmluZCBBbGwgUHJvc3BlY3RzIEluIFByb3NwZWN0TGlzdCB0aGF0IGFyZSBub3QgaW4gYW55IGJhdGNoZXNcbiAgICAgIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicpXG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgIH1cbiAgICAgfSk7XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDogJ2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvUHJvc3BlY3RMaXN0JyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgb3JkZXI6ICctY3JlYXRlZEF0JyxcbiAgICAgICAgd2hlcmUgOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgdXNlcjogYXBwQ29uZmlnLnVzZXIsXG4gICAgICAgICAgY29tcGFueTogYXBwQ29uZmlnLmNvbXBhbnksXG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1BST1NQRUNUIExJU1RTJylcbiAgICAgICAgY29uc29sZS5sb2cocmVzLnJlc3VsdHMpXG4gICAgICAgIHRoaXNzLnNldFN0YXRlKHtwcm9zcGVjdExpc3RzOiByZXMucmVzdWx0c30pXG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuXG4gICAgICB9XG4gICAgfSlcblxuXG4gIH0sXG4gIFxuICB0b2dnbGVTY3JlZW46IGZ1bmN0aW9uKHNjcmVlbikge1xuICAgIHRoaXMuc2V0U3RhdGUoe3NlbGVjdGVkU2NyZWVuIDogc2NyZWVufSlcbiAgfSxcblxuICBjaGFuZ2VTZWxlY3RlZENhbXBhaWduOiBmdW5jdGlvbihzY3JlZW4sIHNlbGVjdGVkQ2FtcGFpZ24pIHtcbiAgICBjb25zb2xlLmxvZyhzZWxlY3RlZENhbXBhaWduKVxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2VsZWN0ZWRDYW1wYWlnbiA6IHNlbGVjdGVkQ2FtcGFpZ24sXG4gICAgICBzZWxlY3RlZFNjcmVlbjogc2NyZWVuLFxuICAgIH0pXG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzcyA9IHRoaXNcbiAgICBjb25zb2xlLmxvZyh0aGlzLnN0YXRlLnNlbGVjdGVkQ2FtcGFpZ24pXG4gICAgY29uc29sZS5sb2codGhpcy5zdGF0ZS5zZWxlY3RlZFNjcmVlbilcbiAgICBjb25zb2xlLmxvZyh0aGlzLnN0YXRlLmNhbXBhaWducylcbiAgICBzd2l0Y2ggKHRoaXMuc3RhdGUuc2VsZWN0ZWRTY3JlZW4pe1xuICAgICAgY2FzZSAnQ2FtcGFpZ25zJzpcbiAgICAgICAgQ3VycmVudFNjcmVlbiA9IENhbXBhaWducyh7Y2FtcGFpZ25zOiB0aGlzcy5zdGF0ZS5jYW1wYWlnbnMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVNlbGVjdGVkQ2FtcGFpZ246IHRoaXNzLmNoYW5nZVNlbGVjdGVkQ2FtcGFpZ24sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZUNhbXBhaWduOiB0aGlzLmRlbGV0ZUNhbXBhaWduLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVTY3JlZW46IHRoaXNzLnRvZ2dsZVNjcmVlbn0pXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnQ2FtcGFpZ25EZXRhaWwnOlxuICAgICAgICBDdXJyZW50U2NyZWVuID0gQ2FtcGFpZ25EZXRhaWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYW1wYWlnbjogdGhpc3Muc3RhdGUuc2VsZWN0ZWRDYW1wYWlnbiwgXG4gICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYW1wYWlnbk9iamVjdElkOiB0aGlzcy5zdGF0ZS5zZWxlY3RlZENhbXBhZ2luT2JqZWN0SWQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlU2NyZWVuOiB0aGlzcy50b2dnbGVTY3JlZW59KVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1RlbXBsYXRlcyc6XG4gICAgICAgIEN1cnJlbnRTY3JlZW4gPSBUZW1wbGF0ZXMobnVsbClcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdPdmVydmlldyc6XG4gICAgICAgIEN1cnJlbnRTY3JlZW4gPSBDYW1wYWlnbnMoe2NhbXBhaWduczogdGhpc3Muc3RhdGUuY2FtcGFpZ25zLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VTZWxlY3RlZENhbXBhaWduOiB0aGlzcy5jaGFuZ2VTZWxlY3RlZENhbXBhaWduLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVTY3JlZW46IHRoaXNzLnRvZ2dsZVNjcmVlbn0pXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnU2VudCBNYWlsJzpcbiAgICAgICAgQ3VycmVudFNjcmVlbiA9IFNlbnRNYWlsKG51bGwpXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnRm9sbG93dXAgRmVlZCc6XG4gICAgICAgIEN1cnJlbnRTY3JlZW4gPSBGb2xsb3d1cEZlZWQobnVsbClcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdTY2hlZHVsZXMnOlxuICAgICAgICBDdXJyZW50U2NyZWVuID0gU2NoZWR1bGVzKG51bGwpXG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiXCIsIHN0eWxlOiB7aGVpZ2h0Oic1NTBweCd9fSwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJjb250YWluZXJcIiwgc3R5bGU6IHtwYWRkaW5nOicwJyx3aWR0aDonMTAwJScsaGVpZ2h0OicxMDAlJ319LCBcbiAgICAgICAgICBTaWRlTWVudSh7XG4gICAgICAgICAgICAgICAgY3JlYXRlQ2FtcGFpZ246IHRoaXMuY3JlYXRlQ2FtcGFpZ24sIFxuICAgICAgICAgICAgICAgIHByb3NwZWN0TGlzdHM6IHRoaXMuc3RhdGUucHJvc3BlY3RMaXN0cywgXG4gICAgICAgICAgICAgICAgdG9nZ2xlU2NyZWVuOiB0aGlzLnRvZ2dsZVNjcmVlbn0pLCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImNvbC1tZC0xMFwiLCBcbiAgICAgICAgICAgICAgICAgICBzdHlsZToge3BhZGRpbmc6JzAnLGhlaWdodDonMTAwJSd9fSwgXG4gICAgICAgICAgICBDdXJyZW50U2NyZWVuXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgKTtcbiAgfSxcblxuICBwZXJzaXN0Q2FtcGFpZ246IGZ1bmN0aW9uKG5ld0NhbXBhaWduKSB7XG4gICAgQ2FtcGFpZ24gPSB7fVxuICAgIENhbXBhaWduLm5hbWUgPSBuZXdDYW1wYWlnbi5uYW1lXG4gICAgQ2FtcGFpZ24uY29tcGFueSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKS5jb21wYW55XG4gICAgdGhpc3MgPSB0aGlzO1xuXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9DYW1wYWlnbicsXG4gICAgICB0eXBlOidQT1NUJyxcbiAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBkYXRhOkpTT04uc3RyaW5naWZ5KENhbXBhaWduKSxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICB0aGVfY2FtcGFpZ24gPSBfLmZpbmQodGhpc3Muc3RhdGUuY2FtcGFpZ25zLCBmdW5jdGlvbihjYW1wYWlnbil7XG4gICAgICAgICAgZmlyc3QgPSBjYW1wYWlnbi5uYW1lID09IG5ld0NhbXBhaWduLm5hbWUgXG4gICAgICAgICAgc2Vjb25kID0gY2FtcGFpZ24ucHJvc3BlY3RfbGlzdCA9PSBuZXdDYW1wYWlnbi5wcm9zcGVjdF9saXN0XG4gICAgICAgICAgcmV0dXJuIGZpcnN0ICYmIHNlY29uZFxuICAgICAgICB9KVxuICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcy5vYmplY3RJZClcblxuICAgICAgICB0aGVfY2FtcGFpZ24ub2JqZWN0SWQgPSByZXMub2JqZWN0SWRcbiAgICAgICAgY2FtcGFpZ25zID0gXy5maWx0ZXIodGhpc3Muc3RhdGUuY2FtcGFpZ25zLCBmdW5jdGlvbihjYW1wYWlnbil7XG4gICAgICAgICAgZmlyc3QgPSBjYW1wYWlnbi5uYW1lID09IG5ld0NhbXBhaWduLm5hbWUgXG4gICAgICAgICAgc2Vjb25kID0gY2FtcGFpZ24ucHJvc3BlY3RfbGlzdCA9PSBuZXdDYW1wYWlnbi5wcm9zcGVjdF9saXN0XG4gICAgICAgICAgcmV0dXJuICEoZmlyc3QgJiYgc2Vjb25kKVxuICAgICAgICB9KVxuICAgICAgICBjYW1wYWlnbnMucHVzaCh0aGVfY2FtcGFpZ24pXG4gICAgICAgIGNvbnNvbGUubG9nKGNhbXBhaWducylcblxuICAgICAgICB0aGlzcy5zZXRTdGF0ZSh7Y2FtcGFpZ25zOiAgY2FtcGFpZ25zfSlcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9DYW1wYWlnbi8nK3Jlcy5vYmplY3RJZCxcbiAgICAgICAgICB0eXBlOidQVVQnLFxuICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtwcm9zcGVjdF9saXN0OntcbiAgICAgICAgICAgICdfX3R5cGUnOidQb2ludGVyJyxcbiAgICAgICAgICAgICdjbGFzc05hbWUnOidQcm9zcGVjdExpc3QnLFxuICAgICAgICAgICAgJ29iamVjdElkJzpuZXdDYW1wYWlnbi5wcm9zcGVjdF9saXN0Lm9iamVjdElkLFxuICAgICAgICAgIH19KSxcbiAgICAgICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcyl7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgY3JlYXRlQ2FtcGFpZ246IGZ1bmN0aW9uKG5ld0NhbXBhaWduKSB7XG4gICAgY2FtcGFpZ25zID0gdGhpcy5zdGF0ZS5jYW1wYWlnbnNcbiAgICBjYW1wYWlnbnMucHVzaChuZXdDYW1wYWlnbilcbiAgICB0aGlzLnNldFN0YXRlKHtjYW1wYWlnbnM6IGNhbXBhaWduc30pXG4gICAgY29uc29sZS5sb2cobmV3Q2FtcGFpZ24pXG5cbiAgICAkKCcubW9kYWwnKS5jbGljaygpXG4gICAgJCgnLm1vZGFsLWJhY2tkcm9wJykuY2xpY2soKVxuXG4gICAgdGhpcy5wZXJzaXN0Q2FtcGFpZ24obmV3Q2FtcGFpZ24pXG4gIH1cbn0pO1xuXG52YXIgU2lkZU1lbnUgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdTaWRlTWVudScsXG4gIHRvZ2dsZVNjcmVlbjogZnVuY3Rpb24oZSkge1xuICAgIHRoaXMucHJvcHMudG9nZ2xlU2NyZWVuKCQoZS50YXJnZXQpLnRleHQoKS50cmltKCkpXG4gIH0sXG5cbiAgLypcbiAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzc05hbWU9XCJzaGFycCBidG4gYnRuLWRlZmF1bHRcIiBvbkNsaWNrPXt0aGlzLnRvZ2dsZVNjcmVlbn0+XG4gICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1maWxlLXRleHRcIiAvPiAmbmJzcDsgVGVtcGxhdGVzXG4gICAgPC9idXR0b24+XG4gICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3NOYW1lPVwic2hhcnAgYnRuIGJ0bi1kZWZhdWx0XCIgb25DbGljaz17dGhpcy50b2dnbGVTY3JlZW59PlxuICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtY2xvY2stb1wiIC8+ICZuYnNwOyBTY2hlZHVsZXNcbiAgICA8L2J1dHRvbj5cbiAgKi9cbiAgY3JlYXRlQ2FtcGFpZ25Nb2RhbDogZnVuY3Rpb24oKSB7XG5cbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiY29sLW1kLTJcIiwgXG4gICAgICAgIHN0eWxlOiB7cGFkZGluZzonMCcsaGVpZ2h0OicxMDAlJywgYmFja2dyb3VuZENvbG9yOidyZ2IoOTAsIDEwNywgMTE5KScsYm9yZGVyQm90dG9tTGVmdFJhZGl1czonM3B4J319LCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImJ0bi1ncm91cC12ZXJ0aWNhbFwiLCBzdHlsZToge3dpZHRoOicxMDAlJ319LCBcbiAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJzaGFycCBidG4gYnRuLWRlZmF1bHRcIiwgXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLnRvZ2dsZVNjcmVlbn0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe3N0eWxlOiB7bWFyZ2luTGVmdDonMjdweCd9fSwgXCJPdmVydmlld1wiKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIFxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcInNoYXJwIGJ0biBidG4tZGVmYXVsdFwiLCBcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMudG9nZ2xlU2NyZWVufSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLW5ld3NwYXBlci1vXCJ9KSwgXCIgwqBcIiwgIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe3N0eWxlOiB7bWFyZ2luTGVmdDonNHB4J319LCBcIkZvbGxvd3VwIEZlZWRcIilcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBzdHlsZToge2Rpc3BsYXk6J25vbmUnfSwgXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwic2hhcnAgYnRuIGJ0bi1kZWZhdWx0XCJ9LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY29kZS1mb3JrXCJ9KSwgXCIgwqBcIiwgIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe3N0eWxlOiB7bWFyZ2luTGVmdDonNHB4J319LCBcIlJ1bGVzXCIpXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgc3R5bGU6IHtkaXNwbGF5Oidub25lJ30sIFxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcInNoYXJwIGJ0biBidG4tZGVmYXVsdFwiLCBvbkNsaWNrOiB0aGlzLnRvZ2dsZVNjcmVlbn0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1waWUtY2hhcnRcIn0pLCBcIiDCoCBBbmFseXRpY3NcIlxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIFxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcInNoYXJwIGJ0biBidG4tZGVmYXVsdFwiLCBcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMudG9nZ2xlU2NyZWVufSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBhcGVyLXBsYW5lXCJ9KSwgXCIgwqAgU2VudCBNYWlsXCJcbiAgICAgICAgICApXG4gICAgICAgICksIFxuXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJcIiwgc3R5bGU6IHt3aWR0aDonMTAwJScsdGV4dEFsaWduOidjZW50ZXInLG1hcmdpblRvcDoxMDB9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgY2xhc3NOYW1lOiBcImJ0biBidG4tcHJpbWFyeSBuZXctbGlzdC1idG5cIiwgXG4gICAgICAgICAgICAgICAgJ2RhdGEtdG9nZ2xlJzogXCJtb2RhbFwiLCAnZGF0YS10YXJnZXQnOiBcIi5icy1jcmVhdGVDYW1wYWlnbi1tb2RhbC1zbVwiLCBcbiAgICAgICAgICAgICAgICBzdHlsZTogeyBiYWNrZ3JvdW5kSW1hZ2U6ICdsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCAjMDA5NmZmIDAlLCAjMDA1ZGZmIDEwMCUpJ319LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGx1cy1jaXJjbGVcIn0pLCBcIsKgwqBOZXcgQ2FtcGFpZ25cIlxuICAgICAgICAgIClcbiAgICAgICAgKSwgXG4gICAgICAgIENyZWF0ZUNhbXBhaWduTW9kYWwoe3Byb3NwZWN0TGlzdHM6IHRoaXMucHJvcHMucHJvc3BlY3RMaXN0cywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUNhbXBhaWduOiB0aGlzLmNyZWF0ZUNhbXBhaWdufSlcbiAgICAgIClcbiAgICApO1xuICB9LFxuXG4gIGNyZWF0ZUNhbXBhaWduOiBmdW5jdGlvbihuZXdDYW1wYWlnbikge1xuICAgIHRoaXMucHJvcHMuY3JlYXRlQ2FtcGFpZ24obmV3Q2FtcGFpZ24pXG4gIH1cbn0pO1xuIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIC8vIEZvbGxvd3VwRmVlZFxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBzY2hlZHVsZWRGb2xsb3d1cHM6IFtdXG4gICAgfVxuICB9LFxuXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBzY2hlZHVsZWRGb2xsb3d1cHMgPSBbXVxuICAgIGZvcihpPTA7aTwgdGhpcy5zdGF0ZS5zY2hlZHVsZWRGb2xsb3d1cHMubGVuZ3RoOyBpKyspeyBcbiAgICAgIHNjaGVkdWxlZEZvbGxvd3Vwcy5wdXNoKFNjaGVkdWxlZEZvbGxvd3VwUm93KG51bGwpKVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtzdHlsZToge292ZXJmbG93OidhdXRvJywgaGVpZ2h0OjU1MH19LCBcbiAgICAgICAgUmVhY3QuRE9NLnRhYmxlKHtjbGFzc05hbWU6IFwidGFibGUgdGFibGUtc3RyaXBlZFwiLCBzdHlsZToge21hcmdpbkJvdHRvbTowfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS50aGVhZChudWxsLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00udGgobnVsbCwgXCJQcm9zcGVjdCBOYW1lXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlByb3NwZWN0IEVtYWlsXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aCh7c3R5bGU6IHt0ZXh0QWxpZ246J2NlbnRlcid9fSwgXCJTdGF0dXNcIilcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udGJvZHkobnVsbCwgXG4gICAgICAgICAgICBzY2hlZHVsZWRGb2xsb3d1cHNcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApO1xuICB9XG59KTtcblxudmFyIFNjaGVkdWxlZEZvbGxvd3VwUm93ID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnU2NoZWR1bGVkRm9sbG93dXBSb3cnLFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00udHIobnVsbFxuXG4gICAgICApXG4gICAgKTtcbiAgfVxufSlcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xudmFyIFNlbmRFbWFpbE1vZGFsID0gcmVxdWlyZSgnLi9zZW5kX2VtYWlsX21vZGFsLmpzLm1pbi5qcycpXG52YXIgVGltZWxpbmVEYXlFbGVtZW50ID0gcmVxdWlyZSgnLi90aW1lbGluZV9kYXlfZWxlbWVudC5qcy5taW4uanMnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvLyBGb2xsb3d1cFRpbWVsaW5lXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgaW5pdGlhbEZvbGxvd3VwcyA9IHRoaXMucHJvcHMuaW5pdGlhbEZvbGxvd3Vwc1xuICAgIGluaXRpYWxGb2xsb3d1cHMgPSAoaW5pdGlhbEZvbGxvd3VwcykgPyBpbml0aWFsRm9sbG93dXBzIDogW11cbiAgICBiYXRjaGVzID0gdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmJhdGNoZXNcbiAgICBiYXRjaGVzID0gKGJhdGNoZXMpID8gYmF0Y2hlcyA6IFtdXG4gICAgcmV0dXJuIHtcbiAgICAgIGZvbGxvd3VwczogXy5jb21wYWN0KGluaXRpYWxGb2xsb3d1cHMpLFxuICAgICAgbG9hZGluZzogZmFsc2UsXG4gICAgICBjdXJyZW50VGVtcGxhdGU6JycsXG4gICAgICBjdXJyZW50QmF0Y2g6ICcnLFxuICAgICAgYmF0Y2hlcyA6IGJhdGNoZXNcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXNzID0gdGhpcztcbiAgICAkKCcuZGF5JykudG9vbHRpcCh7XG4gICAgICBwbGFjZW1lbnQ6ICdyaWdodCcsXG4gICAgICB0aXRsZTonKyBBZGQgYSBmb2xsb3ctdXAnXG4gICAgfSlcblxuICAgIGNvbnNvbGUubG9nKHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbilcbiAgICAgY29tcGFueSA9IEpTT04uc3RyaW5naWZ5KEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKS5jb21wYW55KVxuICAgICBjdXJyZW50Q2FtcGFpZ24gPSBhcHBDb25maWcucG9pbnRlcignQ2FtcGFpZ24nLCB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24ub2JqZWN0SWQpXG4gICAgICQuYWpheCh7XG4gICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL0ZvbGxvd3VwJyxcbiAgICAgICB0eXBlOidHRVQnLFxuICAgICAgIGhlYWRlcnM6IGFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgIGRhdGE6IHtcbiAgICAgICAgIHdoZXJlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgIGNhbXBhaWduOiBjdXJyZW50Q2FtcGFpZ24sXG4gICAgICAgICAgIGNvbXBhbnk6IGFwcENvbmZpZy5jb21wYW55XG4gICAgICAgICB9KSxcbiAgICAgICAgIGluY2x1ZGU6J3RlbXBsYXRlJyxcbiAgICAgICB9LFxuICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgY29uc29sZS5sb2coJ2ZvbGxvd3VwIHRpbWVsaW5lJylcbiAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5yZXN1bHRzKVxuICAgICAgIH0sXG4gICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJylcbiAgICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICB9XG4gICAgIH0pXG4gIH0sXG5cbiAgYWRkRm9sbG93dXBTZW50VG9CYXRjaDogZnVuY3Rpb24oYmF0Y2gsIGZvbGxvd3VwKSB7XG4gICAgYmF0Y2hlcyA9IF8ubWFwKHRoaXMuc3RhdGUuYmF0Y2hlcywgZnVuY3Rpb24oX2JhdGNoKSB7XG4gICAgICAgICAgICAgICAgICBpZihfYmF0Y2gub2JqZWN0SWQgPT0gYmF0Y2gub2JqZWN0SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoX2JhdGNoLmZvbGxvd3VwcylcbiAgICAgICAgICAgICAgICAgICAgICBfYmF0Y2guZm9sbG93dXBzLnB1c2goZm9sbG93dXApXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICBfYmF0Y2guZm9sbG93dXBzID0gW2ZvbGxvd3VwXVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIF9iYXRjaFxuICAgICAgICAgICAgICB9KVxuICAgIC8vIFBlcnNpc3RcbiAgfSxcbiAgXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdGltZWxpbmVFbGVtZW50cyA9IFtdXG4gICAgZm9sbG93dXBzID0gdGhpcy5zdGF0ZS5mb2xsb3d1cHNcblxuICAgIGJhdGNoZXMgPSBfLm1hcCh0aGlzLnN0YXRlLmJhdGNoZXMsIGZ1bmN0aW9uKGJhdGNoKSB7XG4gICAgICBpZihiYXRjaCl7XG4gICAgICAgIG5vdyA9IG1vbWVudCgpLnN0YXJ0T2YoJ2RheScpLnZhbHVlT2YoKVxuICAgICAgICBiYXRjaC5jdXJyZW50RGF5ID0gbW9tZW50KGJhdGNoLnN0YXJ0ZWQpLmRpZmYobW9tZW50KG5vdyksICAnZGF5cycpICogLTFcbiAgICAgICAgcmV0dXJuIGJhdGNoXG4gICAgICB9XG4gICAgfSlcbiAgICBiYXRjaGVzID0gXy5jb21wYWN0KGJhdGNoZXMpXG5cbiAgICBmb3IoaT0wO2k8IDMxO2krKyl7XG4gICAgICBmb2xsb3d1cCA9IF8uZmluZFdoZXJlKHRoaXMuc3RhdGUuZm9sbG93dXBzLCB7ZGF5OiBpfSlcbiAgICAgIHZhciBlbGVtZW50VHlwZSA9IChmb2xsb3d1cCkgPyB0cnVlIDogZmFsc2VcbiAgICAgIHZhciBjdXJyZW50VGVtcGxhdGUgPSAoZm9sbG93dXApID8gZm9sbG93dXAudGVtcGxhdGUgOiBmYWxzZVxuICAgICAgdmFyIGFkZFRlbXBsYXRlTW9kZSA9IChmb2xsb3d1cCkgPyBmb2xsb3d1cC5hZGRUZW1wbGF0ZU1vZGUgOiB0cnVlXG4gICAgICBjYW1wYWlnbiA9IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnblxuXG4gICAgICBjdXJyZW50QmF0Y2ggPSB7fVxuICAgICAgYmF0Y2hfc3RhcnRlZF90b2RheSA9IGZhbHNlXG4gICAgICBhbHJlYWR5U2VudCA9IGZhbHNlXG4gICAgICBiYXRjaENvdW50ID0gdW5kZWZpbmVkXG4gICAgICBpZihpID09IDApIHtcbiAgICAgICAgYmF0Y2hDb3VudCA9IChiYXRjaGVzKSA/IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLmxlbmd0aCA6IHRoaXMucHJvcHMucHJvc3BlY3RzLmxlbmd0aFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYmF0Y2ggPSBfLmZpbmRXaGVyZShiYXRjaGVzLCB7Y3VycmVudERheTogaX0pXG4gICAgICAgIGlmKGJhdGNoKSB7XG4gICAgICAgICAgY3VycmVudEJhdGNoID0gYmF0Y2gub2JqZWN0SWRcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKGJhdGNoLm9iamVjdElkKVxuICAgICAgICAgIGJhdGNoQ291bnQgPSBcIn5cIlxuICAgICAgICAgIGlmKGZvbGxvd3VwKSB7XG4gICAgICAgICAgICBfYmF0Y2hlcyA9IGZvbGxvd3VwLmJhdGNoZXNcbiAgICAgICAgICAgIGFscmVhZHlTZW50ID0gXy5maW5kV2hlcmUoX2JhdGNoZXMsIF8ucGljayhiYXRjaCwnb2JqZWN0SWQnKSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGltZWxpbmVFbGVtZW50cy5wdXNoKFJlYWN0LkRPTS5kaXYobnVsbCwgVGltZWxpbmVEYXlFbGVtZW50KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNvdW50OiBpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRUeXBlOiAhZWxlbWVudFR5cGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRlbXBsYXRlOiBjdXJyZW50VGVtcGxhdGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hDb3VudDogYmF0Y2hDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QmF0Y2g6IGN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHJlYWR5U2VudDogYWxyZWFkeVNlbnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVGVtcGxhdGVNb2RlOiBhZGRUZW1wbGF0ZU1vZGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVzOiB0aGlzLnByb3BzLnRlbXBsYXRlcywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdQcm9zcGVjdHM6IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEZvbGxvd3VwOiB0aGlzLmFkZEZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRGb2xsb3d1cDogdGhpcy5lZGl0Rm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUZvbGxvd3VwOiB0aGlzLnNhdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVGb2xsb3d1cDogdGhpcy5yZW1vdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRGb2xsb3d1cFNlbnRUb0JhdGNoOiB0aGlzLmFkZEZvbGxvd3VwU2VudFRvQmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hlczogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmJhdGNoZXMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvc3BlY3RMaXN0Q291bnQ6IHRoaXMucHJvcHMucHJvc3BlY3RMaXN0Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudEJhdGNoOiB0aGlzLnNldEN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRDdXJyZW50VGVtcGxhdGU6IHRoaXMuc2V0Q3VycmVudFRlbXBsYXRlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApKVxuXG4gICAgICBpZihpID09IDAgJiYgXy5maW5kV2hlcmUoYmF0Y2hlcywge2N1cnJlbnREYXk6IDB9KSl7XG4gICAgICAgICAgY3VycmVudEJhdGNoID0gXy5maW5kV2hlcmUoYmF0Y2hlcywge2N1cnJlbnREYXk6IDB9KS5vYmplY3RJZFxuICAgICAgICAgIGNvbnNvbGUuZGVidWcoJzAuNScpXG4gICAgICAgICAgY29uc29sZS5kZWJ1ZyhjdXJyZW50QmF0Y2gpXG4gICAgICAgICAgYmF0Y2hDb3VudCA9IFwiflwiXG4gICAgICAgICAgdGltZWxpbmVFbGVtZW50cy5wdXNoKFJlYWN0LkRPTS5kaXYobnVsbCwgVGltZWxpbmVEYXlFbGVtZW50KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlDb3VudDogMC41LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaENvdW50OiBiYXRjaENvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QmF0Y2g6IGN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UHJvc3BlY3RzOiB0aGlzLnByb3BzLm5ld1Byb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFR5cGU6IHRydWUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoZXM6IHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5iYXRjaGVzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9zcGVjdExpc3RDb3VudDogdGhpcy5wcm9wcy5wcm9zcGVjdExpc3RDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudEJhdGNoOiB0aGlzLnNldEN1cnJlbnRCYXRjaH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwidGltZWxpbmVcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtoZWlnaHQ6JzEwMCUnLGJhY2tncm91bmRDb2xvcjoncmdiKDkwLCAxMDcsIDExOSknLCB3aWR0aDo1LG1hcmdpblRvcDotMzV9fSwgXG4gICAgICAgICAgICAgdGltZWxpbmVFbGVtZW50c1xuICAgICAgICApLCBcbiAgICAgICAgU2VuZEVtYWlsTW9kYWwoe3Byb3NwZWN0czogdGhpcy5wcm9wcy5wcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDYW1wYWlnbjogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb3NwZWN0czogdGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkRm9sbG93dXBTZW50VG9CYXRjaDogdGhpcy5hZGRGb2xsb3d1cFNlbnRUb0JhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCYXRjaDogdGhpcy5zdGF0ZS5jdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRlbXBsYXRlOiB0aGlzLnN0YXRlLmN1cnJlbnRUZW1wbGF0ZX0pXG4gICAgICApXG4gICAgKTtcbiAgfSxcblxuICBjcmVhdGVGb2xsb3d1cDogZnVuY3Rpb24oKSB7XG4gICAgLy9cbiAgfSwgICAgICAgICBcblxuICBhZGRGb2xsb3d1cDogZnVuY3Rpb24oZGF5KSB7XG4gICAgLy9jb25zb2xlLmxvZygnY2FsbGVkIHRlbXBsYXRlIGVkaXQgbWVudScpXG4gICAgZm9sbG93dXBzID0gdGhpcy5zdGF0ZS5mb2xsb3d1cHNcbiAgICBmb2xsb3d1cHMucHVzaCh7YWRkVGVtcGxhdGVNb2RlOiB0cnVlLCBkYXk6IGRheX0pXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGZvbGxvd3VwczogZm9sbG93dXBzIH0pXG4gIH0sXG5cbiAgZWRpdEZvbGxvd3VwOiBmdW5jdGlvbihkYXkpIHtcbiAgICAvLyBmaW5kIHRlbXBsYXRlIHNldCBlZGl0bW9kZSBpcyBmYWxzZVxuICAgIGZvbGxvd3VwcyA9IF8ubWFwKHRoaXMuc3RhdGUuZm9sbG93dXBzLCBmdW5jdGlvbihmb2xsb3d1cCkge1xuICAgICAgaWYoZm9sbG93dXAuZGF5ID09IGRheSl7IGZvbGxvd3VwLmFkZFRlbXBsYXRlTW9kZSA9IHRydWUgfVxuICAgICAgcmV0dXJuIGZvbGxvd3VwXG4gICAgfSlcbiAgICB0aGlzLnNldFN0YXRlKHtmb2xsb3d1cHM6IGZvbGxvd3Vwc30pXG4gIH0sXG5cbiAgc2F2ZUZvbGxvd3VwOiBmdW5jdGlvbihkYXksIGNob3NlblRlbXBsYXRlKSB7XG4gICAgbmV3X2ZvbGxvd3VwcyA9IF8ubWFwKHRoaXMuc3RhdGUuZm9sbG93dXBzLCBmdW5jdGlvbihmb2xsb3d1cCkge1xuICAgICAgaWYoZm9sbG93dXAuZGF5ID09IGRheSl7XG4gICAgICAgIGZvbGxvd3VwLmFkZFRlbXBsYXRlTW9kZSA9IGZhbHNlXG4gICAgICAgIGZvbGxvd3VwLnRlbXBsYXRlID0gY2hvc2VuVGVtcGxhdGVcbiAgICAgIH1cbiAgICAgIHJldHVybiBmb2xsb3d1cFxuICAgIH0pXG4gICAgdGhpcy5zZXRTdGF0ZSh7Zm9sbG93dXBzOiBuZXdfZm9sbG93dXBzfSlcbiAgICBmb2xsb3d1cCA9IF8uZmluZFdoZXJlKG5ld19mb2xsb3d1cHMsIHtkYXk6IGRheX0pXG5cbiAgICAgIGlmKGZvbGxvd3VwLm9iamVjdElkKXtcbiAgICAgICAgdXJsID0gXCIvXCIrZm9sbG93dXAub2JqZWN0SWQ7IHR5cGU9XCJQVVRcIlxuICAgICAgICBkYXRhID0ge3RlbXBsYXRlOiBhcHBDb25maWcucG9pbnRlcignVGVtcGxhdGUnLCBjaG9zZW5UZW1wbGF0ZS5vYmplY3RJZCl9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1cmwgPSBcIlwiOyB0eXBlPVwiUE9TVFwiO1xuXG4gICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgIGRheTogZGF5LFxuICAgICAgICAgICAgY2FtcGFpZ24gOiBhcHBDb25maWcucG9pbnRlcignQ2FtcGFpZ24nLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLm9iamVjdElkKSxcbiAgICAgICAgICAgIHRlbXBsYXRlOiBhcHBDb25maWcucG9pbnRlcignVGVtcGxhdGUnLCBjaG9zZW5UZW1wbGF0ZS5vYmplY3RJZCksXG4gICAgICAgICAgfVxuICAgICAgfVxuXG4gICAgdGhpc3MgPSB0aGlzO1xuICAgICQuYWpheCh7XG4gICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvRm9sbG93dXAnK3VybCxcbiAgICAgIHR5cGU6dHlwZSxcbiAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIG5ld19mb2xsb3d1cHMgPSBfLm1hcChuZXdfZm9sbG93dXBzLCBmdW5jdGlvbihmb2xsb3d1cCkge1xuICAgICAgICAgIGlmKGZvbGxvd3VwLmRheSA9PSBkYXkpIHsgZm9sbG93dXAub2JqZWN0SWQgPSBmYWxzZSB9XG4gICAgICAgICAgcmV0dXJuIGZvbGxvd3VwXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXNzLnNldFN0YXRlKHtmb2xsb3d1cHM6IG5ld19mb2xsb3d1cHN9KVxuXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvQ2FtcGFpZ24vJyt0aGlzcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLm9iamVjdElkLFxuICAgICAgICAgIHR5cGU6J1BVVCcsXG4gICAgICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeSh7Zm9sbG93dXBzOiB7XG4gICAgICAgICAgICBfX29wOiAnQWRkVW5pcXVlJyxcbiAgICAgICAgICAgIG9iamVjdHM6W2FwcENvbmZpZy5wb2ludGVyKCdGb2xsb3d1cCcsIHJlcy5vYmplY3RJZCldXG4gICAgICAgICAgfX0pLFxuICAgICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oKSB7IH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgeyB9XG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgeyB9LFxuICAgIH0pXG4gIH0sXG5cbiAgcmVtb3ZlRm9sbG93dXA6IGZ1bmN0aW9uKGRheSkge1xuICAgIGZvbGxvd3VwcyA9IFtdXG4gICAgZm9yKGk9MDtpPCB0aGlzLnN0YXRlLmZvbGxvd3Vwcy5sZW5ndGg7aSsrKVxuICAgICAgaWYodGhpcy5zdGF0ZS5mb2xsb3d1cHNbaV0uZGF5ICE9IGRheSlcbiAgICAgICAgZm9sbG93dXBzLnB1c2godGhpcy5zdGF0ZS5mb2xsb3d1cHNbaV0pXG4gICAgICBcbiAgICBmb3IoaT0wO2k8IHRoaXMuc3RhdGUuZm9sbG93dXBzLmxlbmd0aDtpKyspXG4gICAgICBpZih0aGlzLnN0YXRlLmZvbGxvd3Vwc1tpXS5kYXkgPT0gZGF5KVxuICAgICAgICBicmVha1xuICAgIFxuICAgIHRoaXMuc2V0U3RhdGUoe2ZvbGxvd3VwczogZm9sbG93dXBzfSkgXG4gICAgaWQgPSB0aGlzLnN0YXRlLmZvbGxvd3Vwc1tpXVxuXG4gICAgdGhpc3MgPSB0aGlzO1xuICAgIGlmKGlkKSB7XG4gICAgICBpZCA9IGlkLm9iamVjdElkXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvRm9sbG93dXAvJytpZCxcbiAgICAgICAgaGVhZGVyczphcHBDb25maWcuaGVhZGVycyxcbiAgICAgICAgdHlwZTonREVMRVRFJyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7IGNvbnNvbGUubG9nKHJlcykgfVxuICAgICAgfSlcblxuICAgICBjb25zb2xlLmxvZygnUkVNT1ZFIEFSUkFZJylcbiAgICAgICQuYWpheCh7XG4gICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9DYW1wYWlnbi8nK3RoaXNzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24ub2JqZWN0SWQsXG4gICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgIHR5cGU6J1BVVCcsXG4gICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBmb2xsb3d1cHM6IHtcbiAgICAgICAgICAgIF9fb3AgOiAnUmVtb3ZlJyxcbiAgICAgICAgICAgIG9iamVjdHM6IFthcHBDb25maWcucG9pbnRlcignRm9sbG93dXAnLCBpZCldXG4gICAgICAgICAgfVxuICAgICAgICB9KSxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKXsgY29uc29sZS5sb2cocmVzKSB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7IH1cbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG4gIHNldEN1cnJlbnRCYXRjaDogZnVuY3Rpb24oY3VycmVudEJhdGNoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Y3VycmVudEJhdGNoOiBjdXJyZW50QmF0Y2h9KVxuICB9LFxuXG4gIHNldEN1cnJlbnRUZW1wbGF0ZTogZnVuY3Rpb24odGVtcGxhdGUpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50VGVtcGxhdGU6IHRlbXBsYXRlIH0pXG4gIH1cbn0pO1xuXG5cbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICBcIlNjaGVkdWxzXCJcbiAgICAgIClcbiAgICApO1xuICB9XG59KTtcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBjdXJyZW50UHJvc3BlY3Q6IDAsXG4gICAgfVxuICB9LFxuXG4gIHNlbmRFbWFpbHM6IGZ1bmN0aW9uKCkge1xuICAgIHNlbGVjdGVkQ2FtcGFpZ24gPSB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ25cbiAgICBjYW1wYWlnbl9pZCA9IHNlbGVjdGVkQ2FtcGFpZ24ub2JqZWN0SWRcbiAgICBwcm9zcGVjdGxpc3RfaWQgPSBzZWxlY3RlZENhbXBhaWduLnByb3NwZWN0X2xpc3Qub2JqZWN0SWRcbiAgICB0ZW1wbGF0ZV9pZCA9IHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLm9iamVjdElkXG4gICAgXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9uYW1lbGVzcy1yZXRyZWF0LTM1MjUuaGVyb2t1YXBwLmNvbS9zZW5kX2VtYWlsJyxcbiAgICAgIC8vdXJsOidodHRwOi8vMTI3LjAuMC4xOjUwMDAvc2VuZF9lbWFpbCcsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHRlbXBsYXRlX2lkIDogdGVtcGxhdGVfaWQsXG4gICAgICAgIGNhbXBhaWduX2lkIDogY2FtcGFpZ25faWQsXG4gICAgICAgIHByb3NwZWN0bGlzdF9pZCA6IHByb3NwZWN0bGlzdF9pZCxcbiAgICAgIH0sXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgY29uc29sZS5sb2cocmVzLnJlc3VsdHMpIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7IGNvbnNvbGUubG9nKGVycikgfVxuICAgIH0pXG5cbiAgICAvKlxuICAgICovXG4gICAgLy8gVXBkYXRlIEZvbGxvd3VwXG4gICAgLy8gUGVyc2lzdCBGb2xsb3d1cFxuICAgIC8vIGNsb3NlIG1vZGFsXG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBwcm9zcGVjdCA9IHRoaXMucHJvcHMucHJvc3BlY3RzW3RoaXMuc3RhdGUuY3VycmVudFByb3NwZWN0XVxuICAgIHByb3NwZWN0ID0gKHByb3NwZWN0KSA/IHByb3NwZWN0IDogeyduYW1lJzonJywnZW1haWwnOicnfVxuXG4gICAgdmFyIHRoaXNzID0gdGhpcztcbiAgICBjb25zb2xlLmRlYnVnKCdTRU5EIEVNQUlMIEJBVENIJylcbiAgICBjb25zb2xlLmRlYnVnKHRoaXMucHJvcHMuY3VycmVudEJhdGNoKVxuICAgIG5ld0JhdGNoID0gXy5pc0VxdWFsKHRoaXMucHJvcHMuY3VycmVudEJhdGNoLCB7fSlcbiAgICBwcm9zcGVjdHMgPSAobmV3QmF0Y2gpID8gdGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMgOiB0aGlzLnByb3BzLnByb3NwZWN0c1xuICAgIGlmKG5ld0JhdGNoKXtcbiAgICAgIHByb3NwZWN0cyA9IF8ubWFwKHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLCBmdW5jdGlvbihwcm9zcGVjdCkge1xuICAgICAgICAgIHJldHVybiBVc2VyUGxhY2VIb2xkZXIoe3Byb3NwZWN0OiBwcm9zcGVjdH0pXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICBwcm9zcGVjdHMgPSBfLm1hcCh0aGlzLnByb3BzLnByb3NwZWN0cywgZnVuY3Rpb24ocHJvc3BlY3QpIHtcbiAgICAgICAgaWYoXy5maW5kV2hlcmUocHJvc3BlY3QuYmF0Y2hlcywge29iamVjdElkOiB0aGlzcy5wcm9wcy5jdXJyZW50QmF0Y2h9KSlcbiAgICAgICAgICByZXR1cm4gVXNlclBsYWNlSG9sZGVyKHtwcm9zcGVjdDogcHJvc3BlY3R9KVxuICAgICAgfSlcbiAgICB9XG4gICAgcHJvc3BlY3RzID0gXy5jb21wYWN0KHByb3NwZWN0cylcbiAgICBjb25zb2xlLmRlYnVnKHByb3NwZWN0cylcbiAgICBjb25zb2xlLmRlYnVnKHByb3NwZWN0cy5sZW5ndGgpXG4gICAgcHJvc3BlY3RDb3VudCA9IHByb3NwZWN0cy5sZW5ndGhcbiAgICBlbWFpbCA9IChwcm9zcGVjdC5lbWFpbCkgPyBwcm9zcGVjdC5lbWFpbC50b0xvd2VyQ2FzZSgpIDogXCJcIlxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwgZmFkZSBicy1zZW5kRW1haWwtbW9kYWwtbGdcIiwgdGFiSW5kZXg6IFwiLTFcIiwgXG4gICAgICAgICAgIHJvbGU6IFwiZGlhbG9nXCIsICdhcmlhLWxhYmVsbGVkYnknOiBcIm15U21hbGxNb2RhbExhYmVsXCIsICdhcmlhLWhpZGRlbic6IFwidHJ1ZVwiLCBcbiAgICAgICAgICAgaWQ6IFwic2VuZEVtYWlsTW9kYWxcIiwgc3R5bGU6IHt0b3A6JzEwcHgnfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWRpYWxvZyBtb2RhbC1sZ1wifSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbC1jb250ZW50XCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwtaGVhZGVyXCJ9LCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIGNsYXNzTmFtZTogXCJjbG9zZVwiLCAnZGF0YS1kaXNtaXNzJzogXCJtb2RhbFwifSwgUmVhY3QuRE9NLnNwYW4oeydhcmlhLWhpZGRlbic6IFwidHJ1ZVwifSwgXCLDl1wiKSwgXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwic3Itb25seVwifSwgXCJDbG9zZVwiKSksIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLnNlbmRFbWFpbHMsIFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7ZmxvYXQ6J3JpZ2h0J30sIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLXByaW1hcnkgYnRuLXNtXCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBhcGVyLXBsYW5lXCJ9KSwgXCLCoCBTZW5kIEVtYWlsXCIpLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgc3R5bGU6IHttYXJnaW5SaWdodDoxMCwgZmxvYXQ6J3JpZ2h0J30sIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXCIsICdkYXRhLWRpc21pc3MnOiBcIm1vZGFsXCJ9LCBcIkNsb3NlXCIpLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5oNCh7Y2xhc3NOYW1lOiBcIm1vZGFsLXRpdGxlXCIsIGlkOiBcIm15TW9kYWxMYWJlbFwifSwgXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZW52ZWxvcGVcIn0pLCBcIiDCoFNlbmQgRW1haWxcIiArICcgJyArXG4gICAgICAgICAgICAgICAgICAgIFwiwqDCoFwiLCBcbiAgICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLnNtYWxsKG51bGwsIFwiKFwiK3Byb3NwZWN0Q291bnQrXCIpXCIpXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWJvZHlcIiwgc3R5bGU6IHtwYWRkaW5nVG9wOjV9fSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uaDQobnVsbCwgXCJQZW9wbGVcIiksIFxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicHJvc3BlY3QtY29udGFpbmVyXCJ9LCBcbiAgICAgICAgICAgICAgICAgICAgcHJvc3BlY3RzXG4gICAgICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uaDQoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJ319LCBcIkVtYWlscyDCoMKgwqBcIiwgXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5zbWFsbChudWxsLCAodGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QrMSkrJyBvZiAnK3Byb3NwZWN0Q291bnRcbiAgICAgICAgICAgICAgICAgICkpLCBcbiAgICAgICAgICAgICAgICAgIFwiwqDCoMKgXCIsIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICAgIGNsYXNzTmFtZTogKHRoaXMuc3RhdGUuY3VycmVudFByb3NwZWN0ID09IDAgKSA/IFwiYnRuIGRpc2FibGVkXCIgOiBcImJ0blwiLCBcbiAgICAgICAgICAgICAgICAgICAgb25DbGljazogdGhpcy5wcmV2aW91c1Byb3NwZWN0fSwgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1hcnJvdy1sZWZ0XCJ9KSksIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICBjbGFzc05hbWU6ICh0aGlzLnN0YXRlLmN1cnJlbnRQcm9zcGVjdCA9PSAxMzUgKSA/IFwiYnRuIGRpc2FibGVkXCIgOiBcImJ0blwiLCBcbiAgICAgICAgICAgICAgICAgICAgb25DbGljazogdGhpcy5uZXh0UHJvc3BlY3R9LCBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWFycm93LXJpZ2h0XCJ9KSksIFxuXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuXG5SZWFjdC5ET00udWwoe2NsYXNzTmFtZTogXCJsaXN0LWdyb3VwIGVtYWlsLWhvbGRlclwiLCBzdHlsZToge2JvcmRlclRvcDonc29saWQgMXB4ICNlZWUnfX0sIFxuICBSZWFjdC5ET00ubGkoe2NsYXNzTmFtZTogXCJsaXN0LWdyb3VwLWl0ZW1cIn0sIFxuICAgIFJlYWN0LkRPTS5oNSh7c3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snLG1hcmdpblRvcDowLG1hcmdpbkJvdHRvbTowfX0sIFwiVG86wqDCoFwiKSwgXG4gICAgcHJvc3BlY3QubmFtZSArIFwiIC0gXCIgKyBlbWFpbFxuICApLCBcbiAgUmVhY3QuRE9NLmxpKHtjbGFzc05hbWU6IFwibGlzdC1ncm91cC1pdGVtXCJ9LCBcbiAgICBSZWFjdC5ET00uaDUoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyxtYXJnaW5Ub3A6MCxtYXJnaW5Cb3R0b206MH19LCBcIlN1YmplY3Q6wqDCoFwiKSwgXCIgXCIsIHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLnN1YmplY3RcbiAgKSwgXG4gIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAtaXRlbSBib2R5XCJ9KVxuKVxuICBcbiAgICAgICAgICAgICAgICAgIClcblxuICAgICAgICAgICAgICAgICksIFxuXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwtZm9vdGVyXCIsIHN0eWxlOiB7ZGlzcGxheTonbm9uZSd9fSwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLWRlZmF1bHRcIiwgJ2RhdGEtZGlzbWlzcyc6IFwibW9kYWxcIn0sIFwiQ2xvc2VcIiksIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1wcmltYXJ5XCJ9LCBcIlNlbmQgRW1haWxcIilcbiAgICAgIClcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICApO1xuICB9LFxuXG4gIHByZXZpb3VzUHJvc3BlY3Q6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRQcm9zcGVjdDogdGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QtMSB9KVxuICB9LFxuXG4gIG5leHRQcm9zcGVjdDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Y3VycmVudFByb3NwZWN0OiB0aGlzLnN0YXRlLmN1cnJlbnRQcm9zcGVjdCsxIH0pXG4gIH0sXG5cbiAgcGFyc2VUZW1wbGF0ZTogZnVuY3Rpb24odGVtcGxhdGVCb2R5KSB7XG4gICAgZmlyc3RfbmFtZSA9IHByb3NwZWN0Lm5hbWUuc3BsaXQoJyAnKVswXVxuICAgIC8vaGlyaW5nX3NpZ25hbCA9IHByb3NwZWN0LnNpZ25hbHNcblxuICAgIHNpZ25hbHMgPSAocHJvc3BlY3Quc2lnbmFscykgPyBwcm9zcGVjdC5zaWduYWxzWzBdIDogXCJcIlxuICAgIHRlbXBsYXRlQm9keSA9IE11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZUJvZHksIHtcbiAgICAgIGhpcmluZ19zaWduYWw6IHNpZ25hbHMsXG4gICAgICBmaXJzdF9uYW1lOiBwcm9zcGVjdC5uYW1lLnNwbGl0KCcgJylbMF1cbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2codGVtcGxhdGVCb2R5KVxuICAgICAgXG4gICAgcmV0dXJuIHRlbXBsYXRlQm9keVxuICB9LFxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZSlcbiAgICBwYXJzZWRUZW1wbGF0ZSA9IHRoaXMucGFyc2VUZW1wbGF0ZSh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZS5ib2R5KVxuICAgIFxuICAgIC8vJCgnLmJvZHknKS5odG1sKHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLmJvZHkpXG4gICAgJCgnLmJvZHknKS5odG1sKHBhcnNlZFRlbXBsYXRlKVxuICB9XG59KTtcblxudmFyIFVzZXJQbGFjZUhvbGRlciA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ1VzZXJQbGFjZUhvbGRlcicsXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImJ0bi1ncm91cFwiLCBzdHlsZToge21hcmdpblJpZ2h0OjUsbWFyZ2luQm90dG9tOjV9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImJ0bi1ncm91cFwifSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4tc21cIn0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXVzZXJcIn0pLCBcIsKgwqBcIiwgXG4gICAgICAgICAgICAgICh0aGlzLnByb3BzLnByb3NwZWN0KSA/IHRoaXMucHJvcHMucHJvc3BlY3QubmFtZSA6IFwiXCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi1zbVwifSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgKVxuICB9XG59KTtcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvLyBTZW50IE1haWxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2VudEVtYWlsczogW11cbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXNzID0gdGhpcztcbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOiAnaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9TZW50RW1haWwnLFxuICAgICAgZGF0YTp7aW5jbHVkZTogJ2NhbXBhaWduLHByb3NwZWN0LHByb3NwZWN0LmVtYWlsX2d1ZXNzZXMucGF0dGVybid9LFxuICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgdGhpc3Muc2V0U3RhdGUoe3NlbnRFbWFpbHM6IHJlcy5yZXN1bHRzfSkgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbigpIHt9XG4gICAgfSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHNlbnRFbWFpbHMgPSBbXVxuICAgIGZvcihpPTA7aTwgdGhpcy5zdGF0ZS5zZW50RW1haWxzLmxlbmd0aDsgaSsrKSBcbiAgICAgIHNlbnRFbWFpbHMucHVzaChTZW50RW1haWxSb3coe3NlbnRFbWFpbDogdGhpcy5zdGF0ZS5zZW50RW1haWxzW2ldfSkpXG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7c3R5bGU6IHtvdmVyZmxvdzonYXV0bycsaGVpZ2h0OjU1MH19LCBcbiAgICAgICAgUmVhY3QuRE9NLnRhYmxlKHtjbGFzc05hbWU6IFwidGFibGUgdGFibGUtc3RyaXBlZFwiLCBzdHlsZToge21hcmdpbkJvdHRvbTowfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS50aGVhZChudWxsLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00udGgobnVsbCwgXCJQcm9zcGVjdCBOYW1lXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlByb3NwZWN0IEVtYWlsXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aCh7c3R5bGU6IHt3aWR0aDoyOTB9fSwgXCJTdGF0dXNcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiQ2FtcGFpZ25cIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiVGVtcGxhdGVcIilcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udGJvZHkobnVsbCwgXG4gICAgICAgICAgICBzZW50RW1haWxzXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgKTtcbiAgfVxufSk7XG5cbnZhciBTZW50RW1haWxSb3cgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdTZW50RW1haWxSb3cnLFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHNlbnRFbWFpbCA9IHRoaXMucHJvcHMuc2VudEVtYWlsXG4gICAgLy9jb25zb2xlLmxvZyhzZW50RW1haWwpXG5cbiAgICBlbWFpbCA9IHNlbnRFbWFpbC5lbWFpbFxuICAgIGlmKGVtYWlsID09IFwibm9fZW1haWxcIil7XG4gICAgICBmaXJzdCA9IHNlbnRFbWFpbC5wcm9zcGVjdC5uYW1lLnNwbGl0KCcgJylbMF1cbiAgICAgIGxhc3QgPSBfLmxhc3Qoc2VudEVtYWlsLnByb3NwZWN0Lm5hbWUuc3BsaXQoJyAnKSlcblxuICAgICAgcGF0dGVybiA9IF8uZmluZFdoZXJlKHNlbnRFbWFpbC5wcm9zcGVjdC5lbWFpbF9ndWVzc2VzLCB7J3RyaWVkJzpmYWxzZX0pXG4gICAgICBkYXRhID0ge2ZpcnN0OiBmaXJzdCwgbGFzdDogbGFzdCwgZmk6IGZpcnN0WzBdLCBsaTogbGFzdFswXX1cbiAgICAgIGVtYWlsID0gTXVzdGFjaGUucmVuZGVyKHBhdHRlcm4ucGF0dGVybi5wYXR0ZXJuLCBkYXRhKS50b0xvd2VyQ2FzZSgpXG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS50cihudWxsLCBcbiAgICAgICAgUmVhY3QuRE9NLnRkKG51bGwsIFJlYWN0LkRPTS5oNihudWxsLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2xvY2tcIn0pLCBcbiAgICAgICAgICAgIG1vbWVudChzZW50RW1haWwuY3JlYXRlZEF0KS5mcm9tTm93KCkpKSwgXG4gICAgICAgIFJlYWN0LkRPTS50ZChudWxsLCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7Zm9udFNpemU6MTQsZm9udFdlaWdodDonYm9sZCcsbWFyZ2luQm90dG9tOjB9fSwgc2VudEVtYWlsLnByb3NwZWN0Lm5hbWUpLCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luVG9wOjQsbWFyZ2luQm90dG9tOjB9fSwgc2VudEVtYWlsLnByb3NwZWN0LnBvcy50cmltKCkpLCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luVG9wOjR9fSwgc2VudEVtYWlsLnByb3NwZWN0LmNvbXBhbnlfbmFtZSlcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS50ZChudWxsLCBSZWFjdC5ET00uaDYobnVsbCwgZW1haWwpKSwgXG4gICAgICAgIFJlYWN0LkRPTS50ZCh7c3R5bGU6IHtwYWRkaW5nVG9wOjEzfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwibGFiZWwgbGFiZWwtZGVmYXVsdFwifSwgXCJRdWV1ZWRcIiksIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hldnJvbi1jaXJjbGUtcmlnaHQgdGV4dC1tdXRlZFwiLCBcbiAgICAgICAgICAgICBzdHlsZToge3BhZGRpbmdMZWZ0OjUscGFkZGluZ1JpZ2h0OjV9fSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwibGFiZWwgbGFiZWwtc3VjY2Vzc1wifSwgXCJPcGVuZWRcIiksIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hldnJvbi1jaXJjbGUtcmlnaHQgdGV4dC1tdXRlZFwiLCBcbiAgICAgICAgICAgICBzdHlsZToge3BhZGRpbmdMZWZ0OjUscGFkZGluZ1JpZ2h0OjV9fSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwibGFiZWwgbGFiZWwtZGVmYXVsdFwifSwgXCJEZWxpdmVyZWRcIiksIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hldnJvbi1jaXJjbGUtcmlnaHQgdGV4dC1tdXRlZFwiLCBcbiAgICAgICAgICAgICBzdHlsZToge3BhZGRpbmdMZWZ0OjUscGFkZGluZ1JpZ2h0OjV9fSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwibGFiZWwgbGFiZWwtZGVmYXVsdFwifSwgXCJSZXBsaWVkXCIpXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00udGQobnVsbCwgXG4gICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge2N1cnNvcjoncG9pbnRlcid9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1saXN0LWFsdFwifSksIFwiIMKgXCIgKyAnICcgK1xuICAgICAgICAgIFwiQm9zdG9uIFZQIFNhbGVzIC0gUmV0YWlsXCJcbiAgICAgICAgICApXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00udGQobnVsbCwgXG4gICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge2N1cnNvcjoncG9pbnRlcid9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFwiIMKgXCIgKyAnICcgK1xuICAgICAgICAgIFwiRm9sbG93dXAgIzIgLSBQcm92aWRlIFZhbHVlIFwiLCBSZWFjdC5ET00uYnIobnVsbCksIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXCIgU3ViamVjdDogSnVzdCB3YW50ZWQgdG8gZm9sbG93dXAgb24gdGhlIGxhc3QgZW1haWwgXCIpLCBSZWFjdC5ET00uYnIobnVsbCksIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXCIgQm9keTogSnVzdCB3YW50ZWQgdG8gZm9sbG93dXAgb24gdGhlIGxhc3QgZW1haWwgXCIpXG5cbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gIH1cbn0pXG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxudmFyIEVkaXRUZW1wbGF0ZVZpZXcgPSByZXF1aXJlKCcuL2VkaXRfdGVtcGxhdGUuanMubWluLmpzJylcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy9UZW1wbGF0ZXNcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2VsZWN0ZWRUZW1wbGF0ZTogMCxcbiAgICAgIGVkaXRNb2RlOiBmYWxzZVxuICAgIH1cbiAgfSxcblxuICBjaGFuZ2VNb2RlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtlZGl0TW9kZTogIXRoaXMuc3RhdGUuZWRpdGVNb2RlfSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHRlbXBsYXRlVmlldyA9ICghdGhpcy5zdGF0ZS5lZGl0TW9kZSkgPyBUZW1wbGF0ZVZpZXcoe2NoYW5nZU1vZGU6IHRoaXMuY2hhbmdlTW9kZX0pIDogRWRpdFRlbXBsYXRlVmlldyhudWxsKVxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtzdHlsZToge2hlaWdodDonMTAwJSd9fSwgXG4gICAgICAgICAgVGVtcGxhdGVTaWRlTWVudShudWxsKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImNvbC1tZC05XCIsIHN0eWxlOiB7cGFkZGluZzowLGhlaWdodDonMTAwJSd9fSwgXG4gICAgICAgICAgICAgIHRlbXBsYXRlVmlld1xuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgICk7XG4gIH1cbn0pO1xuXG5cbnZhciBUZW1wbGF0ZVZpZXcgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdUZW1wbGF0ZVZpZXcnLFxuICBjaGFuZ2VNb2RlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnByb3BzLmNoYW5nZU1vZGUoKVxuICB9LFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwgcGFuZWwtaW5mb1wiLCBzdHlsZToge3dpZHRoOicxMDAlJyxoZWlnaHQ6JzEwMCUnLGJvcmRlcjowfX0sIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtaGVhZGluZ1wifSwgXG4gICAgICAgICAgXCJUZW1wbGF0ZSBOYW1lXCIsICBcbiAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLmNoYW5nZU1vZGUsIFxuICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLXByaW1hcnkgYnRuLXhzXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7ZGlzcGxheTonYmxvY2snLGZsb2F0OidyaWdodCcsbWFyZ2luVG9wOicwcHgnfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wZW5jaWwtc3F1YXJlXCJ9KSwgXCIgwqAgRWRpdCBUZW1wbGF0ZVwiKVxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWJvZHlcIn0sIFxuICAgICAgICBSZWFjdC5ET00uaDQobnVsbCwgXCJGb2xsb3d1cCAtIFByb3NwZWN0aW5nIFNBQVMgT3V0cmVhY2hcIiksIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luQm90dG9tOicwJ30sIGNsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcIkNyZWF0ZWQgYnkgTWFyayBvbiBKdWwuIDIxLCAyMDE0XCIpLCBcbiAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge21hcmdpblRvcDonMCd9LCBjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXCJsYXN0IHVwZGF0ZWQgNyBkYXlzIGFnb1wiKSwgXG4gICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXG5cbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsIHBhbmVsLWRlZmF1bHRcIn0sIFxuXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWJvZHlcIn0sIFxuICAgICAgICAgIFwiMTUgbWludXRlcyB0byBnZXQgY29tcGFueV9uYW1lIG1vcmUgY3VzdG9tZXJzXCIgKyAnICcgK1xuICAgICAgICAgIFwiSGV5IGZpcnN0X25hbWUsXCIgKyAnICcgK1xuXG4gICAgICAgICAgXCJXb3VsZCB5b3UgbGlrZSB0byBoZWFyIGFuIGlkZWEgZm9yIGEgMTUgbWludXRlIGhhY2sgdGhhdCBjb3VsZCBzaWduaWZpY2FudGx5IGluY3JlYXNlIHRoZSBudW1iZXIgb2YgcHJvc3BlY3RzIHlvdXIgc2FsZXMgcGVvcGxlIGhhdmUgYWNjZXNzIHRvID9cIiArICcgJyArXG4gICAgICAgICAgIFxuICAgICAgICAgIFwiUmVjZW50bHkgb25lIG9mIG91ciBCMkIgY2xpZW50cyBzYXcgYSBodWdlIGluY3JlYXNlIGluIHRyaWFsIHNpZ24gdXBzIGFmdGVyIHdvcmtpbmcgd2l0aCB1cy4gZmlyc3RfbmFtZSwgbGV0cyBzY2hlZHVsZSBhIDE1IG1pbnV0ZSBjYWxsIHRoaXMgd2VlayB0byBzZWUgaWYgdGhpcyB3b3VsZCBiZSBhIGdvb2QgZml0IGZvciBib3RoIG9mIHVzLlwiICsgJyAnICtcbiAgICAgICAgICAgXG4gICAgICAgICAgXCJXaGF0IHRoZSBiZXN0IHRpbWUgZm9yIHlvdSB0aGlzIHdlZWsgP1wiICsgJyAnICtcbiAgICAgICAgICAgXG4gICAgICAgICAgXCItLVwiICsgJyAnICtcbiAgICAgICAgICBcIk1hcmtcIiArICcgJyArIFxuICAgICAgICAgIFwiQ3VzdG9tZXJvXCIgKyAnICcgK1xuICAgICAgICAgIFwibWFya0BjdXN0b21lcm9ocS5jb21cIlxuICAgICAgICAgIFxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgICApO1xuICB9LFxufSk7XG5cbnZhciBUZW1wbGF0ZVNpZGVNZW51ID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnVGVtcGxhdGVTaWRlTWVudScsXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRlbXBsYXRlczogW10sXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICAvL0FqYXggUmVxdWVzdCBGb3IgVGVtcGxhdGVzXG4gICAgLypcbiAgICAgJC5hamF4KHtcbiAgICAgIHVybDonJyxcbiAgICAgIGhlYWRlcnM6IFwiXCIsXG4gICAgICBkYXRhOiBcIlwiLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24oKSB7XG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xuICAgICAgfVxuICAgICB9KTtcbiAgICAqL1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdGVtcGxhdGVzID0gW11cbiAgICBmb3IoaT0wO2k8IHRoaXMuc3RhdGUudGVtcGxhdGVzLmxlbmd0aDsgaSsrKVxuICAgICAgdGVtcGxhdGVzLnB1c2goUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgY2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAtaXRlbVwifSwgXCJ0ZW1wbGF0ZXNbaV0ubmFtZVwiKSlcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImNvbC1tZC0zXCIsIHN0eWxlOiB7cGFkZGluZzonMCcsIGJvcmRlclJpZ2h0OicxcHggc29saWQgI2RkZCcsaGVpZ2h0OicxMDAlJyx0ZXh0QWxpZ246J2NlbnRlcid9fSwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbCBwYW5lbC1kZWZhdWx0XCIsIHN0eWxlOiB7Ym9yZGVyOjB9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsLWhlYWRpbmdcIiwgc3R5bGU6IHtoZWlnaHQ6NjB9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHtmbG9hdDonbGVmdCcsZm9udFNpemU6MjAsZm9udFdlaWdodDonYm9sZCd9fSwgXG4gICAgICAgICAgICAgIFwiVGVtcGxhdGVzXCJcbiAgICAgICAgICAgICksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBcIiwgXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtmbG9hdDoncmlnaHQnfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBsdXNcIn0pXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnVsKHtjbGFzc05hbWU6IFwibGlzdC1ncm91cFwiLCBzdHlsZToge3RleHRBbGlnbjonbGVmdCd9fSwgXG4gICAgICAgICAgICB0ZW1wbGF0ZXNcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gIH1cbn0pO1xuIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIC8vVGVtcGxhdGVzTWVudVxuICB0b2dnbGVUZW1wbGF0ZUVkaXRNZW51OiBmdW5jdGlvbihjdXJyZW50VGVtcGxhdGUpIHtcbiAgICB0aGlzLnByb3BzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUoY3VycmVudFRlbXBsYXRlKVxuICB9LFxuXG4gIGNyZWF0ZVRlbXBsYXRlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnByb3BzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUoe1xuICAgICAgbmFtZTogJycsXG4gICAgICBib2R5OicnLFxuICAgICAgc3ViamVjdDonJyxcbiAgICAgIGVkaXRNb2RlOnRydWUsXG4gICAgICBuZXdUZW1wbGF0ZTogdHJ1ZVxuICAgIH0sIHRydWUpXG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAvL2NvbnNvbGUubG9nKHRoaXMucHJvcHMudGVtcGxhdGVzKVxuICAgIHRlbXBsYXRlcyA9IFtdXG4gICAgZm9yKGk9MDtpPCB0aGlzLnByb3BzLnRlbXBsYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGVtcGxhdGVzLnB1c2goXG4gICAgICAgIFRlbXBsYXRlTGlzdEl0ZW0oe1xuICAgICAgICAgIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IHRoaXMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSwgXG4gICAgICAgICAgdGVtcGxhdGU6IHRoaXMucHJvcHMudGVtcGxhdGVzW2ldfSlcbiAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIlwiLCBzdHlsZToge3BhZGRpbmc6JzAnLCBoZWlnaHQ6JzEwMCUnLHRleHRBbGlnbjonY2VudGVyJ319LCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsIHBhbmVsLWRlZmF1bHRcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtib3JkZXJSaWdodDowLGJvcmRlclJhZGl1czowLGhlaWdodDonMTAwJScsIG92ZXJmbG93OidhdXRvJ319LCBcbiAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtaGVhZGluZ1wiLCBzdHlsZToge2hlaWdodDo0MH19LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtzdHlsZToge2Zsb2F0OidsZWZ0Jyxmb250U2l6ZToxNCxmb250V2VpZ2h0Oidib2xkJ319LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHttYXJnaW5MZWZ0OjV9fSwgXCJUZW1wbGF0ZXNcIilcbiAgICAgICAgICAgICksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLXN1Y2Nlc3MgYnRuLXhzXCIsIFxuICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLmNyZWF0ZVRlbXBsYXRlLCBcbiAgICAgICAgICAgICAgICBzdHlsZToge2Zsb2F0OidyaWdodCd9fSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGx1c1wifSksIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHttYXJnaW5MZWZ0OjV9fSwgXCJDcmVhdGUgVGVtcGxhdGVcIilcbiAgICAgICAgICAgIClcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udWwoe2NsYXNzTmFtZTogXCJsaXN0LWdyb3VwXCIsIFxuICAgICAgICAgICAgICBzdHlsZToge3RleHRBbGlnbjonbGVmdCd9fSwgXG4gICAgICAgICAgICB0ZW1wbGF0ZXNcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gIH1cbn0pO1xuXG52YXIgVGVtcGxhdGVMaXN0SXRlbSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ1RlbXBsYXRlTGlzdEl0ZW0nLFxuICB0b2dnbGVUZW1wbGF0ZUVkaXRNZW51OiBmdW5jdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZyh0aGlzLnByb3BzLnRlbXBsYXRlKVxuICAgIHRlbXBsYXRlID0gdGhpcy5wcm9wcy50ZW1wbGF0ZVxuICAgIHRlbXBsYXRlLmVkaXRNb2RlID0gZmFsc2VcbiAgICB0aGlzLnByb3BzLnRvZ2dsZVRlbXBsYXRlRWRpdE1lbnUodGVtcGxhdGUpXG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdihudWxsLCBcbiAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgc3R5bGU6IHtib3JkZXJCb3R0b206ICcxcHggc29saWQgcmdiKDIyMSwgMjIxLCAyMjEpJyxwYWRkaW5nVG9wOjUscGFkZGluZ0JvdHRvbTowfSwgXG4gICAgICAgICAgIG9uQ2xpY2s6IHRoaXMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSwgXG4gICAgICAgICAgIGNsYXNzTmFtZTogXCJsaXN0LWdyb3VwLWl0ZW1cIn0sIFxuICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcImxhYmVsIGxhYmVsLWRlZmF1bHRcIn0sIFxuICAgICAgICAgICAgIHRoaXMucHJvcHMudGVtcGxhdGUubmFtZVxuICAgICAgICAgICApLCBcbiAgICAgICAgICAgUmVhY3QuRE9NLmg2KG51bGwsIFwiU3ViamVjdDpcIiwgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJ0ZXh0IHRleHQtbXV0ZWRcIn0sIFxuICAgICAgICAgICAgIFwiIFwiICsgdGhpcy5wcm9wcy50ZW1wbGF0ZS5zdWJqZWN0XG4gICAgICAgICAgICkpXG4gICAgICAgICApXG4gICAgICApXG4gICAgKTtcbiAgfVxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy8gVGltZWxpbmVEYXlFbGVtZW50XG4gIC8vIFRPRE9cbiAgLy8gLSBhZGQgcHJvc3BlY3QgbGlzdCBwcm9ncmVzc2lvblxuICAvLyAtIGFkZCBzY2hlZHVsZWQgZm9sbG93dXBcbiAgLy9cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICAvLyBcbiAgICByZXR1cm4ge1xuICAgICAgZm9sbG93dXBDb21wbGV0ZWQ6IDAsXG4gICAgfVxuICB9LFxuXG4gIGFkZEZvbGxvd3VwOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnByb3BzLmFkZEZvbGxvd3VwKHRoaXMucHJvcHMuZGF5Q291bnQpXG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBpZih0aGlzLnByb3BzLmFkZFRlbXBsYXRlTW9kZSkge1xuICAgICAgbW9kZSA9IEVkaXRUZW1wbGF0ZSh7YWRkRm9sbG93dXA6IHRoaXMucHJvcHMuYWRkRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUZvbGxvd3VwOiB0aGlzLnByb3BzLnNhdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVGb2xsb3d1cDogdGhpcy5wcm9wcy5yZW1vdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlDb3VudDogdGhpcy5wcm9wcy5kYXlDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXM6IHRoaXMucHJvcHMudGVtcGxhdGVzfSlcbiAgICB9IGVsc2Uge1xuICAgICAgbW9kZSA9IFRlbXBsYXRlRm9sbG93dXAoe2N1cnJlbnRUZW1wbGF0ZTogdGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRGb2xsb3d1cDogdGhpcy5wcm9wcy5lZGl0Rm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNvdW50OiB0aGlzLnByb3BzLmRheUNvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QmF0Y2g6IHRoaXMucHJvcHMuY3VycmVudEJhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNCYXRjaDogdHlwZW9mKHRoaXMucHJvcHMuYmF0Y2hDb3VudCkgIT0gXCJ1bmRlZmluZWRcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudEJhdGNoOiB0aGlzLnByb3BzLnNldEN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5Q291bnQ6IHRoaXMucHJvcHMuZGF5Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZvbGxvd3VwOiB0aGlzLnByb3BzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRDdXJyZW50VGVtcGxhdGU6IHRoaXMucHJvcHMuc2V0Q3VycmVudFRlbXBsYXRlfSlcbiAgICB9XG4gICAgaWYodGhpcy5wcm9wcy5hbHJlYWR5U2VudCkge1xuICAgICAgbW9kZSA9IEZvbGxvd3VwQ29tcGxldGVkKHtjdXJyZW50VGVtcGxhdGU6IHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlfSlcbiAgICB9XG5cbiAgICBtb2RlID0gKHRoaXMucHJvcHMuZWxlbWVudFR5cGUpID8gXCJcIiA6IG1vZGVcbiAgICBhZGRGb2xsb3d1cCA9ICh0aGlzLnByb3BzLmVsZW1lbnRUeXBlKSA/IHRoaXMuYWRkRm9sbG93dXAgOiBcIlwiXG4gICAgaWYodHlwZW9mKHRoaXMucHJvcHMuYmF0Y2hDb3VudCkgIT0gXCJ1bmRlZmluZWRcIilcbiAgICAgIGJhdGNoU3RhZ2UgPSBCYXRjaFN0YWdlKHtjdXJyZW50QmF0Y2g6IHRoaXMucHJvcHMuY3VycmVudEJhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdQcm9zcGVjdHM6IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9zcGVjdExpc3RDb3VudDogdGhpcy5wcm9wcy5wcm9zcGVjdExpc3RDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hDb3VudDogdGhpcy5wcm9wcy5iYXRjaENvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNTY2hlZHVsZWRFbWFpbDogbW9kZSAhPSBcIlwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlDb3VudDogdGhpcy5wcm9wcy5kYXlDb3VudH0pXG4gICAgZWxzZVxuICAgICAgYmF0Y2hTdGFnZSA9IFwiXCJcblxuICAgIGRheUNvdW50ID0gKHRoaXMucHJvcHMuZGF5Q291bnQgIT0gMC41KSA/IFwiRFwiK3RoaXMucHJvcHMuZGF5Q291bnQgOiBcIlwiXG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdihudWxsLCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7b25DbGljazogYWRkRm9sbG93dXAsIGNsYXNzTmFtZTogXCJkYXlcIiwgJ2RhdGEtdHJpZ2dlcic6IFwibWFudWFsXCJ9LCBcbiAgICAgICAgICBkYXlDb3VudFxuICAgICAgICApLCBcbiAgICAgICAgbW9kZSwgYmF0Y2hTdGFnZVxuICAgICAgKVxuICAgIClcbiAgfSxcblxuICBzZXRDdXJyZW50VGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlKSB7XG4gICAgdGhpcy5wcm9wcy5zZXRDdXJyZW50VGVtcGxhdGUodGVtcGxhdGUpXG4gIH1cbn0pO1xuXG52YXIgRm9sbG93dXBDb21wbGV0ZWQgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdGb2xsb3d1cENvbXBsZXRlZCcsXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJmb2xsb3d1cC1wbGFjZW1lbnQgYXJyb3dfYm94XzEgdG1wXzJcIn0sIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7d2lkdGg6MTMwLGRpc3BsYXk6J2lubGluZS1ibG9jayd9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFwiwqDCoFwiLCBcbiAgICAgICAgICAodGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUpID8gdGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUubmFtZSA6IFwiXCJcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe2NsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tc3VjY2VzcyBidG4teHMgZGlzYWJsZWRcIiwgXG4gICAgICAgICAgICAgICAgJ2RhdGEtdGFyZ2V0JzogXCIuYnMtc2VuZEVtYWlsLW1vZGFsLWxnXCIsIFxuICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuc2V0Q3VycmVudFRlbXBsYXRlLCBcbiAgICAgICAgICAgICAgICAnZGF0YS10b2dnbGUnOiBcIm1vZGFsXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWNoZWNrXCJ9KSwgXCLCoFNlbnRcIiksIFwiwqBcIiwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMuZWRpdEZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGRpc2FibGVkXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBlbmNpbFwifSkpLCBcIsKgXCIsIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGRpc2FibGVkXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pKVxuICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gIH1cbn0pXG5cbnZhciBUZW1wbGF0ZUZvbGxvd3VwID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnVGVtcGxhdGVGb2xsb3d1cCcsXG4gIC8vIEVkaXRNb2RlIEZhbHNlXG5cbiAgc2V0Q3VycmVudFRlbXBsYXRlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnByb3BzLnNldEN1cnJlbnRUZW1wbGF0ZSh0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZSlcbiAgICAvLyBzZXRDdXJyZW50QmF0Y2hcbiAgICB0aGlzLnByb3BzLnNldEN1cnJlbnRCYXRjaCh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaClcbiAgICAkKCcuYnMtc2VuZEVtYWlsLW1vZGFsLWxnJykubW9kYWwoKVxuICB9LFxuXG4gIHdhaXRGb3JCYXRjaDogZnVuY3Rpb24oKSB7XG4gICAgYWxlcnRpZnkubG9nKFwiWW91IG11c3Qgd2FpdCBmb3IgYSBiYXRjaCFcIik7XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB0cmFzaCA9ICh0aGlzLnByb3BzLmRheUNvdW50ID09IDApID8gIFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMucmVtb3ZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHMgZGlzYWJsZWRcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdHJhc2gtb1wifSkpIDogUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5yZW1vdmVGb2xsb3d1cCwgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS10cmFzaC1vXCJ9KSkgXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJmb2xsb3d1cC1wbGFjZW1lbnQgYXJyb3dfYm94XzEgdG1wXzJcIn0sIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7d2lkdGg6MTMwLGRpc3BsYXk6J2lubGluZS1ibG9jayd9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1maWxlLXRleHQtb1wifSksIFwiwqDCoFwiLCBcbiAgICAgICAgICAodGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUpID8gdGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUubmFtZSA6IFwiXCJcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe2NsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tc3VjY2VzcyBidG4teHNcIiwgXG4gICAgICAgIG9uQ2xpY2s6ICh0aGlzLnByb3BzLmhhc0JhdGNoKSA/IHRoaXMuc2V0Q3VycmVudFRlbXBsYXRlIDogdGhpcy53YWl0Rm9yQmF0Y2gsIFxuICAgICAgICAgICAgICAgICdkYXRhLXRvZ2dsZSc6IFwibW9kYWxcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGFwZXItcGxhbmVcIn0pLCBcIsKgU2VuZFwiKSwgXCLCoFwiLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5lZGl0Rm9sbG93dXAsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHNcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGVuY2lsXCJ9KSksIFwiwqBcIiwgXG4gICAgICAgIHRyYXNoXG4gICAgICApXG4gICAgKTtcbiAgfSxcblxuICBlZGl0Rm9sbG93dXA6IGZ1bmN0aW9uKGUpIHsgXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY29uc29sZS5sb2codGhpcy5wcm9wcy5kYXlDb3VudClcbiAgICB0aGlzLnByb3BzLmVkaXRGb2xsb3d1cCh0aGlzLnByb3BzLmRheUNvdW50KVxuICB9LFxuXG4gIHJlbW92ZUZvbGxvd3VwOiBmdW5jdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZygncmVtb3ZlJylcbiAgICB0aGlzLnByb3BzLnJlbW92ZUZvbGxvd3VwKHRoaXMucHJvcHMuZGF5Q291bnQpXG4gIH1cbn0pO1xuXG52YXIgQmF0Y2hTdGFnZSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ0JhdGNoU3RhZ2UnLFxuICAvLyBEaWZmZXJlbnQgU3RhZ2VzIG9mIFBlb3BsZSBBZGRlZCB0byBQcm9zcGVjdCBMaXN0XG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgLy8gXG4gICAgcmV0dXJuIHtcbiAgICAgIGluaXRpYWxCYXRjaENvdW50OiB0aGlzLnByb3BzLmJhdGNoQ291bnRcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIC8vIHN0YXRlXG4gICAgLy9jb25zb2xlLmRlYnVnKCdJTlNJREUgQkFUQ0ggJyt0aGlzLnByb3BzLmRheUNvdW50KVxuICAgIGNvbnNvbGUuZGVidWcodGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gpXG4gICAgX2JhdGNoZXMgPSBhcHBDb25maWcucG9pbnRlcignUHJvc3BlY3RCYXRjaCcsIHRoaXMucHJvcHMuY3VycmVudEJhdGNoKVxuICAgIGlmKHRoaXMucHJvcHMuYmF0Y2hDb3VudCA9PSBcIn5cIikge1xuICAgICAgLy8gV2h5IGRvZXNudCB0aGlzIHdvcmsgXG4gICAgICB2YXIgdGhpc3NzcyA9IHRoaXM7XG4gICAgICBjb25zb2xlLmRlYnVnKCdJTlNJREUgQkFUQ0ggJyt0aGlzcy5wcm9wcy5kYXlDb3VudClcbiAgICAgIGNvbnNvbGUuZGVidWcoX2JhdGNoZXMpXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvUHJvc3BlY3QnLFxuICAgICAgICBiYXRjaGVzOiBfYmF0Y2hlcyxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHdoZXJlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBiYXRjaGVzOiBfYmF0Y2hlc1xuICAgICAgICAgIH0pLFxuICAgICAgICAgIGNvdW50OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7IFxuICAgICAgICAgIC8vY29uc29sZS5kZWJ1ZygnU1VDQ0VTUyBHRVQgQ09VTlQgJyArIHJlcy5jb3VudClcbiAgICAgICAgICAvL2NvbnNvbGUuZGVidWcocmVzLnJlc3VsdHMpIFxuICAgICAgICAgIHRoaXNzc3Muc2V0U3RhdGUoe2luaXRpYWxCYXRjaENvdW50OiByZXMuY291bnR9KVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7IFxuICAgICAgICAgIHRoaXNzc3Muc2V0U3RhdGUoe2luaXRpYWxCYXRjaENvdW50OiAwIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uKG5leHRQcm9wcykge1xuICAgIGlmKHRoaXMucHJvcHMuZGF5Q291bnQgPT0gMClcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBpbml0aWFsQmF0Y2hDb3VudDogbmV4dFByb3BzLmJhdGNoQ291bnQgfSlcbiAgfSxcblxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgaWYodGhpcy5wcm9wcy5oYXNTY2hlZHVsZWRFbWFpbClcbiAgICAgIGJhdGNoU3RhZ2VTdHlsZSA9IHt0b3A6LTQyLCBsZWZ0OjZ9XG4gICAgZWxzZVxuICAgICAgYmF0Y2hTdGFnZVN0eWxlID0ge31cblxuICAgIGlmKHRoaXMucHJvcHMuZGF5Q291bnQgPT0gMC41KVxuICAgICAgYmF0Y2hTdGFnZVN0eWxlLmxlZnQgPSA3XG5cbiAgICAvL2NvbnNvbGUubG9nKCdCQVRDSCBTVEFHRScpXG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLnByb3BzKVxuICAgIC8vY29uc29sZS5kZWJ1Zyh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJmb2xsb3d1cC1wbGFjZW1lbnQgYXJyb3dfYm94IHRtcFwiLCBzdHlsZTogYmF0Y2hTdGFnZVN0eWxlfSwgXG4gICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwibGFiZWwgbGFiZWwtcHJpbWFyeVwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS11c2VyXCJ9KSwgXCLCoFwiLCBcbiAgICAgICAgICB0aGlzLnN0YXRlLmluaXRpYWxCYXRjaENvdW50XG4gICAgICAgICksIFwiwqBcIiwgXG4gICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snfX0sIFxuICAgICAgICAgIFwicHJvc3BlY3RzIGluIHRoZSBzYWxlcyBjeWNsZS5cIilcbiAgICAgIClcbiAgICApO1xuICB9XG59KTtcblxudmFyIEVkaXRUZW1wbGF0ZSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ0VkaXRUZW1wbGF0ZScsXG4gIC8vIEVkaXQgTW9kZSAtIFRydWVcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBvcHRpb25zID0gW11cbiAgICBmb3IoaT0wO2k8IHRoaXMucHJvcHMudGVtcGxhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBvcHRpb25zLnB1c2goIFJlYWN0LkRPTS5vcHRpb24obnVsbCwgdGhpcy5wcm9wcy50ZW1wbGF0ZXNbaV0ubmFtZSkpXG4gICAgfVxuICAgIHRyYXNoID0gKHRoaXMucHJvcHMuZGF5Q291bnQgPT0gMCkgPyAgUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5yZW1vdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBkaXNhYmxlZFwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS10cmFzaC1vXCJ9KSkgOiBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLnJlbW92ZUZvbGxvd3VwLCBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzXCJ9LCBcIiBcIiwgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS10cmFzaC1vXCJ9KSkgXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJmb2xsb3d1cC1wbGFjZW1lbnQgYXJyb3dfYm94XzEgdG1wXzJcIn0sIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7d2lkdGg6NTUsZGlzcGxheTonaW5saW5lLWJsb2NrJ30sIFxuICAgICAgICAgICAgY2xhc3NOYW1lOiBcInRleHQtbXV0ZWRcIn0sIFxuICAgICAgICAgIFwiQ2hvb3NlIDpcIlxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLnNlbGVjdCh7Y2xhc3NOYW1lOiBcImZvcm0tY29udHJvbCBpbnB1dC1zbVwiLCBcbiAgICAgICAgICAgICAgICBpZDogXCJjaG9vc2VUZW1wbGF0ZUZvckZvbGxvd3VwXCIsIFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyx3aWR0aDoxMjcsbWFyZ2luUmlnaHQ6NX19LCBcbiAgICAgICAgICBvcHRpb25zXG4gICAgICAgICksIFxuXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe2NsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tc3VjY2VzcyBidG4teHNcIiwgXG4gICAgICAgICAgICAgICAgb25DbGljazogdGhpcy5zYXZlRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7bWFyZ2luUmlnaHQ6NX19LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWNoZWNrXCJ9KSksIFxuICAgICAgICB0cmFzaFxuICAgICAgKVxuICAgIClcbiAgfSxcblxuICBzYXZlRm9sbG93dXA6IGZ1bmN0aW9uKGUpIHtcbiAgICAvL2dldCB0ZW1wbGF0ZSBmcm9tIGN1cnJlbnRUZW1wbGF0ZVxuICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgIGNob3NlblRlbXBsYXRlID0gJCgnI2Nob29zZVRlbXBsYXRlRm9yRm9sbG93dXAnKS52YWwoKVxuICAgIGNvbnNvbGUubG9nKGNob3NlblRlbXBsYXRlKVxuICAgIGZvcihpPTA7aTwgdGhpcy5wcm9wcy50ZW1wbGF0ZXMubGVuZ3RoOyBpKyspe1xuICAgICAgaWYodGhpcy5wcm9wcy50ZW1wbGF0ZXNbaV0ubmFtZSA9PSBjaG9zZW5UZW1wbGF0ZSl7XG4gICAgICAgIGNob3NlblRlbXBsYXRlID0gdGhpcy5wcm9wcy50ZW1wbGF0ZXNbaV1cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc29sZS5sb2coY2hvc2VuVGVtcGxhdGUpXG4gICAgXG4gICAgdGhpcy5wcm9wcy5zYXZlRm9sbG93dXAodGhpcy5wcm9wcy5kYXlDb3VudCwgY2hvc2VuVGVtcGxhdGUpXG4gIH0sXG5cbiAgcmVtb3ZlRm9sbG93dXA6IGZ1bmN0aW9uKGRheSkge1xuICAgIHRoaXMucHJvcHMucmVtb3ZlRm9sbG93dXAodGhpcy5wcm9wcy5kYXlDb3VudClcbiAgfSxcbn0pO1xuXG4iXX0=
