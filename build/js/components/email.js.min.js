(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      activities: []
    }
  },

  componentDidMount: function() {
    var thiss = this;
    $.ajax({
      url: 'https://api.parse.com/1/classes/EmailEvent',
      data: {include: 'prospect,sent_email', order:'-createdAt', limit:1000},
      headers: appConfig.headers,
      success: function(res) { 
        console.log(res.results)
        thiss.setState({activities: res.results}) 
      },
      error: function() {}
    })
  },

  render: function() {
    activities = _.map(this.state.activities, function(activity) {
      return EmailActivities({activity: activity})
    })

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Sent "), 
            React.DOM.th(null, "Prospect "), 
            React.DOM.th(null, "Email "), 
            React.DOM.th(null, "Events "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons"), 
            React.DOM.th(null, "Social")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Event = React.createClass({displayName: 'Event',
  render: function() {
    event = this.props.event
    if(event == "delivered"){
      iconType = "fa fa-paper-plane"; eventName = "Delivered";
    }else if(event == "failed") {
      iconType = "fa fa-exclamation-circle"; eventName="Failed"
    }else if(event == "opened"){
      iconType = "fa fa-eye"; eventName="Opened"
    }else if(event == "replied"){
      iconType = "fa fa-mail-reply";  eventName = "Replied"
    }else if(event == "visited"){
      iconType = "fa fa-home";  eventName="Visited"
    }

    return (
      React.DOM.ul({className: "list-group email-events", style: {marginBottom:0}}, 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {paddingTop:16, height:49,textAlign:'center'}}, 
          React.DOM.i({className: iconType}), " ", React.DOM.span({style: {fontWeight:'bold'}}, eventName), " "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-home"}), " ", React.DOM.span({style: {fontWeight:'bold'}}, "Visited"), " ", 
          React.DOM.a({href: "javascript:"}, "customerohq.com/resources"), "  "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-external-link-square"}), " ", 
          React.DOM.span(null, "2:19 pm"), " ", 
          React.DOM.span({style: {fontWeight:'bold'}}, "clicked "), 
          React.DOM.a({href: "javascript:"}, "customerohq.com")
        )
      )
    )
  }
})

var EmailActivities = React.createClass({displayName: 'EmailActivities',
  render: function() {
    activity = this.props.activity
    prospect = (activity.prospect) ? activity.prospect : {}
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " ", 
              moment(activity.createdAt).fromNow()
            )
          ), 
          React.DOM.td(null, React.DOM.h6(null, prospect.name)), 
          React.DOM.td(null, React.DOM.h6(null, activity.sent_email.subject)), 
          React.DOM.td({style: {padding:0, fontSize:12}}, 
            Event({event: activity.event_type})
          ), 
          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.div({style: {display:'none'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Email"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, React.DOM.i({className: "fa fa-cloud-upload"}), " CRM"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Call")
          )
          ), 
          React.DOM.td(null, 
            "lol"
          )
      )
    )
  }
})

},{}]},{},[1])


},{}],2:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      activities: []
    }
  },

  componentDidMount: function() {
    var thiss = this;
    $.ajax({
      url: 'https://api.parse.com/1/classes/EmailEvent',
      data: {include: 'prospect,sent_email', order:'-createdAt', limit:1000},
      headers: appConfig.headers,
      success: function(res) { 
        console.log(res.results)
        thiss.setState({activities: res.results}) 
      },
      error: function() {}
    })
  },

  render: function() {
    activities = _.map(this.state.activities, function(activity) {
      return EmailActivities({activity: activity})
    })

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Sent "), 
            React.DOM.th(null, "Prospect "), 
            React.DOM.th(null, "Email "), 
            React.DOM.th(null, "Events "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons"), 
            React.DOM.th(null, "Social")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Event = React.createClass({displayName: 'Event',
  render: function() {
    event = this.props.event
    if(event == "delivered"){
      iconType = "fa fa-paper-plane"; eventName = "Delivered";
    }else if(event == "failed") {
      iconType = "fa fa-exclamation-circle"; eventName="Failed"
    }else if(event == "opened"){
      iconType = "fa fa-eye"; eventName="Opened"
    }else if(event == "replied"){
      iconType = "fa fa-mail-reply";  eventName = "Replied"
    }else if(event == "visited"){
      iconType = "fa fa-home";  eventName="Visited"
    }

    return (
      React.DOM.ul({className: "list-group email-events", style: {marginBottom:0}}, 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {paddingTop:16, height:49,textAlign:'center'}}, 
          React.DOM.i({className: iconType}), " ", React.DOM.span({style: {fontWeight:'bold'}}, eventName), " "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-home"}), " ", React.DOM.span({style: {fontWeight:'bold'}}, "Visited"), " ", 
          React.DOM.a({href: "javascript:"}, "customerohq.com/resources"), "  "
        ), 
        React.DOM.li({className: "list-group-item list-group-item-info", style: {display:'none'}}, 
          React.DOM.i({className: "fa fa-external-link-square"}), " ", 
          React.DOM.span(null, "2:19 pm"), " ", 
          React.DOM.span({style: {fontWeight:'bold'}}, "clicked "), 
          React.DOM.a({href: "javascript:"}, "customerohq.com")
        )
      )
    )
  }
})

var EmailActivities = React.createClass({displayName: 'EmailActivities',
  render: function() {
    activity = this.props.activity
    prospect = (activity.prospect) ? activity.prospect : {}
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " ", 
              moment(activity.createdAt).fromNow()
            )
          ), 
          React.DOM.td(null, React.DOM.h6(null, prospect.name)), 
          React.DOM.td(null, React.DOM.h6(null, activity.sent_email.subject)), 
          React.DOM.td({style: {padding:0, fontSize:12}}, 
            Event({event: activity.event_type})
          ), 
          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.div({style: {display:'none'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Email"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, React.DOM.i({className: "fa fa-cloud-upload"}), " CRM"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:70,fontWeight:'bold',marginBottom:2}}, "Call")
          )
          ), 
          React.DOM.td(null, 
            "lol"
          )
      )
    )
  }
})

},{}]},{},[1])


},{}],2:[function(require,module,exports){
/** @jsx React.DOM */
var TemplatesMenu = require('./templates_menu.js.min.js');
var EditTemplateView = require('./edit_template.js.min.js');
var CreateTemplateView = require('./create_template.js.min.js');
var Timeline = require('./followup_timeline.js.min.js');
var CampaignActivityView = require('./campaign_activity_view.js.min.js')
var CampaignFollowupFeed = require('./campaign_followup_feed.js.min.js')
var CampaignSentEmail = require('./campaign_sent_email.js.min.js')
var CampaignReport = require('./campaign_report.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // Campaign Detail
  getInitialState: function() {
    return {
      selectedTemplate: 0,
      templateDetailMode: false,
      editMode: false,
      followupDay: 0,
      templates:[],
      currentTemplate:'',
      prospectListCount:'~',
      prospects:[],
      currentScreen: 'timeline',
      newProspects: [],
      bounced: '~',
      delivered: '~',
      opened: '~',
    }
  },

  changeScreen: function(e) {
    this.setState({currentScreen: $(e.target).text().toLowerCase()})
  },

  componentDidMount: function() {
    thissss = this;
    company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
    qry = 'where={"company":'+company+'}'



    $.ajax({
      url:'https://api.parse.com/1/classes/Template',
      headers: appConfig.headers,
      data: qry,
      success: function(res) { thissss.setState({templates: res.results}) },
      error: function(err) { console.log('error') }
    });

    currentList = JSON.stringify({
      '__type'    : 'Pointer', 
      'className' : 'ProspectList',
      'objectId'  : this.props.selectedCampaign.prospect_list.objectId, 
    })

    qry = 'where={"lists":'+currentList+'}&limit=1000&count=1&include=email_guesses,email_guesses.pattern'
    $.ajax({
      url: 'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      data: qry,
      success: function (res) {
        // TODO - why is this being done
        console.log('RESULTS')
        console.log(res)
        console.log(res.results)
        thissss.setState({
          prospects: res.results,
          prospectListCount: res.count 
        })

        if(res.count > 1000){
          for(i=0;i< Math.ceil(res.count/1000); i++) {
            qry = 'where={"lists":'+currentList+'}&limit=1000&count=1'
            $.ajax({
              url: 'https://api.parse.com/1/classes/Prospect',
              headers: appConfig.headers,
              data: qry,
              success: function (res) {
                prospects = thissss.state.prospects
                thissss.setState({prospects:  prospects.concat(res.results)})
              },
              error: function(err) {}
            })
          }
        }
      },
      error: function(err) { }
    })

    var thiss = this;
    selectedCampaign = this.props.selectedCampaign
    console.debug(this.props.selectedCampaign)
    console.debug('Selected Campaign Batches')
    console.debug(this.props.selectedCampaign.batches)
    batches = this.props.selectedCampaign.batches
    if(_.isEqual(batches, [])){ 
      batch_query = { $in: [false, null] }
    } else {
      qry = _.map(batches, function(batch) {
        return appConfig.pointer('ProspectBatch', batch.objectId)
      })
      batch_query = { $nin: qry }
    }
    prospect_list = thiss.props.selectedCampaign.prospect_list.objectId
    // TODO - add support for more than 1000
    $.ajax({
      url:'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      selectedCampaign: thiss.props.selectedCampaign,
      data: {
        where: JSON.stringify({
            batches: batch_query,
            lists: appConfig.pointer('ProspectList', prospect_list),
        }), limit:1000
      },
      success: function(res) { thiss.setState({newProspects: res.results}) },
      error: function(err) { console.debug(err.responseText) }
    })
    campaignId = thiss.props.selectedCampaign.objectId
    qry = {
      where: JSON.stringify({campaign: appConfig.pointer('Campaign', campaignId)}),
      limit: 1000,
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({delivered: res.count})},
      error: function(err) { console.log(err.responseText) }
    })
    qry_1 = {
      where: JSON.stringify({
        campaign: appConfig.pointer('Campaign', campaignId),
        opened: {"$gte": 0} 
      }),
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry_1,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({opened : res.count}) },
      error: function(err) { console.log(err.responseText) }
    })
    qry_2 = {
      where: JSON.stringify({
        campaign: appConfig.pointer('Campaign', campaignId),
        failed: {"$gte": 0} 
      }),
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry_2,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({bounced : res.count}) },
      error: function(err) { console.log(err.responseText) }
    })
  },

  returnToOverview: function() {
    this.props.toggleScreen('Campaigns')
  },

  render: function() {
    //console.log('campaign detail')
    console.log(this.state.currentScreen)
    console.log(this.state.currentScreen.indexOf("sent email"))
    tab_1 = "campaign-tab-link"
    tab_2 = "campaign-tab-link"
    tab_3 = "campaign-tab-link"
    tab_4 = "campaign-tab-link"
    tab_5 = "campaign-tab-link"
    if(this.state.currentScreen == "timeline"){
      //console.debug('SELECTED CAMPAIGN')
      //console.debug(this.props.selectedCampaign)
      lolscreen = FollowupTimeline({
                  templates: this.state.templates, 
                  prospects: this.state.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.state.prospectListCount, 
                  newProspects: this.state.newProspects, 
                  toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
                  initialFollowups: this.props.selectedCampaign.followups})
      tab_1 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "recent activity") {
      lolscreen = CampaignActivityView(null)
      tab_2 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "scheduled followups") {
      lolscreen = CampaignFollowupFeed({
                    batches: this.props.selectedCampaign.batches, 
                    followups: this.props.selectedCampaign.followups})
      tab_3 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "sent mail") {
      lolscreen = CampaignSentEmail({
                      selectedCampaign: this.props.selectedCampaign})
      tab_4 = "active-campaign-tab campaign tab-link"
    } else if(this.state.currentScreen == "analytics") {
      lolscreen = CampaignReport(null)
      tab_5 = "active-campaign-tab campaign tab-link"
    } else{
      console.log('LOL')
      lolscreen = FollowupTimeline({
                  templates: this.state.templates, 
                  prospects: this.state.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.state.prospectListCount, 
                  newProspects: this.state.newProspects, 
                  toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
                  templates: this.state.templates, 
                  initialFollowups: this.props.selectedCampaign.followups})
    }
    //activeTab = "active-campaign-tab campaign tab-link"
      

    //list_type = this.props.selectedCampaign.prospect_list.list_type
    list_type = ""
    if(list_type == "mining_job")
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-cloud-download"}), " ")
    else if(list_type == "signal_list")
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-wifi"}), " ")
    else
      list_type = React.DOM.span(null, React.DOM.i({className: "fa fa-list-alt"}), " ")

    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    console.log('BATCHES')
    console.log(batches)
    return (
      React.DOM.div({className: "container", 
           style: {width:'100%',height:'100%',paddingLeft:0,paddingRight:0}}, 
        React.DOM.div({style: {marginBottom:15}, id: "campaign-top-detail"}, 
        React.DOM.h5({style: {marginTop:20,marginLeft:20}}, 
          React.DOM.a({href: "javascript:", onClick: this.returnToOverview}, "Campaigns "), 
          React.DOM.small(null, 
            React.DOM.i({style: {marginLeft:10, marginRight:10}, 
               className: "fa fa-chevron-right"})
          ), 
          this.props.selectedCampaign.name
        ), 
        React.DOM.h6({style: {marginLeft:20,display:'inline-block',marginRight:15,marginBottom:0,fontWeight:'bold',fontSize:10}}, 
          React.DOM.span({className: "text-muted"}, "PROSPECT LIST:"), "  "
        ), 
          React.DOM.span({className: "label label-success"}, 
          list_type, 
          this.props.selectedCampaign.prospect_list.name, 
          "     ", 
        React.DOM.i({className: "fa fa-user"}), " ", this.state.prospectListCount
        ), 
        React.DOM.br(null), 
        React.DOM.h6({style: {marginLeft:20,display:'inline-block',marginRight:50,marginTop:0,fontWeight:'bold',fontSize:10}, 
            className: "text-muted"}, 
          "BATCHES:"
        ), 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-sitemap"}), " ", 
          (_.isEqual(batches, [])) ? 1 : batches.length
        ), 
        
        React.DOM.div({style: {border:'1px solid #ddd',borderRadius:5,float:'right',marginTop:-45,marginRight:100}}, 
            React.DOM.div({className: "bg-warning", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer',width:70,textAlign:'center'}}, 
              React.DOM.span({className: "text-warning"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), " ", this.state.delivered
              )
            ), 
            React.DOM.div({className: "bg-success", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer',width:70,textAlign:'center'}}, 
              React.DOM.span({className: "text-success"}, 
                React.DOM.i({className: "fa fa-eye"}), " ", this.state.opened
              )
            ), 
            React.DOM.div({className: "bg-danger", style: {display:'inline-block',padding:10,fontWeight:'bold',cursor:'pointer',width:70,textAlign:'center'}}, 
              React.DOM.span({className: "text-danger"}, 
                React.DOM.i({className: "fa fa-exclamation-circle"}), " ", this.state.bounced
              )
            )
        ), 
        
        React.DOM.a({href: "javascript:", 
           style: {float: 'right', marginTop: -35, marginRight: 30, display:'none'}, 
           className: "btn btn-success btn-sm"}, 
          React.DOM.i({className: "fa fa-envelope"}), " Send!"
        )
        
        ), 
              React.DOM.ul({className: "nav nav-tabs campaign-tabs", role: "tablist", style: {paddingRight:0}}, 
                React.DOM.li({className: "campaign-tab"}, " ", React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_1}, "TIMELINE")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_2}, "RECENT ACTIVITY")), 
                React.DOM.li({className: "campaign-tab"}, 
                  React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_3, style: {fontSize:12}}, 
                    "SCHEDULED FOLLOWUPS")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_4}, "SENT MAIL")), 
                React.DOM.li({className: "campaign-tab"}, React.DOM.a({onClick: this.changeScreen, href: "javascript:", className: tab_5}, "ANALYTICS"))
              ), 
            lolscreen, 

          (this.state.templateDetailMode) ? EditTemplateView({
            editMode: this.state.editMode, 
            initialTemplateValues: this.state.currentTemplate, 
            saveTemplate: this.saveTemplate, 
            prospect: this.state.prospects[0], 
            toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
            followupDay: this.state.followupDay}) : ""
      )
    );
  },

  saveTemplate: function(template, newTemplate) {
    templates = this.state.templates
    for(i=0;i< this.state.templates.length; i++)
      if(this.state.templates[i].name == template.name)
        break
    
    console.log(template)
    if(newTemplate){
      template.subject = template.subject
      template.name = template.name
      template.body = template.body
      templates.push(template)

      $.ajax({
        url:'https://api.parse.com/1/classes/Template',
        headers:appConfig.headers,
        type:'POST',
        data:JSON.stringify({
          name : template.name,
          subject: template.subject,
          body: template.body,
          user:{
            __type: 'Pointer',
            className:'_User',
            objectId:JSON.parse(localStorage.currentUser).objectId,
          },
          company:JSON.parse(localStorage.currentUser).company,
        }),
        success: function(res) {
          console.log(res)
        },
        error: function() {
        }
      })
    } else {
      templates[i].subject = template.subject
      templates[i].body = template.body

      $.ajax({
        url:'https://api.parse.com/1/classes/Template/'+templates[i].objectId,
        type:'PUT',
        headers:appConfig.headers,
        data:JSON.stringify({
          name : template.name,
          subject: template.subject,
          body: template.body,
        }),
        success: function(res) {
          console.log(res)
        },
        error: function() {
        }
      })
    }

    this.setState({templates: templates })

  },

  toggleTemplateEditMenu: function(currentTemplate, editMode) {
    editMode = (editMode) ? true : false
    this.setState({
      currentTemplate: currentTemplate,
      templateDetailMode: !this.state.templateDetailMode,
    })
  }
});

var FollowupTimeline = React.createClass({displayName: 'FollowupTimeline',
  render: function() {
    return (
        React.DOM.div(null, 
          React.DOM.div({className: "col-md-8 panel panel-default", 
               style: {height:436,paddingLeft:305,paddingTop:50,overflow:'auto',borderRight:0,borderRadius:0, borderTop:0}}, 
                Timeline({
                  templates: this.props.templates, 
                  prospects: this.props.prospects, 
                  selectedCampaign: this.props.selectedCampaign, 
                  prospectListCount: this.props.prospectListCount, 
                  newProspects: this.props.newProspects, 
                  toggleTemplateEditMenu: this.props.toggleTemplateEditMenu, 
                  initialFollowups: this.props.initialFollowups})
          ), 
          React.DOM.div({className: "col-md-4", 
               style: {paddingLeft:0,paddingRight:0,height:436}}, 
            TemplatesMenu({
              templates: this.props.templates, 
              toggleTemplateEditMenu: this.props.toggleTemplateEditMenu})
          )
        )

    )
  }
})

},{"./campaign_activity_view.js.min.js":1,"./campaign_followup_feed.js.min.js":3,"./campaign_report.js.min.js":4,"./campaign_sent_email.js.min.js":5,"./create_template.js.min.js":6,"./edit_template.js.min.js":7,"./followup_timeline.js.min.js":8,"./templates_menu.js.min.js":10}],3:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      followups: []
    }
  },

  componentDidMount: function() {
        // for each batch find followups remaining
        // sort followups by ascending followup day
        //
    // Batch Start Date
    // Current Batch Date
  },

  render: function() {
    var thiss = this;
    followups = _.map(this.props.batches, function(batch) {
      now = moment().startOf('day').valueOf()/1000
      batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
      return _.map(thiss.props.followups, function(followup) {
        followup.batch = batch
        if(followup.day >= batch.currentDay)
          return followup
      })
    })
    followups = _.sortBy(followups, function(followup){ return followup.day })

    console.debug(followups)

    activities = _.map(followups[0], function(followup) {
      return Followups({followup: followup, batch: followup.batch})
    })
    console.debug(activities)

    return (
      React.DOM.div({style: {overflow:'auto',height:436}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Scheduled for "), 
            React.DOM.th(null, "Outreach Stage "), 
            React.DOM.th(null, "Prospect List"), 
            React.DOM.th(null, "Template "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Followups = React.createClass({displayName: 'Followups',
  render: function() {
    // this.props.batch
    // this.props.followup
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " " + ' ' +
              "29 minutes ago"
            )
          ), 
          React.DOM.td(null, 
            "second"
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-list-alt"}), "  " + ' ' +
            "Boston VP Sales - Retail"
            )
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-file-text-o"}), "  " + ' ' +
            "Followup #2 - Provide Value ", React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Subject: Just wanted to followup on the last email "), React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Body: Just wanted to followup on the last email ")

            )
          ), 

          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Send Now"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Remind me in 1 hour"), React.DOM.br(null)
          )
      )
    )
  }
})

},{}],4:[function(require,module,exports){
/** @jsx React.DOM */

lol = 

module.exports = React.createClass({displayName: 'exports',
  // Campaign Report
  getInitialState: function() {
    return {
    }
  },

  componentDidMount: function() { 
    testData = this.testData()
    var industryChart   = dc.pieChart("#industry-chart"),
        spendHistChart  = dc.barChart("#chart-hist-spend"),
        spenderRowChart = dc.rowChart("#chart-row-spenders");

    // set crossfilter
    var ndx = crossfilter(spendData),
        yearDim  = ndx.dimension(function(d) {return +d.Year;}),
        spendDim = ndx.dimension(function(d) {return Math.floor(d.Spent/10);}),
        nameDim  = ndx.dimension(function(d) {return d.Name;}),
        spendPerYear = yearDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendPerName = nameDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendHist    = spendDim.group().reduceCount();

    industryChart
        .width(200).height(200)
        .dimension(yearDim)
        .group(spendPerYear)
        .innerRadius(50);

    //
    // Batch Analytics - Bubble Chart
    // Batch Block Charts
    // Pie Chart - Industry
    // Revenue - PC
    // Company Size - PC
    // Opens / Replies / Link Clicks / Bounces - Bar Chart
    // Titles - PC
    // Time / Date Email Sent - Line Chart
    // Date Prospected - BC
    //
  },
  
  render: function() {
    return (
      React.DOM.div(null, 
        "Report View", 
        React.DOM.div({id: "industry-chart"})
      )
    )
  },

  testData: function() { 
    return [{"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140218.58883.75040@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140219.50015.20571@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140219.50019.67418@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140220.58887.52484@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shadowzprotection.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.598Z", "createdAt": "2014-10-07T15:20:15.147Z", "city": "New Delhi Area, India\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "f44YU2Yrm7", "company_name": "M/S Golden Bricks Constructions Pvt. Ltd.", "mailgun_id": "<20141010140220.19960.3157@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "6B4MDqWqtw"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "e9sMFL1QWx"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:15.147Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "201-500 employees", "name": "Vivek Narang", "industry": "Security and Investigations", "linkedin_url": "in.linkedin.com/pub/vivek-narang/20/b67/39", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shangri-la.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.880Z", "createdAt": "2014-10-07T15:20:13.197Z", "city": "Brisbane, Australia\\u00a0", "archived": true, "loading": false, "objectId": "TSSDEZ3lUA", "company_name": "Shangri-La Hotels and Resorts", "mailgun_id": "<20141010140221.39548.29627@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "PIDGJPqraI"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "mG4U69xDcg"}], "email": "andy.mccutcheon@shangri-la.com", "prospect_created_at": "2014-10-07T15:20:13.197Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Andy McCutcheon", "industry": "Hospitality", "linkedin_url": "au.linkedin.com/pub/andy-mccutcheon/1a/665/650", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140813.19956.20454@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140813.58881.85733@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140814.19938.90169@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140814.77386.74943@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}]
  },

});

},{}],5:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Sent Mail
  getInitialState: function() {
    return {
      sentEmails: []
    }
  },

  componentDidMount: function() {
    thiss = this;
    qry = {
      include: 'campaign,prospect,prospect.email_guesses.pattern',
      order:'-createdAt',
      campaign: {
        __type: 'Pointer',
        className:'Campaign',
        objectId: this.props.selectedCampaign.objectId,
      }
    }
    $.ajax({
      url: 'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({sentEmails: res.results}) },
      error: function() {}
    })
  },

  render: function() {
    sentEmails = []
    for(i=0;i< this.state.sentEmails.length; i++) 
      sentEmails.push(SentEmailRow({sentEmail: this.state.sentEmails[i]}))

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th(null, "Template"), 
            React.DOM.th({style: {width:290}}, "Status")
          ), 
          React.DOM.tbody(null, 
            sentEmails
          )
        )
      )
    );
  }
});

var SentEmailRow = React.createClass({displayName: 'SentEmailRow',
  render: function() {
    sentEmail = this.props.sentEmail
    //console.log(sentEmail)

    email = sentEmail.email
    /*
    if(email == "no_email"){
      first = sentEmail.prospect.name.split(' ')[0]
      last = _.last(sentEmail.prospect.name.split(' '))

      pattern = _.findWhere(sentEmail.prospect.email_guesses, {'tried':false})
      data = {first: first, last: last, fi: first[0], li: last[0]}
      email = Mustache.render(pattern.pattern.pattern, data).toLowerCase()
    }
    */

    replied = "label label-default"
    opened = "label label-default"
    delivered = "label label-default"
    queued = "label label-default"

    if(sentEmail.replied) 
      replied = "label label-success"
    if(sentEmail.opened) 
      opened = "label label-success"
    if(sentEmail.delivered) 
      delivered = "label label-success"
    if(sentEmail.queued) 
      queued = "label label-success"

    return (
      React.DOM.tr(null, 
        React.DOM.td({style: {width:100}}, React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-clock"}), 
            moment(sentEmail.createdAt).fromNow())), 
        React.DOM.td({style: {width:200}}, 
          React.DOM.h6({style: {fontSize:14,fontWeight:'bold',marginBottom:0}}, 
            sentEmail.prospect.name), 
          React.DOM.h6({style: {fontStyle:'italic',marginTop:4,marginBottom:0}}, 
            sentEmail.prospect.pos.trim()), 
          React.DOM.h6({style: {marginTop:4,fontWeight:'bold'}}, 
            React.DOM.i({className: "fa fa-building"}), " ", 
            sentEmail.prospect.company_name)
        ), 
        React.DOM.td({style: {width:200}}, React.DOM.h6(null, email)), 
        React.DOM.td(null, 
          React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-file-text-o"}), " " + ' ' +
            "Template"
          )
        ), 
        React.DOM.td({style: {paddingTop:13}}, 
          React.DOM.span({className: queued}, "Queued"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: delivered}, "Delivered"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: opened}, "Opened"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: replied}, "Replied")
        )
      )
    )
  }
})

},{}],6:[function(require,module,exports){
/** @jsx react.dom */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      
    }
  },

  componentDidMount: function() {
    $('.template-body').html(this.state.templateBody)
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    console.log('EDIT MODE')
    console.log(this.state.editMode)
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      this.props.saveTemplate({
        name: this.state.name,
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
      })
      this.setState({
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
        editMode: !this.state.editMode,
      })
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+this.props.initialTemplateValues.objectId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
    }
  },

  componentDidUpdate: function() {
    /* thiss = this; */

    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.templateSubject)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.templateBody)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? react.dom.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.templateSubject

    if(this.state.editMode){
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-save"}), "   Save Template")
    } else {
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-pencil-square"}), "   Edit Template")
    }

    return (
      react.dom.div(null, 
      react.dom.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
      react.dom.div({id: "editTemplateView", 
           className: "panel panel-info", 
           style: {display:'block'}}, 
           react.dom.div({className: "panel-heading", style: {height:50}}, 
             react.dom.h6({style: {float:'left'}}, 
               react.dom.i({className: "fa fa-file-text-o"}), 
               "  " + this.props.initialTemplateValues.name
             ), 
          toggleButton
        ), 
        react.dom.div({className: "panel-body"}, 
          react.dom.div({className: "editTemplateTitle"}, 
            react.dom.span(null, "Subject: "), 
            subjectPlace
          ), 
         react.dom.br(null), 
         react.dom.div({className: "templateDetails"}, 
           react.dom.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
             "Created by Mark on Jul. 21, 2014"
           ), 
           react.dom.h6({style: {marginTop:'0'}, className: "text-muted"}, 
             "last updated 7 days ago"
           )
         ), 
        react.dom.br(null), 
        react.dom.div({className: "panel panel-default"}, 
          react.dom.div({className: "panel-body summer template-body"}
          )
        )
    )
)
)
    );
  }
});

},{}],7:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      name: this.props.initialTemplateValues.name,
      body: this.props.initialTemplateValues.body,
      subject: this.props.initialTemplateValues.subject,
      editMode: this.props.initialTemplateValues.editMode
    }
  },

  componentDidMount: function() {
    console.log('did mount')
    $('.template-body').html(this.state.body)
    if(this.state.editMode) {
      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })
    }

    renderjson.set_show_to_level('all')
    prospect = _.pick(this.props.prospect, 
      'company_name', 'name', 'pos'
    )
    prospect.first_name = prospect.name.split(' ')[0]
    prospect.last_name = _.last(prospect.name.split(' '))
    prospect = _.omit(prospect, 'name')

    document.getElementById("editTemplate").appendChild(renderjson(prospect));
    $('#editTemplateOverlay').html()
    thiss = this;
    $('.renderjson').click(function() {
      thiss.props.toggleTemplateEditMenu()
    })

    $('.renderjson').css({
      'position': 'absolute',
      'z-index': '1000000000',
      'background-color':'rgba(0,0,0,0)',
      'border':'0',
      'color':'white',
      'margin-top':'0px',
      'height': '542px',
      'overflow':'auto',
      'width':'380px'
    })

    $('.key').css({
      'cursor':'pointer'
    })

    $('.timeline').css({
      '-webkit-filter': 'blur(10px)',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': 'blur(10px)',
    })
  },
  componentWillUnmount:function() {
    $('.timeline').css({
      '-webkit-filter': '',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': '',
    })
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })

      console.log('look at this')
      console.log(name)
      name = (this.props.initialTemplateValues.newTemplate) ? $('#template-name').val() : this.state.name
      this.props.saveTemplate({
        name: name,
        body: $('.summer').code(),
        subject: $('.subject').val(),
      }, this.props.initialTemplateValues.newTemplate)

      this.setState({
        name: $('#template-name').val(),
        body: $('.summer').code(),
        subject: $('.subject').val(),
        editMode: !this.state.editMode,
      })

      objId = this.props.initialTemplateValues.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+objId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),
                             subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })
    }
  },

  componentWillUpdate: function(newProps) {
    console.log('THE NEW PROPS')
    console.log(newProps)
  },

  componentDidUpdate: function() {
    /* thiss = this; */
    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.subject)
      $('#template-name').val(this.state.name)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.body)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? React.DOM.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.subject

    if(this.state.editMode){
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-save"}), "   Save Template")

       if(this.props.initialTemplateValues.newTemplate){
         the_name = React.DOM.input({className: "form-control", 
                           id: "template-name", 
                           style: {float:'left',width:200}})
       }
    } else {
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")

       the_name = React.DOM.h6({style: {float:'left'}}, 
                   React.DOM.i({className: "fa fa-file-text-o"}), " ", 
                   this.state.name
                  )
    }

    return (
      React.DOM.div({id: "editTemplate"}, 
        React.DOM.h5({className: "example-template-title"}, "Example Template Values"), 
        React.DOM.div({className: "example-template-title", 
             style: {marginLeft:215, marginTop:8}}, 
          React.DOM.a({href: "javascript:", 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-left"})), 
          React.DOM.a({href: "javascript:", 
            style: {marginLeft:5}, 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-right"}))
        ), 
        React.DOM.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
          React.DOM.div({id: "editTemplateView", 
               className: "panel panel-default", 
               style: {display:'block'}}, 
               React.DOM.div({className: "panel-heading", style: {height:50}}, 
                 the_name, 
              React.DOM.a({href: "javascript:", 
                className: "btn btn-default btn-xs", 
                style: {float:'right',marginLeft:5,marginTop:5}}, 
                React.DOM.i({className: "fa fa-trash"})
              ), 
              toggleButton
            ), 
            React.DOM.div({className: "panel-body"}, 
              React.DOM.div({className: "editTemplateTitle"}, 
                React.DOM.span(null, "Subject: "), 
                subjectPlace
              ), 
             React.DOM.br(null), 
             React.DOM.div({className: "templateDetails"}, 
               React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
                 "Created by Mark on Jul. 21, 2014"
               ), 
               React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, 
                 "last updated 7 days ago"
               )
             ), 
            React.DOM.br(null), 
            React.DOM.div({className: "panel panel-default"}, 
              React.DOM.div({className: "panel-body summer template-body"}
              )
            )
        )
      )
    )
    );
  }
});

},{}],8:[function(require,module,exports){
/** @jsx React.DOM */
var SendEmailModal = require('./send_email_modal.js.min.js')
var TimelineDayElement = require('./timeline_day_element.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // FollowupTimeline
  getInitialState: function() {
    initialFollowups = this.props.initialFollowups
    initialFollowups = (initialFollowups) ? initialFollowups : []
    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    return {
      followups: _.compact(initialFollowups),
      loading: false,
      currentTemplate:'',
      currentBatch: '',
      batches : batches
    }
  },

  componentDidMount: function() {
    thiss = this;
    $('.day').tooltip({
      placement: 'right',
      title:'+ Add a follow-up'
    })

    console.log(this.props.selectedCampaign)
     company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
     currentCampaign = appConfig.pointer('Campaign', this.props.selectedCampaign.objectId)
     $.ajax({
       url:'https://api.parse.com/1/classes/Followup',
       type:'GET',
       headers: appConfig.headers,
       data: {
         where: JSON.stringify({
           campaign: currentCampaign,
           company: appConfig.company
         }),
         include:'template',
       },
       success: function(res) {
         console.log('followup timeline')
         console.log(res.results)
       },
       error: function(err) {
         console.log('error')
         console.log(err)
       }
     })
  },

  addFollowupSentToBatch: function(batch, followup) {
    batches = _.map(this.state.batches, function(_batch) {
                  if(_batch.objectId == batch.objectId) {
                    if(_batch.followups)
                      _batch.followups.push(followup)
                    else
                      _batch.followups = [followup]
                  }
                  return _batch
              })
    // Persist
  },
  
  render: function() {
    timelineElements = []
    followups = this.state.followups

    batches = _.map(this.state.batches, function(batch) {
      if(batch){
        now = moment().startOf('day').valueOf()
        batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
        return batch
      }
    })
    batches = _.compact(batches)

    for(i=0;i< 31;i++){
      followup = _.findWhere(this.state.followups, {day: i})
      var elementType = (followup) ? true : false
      var currentTemplate = (followup) ? followup.template : false
      var addTemplateMode = (followup) ? followup.addTemplateMode : true
      campaign = this.props.selectedCampaign

      currentBatch = {}
      batch_started_today = false
      alreadySent = false
      batchCount = undefined
      if(i == 0) {
        batchCount = (batches) ? this.props.newProspects.length : this.props.prospects.length
      } else {
        batch = _.findWhere(batches, {currentDay: i})
        if(batch) {
          currentBatch = batch.objectId
          console.debug(batch.objectId)
          batchCount = "~"
          if(followup) {
            _batches = followup.batches
            alreadySent = _.findWhere(_batches, _.pick(batch,'objectId'))
          }
        }
      }

      timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                    dayCount: i, 
                                    elementType: !elementType, 
                                    currentTemplate: currentTemplate, 
                                    batchCount: batchCount, 
                                    currentBatch: currentBatch, 
                                    alreadySent: alreadySent, 
                                    addTemplateMode: addTemplateMode, 
                                    templates: this.props.templates, 
                                    newProspects: this.props.newProspects, 
                                    addFollowup: this.addFollowup, 
                                    editFollowup: this.editFollowup, 
                                    saveFollowup: this.saveFollowup, 
                                    removeFollowup: this.removeFollowup, 
                                 addFollowupSentToBatch: this.addFollowupSentToBatch, 
                                    batches: this.props.selectedCampaign.batches, 
                                    prospectListCount: this.props.prospectListCount, 
                                    setCurrentBatch: this.setCurrentBatch, 
                                    setCurrentTemplate: this.setCurrentTemplate})
                                  ))

      if(i == 0 && _.findWhere(batches, {currentDay: 0})){
          currentBatch = _.findWhere(batches, {currentDay: 0}).objectId
          console.debug('0.5')
          console.debug(currentBatch)
          batchCount = "~"
          timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                  dayCount: 0.5, 
                                  batchCount: batchCount, 
                                  currentBatch: currentBatch, 
                                  newProspects: this.props.newProspects, 
                                  elementType: true, 
                                  batches: this.props.selectedCampaign.batches, 
                                  prospectListCount: this.props.prospectListCount, 
                                  setCurrentBatch: this.setCurrentBatch})
                                ))
      }
    }
    return (
      React.DOM.div(null, 
        React.DOM.div({className: "timeline", 
             style: {height:'100%',backgroundColor:'rgb(90, 107, 119)', width:5,marginTop:-35}}, 
             timelineElements
        ), 
        SendEmailModal({prospects: this.props.prospects, 
                        selectedCampaign: this.props.selectedCampaign, 
                        newProspects: this.props.newProspects, 
                        addFollowupSentToBatch: this.addFollowupSentToBatch, 
                        currentBatch: this.state.currentBatch, 
                        currentTemplate: this.state.currentTemplate})
      )
    );
  },

  createFollowup: function() {
    //
  },         

  addFollowup: function(day) {
    //console.log('called template edit menu')
    followups = this.state.followups
    followups.push({addTemplateMode: true, day: day})
    this.setState({ followups: followups })
  },

  editFollowup: function(day) {
    // find template set editmode is false
    followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){ followup.addTemplateMode = true }
      return followup
    })
    this.setState({followups: followups})
  },

  saveFollowup: function(day, chosenTemplate) {
    new_followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){
        followup.addTemplateMode = false
        followup.template = chosenTemplate
      }
      return followup
    })
    this.setState({followups: new_followups})
    followup = _.findWhere(new_followups, {day: day})

      if(followup.objectId){
        url = "/"+followup.objectId; type="PUT"
        data = {template: appConfig.pointer('Template', chosenTemplate.objectId)}
      } else {
        url = ""; type="POST";

          data = {
            day: day,
            campaign : appConfig.pointer('Campaign', 
                                         this.props.selectedCampaign.objectId),
            template: appConfig.pointer('Template', chosenTemplate.objectId),
          }
      }

    thiss = this;
    $.ajax({
      url:'https://api.parse.com/1/classes/Followup'+url,
      type:type,
      data:JSON.stringify(data),
      headers:appConfig.headers,
      success: function(res) {
        new_followups = _.map(new_followups, function(followup) {
          if(followup.day == day) { followup.objectId = false }
          return followup
        })
        thiss.setState({followups: new_followups})

        console.log(res)
        $.ajax({
          url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
          type:'PUT',
          data:JSON.stringify({followups: {
            __op: 'AddUnique',
            objects:[appConfig.pointer('Followup', res.objectId)]
          }}),
          headers:appConfig.headers,
          success: function() { },
          error: function() { }
        })
      },
      error: function() { },
    })
  },

  removeFollowup: function(day) {
    followups = []
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day != day)
        followups.push(this.state.followups[i])
      
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day == day)
        break
    
    this.setState({followups: followups}) 
    id = this.state.followups[i]

    thiss = this;
    if(id) {
      id = id.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Followup/'+id,
        headers:appConfig.headers,
        type:'DELETE',
        success: function(res) { console.log(res) }
      })

     console.log('REMOVE ARRAY')
      $.ajax({
        url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
        headers:appConfig.headers,
        type:'PUT',
        data: JSON.stringify({
          followups: {
            __op : 'Remove',
            objects: [appConfig.pointer('Followup', id)]
          }
        }),
        success: function(res){ console.log(res) },
        error: function() { }
      })
    }
  },

  setCurrentBatch: function(currentBatch) {
    this.setState({currentBatch: currentBatch})
  },

  setCurrentTemplate: function(template) {
    this.setState({currentTemplate: template })
  }
});

},{"./send_email_modal.js.min.js":9,"./timeline_day_element.js.min.js":11}],9:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      currentProspect: 0,
    }
  },

  sendEmails: function() {
    selectedCampaign = this.props.selectedCampaign
    campaign_id = selectedCampaign.objectId
    prospectlist_id = selectedCampaign.prospect_list.objectId
    template_id = this.props.currentTemplate.objectId
    
    $.ajax({
      //url:'https://nameless-retreat-3525.herokuapp.com/send_email',
      url:'http://127.0.0.1:5000/v1/campaign/email',
      data: {
        template : template_id,
        campaign : campaign_id,
        //batch: batch_id
      },
      success: function(res) { console.log(res.results) },
      error: function(err) { console.log(err) }
    })

    /* */
    // Update Followup
    // Persist Followup
    // close modal
  },

  render: function() {
    prospect = this.props.prospects[this.state.currentProspect]
    prospect = (prospect) ? prospect : {'name':'','email':''}

    var thiss = this;
    console.debug('SEND EMAIL BATCH')
    console.debug(this.props.currentBatch)
    newBatch = _.isEqual(this.props.currentBatch, {})
    prospects = (newBatch) ? this.props.newProspects : this.props.prospects
    if(newBatch){
      prospects = _.map(this.props.newProspects, function(prospect) {
          return UserPlaceHolder({prospect: prospect})
      })
    } else {
      prospects = _.map(this.props.prospects, function(prospect) {
        if(_.findWhere(prospect.batches, {objectId: thiss.props.currentBatch}))
          return UserPlaceHolder({prospect: prospect})
      })
    }
    prospects = _.compact(prospects)
    console.debug(prospects)
    console.debug(prospects.length)
    prospectCount = prospects.length
    email = (prospect.email) ? prospect.email : ""
    if(email == "no_email" || email == "") {
      console.log('GUESSING')
      if(prospect.email_guesses) {
        console.log('GUESSING EMAIL')
        guess = _.findWhere(prospect.email_guesses, {tried: false})
        name = _.title(prospect.name.trim())

        vars = {
          first: _.first(name.split(' ')).replace(/\W/g, ''),
          last: _.last(name.split(' ')).replace(/\W/g, ''),
          fi: _.first(name.split(' '))[0].replace(/\W/g, ''),
          li: _.last(name.split(' '))[0].replace(/\W/g, '')
        }
        if(guess){
          console.log(guess.pattern.pattern)
          email = Mustache.render(guess.pattern.pattern, vars)
          email = email+"@"+prospect.domain
        }
      } else {
        console.log('NO GUESSES FOUND')
      }
    }
    email = email.toLowerCase()
    email = email
    return (
      React.DOM.div({className: "modal fade bs-sendEmail-modal-lg", tabIndex: "-1", 
           role: "dialog", 'aria-labelledby': "mySmallModalLabel", 'aria-hidden': "true", 
           id: "sendEmailModal", style: {top:'10px'}}, 
            React.DOM.div({className: "modal-dialog modal-lg"}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.button({type: "button", className: "close", 'data-dismiss': "modal"}, React.DOM.span({'aria-hidden': "true"}, "×"), 
                    React.DOM.span({className: "sr-only"}, "Close")), 
        React.DOM.button({type: "button", 
                onClick: this.sendEmails, 
                style: {float:'right'}, 
                className: "btn btn-primary btn-sm"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), "  Send Email"), 
        React.DOM.button({type: "button", style: {marginRight:10, float:'right'}, 
                className: "btn btn-default btn-sm", 'data-dismiss': "modal"}, "Close"), 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    React.DOM.i({className: "fa fa-envelope"}), "  Send Email" + ' ' +
                    "  ", 
                    React.DOM.small(null, "("+prospectCount+")")
                  )
                ), 
                React.DOM.div({className: "modal-body", style: {paddingTop:5}}, 
                  React.DOM.h4(null, "People"), 
                  
                  React.DOM.div({className: "prospect-container"}, 
                    prospects
                  ), 
                  React.DOM.br(null), 
                  React.DOM.h4({style: {display:'inline-block'}}, "Emails    ", 
                  React.DOM.a({href: "javascript:", 
              className: (this.state.currentProspect == 0 ) ? "badge btn disabled" : "badge btn", 
                    onClick: this.previousProspect}, React.DOM.i({className: "fa fa-arrow-left"})), "  ", 
                    React.DOM.small(null, (this.state.currentProspect+1)+' of '+prospectCount
                  )), 
                  "   ", 
                  React.DOM.a({href: "javascript:", 
            className: (this.state.currentProspect ==  this.props.prospects.length-1) ? "btn disabled badge" : "btn badge", 
                    onClick: this.nextProspect}, React.DOM.i({className: "fa fa-arrow-right"})), 

                  React.DOM.div(null, 

React.DOM.ul({className: "list-group email-holder", style: {borderTop:'solid 1px #eee'}}, 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "To:  "), 
    
    React.DOM.span({className: "label label-primary"}, email)
  ), 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "Subject:  "), " ", React.DOM.span({className: "label label-primary"}, this.props.currentTemplate.subject)
  ), 
  React.DOM.li({className: "list-group-item body"})
)
  
                  )

                ), 

      React.DOM.div({className: "modal-footer", style: {display:'none'}}, 
        React.DOM.button({type: "button", 
                className: "btn btn-default", 'data-dismiss': "modal"}, "Close"), 
        React.DOM.button({type: "button", 
                className: "btn btn-primary"}, "Send Email")
      )
              )
            )
          )
    );
  },

  previousProspect: function() {
    this.setState({currentProspect: this.state.currentProspect-1 })
  },

  nextProspect: function() {
    this.setState({currentProspect: this.state.currentProspect+1 })
  },

  parseTemplate: function(templateBody) {
    first_name = prospect.name.split(' ')[0]
    //hiring_signal = prospect.signals

    signals = (prospect.signals) ? prospect.signals[0] : ""
    templateBody = Mustache.render(templateBody, {
      hiring_signal: signals,
      first_name: _.title(prospect.name.split(' ')[0])
    })

    //console.log(templateBody)
      
    return templateBody
  },

  componentDidUpdate: function() {
    //console.log(this.props.currentTemplate)
    parsedTemplate = this.parseTemplate(this.props.currentTemplate.body)
    
    //$('.body').html(this.props.currentTemplate.body)
    $('.body').html(parsedTemplate)
  }
});

var UserPlaceHolder = React.createClass({displayName: 'UserPlaceHolder',
  render: function() {
    return (
        React.DOM.div({className: "btn-group", style: {marginRight:5,marginBottom:5}}, 
          React.DOM.div({className: "btn-group"}, 
            React.DOM.button({type: "button", 
                    className: "btn btn-success btn-sm"}, 
              React.DOM.i({className: "fa fa-user"}), "  ", 
              (this.props.prospect) ? _.title(this.props.prospect.name) : ""
            )
          ), 
          React.DOM.button({type: "button", className: "btn btn-success btn-sm"}, 
            React.DOM.i({className: "fa fa-trash-o"})
          )
        )
    )
  }
});

},{}],10:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  //TemplatesMenu
  toggleTemplateEditMenu: function(currentTemplate) {
    this.props.toggleTemplateEditMenu(currentTemplate)
  },

  createTemplate: function() {
    this.props.toggleTemplateEditMenu({
      name: '',
      body:'',
      subject:'',
      editMode:true,
      newTemplate: true
    }, true)
  },

  render: function() {
    //console.log(this.props.templates)
    templates = []
    for(i=0;i< this.props.templates.length; i++) {
      templates.push(
        TemplateListItem({
          toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
          template: this.props.templates[i]})
      )
    }

    return (
      React.DOM.div({className: "", style: {padding:'0', height:'100%',textAlign:'center'}}, 
        React.DOM.div({className: "panel panel-default", 
             style: {borderRight:0,borderRadius:0,height:'100%', overflow:'auto'}}, 
          React.DOM.div({className: "panel-heading", style: {height:40}}, 
            React.DOM.span({style: {float:'left',fontSize:14,fontWeight:'bold'}}, 
              React.DOM.i({className: "fa fa-file-text-o"}), 
              React.DOM.span({style: {marginLeft:5}}, "Templates")
            ), 
            React.DOM.a({href: "javascript:", 
              className: "btn btn-success btn-xs", 
              onClick: this.createTemplate, 
                style: {float:'right'}}, 
              React.DOM.i({className: "fa fa-plus"}), 
              React.DOM.span({style: {marginLeft:5}}, "Create Template")
            )
          ), 
          React.DOM.ul({className: "list-group", 
              style: {textAlign:'left'}}, 
            templates
          )
        )
      )
    )
  }
});

var TemplateListItem = React.createClass({displayName: 'TemplateListItem',
  toggleTemplateEditMenu: function() {
    console.log(this.props.template)
    template = this.props.template
    template.editMode = false
    this.props.toggleTemplateEditMenu(template)
  },

  render: function() {
    return (
      React.DOM.div(null, 
        React.DOM.a({href: "javascript:", 
          style: {borderBottom: '1px solid rgb(221, 221, 221)',paddingTop:5,paddingBottom:0}, 
           onClick: this.toggleTemplateEditMenu, 
           className: "list-group-item"}, 
           React.DOM.span({className: "label label-default"}, 
             this.props.template.name
           ), 
           React.DOM.h6(null, "Subject:", React.DOM.span({className: "text text-muted"}, 
             " " + this.props.template.subject
           ))
         )
      )
    );
  }
});

},{}],11:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // TimelineDayElement
  // TODO
  // - add prospect list progression
  // - add scheduled followup
  //
  getInitialState: function() {
    // 
    return {
      followupCompleted: 0,
    }
  },

  addFollowup: function() {
    this.props.addFollowup(this.props.dayCount)
  },

  render: function() {
    if(this.props.addTemplateMode) {
      mode = EditTemplate({addFollowup: this.props.addFollowup, 
                           saveFollowup: this.props.saveFollowup, 
                           removeFollowup: this.props.removeFollowup, 
                           dayCount: this.props.dayCount, 
                           templates: this.props.templates})
    } else {
      mode = TemplateFollowup({currentTemplate: this.props.currentTemplate, 
                               editFollowup: this.props.editFollowup, 
                               dayCount: this.props.dayCount, 
                               currentBatch: this.props.currentBatch, 
                               hasBatch: typeof(this.props.batchCount) != "undefined" && this.props.batchCount > 0, 
                               setCurrentBatch: this.props.setCurrentBatch, 
                               dayCount: this.props.dayCount, 
                               removeFollowup: this.props.removeFollowup, 
                               setCurrentTemplate: this.props.setCurrentTemplate})
    }
    if(this.props.alreadySent) {
      mode = FollowupCompleted({currentTemplate: this.props.currentTemplate})
    }

    mode = (this.props.elementType) ? "" : mode
    addFollowup = (this.props.elementType) ? this.addFollowup : ""
    if(typeof(this.props.batchCount) != "undefined")
      batchStage = BatchStage({currentBatch: this.props.currentBatch, 
                               newProspects: this.props.newProspects, 
                               prospectListCount: this.props.prospectListCount, 
                               batchCount: this.props.batchCount, 
                               hasScheduledEmail: mode != "", 
                               dayCount: this.props.dayCount})
    else
      batchStage = ""

    dayCount = (this.props.dayCount != 0.5) ? "D"+this.props.dayCount : ""

    return (
      React.DOM.div(null, 
        React.DOM.div({onClick: addFollowup, className: "day", 'data-trigger': "manual"}, 
          dayCount
        ), 
        mode, batchStage
      )
    )
  },

  setCurrentTemplate: function(template) {
    this.props.setCurrentTemplate(template)
  }
});

var FollowupCompleted = React.createClass({displayName: 'FollowupCompleted',
  render: function() {
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs disabled", 
                'data-target': ".bs-sendEmail-modal-lg", 
                onClick: this.setCurrentTemplate, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-check"}), " Sent"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"}))
      )
                                         )
  }
})

var TemplateFollowup = React.createClass({displayName: 'TemplateFollowup',
  // EditMode False

  setCurrentTemplate: function() {
    this.props.setCurrentTemplate(this.props.currentTemplate)
    // setCurrentBatch
    this.props.setCurrentBatch(this.props.currentBatch)
    $('.bs-sendEmail-modal-lg').modal()
  },

  waitForBatch: function() {
    alertify.log("You must wait for a batch!");
  },

  render: function() {
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
          onClick: (this.props.hasBatch) ? this.setCurrentTemplate : this.waitForBatch, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-paper-plane"}), " Send"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        trash
      )
    );
  },

  editFollowup: function(e) { 
    e.preventDefault()
    console.log(this.props.dayCount)
    this.props.editFollowup(this.props.dayCount)
  },

  removeFollowup: function() {
    console.log('remove')
    this.props.removeFollowup(this.props.dayCount)
  }
});

var BatchStage = React.createClass({displayName: 'BatchStage',
  // Different Stages of People Added to Prospect List
  getInitialState: function() {
    return {
      initialBatchCount: this.props.batchCount
    }
  },

  componentDidMount: function() {
    // state
    //console.debug('INSIDE BATCH '+this.props.dayCount)
    console.debug(this.props.currentBatch)
    _batches = appConfig.pointer('ProspectBatch', this.props.currentBatch)
    if(this.props.batchCount == "~") {
      // Why doesnt this work 
      var thissss = this;
      console.debug('INSIDE BATCH '+thiss.props.dayCount)
      console.debug(_batches)
      $.ajax({
        url:'https://api.parse.com/1/classes/Prospect',
        batches: _batches,
        data: {
          where: JSON.stringify({
            batches: _batches
          }),
          count: true,
          limit:1000,
        },
        headers: appConfig.headers,
        success: function(res) { 
          //console.debug('SUCCESS GET COUNT ' + res.count)
          //console.debug(res.results) 
          thissss.setState({initialBatchCount: res.count})
        },
        error: function(err) { 
          thissss.setState({initialBatchCount: 0 })
        }
      })
    }
  },

  componentWillReceiveProps: function(nextProps) {
    if(this.props.dayCount == 0)
      this.setState({ initialBatchCount: nextProps.batchCount })
  },


  render: function() {
    if(this.props.hasScheduledEmail)
      batchStageStyle = {top:-42, left:6}
    else
      batchStageStyle = {}

    if(this.props.dayCount == 0.5)
      batchStageStyle.left = 7

    //console.log('BATCH STAGE')
    //console.log(this.props)
    //console.debug(this.props.currentBatch)                                                           

    return (
      React.DOM.div({className: "followup-placement arrow_box tmp", style: batchStageStyle}, 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-user"}), " ", 
          this.state.initialBatchCount
        ), " ", 
        React.DOM.h6({style: {display:'inline-block'}}, 
          "prospects in the sales cycle.")
      )
    );
  }
});

var EditTemplate = React.createClass({displayName: 'EditTemplate',
  // Edit Mode - True
  render: function() {
    options = []
    for(i=0;i< this.props.templates.length; i++) {
      options.push( React.DOM.option(null, this.props.templates[i].name))
    }
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, " ", React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:55,display:'inline-block'}, 
            className: "text-muted"}, 
          "Choose :"
        ), 
        React.DOM.select({className: "form-control input-sm", 
                id: "chooseTemplateForFollowup", 
                style: {display:'inline-block',width:127,marginRight:5}}, 
          options
        ), 

        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
                onClick: this.saveFollowup, 
                style: {marginRight:5}}, 
          React.DOM.i({className: "fa fa-check"})), 
        trash
      )
    )
  },

  saveFollowup: function(e) {
    //get template from currentTemplate
    e.preventDefault()
    chosenTemplate = $('#chooseTemplateForFollowup').val()
    console.log(chosenTemplate)
    for(i=0;i< this.props.templates.length; i++){
      if(this.props.templates[i].name == chosenTemplate){
        chosenTemplate = this.props.templates[i]
        break
      }
    }
    console.log(chosenTemplate)
    
    this.props.saveFollowup(this.props.dayCount, chosenTemplate)
  },

  removeFollowup: function(day) {
    this.props.removeFollowup(this.props.dayCount)
  },
});


},{}]},{},[2])


},{"./campaign_activity_view.js.min.js":1,"./campaign_followup_feed.js.min.js":3,"./campaign_report.js.min.js":4,"./campaign_sent_email.js.min.js":5,"./create_template.js.min.js":8,"./edit_template.js.min.js":9,"./followup_timeline.js.min.js":12,"./send_email_modal.js.min.js":14,"./templates_menu.js.min.js":17,"./timeline_day_element.js.min.js":18}],3:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      followups: []
    }
  },

  componentDidMount: function() {
        // for each batch find followups remaining
        // sort followups by ascending followup day
        //
    // Batch Start Date
    // Current Batch Date
  },

  render: function() {
    var thiss = this;
    followups = _.map(this.props.batches, function(batch) {
      now = moment().startOf('day').valueOf()/1000
      batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
      return _.map(thiss.props.followups, function(followup) {
        followup.batch = batch
        if(followup.day >= batch.currentDay)
          return followup
      })
    })
    followups = _.sortBy(followups, function(followup){ return followup.day })

    console.debug(followups)

    activities = _.map(followups[0], function(followup) {
      return Followups({followup: followup, batch: followup.batch})
    })
    console.debug(activities)

    return (
      React.DOM.div({style: {overflow:'auto',height:436}}, 
        React.DOM.table({className: "table", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Scheduled for "), 
            React.DOM.th(null, "Outreach Stage "), 
            React.DOM.th(null, "Prospect List"), 
            React.DOM.th(null, "Template "), 
            React.DOM.th({style: {textAlign:'center'}}, "Action Buttons")
          ), 
          React.DOM.tbody(null, 
            activities
          )
        )
      )
    )
  }
})

var Followups = React.createClass({displayName: 'Followups',
  render: function() {
    // this.props.batch
    // this.props.followup
    return (
      React.DOM.tr(null, 
          React.DOM.td(null), 
          React.DOM.td(null, 
            React.DOM.h6(null, 
              React.DOM.i({className: "fa fa-clock"}), " " + ' ' +
              "29 minutes ago"
            )
          ), 
          React.DOM.td(null, 
            "second"
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-list-alt"}), "  " + ' ' +
            "Boston VP Sales - Retail"
            )
          ), 
          React.DOM.td(null, 
            React.DOM.h6({style: {cursor:'pointer'}}, 
            React.DOM.i({className: "fa fa-file-text-o"}), "  " + ' ' +
            "Followup #2 - Provide Value ", React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Subject: Just wanted to followup on the last email "), React.DOM.br(null), 
            React.DOM.span({className: "text-muted"}, " Body: Just wanted to followup on the last email ")

            )
          ), 

          React.DOM.td({style: {textAlign:'center'}}, 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Send Now"), React.DOM.br(null), 
            React.DOM.a({href: "javascript:", className: "btn btn-success btn-xs", style: {width:170,fontWeight:'bold',marginBottom:2}}, "Remind me in 1 hour"), React.DOM.br(null)
          )
      )
    )
  }
})

},{}]},{},[1])


},{}],4:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

lol = 

module.exports = React.createClass({displayName: 'exports',
  // Campaign Report
  getInitialState: function() {
    return {
    }
  },

  componentDidMount: function() { 
    testData = this.testData()
    var industryChart   = dc.pieChart("#industry-chart"),
        spendHistChart  = dc.barChart("#chart-hist-spend"),
        spenderRowChart = dc.rowChart("#chart-row-spenders");

    // set crossfilter
    var ndx = crossfilter(spendData),
        yearDim  = ndx.dimension(function(d) {return +d.Year;}),
        spendDim = ndx.dimension(function(d) {return Math.floor(d.Spent/10);}),
        nameDim  = ndx.dimension(function(d) {return d.Name;}),
        spendPerYear = yearDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendPerName = nameDim.group().reduceSum(function(d) {return +d.Spent;}),
        spendHist    = spendDim.group().reduceCount();

    industryChart
        .width(200).height(200)
        .dimension(yearDim)
        .group(spendPerYear)
        .innerRadius(50);

    //
    // Batch Analytics - Bubble Chart
    // Batch Block Charts
    // Pie Chart - Industry
    // Revenue - PC
    // Company Size - PC
    // Opens / Replies / Link Clicks / Bounces - Bar Chart
    // Titles - PC
    // Time / Date Email Sent - Line Chart
    // Date Prospected - BC
    //
  },
  
  render: function() {
    return (
      React.DOM.div(null, 
        "Report View", 
        React.DOM.div({id: "industry-chart"})
      )
    )
  },

  testData: function() { 
    return [{"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140218.58883.75040@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140219.50015.20571@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140219.50019.67418@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140220.58887.52484@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shadowzprotection.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.598Z", "createdAt": "2014-10-07T15:20:15.147Z", "city": "New Delhi Area, India\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "f44YU2Yrm7", "company_name": "M/S Golden Bricks Constructions Pvt. Ltd.", "mailgun_id": "<20141010140220.19960.3157@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "6B4MDqWqtw"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "e9sMFL1QWx"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:15.147Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "201-500 employees", "name": "Vivek Narang", "industry": "Security and Investigations", "linkedin_url": "in.linkedin.com/pub/vivek-narang/20/b67/39", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.shangri-la.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.880Z", "createdAt": "2014-10-07T15:20:13.197Z", "city": "Brisbane, Australia\\u00a0", "archived": true, "loading": false, "objectId": "TSSDEZ3lUA", "company_name": "Shangri-La Hotels and Resorts", "mailgun_id": "<20141010140221.39548.29627@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "PIDGJPqraI"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "mG4U69xDcg"}], "email": "andy.mccutcheon@shangri-la.com", "prospect_created_at": "2014-10-07T15:20:13.197Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Andy McCutcheon", "industry": "Hospitality", "linkedin_url": "au.linkedin.com/pub/andy-mccutcheon/1a/665/650", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.tencate.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Sales & Marketing Aerospace", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.516Z", "createdAt": "2014-10-07T15:20:18.481Z", "city": "Coventry, United Kingdom\\u00a0", "archived": true, "loading": false, "objectId": "ftyKCGmR9H", "company_name": "Tencate", "mailgun_id": "<20141010140813.19956.20454@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "u8SetCQOJP"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "P0KmFG92dK"}], "email": "n.tiffin@tencate.com", "prospect_created_at": "2014-10-07T15:20:18.481Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Nick Tiffin", "industry": "Textiles", "linkedin_url": "uk.linkedin.com/pub/nick-tiffin/5/434/256", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.pearson.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director, Sales Performance Management", "__type": "Object", "updatedAt": "2014-10-10T13:29:22.780Z", "createdAt": "2014-10-07T15:20:17.873Z", "city": "Phoenix, Arizona Area\\u00a0", "archived": true, "loading": false, "objectId": "LPiE0CcEsR", "company_name": "Pearson plc", "mailgun_id": "<20141010140813.58881.85733@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "Q57kwN1LQT"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "53K0lWY7hv"}], "email": "jason.linkedin@pearson.com", "prospect_created_at": "2014-10-07T15:20:17.873Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "10,001+ employees", "name": "Jason Upah", "industry": "Education Management", "linkedin_url": "www.linkedin.com/pub/jason-upah/7/233/940", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.rmwmusic.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director of Sales and Marketing", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.049Z", "createdAt": "2014-10-07T15:20:16.735Z", "city": "Toronto, Ontario, Canada\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "COSpyXgsD2", "company_name": "RMW Music", "mailgun_id": "<20141010140814.19938.90169@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "3OEKtIxIAp"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "xvGbUYpo43"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.735Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "11-50 employees", "name": "Laura Nikolic", "industry": "Music", "linkedin_url": "ca.linkedin.com/pub/laura-nikolic/50/450/771", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}, {"website": "http://www.saudiacargo.com", "campaign": {"className": "Campaign", "__type": "Pointer", "objectId": "nmElU7zcBf"}, "pos": "\\u00a0Director Global Sales Support", "__type": "Object", "updatedAt": "2014-10-10T13:29:23.327Z", "createdAt": "2014-10-07T15:20:16.127Z", "city": "Saudi Arabia\\u00a0", "archived": true, "loading": false, "opened": true, "objectId": "Ke06g6kSk5", "company_name": "Saudi Airlines Cargo Company", "mailgun_id": "<20141010140814.77386.74943@customerohq.com>", "email_guesses": [{"className": "EmailGuess", "__type": "Pointer", "objectId": "o33JavhSpy"}, {"className": "EmailGuess", "__type": "Pointer", "objectId": "l3vy2TxF73"}], "email": "no_email", "prospect_created_at": "2014-10-07T15:20:16.127Z", "company": {"className": "Company", "__type": "Pointer", "objectId": "fqHWp5NsFx"}, "lists": [{"className": "ProspectList", "__type": "Pointer", "objectId": "izLbVulyr6"}], "user": {"className": "User", "__type": "Pointer", "objectId": "xWESiw5Smd"}, "company_size": "1001-5000 employees", "name": "Rainer Mueller", "industry": "Airlines/Aviation", "linkedin_url": "sa.linkedin.com/pub/rainer-mueller/5/a48/428", "batch": {"className": "ProspectBatch", "__type": "Pointer", "objectId": "YPaTGbD56a"}, "className": "Prospect", "queued": true}]
  },

});

},{}]},{},[1])


},{}],5:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Sent Mail
  getInitialState: function() {
    return {
      sentEmails: []
    }
  },

  componentDidMount: function() {
    thiss = this;
    qry = {
      include: 'campaign,prospect,prospect.email_guesses.pattern',
      order:'-createdAt',
      campaign: {
        __type: 'Pointer',
        className:'Campaign',
        objectId: this.props.selectedCampaign.objectId,
      }
    }
    $.ajax({
      url: 'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({sentEmails: res.results}) },
      error: function() {}
    })
  },

  render: function() {
    sentEmails = []
    for(i=0;i< this.state.sentEmails.length; i++) 
      sentEmails.push(SentEmailRow({sentEmail: this.state.sentEmails[i]}))

    return (
      React.DOM.div({style: {overflow:'auto',height:417}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th(null, "Template"), 
            React.DOM.th({style: {width:290}}, "Status")
          ), 
          React.DOM.tbody(null, 
            sentEmails
          )
        )
      )
    );
  }
});

var SentEmailRow = React.createClass({displayName: 'SentEmailRow',
  render: function() {
    sentEmail = this.props.sentEmail
    //console.log(sentEmail)

    email = sentEmail.email
    /*
    if(email == "no_email"){
      first = sentEmail.prospect.name.split(' ')[0]
      last = _.last(sentEmail.prospect.name.split(' '))

      pattern = _.findWhere(sentEmail.prospect.email_guesses, {'tried':false})
      data = {first: first, last: last, fi: first[0], li: last[0]}
      email = Mustache.render(pattern.pattern.pattern, data).toLowerCase()
    }
    */

    replied = "label label-default"
    opened = "label label-default"
    delivered = "label label-default"
    queued = "label label-default"

    if(sentEmail.replied) 
      replied = "label label-success"
    if(sentEmail.opened) 
      opened = "label label-success"
    if(sentEmail.delivered) 
      delivered = "label label-success"
    if(sentEmail.queued) 
      queued = "label label-success"

    return (
      React.DOM.tr(null, 
        React.DOM.td({style: {width:100}}, React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-clock"}), 
            moment(sentEmail.createdAt).fromNow())), 
        React.DOM.td({style: {width:200}}, 
          React.DOM.h6({style: {fontSize:14,fontWeight:'bold',marginBottom:0}}, 
            sentEmail.prospect.name), 
          React.DOM.h6({style: {fontStyle:'italic',marginTop:4,marginBottom:0}}, 
            sentEmail.prospect.pos.trim()), 
          React.DOM.h6({style: {marginTop:4,fontWeight:'bold'}}, 
            React.DOM.i({className: "fa fa-building"}), " ", 
            sentEmail.prospect.company_name)
        ), 
        React.DOM.td({style: {width:200}}, React.DOM.h6(null, email)), 
        React.DOM.td(null, 
          React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-file-text-o"}), " " + ' ' +
            "Template"
          )
        ), 
        React.DOM.td({style: {paddingTop:13}}, 
          React.DOM.span({className: queued}, "Queued"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: delivered}, "Delivered"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: opened}, "Opened"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: replied}, "Replied")
        )
      )
    )
  }
})

},{}]},{},[1])


},{}],6:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Campaigns
  getInitialState: function() {
    return {
      selectedScreen: 'Overview',
    }
  },

  changeSelectedCampaign: function(campaign) {
    //this.props.toggleScreen('CampaignDetail')
    this.props.changeSelectedCampaign('CampaignDetail', campaign)
  },

  render: function() {
    campaigns = []
    console.log(this.props)
    for(i=0;i< this.props.campaigns.length; i++){ 
      campaigns.push(CampaignRow({
                        toggleScreen: this.toggleScreen, 
                        deleteCampaign: this.props.deleteCampaign, 
                        changeSelectedCampaign: this.changeSelectedCampaign, 
                        campaign: this.props.campaigns[i]}) )
    }
    return (
      React.DOM.div({style: {overflow:'auto',height:550}}, 
        React.DOM.table({className: "table table-striped"}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Campaign Name"), 
            React.DOM.th(null, "Prospect List"), 
            React.DOM.th(null, "Size"), 
            React.DOM.th({style: {textAlign:'center'}}, "Delivered"), 
            React.DOM.th({style: {textAlign:'center'}}, "Opened"), 
            React.DOM.th({style: {textAlign:'center',display:'none'}}, "Replied"), 
            React.DOM.th({style: {textAlign:'center',display:'none'}}, "Link Clicks"), 
            React.DOM.th({style: {textAlign:'center'}}, "Bounced"), 
            React.DOM.th({style: {width:150,textAlign:'center'}}, " ")
          ), 
          React.DOM.tbody(null, 
            campaigns
          )
        )
      )
    );
  },
});

var CampaignRow = React.createClass({displayName: 'CampaignRow',
  getInitialState: function() {
    return {
      delivered: '~',
      opened: '~',
      bounced: '~',
      prospectListCount: '~'
    }
  },

  DeleteCampaign: function(e) {
    var thiss = this;
    console.log('DELETE CAMPAIGN')
    e.stopPropagation()
    swal({   
      title: "Are you sure?",   
      text: "You will not be able to recover this Campaign!",
      type: "warning",   
      showCancelButton: true,   
      confirmButtonColor: "#DD6B55",   
      confirmButtonText: "Yes, delete it!",   
      closeOnConfirm: false }, 
      function(){   
        swal("Deleted!", "Your campaign has been deleted.", "success"); 
        console.log('deleted')
        thiss.props.deleteCampaign(thiss.props.campaign.objectId)
      });
  },

  toggleScreen: function() {
    //this.props.toggleScreen()
    this.props.changeSelectedCampaign(this.props.campaign)
  },

  componentDidMount: function() {
    var thiss = this;
    list = this.props.campaign.prospect_list
    list = (list) ? list.objectId : ""
    qry = {
      where: JSON.stringify({lists: appConfig.pointer('ProspectList',list)}),
      count: true
    }
    $.ajax({
      url: 'https://api.parse.com/1/classes/Prospect',
      headers: appConfig.headers,
      data: qry,
      success: function(res) { thiss.setState({prospectListCount: res.count})},
      error: function(err) { console.log(err.responseText) }
    })
    campaignId = this.props.campaign.objectId
    qry = {
      where: JSON.stringify({campaign: appConfig.pointer('Campaign', campaignId)}),
      limit: 1000,
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({delivered: res.count})},
      error: function(err) { console.log(err.responseText) }
    })
    qry_1 = {
      where: JSON.stringify({
        campaign: appConfig.pointer('Campaign', campaignId),
        opened: {"$gte": 0} 
      }),
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry_1,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({opened : res.count}) },
      error: function(err) { console.log(err.responseText) }
    })
    qry_2 = {
      where: JSON.stringify({
        campaign: appConfig.pointer('Campaign', campaignId),
        failed: {"$gte": 0} 
      }),
      count: true
    }
    $.ajax({
      url:'https://api.parse.com/1/classes/SentEmail',
      data: qry_2,
      headers: appConfig.headers,
      success: function(res) { thiss.setState({bounced : res.count}) },
      error: function(err) { console.log(err.responseText) }
    })
  },

  render: function() {
    prospect_list = (this.props.campaign.prospect_list) ? this.props.campaign.prospect_list : {list_type:"", name:""}
    if(prospect_list.list_type == "signal_list")
        iconType = React.DOM.i({className: "fa fa-wifi", style: {marginRight:5}})
    else if(prospect_list.list_type == "mining_job")
        iconType = React.DOM.i({className: "fa fa-cloud-download", style: {marginRight:5}})
    else 
        iconType =""
    return (
      React.DOM.tr({style: {cursor:'pointer'}, onClick: this.toggleScreen}, 
        React.DOM.td(null), 
        React.DOM.td(null, " ", React.DOM.h6(null, 
            this.props.campaign.name
        ), " "), 
        React.DOM.td(null, " ", React.DOM.h6(null, 
            iconType, 
            prospect_list.name
        ), " "), 
        React.DOM.td(null, 
          React.DOM.div({className: "label label-primary"}, 
            React.DOM.i({className: "fa fa-user"}), "  ", 
            this.state.prospectListCount
          )
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12}}, 
          React.DOM.span({className: "badge", style: {backgroundColor:'#f0ad4e',width:50}}, 
            React.DOM.i({className: "fa fa-paper-plane", style: {float:'left'}}), "  ", 
            this.state.delivered
          )
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12}}, 
          React.DOM.span({className: "label label-success"}, 
            React.DOM.i({className: "fa fa-eye"}), "   ", this.state.opened, " ")
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12,display:'none'}}, 
          React.DOM.span({className: "label label-primary"}, 
            React.DOM.i({className: "fa fa-mail-reply"}), "  ", 
            this.state.bounced)
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12,display:'none'}}, 
          React.DOM.span({className: "label label-info"}, 
            React.DOM.i({className: "fa fa-external-link-square"}), "  " + ' ' +
            "18%")
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12}}, 
          React.DOM.span({className: "label label-default"}, 
            React.DOM.i({className: "fa fa-exclamation-circle"}), "  ", 
            this.state.bounced)
        ), 
        React.DOM.td({style: {textAlign:'center',paddingTop:12}}, 
          React.DOM.a({href: "javascript:", className: "btn btn-primary btn-xs", 
            style: {backgroundImage: 'linear-gradient(180deg, #0096ff 0%, #005dff 100%) !important;',display:'none'}}, 
            React.DOM.i({className: "fa fa-copy", style: {fontWeight:'bold'}}), "  Clone"), 

          React.DOM.a({href: "javascript:", 
             className: "btn-default", 
             onClick: this.DeleteCampaign, 
             style: {marginLeft:5}}, " ", React.DOM.i({className: "fa fa-trash-o"}))
        ), 
        React.DOM.td({style: {textAlign:'center',padding:12,display:'none'}}, 
          React.DOM.h4({style: {margin:0}}, 
            React.DOM.span({className: "label label-success"}, "Ready")
          )
        )
      )
    )
  }
});

},{}]},{},[1])


},{}],7:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // createListModal
  createCampaign: function(e) {
    e.preventDefault()
    //console.log($('#newListName').val())
    newCampaignName = $('#newCampaignName').val()
    prospectListName = $('#prospect_lists').val()
    thiss = this
    for(i=0;i< this.props.prospectLists.length; i++){
      if(this.props.prospectLists[i].name == prospectListName){
        prospect_list = this.props.prospectLists[i]; 
        break;
      }
    }
    if(newCampaignName.trim() != "")
      this.props.createCampaign({
        name: newCampaignName,
        prospect_list: prospect_list
      })
    // Disable Modal
    $('.modal-backdrop').click()
    $('.fade').click()
    $('#newCampaignName').val('')
  },

  render: function() {
    prospect_lists = []
    for(i=0;i< this.props.prospectLists.length; i++) {
      prospect_lists.push( React.DOM.option(null, this.props.prospectLists[i].name))
    }

    return (
      React.DOM.div({className: "modal fade bs-createCampaign-modal-sm", 
           tabIndex: "-1", role: "dialog", 'aria-labelledby': "mySmallModalLabel", 
           'aria-hidden': "true", id: "createListModal", style: {top:'200px'}}, 
            React.DOM.div({className: "modal-dialog modal-sm"}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.button({type: "button", className: "close", 'data-dismiss': "modal"}, React.DOM.span({'aria-hidden': "true"}, "×"), 
                    React.DOM.span({className: "sr-only"}, "Close")), 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    React.DOM.i({className: "fa fa-envelope"}), "  Create Campaign")
                ), 

                React.DOM.div({className: "modal-body"}, 
                  React.DOM.form({onSubmit: this.createCampaign}, 
                    React.DOM.input({id: "newCampaignName", 
                           type: "text", 
                           placeholder: "Enter Campaign Name...", 
                           className: "form-control"}), 

                    React.DOM.select({className: "form-control", 
                            id: "prospect_lists", 
                            style: {marginTop:20,marginBottom:20}}, 
                      prospect_lists
                    ), 

                    React.DOM.a({href: "javascript:", 
                      onClick: this.createCampaign, 
                      className: "btn btn-success", 
                      style: {display:'block', width:'100%'}}, 
                      "Create Campaign"
                    )
                  )
                )
              )
            )
          )
    );
  }
});


},{}]},{},[1])


},{}],8:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx react.dom */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      
    }
  },

  componentDidMount: function() {
    $('.template-body').html(this.state.templateBody)
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    console.log('EDIT MODE')
    console.log(this.state.editMode)
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      this.props.saveTemplate({
        name: this.state.name,
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
      })
      this.setState({
        templateBody: $('.summer').code(),
        templateSubject: $('.subject').val(),
        editMode: !this.state.editMode,
      })
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+this.props.initialTemplateValues.objectId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
    }
  },

  componentDidUpdate: function() {
    /* thiss = this; */

    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.templateSubject)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.templateBody)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? react.dom.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.templateSubject

    if(this.state.editMode){
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-save"}), "   Save Template")
    } else {
       toggleButton = react.dom.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            react.dom.i({className: "fa fa-pencil-square"}), "   Edit Template")
    }

    return (
      react.dom.div(null, 
      react.dom.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
      react.dom.div({id: "editTemplateView", 
           className: "panel panel-info", 
           style: {display:'block'}}, 
           react.dom.div({className: "panel-heading", style: {height:50}}, 
             react.dom.h6({style: {float:'left'}}, 
               react.dom.i({className: "fa fa-file-text-o"}), 
               "  " + this.props.initialTemplateValues.name
             ), 
          toggleButton
        ), 
        react.dom.div({className: "panel-body"}, 
          react.dom.div({className: "editTemplateTitle"}, 
            react.dom.span(null, "Subject: "), 
            subjectPlace
          ), 
         react.dom.br(null), 
         react.dom.div({className: "templateDetails"}, 
           react.dom.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
             "Created by Mark on Jul. 21, 2014"
           ), 
           react.dom.h6({style: {marginTop:'0'}, className: "text-muted"}, 
             "last updated 7 days ago"
           )
         ), 
        react.dom.br(null), 
        react.dom.div({className: "panel panel-default"}, 
          react.dom.div({className: "panel-body summer template-body"}
          )
        )
    )
)
)
    );
  }
});

},{}]},{},[1])


},{}],9:[function(require,module,exports){
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      name: this.props.initialTemplateValues.name,
      body: this.props.initialTemplateValues.body,
      subject: this.props.initialTemplateValues.subject,
      editMode: this.props.initialTemplateValues.editMode
    }
  },

  componentDidMount: function() {
    console.log('did mount')
    $('.template-body').html(this.state.body)
    if(this.state.editMode) {
      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })
    }

    renderjson.set_show_to_level('all')
    prospect = _.pick(this.props.prospect, 
      'company_name', 'name', 'pos'
    )
    prospect.first_name = prospect.name.split(' ')[0]
    prospect.last_name = _.last(prospect.name.split(' '))
    prospect = _.omit(prospect, 'name')

    document.getElementById("editTemplate").appendChild(renderjson(prospect));
    $('#editTemplateOverlay').html()
    thiss = this;
    $('.renderjson').click(function() {
      thiss.props.toggleTemplateEditMenu()
    })

    $('.renderjson').css({
      'position': 'absolute',
      'z-index': '1000000000',
      'background-color':'rgba(0,0,0,0)',
      'border':'0',
      'color':'white',
      'margin-top':'0px',
      'height': '542px',
      'overflow':'auto',
      'width':'380px'
    })

    $('.key').css({
      'cursor':'pointer'
    })

    $('.timeline').css({
      '-webkit-filter': 'blur(10px)',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': 'blur(10px)',
    })
  },
  componentWillUnmount:function() {
    $('.timeline').css({
      '-webkit-filter': '',
    })
    $('#campaign-top-detail').css({
      '-webkit-filter': '',
    })
  },

  clickedOverlay: function() {
    console.log('clicked overlay')
    this.props.toggleTemplateEditMenu()
  },

  changeMode: function() {
    // Update template html on toggle
    parse_headers = appConfig.parseHeaders
    if(this.state.editMode){
      $('.summer').destroy();
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })

      console.log('look at this')
      console.log(name)
      name = (this.props.initialTemplateValues.newTemplate) ? $('#template-name').val() : this.state.name
      this.props.saveTemplate({
        name: name,
        body: $('.summer').code(),
        subject: $('.subject').val(),
      }, this.props.initialTemplateValues.newTemplate)

      this.setState({
        name: $('#template-name').val(),
        body: $('.summer').code(),
        subject: $('.subject').val(),
        editMode: !this.state.editMode,
      })

      objId = this.props.initialTemplateValues.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Templates/'+objId,
        type:'PUT',
        headers:parse_headers,
        data:JSON.stringify({body: $('.summer').code(),
                             subject: $('.subject').val()}),
        success: function(res) {
          console.log(res)
        },
        error: function(err) {
          console.log(err)
        }
      });
    } else {
      this.setState({ editMode: !this.state.editMode })
      $('.timeline').css({
        '-webkit-filter': 'blur(20px)',
      })
    }
  },

  componentWillUpdate: function(newProps) {
    console.log('THE NEW PROPS')
    console.log(newProps)
  },

  componentDidUpdate: function() {
    /* thiss = this; */
    console.log('OTHER')
    if(this.state.editMode){
      console.log('CALLED')
      // Replace Subject 
      $('.subject').val(this.state.subject)
      $('#template-name').val(this.state.name)

      $('.summer').summernote({
        height: 200,
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']],
        ]
      })

      // Initialize Editor with html
      $('.summer').code(this.state.body)
    }
  },


  render: function() {
    subjectPlace = (this.state.editMode) ? React.DOM.input({style: {display:'inline',width:480}, className: "form-control subject"}) : this.state.subject

    if(this.state.editMode){
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-success btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-save"}), "   Save Template")

       if(this.props.initialTemplateValues.newTemplate){
         the_name = React.DOM.input({className: "form-control", 
                           id: "template-name", 
                           style: {float:'left',width:200}})
       }
    } else {
       toggleButton = React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:5}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")

       the_name = React.DOM.h6({style: {float:'left'}}, 
                   React.DOM.i({className: "fa fa-file-text-o"}), " ", 
                   this.state.name
                  )
    }

    return (
      React.DOM.div({id: "editTemplate"}, 
        React.DOM.h5({className: "example-template-title"}, "Example Template Values"), 
        React.DOM.div({className: "example-template-title", 
             style: {marginLeft:215, marginTop:8}}, 
          React.DOM.a({href: "javascript:", 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-left"})), 
          React.DOM.a({href: "javascript:", 
            style: {marginLeft:5}, 
            className: "btn btn-default btn-xs"}, 
            React.DOM.i({className: "fa fa-chevron-right"}))
        ), 
        React.DOM.div({onClick: this.clickedOverlay, id: "editTemplateOverlay"}), 
          React.DOM.div({id: "editTemplateView", 
               className: "panel panel-default", 
               style: {display:'block'}}, 
               React.DOM.div({className: "panel-heading", style: {height:50}}, 
                 the_name, 
              React.DOM.a({href: "javascript:", 
                className: "btn btn-default btn-xs", 
                style: {float:'right',marginLeft:5,marginTop:5}}, 
                React.DOM.i({className: "fa fa-trash"})
              ), 
              toggleButton
            ), 
            React.DOM.div({className: "panel-body"}, 
              React.DOM.div({className: "editTemplateTitle"}, 
                React.DOM.span(null, "Subject: "), 
                subjectPlace
              ), 
             React.DOM.br(null), 
             React.DOM.div({className: "templateDetails"}, 
               React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, 
                 "Created by Mark on Jul. 21, 2014"
               ), 
               React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, 
                 "last updated 7 days ago"
               )
             ), 
            React.DOM.br(null), 
            React.DOM.div({className: "panel panel-default"}, 
              React.DOM.div({className: "panel-body summer template-body"}
              )
            )
        )
      )
    )
    );
  }
});

},{}]},{},[1])


},{}],10:[function(require,module,exports){
/** @jsx React.DOM */

var Templates = require('./templates.js.min.js');
var Schedules = require('./schedule.js.min.js');
var Campaigns = require('./campaigns.js.min.js');
var SentMail = require('./sent_mail.js.min.js');
var FollowupFeed = require('./followup_feed.js.min.js');
var CampaignDetail = require('./campaign_detail.js.min.js');
var CreateCampaignModal = require('./create_campaign.js.min.js');

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      selectedScreen: 'Campaigns',
      selectedCampaign:'',
      prospectLists: [],
      campaigns: []
    }
  },

  deleteCampaign: function(objectId) {
    // sweetAlert
    console.log(this.state.campaigns)
    campaigns = _.filter(this.state.campaigns, function(campaign) {
      return campaign.objectId != objectId
    })
    console.log(campaigns)
    this.setState({campaigns: campaigns})
    $.ajax({
      url:'https://api.parse.com/1/classes/Campaign/'+objectId,
      type:'DELETE',
      headers:appConfig.headers,
      success: function(res) { console.log(res) },
      error: function(err) { console.log(err) }
    })
    // persist
    // error log
  },

  componentDidMount: function() {
    thiss = this;
     company = JSON.parse(localStorage.currentUser).company
     user = appConfig.pointer('_User', JSON.parse(localStorage.currentUser).objectId)
     qry = {
       where : JSON.stringify({
         user: user,
         company: company
       }),
       include: 'prospect_list,followups,followups.template,batches',
       order: '-createdAt'
     }
     $.ajax({
       url:'https://api.parse.com/1/classes/Campaign',
      headers: appConfig.headers,
      data: qry,
      success: function(res) {
        console.log(res.results)
        thiss.setState({campaigns: res.results})
        // Find All Prospects In ProspectList that are not in any batches
      },
      error: function(err) {
        console.log('error')
        console.log(err)
      }
     });
    $.ajax({
      url: 'https://api.parse.com/1/classes/ProspectList',
      data: {
        order: '-createdAt',
        where : JSON.stringify({
          user: appConfig.user,
          company: appConfig.company,
        })
      },
      headers: appConfig.headers,
      success: function(res) {
        console.log('PROSPECT LISTS')
        console.log(res.results)
        thiss.setState({prospectLists: res.results})
      },
      error: function(err) {

      }
    })


  },
  
  toggleScreen: function(screen) {
    this.setState({selectedScreen : screen})
  },

  changeSelectedCampaign: function(screen, selectedCampaign) {
    console.log(selectedCampaign)
    this.setState({
      selectedCampaign : selectedCampaign,
      selectedScreen: screen,
    })
  },

  render: function() {
    thiss = this
    console.log(this.state.selectedCampaign)
    console.log(this.state.selectedScreen)
    console.log(this.state.campaigns)
    switch (this.state.selectedScreen){
      case 'Campaigns':
        CurrentScreen = Campaigns({campaigns: thiss.state.campaigns, 
                            changeSelectedCampaign: thiss.changeSelectedCampaign, 
                            deleteCampaign: this.deleteCampaign, 
                            toggleScreen: thiss.toggleScreen})
        break;
      case 'CampaignDetail':
        CurrentScreen = CampaignDetail({
                        selectedCampaign: thiss.state.selectedCampaign, 
                      selectedCampaignObjectId: thiss.state.selectedCampaginObjectId, 
                        toggleScreen: thiss.toggleScreen})
        break;
      case 'Templates':
        CurrentScreen = Templates(null)
        break;
      case 'Overview':
        CurrentScreen = Campaigns({campaigns: thiss.state.campaigns, 
                            changeSelectedCampaign: thiss.changeSelectedCampaign, 
                            toggleScreen: thiss.toggleScreen})
        break;
      case 'Sent Mail':
        CurrentScreen = SentMail(null)
        break;
      case 'Followup Feed':
        CurrentScreen = FollowupFeed(null)
        break;
      case 'Schedules':
        CurrentScreen = Schedules(null)
        break;
    }

    return (
      React.DOM.div({className: "", style: {height:'550px'}}, 
        React.DOM.div({className: "container", style: {padding:'0',width:'100%',height:'100%'}}, 
          SideMenu({
                createCampaign: this.createCampaign, 
                prospectLists: this.state.prospectLists, 
                toggleScreen: this.toggleScreen}), 
              React.DOM.div({className: "col-md-10", 
                   style: {padding:'0',height:'100%'}}, 
            CurrentScreen
          )
        )
      )
    );
  },

  persistCampaign: function(newCampaign) {
    Campaign = {}
    Campaign.name = newCampaign.name
    Campaign.user = appConfig.pointer('_User', JSON.parse(localStorage.currentUser).objectId)
    Campaign.company = JSON.parse(localStorage.currentUser).company
    var thiss = this;

    $.ajax({
      url:'https://api.parse.com/1/classes/Campaign',
      type:'POST',
      headers:appConfig.headers,
      data:JSON.stringify(Campaign),
      success: function(res) {
        the_campaign = _.find(thiss.state.campaigns, function(campaign){
          first = campaign.name == newCampaign.name 
          second = campaign.prospect_list == newCampaign.prospect_list
          return first && second
        })
        console.log(res)
        console.log(res.objectId)

        the_campaign.objectId = res.objectId
        campaigns = _.filter(thiss.state.campaigns, function(campaign){
          first = campaign.name == newCampaign.name 
          second = campaign.prospect_list == newCampaign.prospect_list
          return !(first && second)
        })
        campaigns.push(the_campaign)
        console.log(campaigns)

        thiss.setState({campaigns:  campaigns})

        $.ajax({
          url:'https://api.parse.com/1/classes/Campaign/'+res.objectId,
          type:'PUT',
          data: JSON.stringify({prospect_list:{
            '__type':'Pointer',
            'className':'ProspectList',
            'objectId':newCampaign.prospect_list.objectId,
          }}),
          headers:appConfig.headers,
          success: function(res){
          },
          error: function() {

          }
        })
      },
      error: function(err) {
        console.log(err)
      }
    });
  },

  createCampaign: function(newCampaign) {
    campaigns = this.state.campaigns
    campaigns.push(newCampaign)
    this.setState({campaigns: campaigns})
    console.log(newCampaign)

    $('.modal').click()
    $('.modal-backdrop').click()

    this.persistCampaign(newCampaign)
  }
});

var SideMenu = React.createClass({displayName: 'SideMenu',
  toggleScreen: function(e) {
    this.props.toggleScreen($(e.target).text().trim())
  },

  /*
    <button type="button" className="sharp btn btn-default" onClick={this.toggleScreen}>
      <i className="fa fa-file-text" /> &nbsp; Templates
    </button>
    <button type="button" className="sharp btn btn-default" onClick={this.toggleScreen}>
      <i className="fa fa-clock-o" /> &nbsp; Schedules
    </button>
  */
  createCampaignModal: function() {

  },

  render: function() {
    return (
      React.DOM.div({className: "col-md-2", 
        style: {padding:'0',height:'100%', backgroundColor:'rgb(90, 107, 119)',borderBottomLeftRadius:'3px'}}, 
        React.DOM.div({className: "btn-group-vertical", style: {width:'100%'}}, 
          React.DOM.button({type: "button", 
                  className: "sharp btn btn-default", 
                  onClick: this.toggleScreen}, 
            React.DOM.span({style: {marginLeft:'27px'}}, "Overview")
          ), 
          React.DOM.button({type: "button", 
                  className: "sharp btn btn-default", 
                  onClick: this.toggleScreen}, 
            React.DOM.i({className: "fa fa-newspaper-o"}), "  ",  
            React.DOM.span({style: {marginLeft:'4px'}}, "Followup Feed")
          ), 
          React.DOM.button({type: "button", style: {display:'none'}, 
                  className: "sharp btn btn-default"}, 
            React.DOM.i({className: "fa fa-code-fork"}), "  ",  
            React.DOM.span({style: {marginLeft:'4px'}}, "Rules")
          ), 
          React.DOM.button({type: "button", style: {display:'none'}, 
                  className: "sharp btn btn-default", onClick: this.toggleScreen}, 
            React.DOM.i({className: "fa fa-pie-chart"}), "   Analytics"
          ), 
          React.DOM.button({type: "button", 
                  className: "sharp btn btn-default", 
                  onClick: this.toggleScreen}, 
            React.DOM.i({className: "fa fa-paper-plane"}), "   Sent Mail"
          )
        ), 

        React.DOM.div({className: "", style: {width:'100%',textAlign:'center',marginTop:100}}, 
          React.DOM.a({href: "javascript:", className: "btn btn-primary new-list-btn", 
                'data-toggle': "modal", 'data-target': ".bs-createCampaign-modal-sm", 
                style: { backgroundImage: 'linear-gradient(180deg, #0096ff 0%, #005dff 100%)'}}, 
            React.DOM.i({className: "fa fa-plus-circle"}), "  New Campaign"
          )
        ), 
        CreateCampaignModal({prospectLists: this.props.prospectLists, 
                             createCampaign: this.createCampaign})
      )
    );
  },

  createCampaign: function(newCampaign) {
    this.props.createCampaign(newCampaign)
  }
});

},{"./campaign_detail.js.min.js":2,"./campaigns.js.min.js":6,"./create_campaign.js.min.js":7,"./followup_feed.js.min.js":11,"./schedule.js.min.js":13,"./sent_mail.js.min.js":15,"./templates.js.min.js":16}],11:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // FollowupFeed
  getInitialState: function() {
    return {
      scheduledFollowups: []
    }
  },


  render: function() {
    scheduledFollowups = []
    for(i=0;i< this.state.scheduledFollowups.length; i++){ 
      scheduledFollowups.push(ScheduledFollowupRow(null))
    }

    return (
      React.DOM.div({style: {overflow:'auto', height:550}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th({style: {textAlign:'center'}}, "Status")
          ), 
          React.DOM.tbody(null, 
            scheduledFollowups
          )
        )
      )
    );
  }
});

var ScheduledFollowupRow = React.createClass({displayName: 'ScheduledFollowupRow',
  render: function() {
    return (
      React.DOM.tr(null

      )
    );
  }
})

},{}],12:[function(require,module,exports){
/** @jsx React.DOM */
var SendEmailModal = require('./send_email_modal.js.min.js')
var TimelineDayElement = require('./timeline_day_element.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  // FollowupTimeline
  getInitialState: function() {
    initialFollowups = this.props.initialFollowups
    initialFollowups = (initialFollowups) ? initialFollowups : []
    batches = this.props.selectedCampaign.batches
    batches = (batches) ? batches : []
    return {
      followups: _.compact(initialFollowups),
      loading: false,
      currentTemplate:'',
      currentBatch: '',
      batches : batches
    }
  },

  componentDidMount: function() {
    thiss = this;
    $('.day').tooltip({
      placement: 'right',
      title:'+ Add a follow-up'
    })

    console.log(this.props.selectedCampaign)
     company = JSON.stringify(JSON.parse(localStorage.currentUser).company)
     currentCampaign = appConfig.pointer('Campaign', this.props.selectedCampaign.objectId)
     $.ajax({
       url:'https://api.parse.com/1/classes/Followup',
       type:'GET',
       headers: appConfig.headers,
       data: {
         where: JSON.stringify({
           campaign: currentCampaign,
           company: appConfig.company
         }),
         include:'template',
       },
       success: function(res) {
         console.log('followup timeline')
         console.log(res.results)
       },
       error: function(err) {
         console.log('error')
         console.log(err)
       }
     })
  },

  addFollowupSentToBatch: function(batch, followup) {
    batches = _.map(this.state.batches, function(_batch) {
                  if(_batch.objectId == batch.objectId) {
                    if(_batch.followups)
                      _batch.followups.push(followup)
                    else
                      _batch.followups = [followup]
                  }
                  return _batch
              })
    // Persist
  },
  
  render: function() {
    timelineElements = []
    followups = this.state.followups

    batches = _.map(this.state.batches, function(batch) {
      if(batch){
        now = moment().startOf('day').valueOf()
        batch.currentDay = moment(batch.started).diff(moment(now),  'days') * -1
        return batch
      }
    })
    batches = _.compact(batches)

    for(i=0;i< 31;i++){
      followup = _.findWhere(this.state.followups, {day: i})
      var elementType = (followup) ? true : false
      var currentTemplate = (followup) ? followup.template : false
      var addTemplateMode = (followup) ? followup.addTemplateMode : true
      campaign = this.props.selectedCampaign

      currentBatch = {}
      batch_started_today = false
      alreadySent = false
      batchCount = undefined
      if(i == 0) {
        batchCount = (batches) ? this.props.newProspects.length : this.props.prospects.length
      } else {
        batch = _.findWhere(batches, {currentDay: i})
        if(batch) {
          currentBatch = batch.objectId
          console.debug(batch.objectId)
          batchCount = "~"
          if(followup) {
            _batches = followup.batches
            alreadySent = _.findWhere(_batches, _.pick(batch,'objectId'))
          }
        }
      }

      timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                    dayCount: i, 
                                    elementType: !elementType, 
                                    currentTemplate: currentTemplate, 
                                    batchCount: batchCount, 
                                    currentBatch: currentBatch, 
                                    alreadySent: alreadySent, 
                                    addTemplateMode: addTemplateMode, 
                                    templates: this.props.templates, 
                                    newProspects: this.props.newProspects, 
                                    addFollowup: this.addFollowup, 
                                    editFollowup: this.editFollowup, 
                                    saveFollowup: this.saveFollowup, 
                                    removeFollowup: this.removeFollowup, 
                                 addFollowupSentToBatch: this.addFollowupSentToBatch, 
                                    batches: this.props.selectedCampaign.batches, 
                                    prospectListCount: this.props.prospectListCount, 
                                    setCurrentBatch: this.setCurrentBatch, 
                                    setCurrentTemplate: this.setCurrentTemplate})
                                  ))

      if(i == 0 && _.findWhere(batches, {currentDay: 0})){
          currentBatch = _.findWhere(batches, {currentDay: 0}).objectId
          console.debug('0.5')
          console.debug(currentBatch)
          batchCount = "~"
          timelineElements.push(React.DOM.div(null, TimelineDayElement({
                                  dayCount: 0.5, 
                                  batchCount: batchCount, 
                                  currentBatch: currentBatch, 
                                  newProspects: this.props.newProspects, 
                                  elementType: true, 
                                  batches: this.props.selectedCampaign.batches, 
                                  prospectListCount: this.props.prospectListCount, 
                                  setCurrentBatch: this.setCurrentBatch})
                                ))
      }
    }
    return (
      React.DOM.div(null, 
        React.DOM.div({className: "timeline", 
             style: {height:'100%',backgroundColor:'rgb(90, 107, 119)', width:5,marginTop:-35}}, 
             timelineElements
        ), 
        SendEmailModal({prospects: this.props.prospects, 
                        selectedCampaign: this.props.selectedCampaign, 
                        newProspects: this.props.newProspects, 
                        addFollowupSentToBatch: this.addFollowupSentToBatch, 
                        currentBatch: this.state.currentBatch, 
                        currentTemplate: this.state.currentTemplate})
      )
    );
  },

  createFollowup: function() {
    //
  },         

  addFollowup: function(day) {
    //console.log('called template edit menu')
    followups = this.state.followups
    followups.push({addTemplateMode: true, day: day})
    this.setState({ followups: followups })
  },

  editFollowup: function(day) {
    // find template set editmode is false
    followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){ followup.addTemplateMode = true }
      return followup
    })
    this.setState({followups: followups})
  },

  saveFollowup: function(day, chosenTemplate) {
    new_followups = _.map(this.state.followups, function(followup) {
      if(followup.day == day){
        followup.addTemplateMode = false
        followup.template = chosenTemplate
      }
      return followup
    })
    this.setState({followups: new_followups})
    followup = _.findWhere(new_followups, {day: day})

      if(followup.objectId){
        url = "/"+followup.objectId; type="PUT"
        data = {template: appConfig.pointer('Template', chosenTemplate.objectId)}
      } else {
        url = ""; type="POST";

          data = {
            day: day,
            campaign : appConfig.pointer('Campaign', 
                                         this.props.selectedCampaign.objectId),
            template: appConfig.pointer('Template', chosenTemplate.objectId),
          }
      }

    thiss = this;
    $.ajax({
      url:'https://api.parse.com/1/classes/Followup'+url,
      type:type,
      data:JSON.stringify(data),
      headers:appConfig.headers,
      success: function(res) {
        new_followups = _.map(new_followups, function(followup) {
          if(followup.day == day) { followup.objectId = false }
          return followup
        })
        thiss.setState({followups: new_followups})

        console.log(res)
        $.ajax({
          url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
          type:'PUT',
          data:JSON.stringify({followups: {
            __op: 'AddUnique',
            objects:[appConfig.pointer('Followup', res.objectId)]
          }}),
          headers:appConfig.headers,
          success: function() { },
          error: function() { }
        })
      },
      error: function() { },
    })
  },

  removeFollowup: function(day) {
    followups = []
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day != day)
        followups.push(this.state.followups[i])
      
    for(i=0;i< this.state.followups.length;i++)
      if(this.state.followups[i].day == day)
        break
    
    this.setState({followups: followups}) 
    id = this.state.followups[i]

    thiss = this;
    if(id) {
      id = id.objectId
      $.ajax({
        url:'https://api.parse.com/1/classes/Followup/'+id,
        headers:appConfig.headers,
        type:'DELETE',
        success: function(res) { console.log(res) }
      })

     console.log('REMOVE ARRAY')
      $.ajax({
        url:'https://api.parse.com/1/classes/Campaign/'+thiss.props.selectedCampaign.objectId,
        headers:appConfig.headers,
        type:'PUT',
        data: JSON.stringify({
          followups: {
            __op : 'Remove',
            objects: [appConfig.pointer('Followup', id)]
          }
        }),
        success: function(res){ console.log(res) },
        error: function() { }
      })
    }
  },

  setCurrentBatch: function(currentBatch) {
    this.setState({currentBatch: currentBatch})
  },

  setCurrentTemplate: function(template) {
    this.setState({currentTemplate: template })
  }
});

},{"./send_email_modal.js.min.js":14,"./timeline_day_element.js.min.js":18}],13:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  render: function() {
    return (
      React.DOM.div(null, 
        "Scheduls"
      )
    );
  }
});

},{}],14:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  getInitialState: function() {
    return {
      currentProspect: 0,
    }
  },

  sendEmails: function() {
    selectedCampaign = this.props.selectedCampaign
    campaign_id = selectedCampaign.objectId
    prospectlist_id = selectedCampaign.prospect_list.objectId
    template_id = this.props.currentTemplate.objectId
    
    $.ajax({
      //url:'https://nameless-retreat-3525.herokuapp.com/send_email',
      url:'http://127.0.0.1:5000/v1/campaign/email',
      data: {
        template : template_id,
        campaign : campaign_id,
        //batch: batch_id
      },
      success: function(res) { console.log(res.results) },
      error: function(err) { console.log(err) }
    })

    /* */
    // Update Followup
    // Persist Followup
    // close modal
  },

  render: function() {
    prospect = this.props.prospects[this.state.currentProspect]
    prospect = (prospect) ? prospect : {'name':'','email':''}

    var thiss = this;
    console.debug('SEND EMAIL BATCH')
    console.debug(this.props.currentBatch)
    newBatch = _.isEqual(this.props.currentBatch, {})
    prospects = (newBatch) ? this.props.newProspects : this.props.prospects
    if(newBatch){
      prospects = _.map(this.props.newProspects, function(prospect) {
          return UserPlaceHolder({prospect: prospect})
      })
    } else {
      prospects = _.map(this.props.prospects, function(prospect) {
        if(_.findWhere(prospect.batches, {objectId: thiss.props.currentBatch}))
          return UserPlaceHolder({prospect: prospect})
      })
    }
    prospects = _.compact(prospects)
    console.debug(prospects)
    console.debug(prospects.length)
    prospectCount = prospects.length
    email = (prospect.email) ? prospect.email : ""
    if(email == "no_email" || email == "") {
      console.log('GUESSING')
      if(prospect.email_guesses) {
        console.log('GUESSING EMAIL')
        guess = _.findWhere(prospect.email_guesses, {tried: false})
        name = _.title(prospect.name.trim())

        vars = {
          first: _.first(name.split(' ')).replace(/\W/g, ''),
          last: _.last(name.split(' ')).replace(/\W/g, ''),
          fi: _.first(name.split(' '))[0].replace(/\W/g, ''),
          li: _.last(name.split(' '))[0].replace(/\W/g, '')
        }
        if(guess){
          console.log(guess.pattern.pattern)
          email = Mustache.render(guess.pattern.pattern, vars)
          email = email+"@"+prospect.domain
        }
      } else {
        console.log('NO GUESSES FOUND')
      }
    }
    email = email.toLowerCase()
    email = email
    return (
      React.DOM.div({className: "modal fade bs-sendEmail-modal-lg", tabIndex: "-1", 
           role: "dialog", 'aria-labelledby': "mySmallModalLabel", 'aria-hidden': "true", 
           id: "sendEmailModal", style: {top:'10px'}}, 
            React.DOM.div({className: "modal-dialog modal-lg"}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.button({type: "button", className: "close", 'data-dismiss': "modal"}, React.DOM.span({'aria-hidden': "true"}, "×"), 
                    React.DOM.span({className: "sr-only"}, "Close")), 
        React.DOM.button({type: "button", 
                onClick: this.sendEmails, 
                style: {float:'right'}, 
                className: "btn btn-primary btn-sm"}, 
                React.DOM.i({className: "fa fa-paper-plane"}), "  Send Email"), 
        React.DOM.button({type: "button", style: {marginRight:10, float:'right'}, 
                className: "btn btn-default btn-sm", 'data-dismiss': "modal"}, "Close"), 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    React.DOM.i({className: "fa fa-envelope"}), "  Send Email" + ' ' +
                    "  ", 
                    React.DOM.small(null, "("+prospectCount+")")
                  )
                ), 
                React.DOM.div({className: "modal-body", style: {paddingTop:5}}, 
                  React.DOM.h4(null, "People"), 
                  
                  React.DOM.div({className: "prospect-container"}, 
                    prospects
                  ), 
                  React.DOM.br(null), 
                  React.DOM.h4({style: {display:'inline-block'}}, "Emails    ", 
                  React.DOM.a({href: "javascript:", 
              className: (this.state.currentProspect == 0 ) ? "badge btn disabled" : "badge btn", 
                    onClick: this.previousProspect}, React.DOM.i({className: "fa fa-arrow-left"})), "  ", 
                    React.DOM.small(null, (this.state.currentProspect+1)+' of '+prospectCount
                  )), 
                  "   ", 
                  React.DOM.a({href: "javascript:", 
            className: (this.state.currentProspect ==  this.props.prospects.length-1) ? "btn disabled badge" : "btn badge", 
                    onClick: this.nextProspect}, React.DOM.i({className: "fa fa-arrow-right"})), 

                  React.DOM.div(null, 

React.DOM.ul({className: "list-group email-holder", style: {borderTop:'solid 1px #eee'}}, 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "To:  "), 
    
    React.DOM.span({className: "label label-primary"}, email)
  ), 
  React.DOM.li({className: "list-group-item"}, 
    React.DOM.h5({style: {display:'inline-block',marginTop:0,marginBottom:0}}, "Subject:  "), " ", React.DOM.span({className: "label label-primary"}, this.props.currentTemplate.subject)
  ), 
  React.DOM.li({className: "list-group-item body"})
)
  
                  )

                ), 

      React.DOM.div({className: "modal-footer", style: {display:'none'}}, 
        React.DOM.button({type: "button", 
                className: "btn btn-default", 'data-dismiss': "modal"}, "Close"), 
        React.DOM.button({type: "button", 
                className: "btn btn-primary"}, "Send Email")
      )
              )
            )
          )
    );
  },

  previousProspect: function() {
    this.setState({currentProspect: this.state.currentProspect-1 })
  },

  nextProspect: function() {
    this.setState({currentProspect: this.state.currentProspect+1 })
  },

  parseTemplate: function(templateBody) {
    first_name = prospect.name.split(' ')[0]
    //hiring_signal = prospect.signals

    signals = (prospect.signals) ? prospect.signals[0] : ""
    templateBody = Mustache.render(templateBody, {
      hiring_signal: signals,
      first_name: _.title(prospect.name.split(' ')[0])
    })

    //console.log(templateBody)
      
    return templateBody
  },

  componentDidUpdate: function() {
    //console.log(this.props.currentTemplate)
    parsedTemplate = this.parseTemplate(this.props.currentTemplate.body)
    
    //$('.body').html(this.props.currentTemplate.body)
    $('.body').html(parsedTemplate)
  }
});

var UserPlaceHolder = React.createClass({displayName: 'UserPlaceHolder',
  render: function() {
    return (
        React.DOM.div({className: "btn-group", style: {marginRight:5,marginBottom:5}}, 
          React.DOM.div({className: "btn-group"}, 
            React.DOM.button({type: "button", 
                    className: "btn btn-success btn-sm"}, 
              React.DOM.i({className: "fa fa-user"}), "  ", 
              (this.props.prospect) ? _.title(this.props.prospect.name) : ""
            )
          ), 
          React.DOM.button({type: "button", className: "btn btn-success btn-sm"}, 
            React.DOM.i({className: "fa fa-trash-o"})
          )
        )
    )
  }
});

},{}],15:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // Sent Mail
  getInitialState: function() {
    return {
      sentEmails: []
    }
  },

  componentDidMount: function() {
    thiss = this;
    $.ajax({
      url: 'https://api.parse.com/1/classes/SentEmail',
      data:{include: 'campaign,prospect,prospect.email_guesses.pattern'},
      headers: appConfig.headers,
      success: function(res) { thiss.setState({sentEmails: res.results}) },
      error: function() {}
    })
  },

  render: function() {
    sentEmails = []
    for(i=0;i< this.state.sentEmails.length; i++) 
      sentEmails.push(SentEmailRow({sentEmail: this.state.sentEmails[i]}))

    return (
      React.DOM.div({style: {overflow:'auto',height:550}}, 
        React.DOM.table({className: "table table-striped", style: {marginBottom:0}}, 
          React.DOM.thead(null, 
            React.DOM.th(null), 
            React.DOM.th(null, "Prospect Name"), 
            React.DOM.th(null, "Prospect Email"), 
            React.DOM.th({style: {width:290}}, "Status"), 
            React.DOM.th(null, "Campaign"), 
            React.DOM.th(null, "Template")
          ), 
          React.DOM.tbody(null, 
            sentEmails
          )
        )
      )
    );
  }
});

var SentEmailRow = React.createClass({displayName: 'SentEmailRow',
  render: function() {
    sentEmail = this.props.sentEmail
    //console.log(sentEmail)

    email = sentEmail.email
    if(email == "no_email"){
      first = sentEmail.prospect.name.split(' ')[0]
      last = _.last(sentEmail.prospect.name.split(' '))

      pattern = _.findWhere(sentEmail.prospect.email_guesses, {'tried':false})
      data = {first: first, last: last, fi: first[0], li: last[0]}
      email = Mustache.render(pattern.pattern.pattern, data).toLowerCase()
    }

    return (
      React.DOM.tr(null, 
        React.DOM.td(null, React.DOM.h6(null, 
            React.DOM.i({className: "fa fa-clock"}), 
            moment(sentEmail.createdAt).fromNow())), 
        React.DOM.td(null, 
          React.DOM.h6({style: {fontSize:14,fontWeight:'bold',marginBottom:0}}, sentEmail.prospect.name), 
          React.DOM.h6({style: {marginTop:4,marginBottom:0}}, sentEmail.prospect.pos.trim()), 
          React.DOM.h6({style: {marginTop:4}}, sentEmail.prospect.company_name)
        ), 
        React.DOM.td(null, React.DOM.h6(null, email)), 
        React.DOM.td({style: {paddingTop:13}}, 
          React.DOM.span({className: "label label-default"}, "Queued"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: "label label-success"}, "Opened"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: "label label-default"}, "Delivered"), 
          React.DOM.i({className: "fa fa-chevron-circle-right text-muted", 
             style: {paddingLeft:5,paddingRight:5}}), 
          React.DOM.span({className: "label label-default"}, "Replied")
        ), 
        React.DOM.td(null, 
          React.DOM.h6({style: {cursor:'pointer'}}, 
          React.DOM.i({className: "fa fa-list-alt"}), "  " + ' ' +
          "Boston VP Sales - Retail"
          )
        ), 
        React.DOM.td(null, 
          React.DOM.h6({style: {cursor:'pointer'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  " + ' ' +
          "Followup #2 - Provide Value ", React.DOM.br(null), 
          React.DOM.span({className: "text-muted"}, " Subject: Just wanted to followup on the last email "), React.DOM.br(null), 
          React.DOM.span({className: "text-muted"}, " Body: Just wanted to followup on the last email ")

          )
        )
      )
    )
  }
})

},{}],16:[function(require,module,exports){
/** @jsx React.DOM */

var EditTemplateView = require('./edit_template.js.min.js')

module.exports = React.createClass({displayName: 'exports',
  //Templates
  getInitialState: function() {
    return {
      selectedTemplate: 0,
      editMode: false
    }
  },

  changeMode: function() {
    this.setState({editMode: !this.state.editeMode})
  },

  render: function() {
    templateView = (!this.state.editMode) ? TemplateView({changeMode: this.changeMode}) : EditTemplateView(null)
    return (
      React.DOM.div(null, 
        React.DOM.div({style: {height:'100%'}}, 
          TemplateSideMenu(null), 
          React.DOM.div({className: "col-md-9", style: {padding:0,height:'100%'}}, 
              templateView
          )
        )
      )
    );
  }
});


var TemplateView = React.createClass({displayName: 'TemplateView',
  changeMode: function() {
    this.props.changeMode()
  },
  render: function() {
    return (
      React.DOM.div({className: "panel panel-info", style: {width:'100%',height:'100%',border:0}}, 
        React.DOM.div({className: "panel-heading"}, 
          "Template Name",  
          React.DOM.a({href: "javascript:", 
             onClick: this.changeMode, 
             className: "btn btn-primary btn-xs", 
             style: {display:'block',float:'right',marginTop:'0px'}}, 
            React.DOM.i({className: "fa fa-pencil-square"}), "   Edit Template")
        ), 
        React.DOM.div({className: "panel-body"}, 
        React.DOM.h4(null, "Followup - Prospecting SAAS Outreach"), 
        React.DOM.h6({style: {marginBottom:'0'}, className: "text-muted"}, "Created by Mark on Jul. 21, 2014"), 
        React.DOM.h6({style: {marginTop:'0'}, className: "text-muted"}, "last updated 7 days ago"), 
        React.DOM.br(null), 
        React.DOM.br(null), 

        React.DOM.div({className: "panel panel-default"}, 

          React.DOM.div({className: "panel-body"}, 
          "15 minutes to get company_name more customers" + ' ' +
          "Hey first_name," + ' ' +

          "Would you like to hear an idea for a 15 minute hack that could significantly increase the number of prospects your sales people have access to ?" + ' ' +
           
          "Recently one of our B2B clients saw a huge increase in trial sign ups after working with us. first_name, lets schedule a 15 minute call this week to see if this would be a good fit for both of us." + ' ' +
           
          "What the best time for you this week ?" + ' ' +
           
          "--" + ' ' +
          "Mark" + ' ' + 
          "Customero" + ' ' +
          "mark@customerohq.com"
          
          )
        )
      )
    )
    );
  },
});

var TemplateSideMenu = React.createClass({displayName: 'TemplateSideMenu',
  getInitialState: function() {
    return {
      templates: [],
    }
  },

  componentDidMount: function() {
    //Ajax Request For Templates
    /*
     $.ajax({
      url:'',
      headers: "",
      data: "",
      success: function() {
      },
      error: function() {
      }
     });
    */
  },

  render: function() {
    templates = []
    for(i=0;i< this.state.templates.length; i++)
      templates.push(React.DOM.a({href: "javascript:", className: "list-group-item"}, "templates[i].name"))
    return (
      React.DOM.div({className: "col-md-3", style: {padding:'0', borderRight:'1px solid #ddd',height:'100%',textAlign:'center'}}, 
        React.DOM.div({className: "panel panel-default", style: {border:0}}, 
          React.DOM.div({className: "panel-heading", style: {height:60}}, 
            React.DOM.span({style: {float:'left',fontSize:20,fontWeight:'bold'}}, 
              "Templates"
            ), 
            React.DOM.a({href: "javascript:", className: "btn btn-success ", 
                style: {float:'right'}}, 
              React.DOM.i({className: "fa fa-plus"})
            )
          ), 
          React.DOM.ul({className: "list-group", style: {textAlign:'left'}}, 
            templates
          )
        )
      )
    )
  }
});

},{"./edit_template.js.min.js":9}],17:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  //TemplatesMenu
  toggleTemplateEditMenu: function(currentTemplate) {
    this.props.toggleTemplateEditMenu(currentTemplate)
  },

  createTemplate: function() {
    this.props.toggleTemplateEditMenu({
      name: '',
      body:'',
      subject:'',
      editMode:true,
      newTemplate: true
    }, true)
  },

  render: function() {
    //console.log(this.props.templates)
    templates = []
    for(i=0;i< this.props.templates.length; i++) {
      templates.push(
        TemplateListItem({
          toggleTemplateEditMenu: this.toggleTemplateEditMenu, 
          template: this.props.templates[i]})
      )
    }

    return (
      React.DOM.div({className: "", style: {padding:'0', height:'100%',textAlign:'center'}}, 
        React.DOM.div({className: "panel panel-default", 
             style: {borderRight:0,borderRadius:0,height:'100%', overflow:'auto'}}, 
          React.DOM.div({className: "panel-heading", style: {height:40}}, 
            React.DOM.span({style: {float:'left',fontSize:14,fontWeight:'bold'}}, 
              React.DOM.i({className: "fa fa-file-text-o"}), 
              React.DOM.span({style: {marginLeft:5}}, "Templates")
            ), 
            React.DOM.a({href: "javascript:", 
              className: "btn btn-success btn-xs", 
              onClick: this.createTemplate, 
                style: {float:'right'}}, 
              React.DOM.i({className: "fa fa-plus"}), 
              React.DOM.span({style: {marginLeft:5}}, "Create Template")
            )
          ), 
          React.DOM.ul({className: "list-group", 
              style: {textAlign:'left'}}, 
            templates
          )
        )
      )
    )
  }
});

var TemplateListItem = React.createClass({displayName: 'TemplateListItem',
  toggleTemplateEditMenu: function() {
    console.log(this.props.template)
    template = this.props.template
    template.editMode = false
    this.props.toggleTemplateEditMenu(template)
  },

  render: function() {
    return (
      React.DOM.div(null, 
        React.DOM.a({href: "javascript:", 
          style: {borderBottom: '1px solid rgb(221, 221, 221)',paddingTop:5,paddingBottom:0}, 
           onClick: this.toggleTemplateEditMenu, 
           className: "list-group-item"}, 
           React.DOM.span({className: "label label-default"}, 
             this.props.template.name
           ), 
           React.DOM.h6(null, "Subject:", React.DOM.span({className: "text text-muted"}, 
             " " + this.props.template.subject
           ))
         )
      )
    );
  }
});

},{}],18:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // TimelineDayElement
  // TODO
  // - add prospect list progression
  // - add scheduled followup
  //
  getInitialState: function() {
    // 
    return {
      followupCompleted: 0,
    }
  },

  addFollowup: function() {
    this.props.addFollowup(this.props.dayCount)
  },

  render: function() {
    if(this.props.addTemplateMode) {
      mode = EditTemplate({addFollowup: this.props.addFollowup, 
                           saveFollowup: this.props.saveFollowup, 
                           removeFollowup: this.props.removeFollowup, 
                           dayCount: this.props.dayCount, 
                           templates: this.props.templates})
    } else {
      mode = TemplateFollowup({currentTemplate: this.props.currentTemplate, 
                               editFollowup: this.props.editFollowup, 
                               dayCount: this.props.dayCount, 
                               currentBatch: this.props.currentBatch, 
                               hasBatch: typeof(this.props.batchCount) != "undefined" && this.props.batchCount > 0, 
                               setCurrentBatch: this.props.setCurrentBatch, 
                               dayCount: this.props.dayCount, 
                               removeFollowup: this.props.removeFollowup, 
                               setCurrentTemplate: this.props.setCurrentTemplate})
    }
    if(this.props.alreadySent) {
      mode = FollowupCompleted({currentTemplate: this.props.currentTemplate})
    }

    mode = (this.props.elementType) ? "" : mode
    addFollowup = (this.props.elementType) ? this.addFollowup : ""
    if(typeof(this.props.batchCount) != "undefined")
      batchStage = BatchStage({currentBatch: this.props.currentBatch, 
                               newProspects: this.props.newProspects, 
                               prospectListCount: this.props.prospectListCount, 
                               batchCount: this.props.batchCount, 
                               hasScheduledEmail: mode != "", 
                               dayCount: this.props.dayCount})
    else
      batchStage = ""

    dayCount = (this.props.dayCount != 0.5) ? "D"+this.props.dayCount : ""

    return (
      React.DOM.div(null, 
        React.DOM.div({onClick: addFollowup, className: "day", 'data-trigger': "manual"}, 
          dayCount
        ), 
        mode, batchStage
      )
    )
  },

  setCurrentTemplate: function(template) {
    this.props.setCurrentTemplate(template)
  }
});

var FollowupCompleted = React.createClass({displayName: 'FollowupCompleted',
  render: function() {
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs disabled", 
                'data-target': ".bs-sendEmail-modal-lg", 
                onClick: this.setCurrentTemplate, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-check"}), " Sent"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"}))
      )
                                         )
  }
})

var TemplateFollowup = React.createClass({displayName: 'TemplateFollowup',
  // EditMode False

  setCurrentTemplate: function() {
    this.props.setCurrentTemplate(this.props.currentTemplate)
    // setCurrentBatch
    this.props.setCurrentBatch(this.props.currentBatch)
    $('.bs-sendEmail-modal-lg').modal()
  },

  waitForBatch: function() {
    alertify.log("You must wait for a batch!");
  },

  render: function() {
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:130,display:'inline-block'}}, 
          React.DOM.i({className: "fa fa-file-text-o"}), "  ", 
          (this.props.currentTemplate) ? this.props.currentTemplate.name : ""
        ), 
        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
          onClick: (this.props.hasBatch) ? this.setCurrentTemplate : this.waitForBatch, 
                'data-toggle': "modal"}, 
          React.DOM.i({className: "fa fa-paper-plane"}), " Send"), " ", 
        React.DOM.button({onClick: this.editFollowup, 
                className: "win-btn btn btn-default btn-xs"}, 
          React.DOM.i({className: "fa fa-pencil"})), " ", 
        trash
      )
    );
  },

  editFollowup: function(e) { 
    e.preventDefault()
    console.log(this.props.dayCount)
    this.props.editFollowup(this.props.dayCount)
  },

  removeFollowup: function() {
    console.log('remove')
    this.props.removeFollowup(this.props.dayCount)
  }
});

var BatchStage = React.createClass({displayName: 'BatchStage',
  // Different Stages of People Added to Prospect List
  getInitialState: function() {
    return {
      initialBatchCount: this.props.batchCount
    }
  },

  componentDidMount: function() {
    // state
    //console.debug('INSIDE BATCH '+this.props.dayCount)
    console.debug(this.props.currentBatch)
    _batches = appConfig.pointer('ProspectBatch', this.props.currentBatch)
    if(this.props.batchCount == "~") {
      // Why doesnt this work 
      var thissss = this;
      console.debug('INSIDE BATCH '+thiss.props.dayCount)
      console.debug(_batches)
      $.ajax({
        url:'https://api.parse.com/1/classes/Prospect',
        batches: _batches,
        data: {
          where: JSON.stringify({
            batches: _batches
          }),
          count: true,
          limit:1000,
        },
        headers: appConfig.headers,
        success: function(res) { 
          //console.debug('SUCCESS GET COUNT ' + res.count)
          //console.debug(res.results) 
          thissss.setState({initialBatchCount: res.count})
        },
        error: function(err) { 
          thissss.setState({initialBatchCount: 0 })
        }
      })
    }
  },

  componentWillReceiveProps: function(nextProps) {
    if(this.props.dayCount == 0)
      this.setState({ initialBatchCount: nextProps.batchCount })
  },


  render: function() {
    if(this.props.hasScheduledEmail)
      batchStageStyle = {top:-42, left:6}
    else
      batchStageStyle = {}

    if(this.props.dayCount == 0.5)
      batchStageStyle.left = 7

    //console.log('BATCH STAGE')
    //console.log(this.props)
    //console.debug(this.props.currentBatch)                                                           

    return (
      React.DOM.div({className: "followup-placement arrow_box tmp", style: batchStageStyle}, 
        React.DOM.span({className: "label label-primary"}, 
          React.DOM.i({className: "fa fa-user"}), " ", 
          this.state.initialBatchCount
        ), " ", 
        React.DOM.h6({style: {display:'inline-block'}}, 
          "prospects in the sales cycle.")
      )
    );
  }
});

var EditTemplate = React.createClass({displayName: 'EditTemplate',
  // Edit Mode - True
  render: function() {
    options = []
    for(i=0;i< this.props.templates.length; i++) {
      options.push( React.DOM.option(null, this.props.templates[i].name))
    }
    trash = (this.props.dayCount == 0) ?  React.DOM.button({onClick: this.removeFollowup, 
                className: "win-btn btn btn-default btn-xs disabled"}, 
          React.DOM.i({className: "fa fa-trash-o"})) : React.DOM.button({onClick: this.removeFollowup, className: "win-btn btn btn-default btn-xs"}, " ", React.DOM.i({className: "fa fa-trash-o"})) 
    return (
      React.DOM.div({className: "followup-placement arrow_box_1 tmp_2"}, 
        React.DOM.h6({style: {width:55,display:'inline-block'}, 
            className: "text-muted"}, 
          "Choose :"
        ), 
        React.DOM.select({className: "form-control input-sm", 
                id: "chooseTemplateForFollowup", 
                style: {display:'inline-block',width:127,marginRight:5}}, 
          options
        ), 

        React.DOM.button({className: "win-btn btn btn-success btn-xs", 
                onClick: this.saveFollowup, 
                style: {marginRight:5}}, 
          React.DOM.i({className: "fa fa-check"})), 
        trash
      )
    )
  },

  saveFollowup: function(e) {
    //get template from currentTemplate
    e.preventDefault()
    chosenTemplate = $('#chooseTemplateForFollowup').val()
    console.log(chosenTemplate)
    for(i=0;i< this.props.templates.length; i++){
      if(this.props.templates[i].name == chosenTemplate){
        chosenTemplate = this.props.templates[i]
        break
      }
    }
    console.log(chosenTemplate)
    
    this.props.saveFollowup(this.props.dayCount, chosenTemplate)
  },

  removeFollowup: function(day) {
    this.props.removeFollowup(this.props.dayCount)
  },
});


},{}]},{},[10])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L25vZGVfbW9kdWxlcy9ndWxwLWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvZW1haWwuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9mb2xsb3d1cF9mZWVkLmpzLm1pbi5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvZm9sbG93dXBfdGltZWxpbmUuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9zY2hlZHVsZS5qcy5taW4uanMiLCIvVXNlcnMvcm9iaW4vUHJvamVjdHMvcHJvc3BlY3Rlci9wcm9zcGVjdGVyLXBhcnNlL2Rldi9idWlsZC9qcy9jb21wb25lbnRzL3NlbmRfZW1haWxfbW9kYWwuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy9zZW50X21haWwuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy90ZW1wbGF0ZXMuanMubWluLmpzIiwiL1VzZXJzL3JvYmluL1Byb2plY3RzL3Byb3NwZWN0ZXIvcHJvc3BlY3Rlci1wYXJzZS9kZXYvYnVpbGQvanMvY29tcG9uZW50cy90ZW1wbGF0ZXNfbWVudS5qcy5taW4uanMiLCIvVXNlcnMvcm9iaW4vUHJvamVjdHMvcHJvc3BlY3Rlci9wcm9zcGVjdGVyLXBhcnNlL2Rldi9idWlsZC9qcy9jb21wb25lbnRzL3RpbWVsaW5lX2RheV9lbGVtZW50LmpzLm1pbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBckhBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFySEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQWpaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBbEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUEzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQTFIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBdElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUEvT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQXpSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUF6TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUE1UUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBbEdBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQTNEQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUExSEE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBak5BO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQTFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUF0SUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDL09BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOVJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDek1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG52YXIgVGVtcGxhdGVzID0gcmVxdWlyZSgnLi90ZW1wbGF0ZXMuanMubWluLmpzJyk7XG52YXIgU2NoZWR1bGVzID0gcmVxdWlyZSgnLi9zY2hlZHVsZS5qcy5taW4uanMnKTtcbnZhciBDYW1wYWlnbnMgPSByZXF1aXJlKCcuL2NhbXBhaWducy5qcy5taW4uanMnKTtcbnZhciBTZW50TWFpbCA9IHJlcXVpcmUoJy4vc2VudF9tYWlsLmpzLm1pbi5qcycpO1xudmFyIEZvbGxvd3VwRmVlZCA9IHJlcXVpcmUoJy4vZm9sbG93dXBfZmVlZC5qcy5taW4uanMnKTtcbnZhciBDYW1wYWlnbkRldGFpbCA9IHJlcXVpcmUoJy4vY2FtcGFpZ25fZGV0YWlsLmpzLm1pbi5qcycpO1xudmFyIENyZWF0ZUNhbXBhaWduTW9kYWwgPSByZXF1aXJlKCcuL2NyZWF0ZV9jYW1wYWlnbi5qcy5taW4uanMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2VsZWN0ZWRTY3JlZW46ICdDYW1wYWlnbnMnLFxuICAgICAgc2VsZWN0ZWRDYW1wYWlnbjonJyxcbiAgICAgIHByb3NwZWN0TGlzdHM6IFtdLFxuICAgICAgY2FtcGFpZ25zOiBbXVxuICAgIH1cbiAgfSxcblxuICBkZWxldGVDYW1wYWlnbjogZnVuY3Rpb24ob2JqZWN0SWQpIHtcbiAgICAvLyBzd2VldEFsZXJ0XG4gICAgY29uc29sZS5sb2codGhpcy5zdGF0ZS5jYW1wYWlnbnMpXG4gICAgY2FtcGFpZ25zID0gXy5maWx0ZXIodGhpcy5zdGF0ZS5jYW1wYWlnbnMsIGZ1bmN0aW9uKGNhbXBhaWduKSB7XG4gICAgICByZXR1cm4gY2FtcGFpZ24ub2JqZWN0SWQgIT0gb2JqZWN0SWRcbiAgICB9KVxuICAgIGNvbnNvbGUubG9nKGNhbXBhaWducylcbiAgICB0aGlzLnNldFN0YXRlKHtjYW1wYWlnbnM6IGNhbXBhaWduc30pXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9DYW1wYWlnbi8nK29iamVjdElkLFxuICAgICAgdHlwZTonREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgY29uc29sZS5sb2cocmVzKSB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikgeyBjb25zb2xlLmxvZyhlcnIpIH1cbiAgICB9KVxuICAgIC8vIHBlcnNpc3RcbiAgICAvLyBlcnJvciBsb2dcbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpc3MgPSB0aGlzO1xuICAgICBjb21wYW55ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIpLmNvbXBhbnlcbiAgICAgdXNlciA9IGFwcENvbmZpZy5wb2ludGVyKCdfVXNlcicsIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKS5vYmplY3RJZClcbiAgICAgcXJ5ID0ge1xuICAgICAgIHdoZXJlIDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgdXNlcjogdXNlcixcbiAgICAgICAgIGNvbXBhbnk6IGNvbXBhbnlcbiAgICAgICB9KSxcbiAgICAgICBpbmNsdWRlOiAncHJvc3BlY3RfbGlzdCxmb2xsb3d1cHMsZm9sbG93dXBzLnRlbXBsYXRlLGJhdGNoZXMnLFxuICAgICAgIG9yZGVyOiAnLWNyZWF0ZWRBdCdcbiAgICAgfVxuICAgICAkLmFqYXgoe1xuICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9DYW1wYWlnbicsXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIGRhdGE6IHFyeSxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXMucmVzdWx0cylcbiAgICAgICAgdGhpc3Muc2V0U3RhdGUoe2NhbXBhaWduczogcmVzLnJlc3VsdHN9KVxuICAgICAgICAvLyBGaW5kIEFsbCBQcm9zcGVjdHMgSW4gUHJvc3BlY3RMaXN0IHRoYXQgYXJlIG5vdCBpbiBhbnkgYmF0Y2hlc1xuICAgICAgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJylcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgfVxuICAgICB9KTtcbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOiAnaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdExpc3QnLFxuICAgICAgZGF0YToge1xuICAgICAgICBvcmRlcjogJy1jcmVhdGVkQXQnLFxuICAgICAgICB3aGVyZSA6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICB1c2VyOiBhcHBDb25maWcudXNlcixcbiAgICAgICAgICBjb21wYW55OiBhcHBDb25maWcuY29tcGFueSxcbiAgICAgICAgfSlcbiAgICAgIH0sXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBjb25zb2xlLmxvZygnUFJPU1BFQ1QgTElTVFMnKVxuICAgICAgICBjb25zb2xlLmxvZyhyZXMucmVzdWx0cylcbiAgICAgICAgdGhpc3Muc2V0U3RhdGUoe3Byb3NwZWN0TGlzdHM6IHJlcy5yZXN1bHRzfSlcbiAgICAgIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgIH1cbiAgICB9KVxuXG5cbiAgfSxcbiAgXG4gIHRvZ2dsZVNjcmVlbjogZnVuY3Rpb24oc2NyZWVuKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7c2VsZWN0ZWRTY3JlZW4gOiBzY3JlZW59KVxuICB9LFxuXG4gIGNoYW5nZVNlbGVjdGVkQ2FtcGFpZ246IGZ1bmN0aW9uKHNjcmVlbiwgc2VsZWN0ZWRDYW1wYWlnbikge1xuICAgIGNvbnNvbGUubG9nKHNlbGVjdGVkQ2FtcGFpZ24pXG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBzZWxlY3RlZENhbXBhaWduIDogc2VsZWN0ZWRDYW1wYWlnbixcbiAgICAgIHNlbGVjdGVkU2NyZWVuOiBzY3JlZW4sXG4gICAgfSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXNzID0gdGhpc1xuICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdGUuc2VsZWN0ZWRDYW1wYWlnbilcbiAgICBjb25zb2xlLmxvZyh0aGlzLnN0YXRlLnNlbGVjdGVkU2NyZWVuKVxuICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdGUuY2FtcGFpZ25zKVxuICAgIHN3aXRjaCAodGhpcy5zdGF0ZS5zZWxlY3RlZFNjcmVlbil7XG4gICAgICBjYXNlICdDYW1wYWlnbnMnOlxuICAgICAgICBDdXJyZW50U2NyZWVuID0gQ2FtcGFpZ25zKHtjYW1wYWlnbnM6IHRoaXNzLnN0YXRlLmNhbXBhaWducywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlU2VsZWN0ZWRDYW1wYWlnbjogdGhpc3MuY2hhbmdlU2VsZWN0ZWRDYW1wYWlnbiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlQ2FtcGFpZ246IHRoaXMuZGVsZXRlQ2FtcGFpZ24sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZVNjcmVlbjogdGhpc3MudG9nZ2xlU2NyZWVufSlcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdDYW1wYWlnbkRldGFpbCc6XG4gICAgICAgIEN1cnJlbnRTY3JlZW4gPSBDYW1wYWlnbkRldGFpbCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENhbXBhaWduOiB0aGlzcy5zdGF0ZS5zZWxlY3RlZENhbXBhaWduLCBcbiAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENhbXBhaWduT2JqZWN0SWQ6IHRoaXNzLnN0YXRlLnNlbGVjdGVkQ2FtcGFnaW5PYmplY3RJZCwgXG4gICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVTY3JlZW46IHRoaXNzLnRvZ2dsZVNjcmVlbn0pXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnVGVtcGxhdGVzJzpcbiAgICAgICAgQ3VycmVudFNjcmVlbiA9IFRlbXBsYXRlcyhudWxsKVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ092ZXJ2aWV3JzpcbiAgICAgICAgQ3VycmVudFNjcmVlbiA9IENhbXBhaWducyh7Y2FtcGFpZ25zOiB0aGlzcy5zdGF0ZS5jYW1wYWlnbnMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVNlbGVjdGVkQ2FtcGFpZ246IHRoaXNzLmNoYW5nZVNlbGVjdGVkQ2FtcGFpZ24sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZVNjcmVlbjogdGhpc3MudG9nZ2xlU2NyZWVufSlcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdTZW50IE1haWwnOlxuICAgICAgICBDdXJyZW50U2NyZWVuID0gU2VudE1haWwobnVsbClcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdGb2xsb3d1cCBGZWVkJzpcbiAgICAgICAgQ3VycmVudFNjcmVlbiA9IEZvbGxvd3VwRmVlZChudWxsKVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1NjaGVkdWxlcyc6XG4gICAgICAgIEN1cnJlbnRTY3JlZW4gPSBTY2hlZHVsZXMobnVsbClcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJcIiwgc3R5bGU6IHtoZWlnaHQ6JzU1MHB4J319LCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImNvbnRhaW5lclwiLCBzdHlsZToge3BhZGRpbmc6JzAnLHdpZHRoOicxMDAlJyxoZWlnaHQ6JzEwMCUnfX0sIFxuICAgICAgICAgIFNpZGVNZW51KHtcbiAgICAgICAgICAgICAgICBjcmVhdGVDYW1wYWlnbjogdGhpcy5jcmVhdGVDYW1wYWlnbiwgXG4gICAgICAgICAgICAgICAgcHJvc3BlY3RMaXN0czogdGhpcy5zdGF0ZS5wcm9zcGVjdExpc3RzLCBcbiAgICAgICAgICAgICAgICB0b2dnbGVTY3JlZW46IHRoaXMudG9nZ2xlU2NyZWVufSksIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiY29sLW1kLTEwXCIsIFxuICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7cGFkZGluZzonMCcsaGVpZ2h0OicxMDAlJ319LCBcbiAgICAgICAgICAgIEN1cnJlbnRTY3JlZW5cbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApO1xuICB9LFxuXG4gIHBlcnNpc3RDYW1wYWlnbjogZnVuY3Rpb24obmV3Q2FtcGFpZ24pIHtcbiAgICBDYW1wYWlnbiA9IHt9XG4gICAgQ2FtcGFpZ24ubmFtZSA9IG5ld0NhbXBhaWduLm5hbWVcbiAgICBDYW1wYWlnbi51c2VyID0gYXBwQ29uZmlnLnBvaW50ZXIoJ19Vc2VyJywgSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIpLm9iamVjdElkKVxuICAgIENhbXBhaWduLmNvbXBhbnkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5jdXJyZW50VXNlcikuY29tcGFueVxuICAgIHZhciB0aGlzcyA9IHRoaXM7XG5cbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL0NhbXBhaWduJyxcbiAgICAgIHR5cGU6J1BPU1QnLFxuICAgICAgaGVhZGVyczphcHBDb25maWcuaGVhZGVycyxcbiAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkoQ2FtcGFpZ24pLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIHRoZV9jYW1wYWlnbiA9IF8uZmluZCh0aGlzcy5zdGF0ZS5jYW1wYWlnbnMsIGZ1bmN0aW9uKGNhbXBhaWduKXtcbiAgICAgICAgICBmaXJzdCA9IGNhbXBhaWduLm5hbWUgPT0gbmV3Q2FtcGFpZ24ubmFtZSBcbiAgICAgICAgICBzZWNvbmQgPSBjYW1wYWlnbi5wcm9zcGVjdF9saXN0ID09IG5ld0NhbXBhaWduLnByb3NwZWN0X2xpc3RcbiAgICAgICAgICByZXR1cm4gZmlyc3QgJiYgc2Vjb25kXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgY29uc29sZS5sb2cocmVzLm9iamVjdElkKVxuXG4gICAgICAgIHRoZV9jYW1wYWlnbi5vYmplY3RJZCA9IHJlcy5vYmplY3RJZFxuICAgICAgICBjYW1wYWlnbnMgPSBfLmZpbHRlcih0aGlzcy5zdGF0ZS5jYW1wYWlnbnMsIGZ1bmN0aW9uKGNhbXBhaWduKXtcbiAgICAgICAgICBmaXJzdCA9IGNhbXBhaWduLm5hbWUgPT0gbmV3Q2FtcGFpZ24ubmFtZSBcbiAgICAgICAgICBzZWNvbmQgPSBjYW1wYWlnbi5wcm9zcGVjdF9saXN0ID09IG5ld0NhbXBhaWduLnByb3NwZWN0X2xpc3RcbiAgICAgICAgICByZXR1cm4gIShmaXJzdCAmJiBzZWNvbmQpXG4gICAgICAgIH0pXG4gICAgICAgIGNhbXBhaWducy5wdXNoKHRoZV9jYW1wYWlnbilcbiAgICAgICAgY29uc29sZS5sb2coY2FtcGFpZ25zKVxuXG4gICAgICAgIHRoaXNzLnNldFN0YXRlKHtjYW1wYWlnbnM6ICBjYW1wYWlnbnN9KVxuXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL0NhbXBhaWduLycrcmVzLm9iamVjdElkLFxuICAgICAgICAgIHR5cGU6J1BVVCcsXG4gICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe3Byb3NwZWN0X2xpc3Q6e1xuICAgICAgICAgICAgJ19fdHlwZSc6J1BvaW50ZXInLFxuICAgICAgICAgICAgJ2NsYXNzTmFtZSc6J1Byb3NwZWN0TGlzdCcsXG4gICAgICAgICAgICAnb2JqZWN0SWQnOm5ld0NhbXBhaWduLnByb3NwZWN0X2xpc3Qub2JqZWN0SWQsXG4gICAgICAgICAgfX0pLFxuICAgICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKXtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICBjcmVhdGVDYW1wYWlnbjogZnVuY3Rpb24obmV3Q2FtcGFpZ24pIHtcbiAgICBjYW1wYWlnbnMgPSB0aGlzLnN0YXRlLmNhbXBhaWduc1xuICAgIGNhbXBhaWducy5wdXNoKG5ld0NhbXBhaWduKVxuICAgIHRoaXMuc2V0U3RhdGUoe2NhbXBhaWduczogY2FtcGFpZ25zfSlcbiAgICBjb25zb2xlLmxvZyhuZXdDYW1wYWlnbilcblxuICAgICQoJy5tb2RhbCcpLmNsaWNrKClcbiAgICAkKCcubW9kYWwtYmFja2Ryb3AnKS5jbGljaygpXG5cbiAgICB0aGlzLnBlcnNpc3RDYW1wYWlnbihuZXdDYW1wYWlnbilcbiAgfVxufSk7XG5cbnZhciBTaWRlTWVudSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ1NpZGVNZW51JyxcbiAgdG9nZ2xlU2NyZWVuOiBmdW5jdGlvbihlKSB7XG4gICAgdGhpcy5wcm9wcy50b2dnbGVTY3JlZW4oJChlLnRhcmdldCkudGV4dCgpLnRyaW0oKSlcbiAgfSxcblxuICAvKlxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzTmFtZT1cInNoYXJwIGJ0biBidG4tZGVmYXVsdFwiIG9uQ2xpY2s9e3RoaXMudG9nZ2xlU2NyZWVufT5cbiAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWZpbGUtdGV4dFwiIC8+ICZuYnNwOyBUZW1wbGF0ZXNcbiAgICA8L2J1dHRvbj5cbiAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzc05hbWU9XCJzaGFycCBidG4gYnRuLWRlZmF1bHRcIiBvbkNsaWNrPXt0aGlzLnRvZ2dsZVNjcmVlbn0+XG4gICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1jbG9jay1vXCIgLz4gJm5ic3A7IFNjaGVkdWxlc1xuICAgIDwvYnV0dG9uPlxuICAqL1xuICBjcmVhdGVDYW1wYWlnbk1vZGFsOiBmdW5jdGlvbigpIHtcblxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJjb2wtbWQtMlwiLCBcbiAgICAgICAgc3R5bGU6IHtwYWRkaW5nOicwJyxoZWlnaHQ6JzEwMCUnLCBiYWNrZ3JvdW5kQ29sb3I6J3JnYig5MCwgMTA3LCAxMTkpJyxib3JkZXJCb3R0b21MZWZ0UmFkaXVzOiczcHgnfX0sIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiYnRuLWdyb3VwLXZlcnRpY2FsXCIsIHN0eWxlOiB7d2lkdGg6JzEwMCUnfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIFxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcInNoYXJwIGJ0biBidG4tZGVmYXVsdFwiLCBcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMudG9nZ2xlU2NyZWVufSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHttYXJnaW5MZWZ0OicyN3B4J319LCBcIk92ZXJ2aWV3XCIpXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwic2hhcnAgYnRuIGJ0bi1kZWZhdWx0XCIsIFxuICAgICAgICAgICAgICAgICAgb25DbGljazogdGhpcy50b2dnbGVTY3JlZW59LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtbmV3c3BhcGVyLW9cIn0pLCBcIiDCoFwiLCAgXG4gICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHttYXJnaW5MZWZ0Oic0cHgnfX0sIFwiRm9sbG93dXAgRmVlZFwiKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIHN0eWxlOiB7ZGlzcGxheTonbm9uZSd9LCBcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJzaGFycCBidG4gYnRuLWRlZmF1bHRcIn0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jb2RlLWZvcmtcIn0pLCBcIiDCoFwiLCAgXG4gICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHttYXJnaW5MZWZ0Oic0cHgnfX0sIFwiUnVsZXNcIilcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBzdHlsZToge2Rpc3BsYXk6J25vbmUnfSwgXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwic2hhcnAgYnRuIGJ0bi1kZWZhdWx0XCIsIG9uQ2xpY2s6IHRoaXMudG9nZ2xlU2NyZWVufSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBpZS1jaGFydFwifSksIFwiIMKgIEFuYWx5dGljc1wiXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwic2hhcnAgYnRuIGJ0bi1kZWZhdWx0XCIsIFxuICAgICAgICAgICAgICAgICAgb25DbGljazogdGhpcy50b2dnbGVTY3JlZW59LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGFwZXItcGxhbmVcIn0pLCBcIiDCoCBTZW50IE1haWxcIlxuICAgICAgICAgIClcbiAgICAgICAgKSwgXG5cbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIlwiLCBzdHlsZToge3dpZHRoOicxMDAlJyx0ZXh0QWxpZ246J2NlbnRlcicsbWFyZ2luVG9wOjEwMH19LCBcbiAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBjbGFzc05hbWU6IFwiYnRuIGJ0bi1wcmltYXJ5IG5ldy1saXN0LWJ0blwiLCBcbiAgICAgICAgICAgICAgICAnZGF0YS10b2dnbGUnOiBcIm1vZGFsXCIsICdkYXRhLXRhcmdldCc6IFwiLmJzLWNyZWF0ZUNhbXBhaWduLW1vZGFsLXNtXCIsIFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7IGJhY2tncm91bmRJbWFnZTogJ2xpbmVhci1ncmFkaWVudCgxODBkZWcsICMwMDk2ZmYgMCUsICMwMDVkZmYgMTAwJSknfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wbHVzLWNpcmNsZVwifSksIFwiwqDCoE5ldyBDYW1wYWlnblwiXG4gICAgICAgICAgKVxuICAgICAgICApLCBcbiAgICAgICAgQ3JlYXRlQ2FtcGFpZ25Nb2RhbCh7cHJvc3BlY3RMaXN0czogdGhpcy5wcm9wcy5wcm9zcGVjdExpc3RzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlQ2FtcGFpZ246IHRoaXMuY3JlYXRlQ2FtcGFpZ259KVxuICAgICAgKVxuICAgICk7XG4gIH0sXG5cbiAgY3JlYXRlQ2FtcGFpZ246IGZ1bmN0aW9uKG5ld0NhbXBhaWduKSB7XG4gICAgdGhpcy5wcm9wcy5jcmVhdGVDYW1wYWlnbihuZXdDYW1wYWlnbilcbiAgfVxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy8gRm9sbG93dXBGZWVkXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjaGVkdWxlZEZvbGxvd3VwczogW11cbiAgICB9XG4gIH0sXG5cblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHNjaGVkdWxlZEZvbGxvd3VwcyA9IFtdXG4gICAgZm9yKGk9MDtpPCB0aGlzLnN0YXRlLnNjaGVkdWxlZEZvbGxvd3Vwcy5sZW5ndGg7IGkrKyl7IFxuICAgICAgc2NoZWR1bGVkRm9sbG93dXBzLnB1c2goU2NoZWR1bGVkRm9sbG93dXBSb3cobnVsbCkpXG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe3N0eWxlOiB7b3ZlcmZsb3c6J2F1dG8nLCBoZWlnaHQ6NTUwfX0sIFxuICAgICAgICBSZWFjdC5ET00udGFibGUoe2NsYXNzTmFtZTogXCJ0YWJsZSB0YWJsZS1zdHJpcGVkXCIsIHN0eWxlOiB7bWFyZ2luQm90dG9tOjB9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnRoZWFkKG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlByb3NwZWN0IE5hbWVcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiUHJvc3BlY3QgRW1haWxcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKHtzdHlsZToge3RleHRBbGlnbjonY2VudGVyJ319LCBcIlN0YXR1c1wiKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS50Ym9keShudWxsLCBcbiAgICAgICAgICAgIHNjaGVkdWxlZEZvbGxvd3Vwc1xuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgICk7XG4gIH1cbn0pO1xuXG52YXIgU2NoZWR1bGVkRm9sbG93dXBSb3cgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdTY2hlZHVsZWRGb2xsb3d1cFJvdycsXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS50cihudWxsXG5cbiAgICAgIClcbiAgICApO1xuICB9XG59KVxuIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG52YXIgU2VuZEVtYWlsTW9kYWwgPSByZXF1aXJlKCcuL3NlbmRfZW1haWxfbW9kYWwuanMubWluLmpzJylcbnZhciBUaW1lbGluZURheUVsZW1lbnQgPSByZXF1aXJlKCcuL3RpbWVsaW5lX2RheV9lbGVtZW50LmpzLm1pbi5qcycpXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIC8vIEZvbGxvd3VwVGltZWxpbmVcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICBpbml0aWFsRm9sbG93dXBzID0gdGhpcy5wcm9wcy5pbml0aWFsRm9sbG93dXBzXG4gICAgaW5pdGlhbEZvbGxvd3VwcyA9IChpbml0aWFsRm9sbG93dXBzKSA/IGluaXRpYWxGb2xsb3d1cHMgOiBbXVxuICAgIGJhdGNoZXMgPSB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24uYmF0Y2hlc1xuICAgIGJhdGNoZXMgPSAoYmF0Y2hlcykgPyBiYXRjaGVzIDogW11cbiAgICByZXR1cm4ge1xuICAgICAgZm9sbG93dXBzOiBfLmNvbXBhY3QoaW5pdGlhbEZvbGxvd3VwcyksXG4gICAgICBsb2FkaW5nOiBmYWxzZSxcbiAgICAgIGN1cnJlbnRUZW1wbGF0ZTonJyxcbiAgICAgIGN1cnJlbnRCYXRjaDogJycsXG4gICAgICBiYXRjaGVzIDogYmF0Y2hlc1xuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpc3MgPSB0aGlzO1xuICAgICQoJy5kYXknKS50b29sdGlwKHtcbiAgICAgIHBsYWNlbWVudDogJ3JpZ2h0JyxcbiAgICAgIHRpdGxlOicrIEFkZCBhIGZvbGxvdy11cCdcbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2codGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduKVxuICAgICBjb21wYW55ID0gSlNPTi5zdHJpbmdpZnkoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIpLmNvbXBhbnkpXG4gICAgIGN1cnJlbnRDYW1wYWlnbiA9IGFwcENvbmZpZy5wb2ludGVyKCdDYW1wYWlnbicsIHRoaXMucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5vYmplY3RJZClcbiAgICAgJC5hamF4KHtcbiAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvRm9sbG93dXAnLFxuICAgICAgIHR5cGU6J0dFVCcsXG4gICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgZGF0YToge1xuICAgICAgICAgd2hlcmU6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgY2FtcGFpZ246IGN1cnJlbnRDYW1wYWlnbixcbiAgICAgICAgICAgY29tcGFueTogYXBwQ29uZmlnLmNvbXBhbnlcbiAgICAgICAgIH0pLFxuICAgICAgICAgaW5jbHVkZTondGVtcGxhdGUnLFxuICAgICAgIH0sXG4gICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICBjb25zb2xlLmxvZygnZm9sbG93dXAgdGltZWxpbmUnKVxuICAgICAgICAgY29uc29sZS5sb2cocmVzLnJlc3VsdHMpXG4gICAgICAgfSxcbiAgICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InKVxuICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgIH1cbiAgICAgfSlcbiAgfSxcblxuICBhZGRGb2xsb3d1cFNlbnRUb0JhdGNoOiBmdW5jdGlvbihiYXRjaCwgZm9sbG93dXApIHtcbiAgICBiYXRjaGVzID0gXy5tYXAodGhpcy5zdGF0ZS5iYXRjaGVzLCBmdW5jdGlvbihfYmF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgIGlmKF9iYXRjaC5vYmplY3RJZCA9PSBiYXRjaC5vYmplY3RJZCkge1xuICAgICAgICAgICAgICAgICAgICBpZihfYmF0Y2guZm9sbG93dXBzKVxuICAgICAgICAgICAgICAgICAgICAgIF9iYXRjaC5mb2xsb3d1cHMucHVzaChmb2xsb3d1cClcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgIF9iYXRjaC5mb2xsb3d1cHMgPSBbZm9sbG93dXBdXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX2JhdGNoXG4gICAgICAgICAgICAgIH0pXG4gICAgLy8gUGVyc2lzdFxuICB9LFxuICBcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB0aW1lbGluZUVsZW1lbnRzID0gW11cbiAgICBmb2xsb3d1cHMgPSB0aGlzLnN0YXRlLmZvbGxvd3Vwc1xuXG4gICAgYmF0Y2hlcyA9IF8ubWFwKHRoaXMuc3RhdGUuYmF0Y2hlcywgZnVuY3Rpb24oYmF0Y2gpIHtcbiAgICAgIGlmKGJhdGNoKXtcbiAgICAgICAgbm93ID0gbW9tZW50KCkuc3RhcnRPZignZGF5JykudmFsdWVPZigpXG4gICAgICAgIGJhdGNoLmN1cnJlbnREYXkgPSBtb21lbnQoYmF0Y2guc3RhcnRlZCkuZGlmZihtb21lbnQobm93KSwgICdkYXlzJykgKiAtMVxuICAgICAgICByZXR1cm4gYmF0Y2hcbiAgICAgIH1cbiAgICB9KVxuICAgIGJhdGNoZXMgPSBfLmNvbXBhY3QoYmF0Y2hlcylcblxuICAgIGZvcihpPTA7aTwgMzE7aSsrKXtcbiAgICAgIGZvbGxvd3VwID0gXy5maW5kV2hlcmUodGhpcy5zdGF0ZS5mb2xsb3d1cHMsIHtkYXk6IGl9KVxuICAgICAgdmFyIGVsZW1lbnRUeXBlID0gKGZvbGxvd3VwKSA/IHRydWUgOiBmYWxzZVxuICAgICAgdmFyIGN1cnJlbnRUZW1wbGF0ZSA9IChmb2xsb3d1cCkgPyBmb2xsb3d1cC50ZW1wbGF0ZSA6IGZhbHNlXG4gICAgICB2YXIgYWRkVGVtcGxhdGVNb2RlID0gKGZvbGxvd3VwKSA/IGZvbGxvd3VwLmFkZFRlbXBsYXRlTW9kZSA6IHRydWVcbiAgICAgIGNhbXBhaWduID0gdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduXG5cbiAgICAgIGN1cnJlbnRCYXRjaCA9IHt9XG4gICAgICBiYXRjaF9zdGFydGVkX3RvZGF5ID0gZmFsc2VcbiAgICAgIGFscmVhZHlTZW50ID0gZmFsc2VcbiAgICAgIGJhdGNoQ291bnQgPSB1bmRlZmluZWRcbiAgICAgIGlmKGkgPT0gMCkge1xuICAgICAgICBiYXRjaENvdW50ID0gKGJhdGNoZXMpID8gdGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMubGVuZ3RoIDogdGhpcy5wcm9wcy5wcm9zcGVjdHMubGVuZ3RoXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBiYXRjaCA9IF8uZmluZFdoZXJlKGJhdGNoZXMsIHtjdXJyZW50RGF5OiBpfSlcbiAgICAgICAgaWYoYmF0Y2gpIHtcbiAgICAgICAgICBjdXJyZW50QmF0Y2ggPSBiYXRjaC5vYmplY3RJZFxuICAgICAgICAgIGNvbnNvbGUuZGVidWcoYmF0Y2gub2JqZWN0SWQpXG4gICAgICAgICAgYmF0Y2hDb3VudCA9IFwiflwiXG4gICAgICAgICAgaWYoZm9sbG93dXApIHtcbiAgICAgICAgICAgIF9iYXRjaGVzID0gZm9sbG93dXAuYmF0Y2hlc1xuICAgICAgICAgICAgYWxyZWFkeVNlbnQgPSBfLmZpbmRXaGVyZShfYmF0Y2hlcywgXy5waWNrKGJhdGNoLCdvYmplY3RJZCcpKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aW1lbGluZUVsZW1lbnRzLnB1c2goUmVhY3QuRE9NLmRpdihudWxsLCBUaW1lbGluZURheUVsZW1lbnQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5Q291bnQ6IGksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFR5cGU6ICFlbGVtZW50VHlwZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGVtcGxhdGU6IGN1cnJlbnRUZW1wbGF0ZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaENvdW50OiBiYXRjaENvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCYXRjaDogY3VycmVudEJhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscmVhZHlTZW50OiBhbHJlYWR5U2VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRUZW1wbGF0ZU1vZGU6IGFkZFRlbXBsYXRlTW9kZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXM6IHRoaXMucHJvcHMudGVtcGxhdGVzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb3NwZWN0czogdGhpcy5wcm9wcy5uZXdQcm9zcGVjdHMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkRm9sbG93dXA6IHRoaXMuYWRkRm9sbG93dXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEZvbGxvd3VwOiB0aGlzLmVkaXRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlRm9sbG93dXA6IHRoaXMuc2F2ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZvbGxvd3VwOiB0aGlzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEZvbGxvd3VwU2VudFRvQmF0Y2g6IHRoaXMuYWRkRm9sbG93dXBTZW50VG9CYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaGVzOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24uYmF0Y2hlcywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9zcGVjdExpc3RDb3VudDogdGhpcy5wcm9wcy5wcm9zcGVjdExpc3RDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRDdXJyZW50QmF0Y2g6IHRoaXMuc2V0Q3VycmVudEJhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEN1cnJlbnRUZW1wbGF0ZTogdGhpcy5zZXRDdXJyZW50VGVtcGxhdGV9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpXG5cbiAgICAgIGlmKGkgPT0gMCAmJiBfLmZpbmRXaGVyZShiYXRjaGVzLCB7Y3VycmVudERheTogMH0pKXtcbiAgICAgICAgICBjdXJyZW50QmF0Y2ggPSBfLmZpbmRXaGVyZShiYXRjaGVzLCB7Y3VycmVudERheTogMH0pLm9iamVjdElkXG4gICAgICAgICAgY29uc29sZS5kZWJ1ZygnMC41JylcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKGN1cnJlbnRCYXRjaClcbiAgICAgICAgICBiYXRjaENvdW50ID0gXCJ+XCJcbiAgICAgICAgICB0aW1lbGluZUVsZW1lbnRzLnB1c2goUmVhY3QuRE9NLmRpdihudWxsLCBUaW1lbGluZURheUVsZW1lbnQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNvdW50OiAwLjUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoQ291bnQ6IGJhdGNoQ291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCYXRjaDogY3VycmVudEJhdGNoLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdQcm9zcGVjdHM6IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50VHlwZTogdHJ1ZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hlczogdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduLmJhdGNoZXMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3NwZWN0TGlzdENvdW50OiB0aGlzLnByb3BzLnByb3NwZWN0TGlzdENvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRDdXJyZW50QmF0Y2g6IHRoaXMuc2V0Q3VycmVudEJhdGNofSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSlcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYobnVsbCwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJ0aW1lbGluZVwiLCBcbiAgICAgICAgICAgICBzdHlsZToge2hlaWdodDonMTAwJScsYmFja2dyb3VuZENvbG9yOidyZ2IoOTAsIDEwNywgMTE5KScsIHdpZHRoOjUsbWFyZ2luVG9wOi0zNX19LCBcbiAgICAgICAgICAgICB0aW1lbGluZUVsZW1lbnRzXG4gICAgICAgICksIFxuICAgICAgICBTZW5kRW1haWxNb2RhbCh7cHJvc3BlY3RzOiB0aGlzLnByb3BzLnByb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENhbXBhaWduOiB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24sIFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3UHJvc3BlY3RzOiB0aGlzLnByb3BzLm5ld1Byb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRGb2xsb3d1cFNlbnRUb0JhdGNoOiB0aGlzLmFkZEZvbGxvd3VwU2VudFRvQmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJhdGNoOiB0aGlzLnN0YXRlLmN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGVtcGxhdGU6IHRoaXMuc3RhdGUuY3VycmVudFRlbXBsYXRlfSlcbiAgICAgIClcbiAgICApO1xuICB9LFxuXG4gIGNyZWF0ZUZvbGxvd3VwOiBmdW5jdGlvbigpIHtcbiAgICAvL1xuICB9LCAgICAgICAgIFxuXG4gIGFkZEZvbGxvd3VwOiBmdW5jdGlvbihkYXkpIHtcbiAgICAvL2NvbnNvbGUubG9nKCdjYWxsZWQgdGVtcGxhdGUgZWRpdCBtZW51JylcbiAgICBmb2xsb3d1cHMgPSB0aGlzLnN0YXRlLmZvbGxvd3Vwc1xuICAgIGZvbGxvd3Vwcy5wdXNoKHthZGRUZW1wbGF0ZU1vZGU6IHRydWUsIGRheTogZGF5fSlcbiAgICB0aGlzLnNldFN0YXRlKHsgZm9sbG93dXBzOiBmb2xsb3d1cHMgfSlcbiAgfSxcblxuICBlZGl0Rm9sbG93dXA6IGZ1bmN0aW9uKGRheSkge1xuICAgIC8vIGZpbmQgdGVtcGxhdGUgc2V0IGVkaXRtb2RlIGlzIGZhbHNlXG4gICAgZm9sbG93dXBzID0gXy5tYXAodGhpcy5zdGF0ZS5mb2xsb3d1cHMsIGZ1bmN0aW9uKGZvbGxvd3VwKSB7XG4gICAgICBpZihmb2xsb3d1cC5kYXkgPT0gZGF5KXsgZm9sbG93dXAuYWRkVGVtcGxhdGVNb2RlID0gdHJ1ZSB9XG4gICAgICByZXR1cm4gZm9sbG93dXBcbiAgICB9KVxuICAgIHRoaXMuc2V0U3RhdGUoe2ZvbGxvd3VwczogZm9sbG93dXBzfSlcbiAgfSxcblxuICBzYXZlRm9sbG93dXA6IGZ1bmN0aW9uKGRheSwgY2hvc2VuVGVtcGxhdGUpIHtcbiAgICBuZXdfZm9sbG93dXBzID0gXy5tYXAodGhpcy5zdGF0ZS5mb2xsb3d1cHMsIGZ1bmN0aW9uKGZvbGxvd3VwKSB7XG4gICAgICBpZihmb2xsb3d1cC5kYXkgPT0gZGF5KXtcbiAgICAgICAgZm9sbG93dXAuYWRkVGVtcGxhdGVNb2RlID0gZmFsc2VcbiAgICAgICAgZm9sbG93dXAudGVtcGxhdGUgPSBjaG9zZW5UZW1wbGF0ZVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZvbGxvd3VwXG4gICAgfSlcbiAgICB0aGlzLnNldFN0YXRlKHtmb2xsb3d1cHM6IG5ld19mb2xsb3d1cHN9KVxuICAgIGZvbGxvd3VwID0gXy5maW5kV2hlcmUobmV3X2ZvbGxvd3Vwcywge2RheTogZGF5fSlcblxuICAgICAgaWYoZm9sbG93dXAub2JqZWN0SWQpe1xuICAgICAgICB1cmwgPSBcIi9cIitmb2xsb3d1cC5vYmplY3RJZDsgdHlwZT1cIlBVVFwiXG4gICAgICAgIGRhdGEgPSB7dGVtcGxhdGU6IGFwcENvbmZpZy5wb2ludGVyKCdUZW1wbGF0ZScsIGNob3NlblRlbXBsYXRlLm9iamVjdElkKX1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVybCA9IFwiXCI7IHR5cGU9XCJQT1NUXCI7XG5cbiAgICAgICAgICBkYXRhID0ge1xuICAgICAgICAgICAgZGF5OiBkYXksXG4gICAgICAgICAgICBjYW1wYWlnbiA6IGFwcENvbmZpZy5wb2ludGVyKCdDYW1wYWlnbicsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24ub2JqZWN0SWQpLFxuICAgICAgICAgICAgdGVtcGxhdGU6IGFwcENvbmZpZy5wb2ludGVyKCdUZW1wbGF0ZScsIGNob3NlblRlbXBsYXRlLm9iamVjdElkKSxcbiAgICAgICAgICB9XG4gICAgICB9XG5cbiAgICB0aGlzcyA9IHRoaXM7XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Gb2xsb3d1cCcrdXJsLFxuICAgICAgdHlwZTp0eXBlLFxuICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgbmV3X2ZvbGxvd3VwcyA9IF8ubWFwKG5ld19mb2xsb3d1cHMsIGZ1bmN0aW9uKGZvbGxvd3VwKSB7XG4gICAgICAgICAgaWYoZm9sbG93dXAuZGF5ID09IGRheSkgeyBmb2xsb3d1cC5vYmplY3RJZCA9IGZhbHNlIH1cbiAgICAgICAgICByZXR1cm4gZm9sbG93dXBcbiAgICAgICAgfSlcbiAgICAgICAgdGhpc3Muc2V0U3RhdGUoe2ZvbGxvd3VwczogbmV3X2ZvbGxvd3Vwc30pXG5cbiAgICAgICAgY29uc29sZS5sb2cocmVzKVxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9DYW1wYWlnbi8nK3RoaXNzLnByb3BzLnNlbGVjdGVkQ2FtcGFpZ24ub2JqZWN0SWQsXG4gICAgICAgICAgdHlwZTonUFVUJyxcbiAgICAgICAgICBkYXRhOkpTT04uc3RyaW5naWZ5KHtmb2xsb3d1cHM6IHtcbiAgICAgICAgICAgIF9fb3A6ICdBZGRVbmlxdWUnLFxuICAgICAgICAgICAgb2JqZWN0czpbYXBwQ29uZmlnLnBvaW50ZXIoJ0ZvbGxvd3VwJywgcmVzLm9iamVjdElkKV1cbiAgICAgICAgICB9fSksXG4gICAgICAgICAgaGVhZGVyczphcHBDb25maWcuaGVhZGVycyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHsgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7IH1cbiAgICAgICAgfSlcbiAgICAgIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oKSB7IH0sXG4gICAgfSlcbiAgfSxcblxuICByZW1vdmVGb2xsb3d1cDogZnVuY3Rpb24oZGF5KSB7XG4gICAgZm9sbG93dXBzID0gW11cbiAgICBmb3IoaT0wO2k8IHRoaXMuc3RhdGUuZm9sbG93dXBzLmxlbmd0aDtpKyspXG4gICAgICBpZih0aGlzLnN0YXRlLmZvbGxvd3Vwc1tpXS5kYXkgIT0gZGF5KVxuICAgICAgICBmb2xsb3d1cHMucHVzaCh0aGlzLnN0YXRlLmZvbGxvd3Vwc1tpXSlcbiAgICAgIFxuICAgIGZvcihpPTA7aTwgdGhpcy5zdGF0ZS5mb2xsb3d1cHMubGVuZ3RoO2krKylcbiAgICAgIGlmKHRoaXMuc3RhdGUuZm9sbG93dXBzW2ldLmRheSA9PSBkYXkpXG4gICAgICAgIGJyZWFrXG4gICAgXG4gICAgdGhpcy5zZXRTdGF0ZSh7Zm9sbG93dXBzOiBmb2xsb3d1cHN9KSBcbiAgICBpZCA9IHRoaXMuc3RhdGUuZm9sbG93dXBzW2ldXG5cbiAgICB0aGlzcyA9IHRoaXM7XG4gICAgaWYoaWQpIHtcbiAgICAgIGlkID0gaWQub2JqZWN0SWRcbiAgICAgICQuYWpheCh7XG4gICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Gb2xsb3d1cC8nK2lkLFxuICAgICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICB0eXBlOidERUxFVEUnLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgY29uc29sZS5sb2cocmVzKSB9XG4gICAgICB9KVxuXG4gICAgIGNvbnNvbGUubG9nKCdSRU1PVkUgQVJSQVknKVxuICAgICAgJC5hamF4KHtcbiAgICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL0NhbXBhaWduLycrdGhpc3MucHJvcHMuc2VsZWN0ZWRDYW1wYWlnbi5vYmplY3RJZCxcbiAgICAgICAgaGVhZGVyczphcHBDb25maWcuaGVhZGVycyxcbiAgICAgICAgdHlwZTonUFVUJyxcbiAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGZvbGxvd3Vwczoge1xuICAgICAgICAgICAgX19vcCA6ICdSZW1vdmUnLFxuICAgICAgICAgICAgb2JqZWN0czogW2FwcENvbmZpZy5wb2ludGVyKCdGb2xsb3d1cCcsIGlkKV1cbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpeyBjb25zb2xlLmxvZyhyZXMpIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHsgfVxuICAgICAgfSlcbiAgICB9XG4gIH0sXG5cbiAgc2V0Q3VycmVudEJhdGNoOiBmdW5jdGlvbihjdXJyZW50QmF0Y2gpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50QmF0Y2g6IGN1cnJlbnRCYXRjaH0pXG4gIH0sXG5cbiAgc2V0Q3VycmVudFRlbXBsYXRlOiBmdW5jdGlvbih0ZW1wbGF0ZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRUZW1wbGF0ZTogdGVtcGxhdGUgfSlcbiAgfVxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdihudWxsLCBcbiAgICAgICAgXCJTY2hlZHVsc1wiXG4gICAgICApXG4gICAgKTtcbiAgfVxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY3VycmVudFByb3NwZWN0OiAwLFxuICAgIH1cbiAgfSxcblxuICBzZW5kRW1haWxzOiBmdW5jdGlvbigpIHtcbiAgICBzZWxlY3RlZENhbXBhaWduID0gdGhpcy5wcm9wcy5zZWxlY3RlZENhbXBhaWduXG4gICAgY2FtcGFpZ25faWQgPSBzZWxlY3RlZENhbXBhaWduLm9iamVjdElkXG4gICAgcHJvc3BlY3RsaXN0X2lkID0gc2VsZWN0ZWRDYW1wYWlnbi5wcm9zcGVjdF9saXN0Lm9iamVjdElkXG4gICAgdGVtcGxhdGVfaWQgPSB0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZS5vYmplY3RJZFxuICAgIFxuICAgICQuYWpheCh7XG4gICAgICAvL3VybDonaHR0cHM6Ly9uYW1lbGVzcy1yZXRyZWF0LTM1MjUuaGVyb2t1YXBwLmNvbS9zZW5kX2VtYWlsJyxcbiAgICAgIHVybDonaHR0cDovLzEyNy4wLjAuMTo1MDAwL3YxL2NhbXBhaWduL2VtYWlsJyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdGVtcGxhdGUgOiB0ZW1wbGF0ZV9pZCxcbiAgICAgICAgY2FtcGFpZ24gOiBjYW1wYWlnbl9pZCxcbiAgICAgICAgLy9iYXRjaDogYmF0Y2hfaWRcbiAgICAgIH0sXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgY29uc29sZS5sb2cocmVzLnJlc3VsdHMpIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7IGNvbnNvbGUubG9nKGVycikgfVxuICAgIH0pXG5cbiAgICAvKiAqL1xuICAgIC8vIFVwZGF0ZSBGb2xsb3d1cFxuICAgIC8vIFBlcnNpc3QgRm9sbG93dXBcbiAgICAvLyBjbG9zZSBtb2RhbFxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcHJvc3BlY3QgPSB0aGlzLnByb3BzLnByb3NwZWN0c1t0aGlzLnN0YXRlLmN1cnJlbnRQcm9zcGVjdF1cbiAgICBwcm9zcGVjdCA9IChwcm9zcGVjdCkgPyBwcm9zcGVjdCA6IHsnbmFtZSc6JycsJ2VtYWlsJzonJ31cblxuICAgIHZhciB0aGlzcyA9IHRoaXM7XG4gICAgY29uc29sZS5kZWJ1ZygnU0VORCBFTUFJTCBCQVRDSCcpXG4gICAgY29uc29sZS5kZWJ1Zyh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaClcbiAgICBuZXdCYXRjaCA9IF8uaXNFcXVhbCh0aGlzLnByb3BzLmN1cnJlbnRCYXRjaCwge30pXG4gICAgcHJvc3BlY3RzID0gKG5ld0JhdGNoKSA/IHRoaXMucHJvcHMubmV3UHJvc3BlY3RzIDogdGhpcy5wcm9wcy5wcm9zcGVjdHNcbiAgICBpZihuZXdCYXRjaCl7XG4gICAgICBwcm9zcGVjdHMgPSBfLm1hcCh0aGlzLnByb3BzLm5ld1Byb3NwZWN0cywgZnVuY3Rpb24ocHJvc3BlY3QpIHtcbiAgICAgICAgICByZXR1cm4gVXNlclBsYWNlSG9sZGVyKHtwcm9zcGVjdDogcHJvc3BlY3R9KVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcHJvc3BlY3RzID0gXy5tYXAodGhpcy5wcm9wcy5wcm9zcGVjdHMsIGZ1bmN0aW9uKHByb3NwZWN0KSB7XG4gICAgICAgIGlmKF8uZmluZFdoZXJlKHByb3NwZWN0LmJhdGNoZXMsIHtvYmplY3RJZDogdGhpc3MucHJvcHMuY3VycmVudEJhdGNofSkpXG4gICAgICAgICAgcmV0dXJuIFVzZXJQbGFjZUhvbGRlcih7cHJvc3BlY3Q6IHByb3NwZWN0fSlcbiAgICAgIH0pXG4gICAgfVxuICAgIHByb3NwZWN0cyA9IF8uY29tcGFjdChwcm9zcGVjdHMpXG4gICAgY29uc29sZS5kZWJ1Zyhwcm9zcGVjdHMpXG4gICAgY29uc29sZS5kZWJ1Zyhwcm9zcGVjdHMubGVuZ3RoKVxuICAgIHByb3NwZWN0Q291bnQgPSBwcm9zcGVjdHMubGVuZ3RoXG4gICAgZW1haWwgPSAocHJvc3BlY3QuZW1haWwpID8gcHJvc3BlY3QuZW1haWwgOiBcIlwiXG4gICAgaWYoZW1haWwgPT0gXCJub19lbWFpbFwiIHx8IGVtYWlsID09IFwiXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdHVUVTU0lORycpXG4gICAgICBpZihwcm9zcGVjdC5lbWFpbF9ndWVzc2VzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdHVUVTU0lORyBFTUFJTCcpXG4gICAgICAgIGd1ZXNzID0gXy5maW5kV2hlcmUocHJvc3BlY3QuZW1haWxfZ3Vlc3Nlcywge3RyaWVkOiBmYWxzZX0pXG4gICAgICAgIG5hbWUgPSBfLnRpdGxlKHByb3NwZWN0Lm5hbWUudHJpbSgpKVxuXG4gICAgICAgIHZhcnMgPSB7XG4gICAgICAgICAgZmlyc3Q6IF8uZmlyc3QobmFtZS5zcGxpdCgnICcpKS5yZXBsYWNlKC9cXFcvZywgJycpLFxuICAgICAgICAgIGxhc3Q6IF8ubGFzdChuYW1lLnNwbGl0KCcgJykpLnJlcGxhY2UoL1xcVy9nLCAnJyksXG4gICAgICAgICAgZmk6IF8uZmlyc3QobmFtZS5zcGxpdCgnICcpKVswXS5yZXBsYWNlKC9cXFcvZywgJycpLFxuICAgICAgICAgIGxpOiBfLmxhc3QobmFtZS5zcGxpdCgnICcpKVswXS5yZXBsYWNlKC9cXFcvZywgJycpXG4gICAgICAgIH1cbiAgICAgICAgaWYoZ3Vlc3Mpe1xuICAgICAgICAgIGNvbnNvbGUubG9nKGd1ZXNzLnBhdHRlcm4ucGF0dGVybilcbiAgICAgICAgICBlbWFpbCA9IE11c3RhY2hlLnJlbmRlcihndWVzcy5wYXR0ZXJuLnBhdHRlcm4sIHZhcnMpXG4gICAgICAgICAgZW1haWwgPSBlbWFpbCtcIkBcIitwcm9zcGVjdC5kb21haW5cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ05PIEdVRVNTRVMgRk9VTkQnKVxuICAgICAgfVxuICAgIH1cbiAgICBlbWFpbCA9IGVtYWlsLnRvTG93ZXJDYXNlKClcbiAgICBlbWFpbCA9IGVtYWlsXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbCBmYWRlIGJzLXNlbmRFbWFpbC1tb2RhbC1sZ1wiLCB0YWJJbmRleDogXCItMVwiLCBcbiAgICAgICAgICAgcm9sZTogXCJkaWFsb2dcIiwgJ2FyaWEtbGFiZWxsZWRieSc6IFwibXlTbWFsbE1vZGFsTGFiZWxcIiwgJ2FyaWEtaGlkZGVuJzogXCJ0cnVlXCIsIFxuICAgICAgICAgICBpZDogXCJzZW5kRW1haWxNb2RhbFwiLCBzdHlsZToge3RvcDonMTBweCd9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwtZGlhbG9nIG1vZGFsLWxnXCJ9LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWNvbnRlbnRcIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbC1oZWFkZXJcIn0sIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7dHlwZTogXCJidXR0b25cIiwgY2xhc3NOYW1lOiBcImNsb3NlXCIsICdkYXRhLWRpc21pc3MnOiBcIm1vZGFsXCJ9LCBSZWFjdC5ET00uc3Bhbih7J2FyaWEtaGlkZGVuJzogXCJ0cnVlXCJ9LCBcIsOXXCIpLCBcbiAgICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJzci1vbmx5XCJ9LCBcIkNsb3NlXCIpKSwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIFxuICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuc2VuZEVtYWlscywgXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtmbG9hdDoncmlnaHQnfSwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tcHJpbWFyeSBidG4tc21cIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGFwZXItcGxhbmVcIn0pLCBcIsKgIFNlbmQgRW1haWxcIiksIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBzdHlsZToge21hcmdpblJpZ2h0OjEwLCBmbG9hdDoncmlnaHQnfSwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tZGVmYXVsdCBidG4tc21cIiwgJ2RhdGEtZGlzbWlzcyc6IFwibW9kYWxcIn0sIFwiQ2xvc2VcIiksIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmg0KHtjbGFzc05hbWU6IFwibW9kYWwtdGl0bGVcIiwgaWQ6IFwibXlNb2RhbExhYmVsXCJ9LCBcbiAgICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1lbnZlbG9wZVwifSksIFwiIMKgU2VuZCBFbWFpbFwiICsgJyAnICtcbiAgICAgICAgICAgICAgICAgICAgXCLCoMKgXCIsIFxuICAgICAgICAgICAgICAgICAgICBSZWFjdC5ET00uc21hbGwobnVsbCwgXCIoXCIrcHJvc3BlY3RDb3VudCtcIilcIilcbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwtYm9keVwiLCBzdHlsZToge3BhZGRpbmdUb3A6NX19LCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5oNChudWxsLCBcIlBlb3BsZVwiKSwgXG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwcm9zcGVjdC1jb250YWluZXJcIn0sIFxuICAgICAgICAgICAgICAgICAgICBwcm9zcGVjdHNcbiAgICAgICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmJyKG51bGwpLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5oNCh7c3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snfX0sIFwiRW1haWxzIMKgwqDCoFwiLCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgICBjbGFzc05hbWU6ICh0aGlzLnN0YXRlLmN1cnJlbnRQcm9zcGVjdCA9PSAwICkgPyBcImJhZGdlIGJ0biBkaXNhYmxlZFwiIDogXCJiYWRnZSBidG5cIiwgXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMucHJldmlvdXNQcm9zcGVjdH0sIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtYXJyb3ctbGVmdFwifSkpLCBcIsKgwqBcIiwgXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5zbWFsbChudWxsLCAodGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QrMSkrJyBvZiAnK3Byb3NwZWN0Q291bnRcbiAgICAgICAgICAgICAgICAgICkpLCBcbiAgICAgICAgICAgICAgICAgIFwiwqDCoMKgXCIsIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICBjbGFzc05hbWU6ICh0aGlzLnN0YXRlLmN1cnJlbnRQcm9zcGVjdCA9PSAgdGhpcy5wcm9wcy5wcm9zcGVjdHMubGVuZ3RoLTEpID8gXCJidG4gZGlzYWJsZWQgYmFkZ2VcIiA6IFwiYnRuIGJhZGdlXCIsIFxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLm5leHRQcm9zcGVjdH0sIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtYXJyb3ctcmlnaHRcIn0pKSwgXG5cbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYobnVsbCwgXG5cblJlYWN0LkRPTS51bCh7Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAgZW1haWwtaG9sZGVyXCIsIHN0eWxlOiB7Ym9yZGVyVG9wOidzb2xpZCAxcHggI2VlZSd9fSwgXG4gIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAtaXRlbVwifSwgXG4gICAgUmVhY3QuRE9NLmg1KHtzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jaycsbWFyZ2luVG9wOjAsbWFyZ2luQm90dG9tOjB9fSwgXCJUbzrCoMKgXCIpLCBcbiAgICBcbiAgICBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcImxhYmVsIGxhYmVsLXByaW1hcnlcIn0sIGVtYWlsKVxuICApLCBcbiAgUmVhY3QuRE9NLmxpKHtjbGFzc05hbWU6IFwibGlzdC1ncm91cC1pdGVtXCJ9LCBcbiAgICBSZWFjdC5ET00uaDUoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyxtYXJnaW5Ub3A6MCxtYXJnaW5Cb3R0b206MH19LCBcIlN1YmplY3Q6wqDCoFwiKSwgXCIgXCIsIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwibGFiZWwgbGFiZWwtcHJpbWFyeVwifSwgdGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUuc3ViamVjdClcbiAgKSwgXG4gIFJlYWN0LkRPTS5saSh7Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAtaXRlbSBib2R5XCJ9KVxuKVxuICBcbiAgICAgICAgICAgICAgICAgIClcblxuICAgICAgICAgICAgICAgICksIFxuXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwtZm9vdGVyXCIsIHN0eWxlOiB7ZGlzcGxheTonbm9uZSd9fSwgXG4gICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLWRlZmF1bHRcIiwgJ2RhdGEtZGlzbWlzcyc6IFwibW9kYWxcIn0sIFwiQ2xvc2VcIiksIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1wcmltYXJ5XCJ9LCBcIlNlbmQgRW1haWxcIilcbiAgICAgIClcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICApO1xuICB9LFxuXG4gIHByZXZpb3VzUHJvc3BlY3Q6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRQcm9zcGVjdDogdGhpcy5zdGF0ZS5jdXJyZW50UHJvc3BlY3QtMSB9KVxuICB9LFxuXG4gIG5leHRQcm9zcGVjdDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Y3VycmVudFByb3NwZWN0OiB0aGlzLnN0YXRlLmN1cnJlbnRQcm9zcGVjdCsxIH0pXG4gIH0sXG5cbiAgcGFyc2VUZW1wbGF0ZTogZnVuY3Rpb24odGVtcGxhdGVCb2R5KSB7XG4gICAgZmlyc3RfbmFtZSA9IHByb3NwZWN0Lm5hbWUuc3BsaXQoJyAnKVswXVxuICAgIC8vaGlyaW5nX3NpZ25hbCA9IHByb3NwZWN0LnNpZ25hbHNcblxuICAgIHNpZ25hbHMgPSAocHJvc3BlY3Quc2lnbmFscykgPyBwcm9zcGVjdC5zaWduYWxzWzBdIDogXCJcIlxuICAgIHRlbXBsYXRlQm9keSA9IE11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZUJvZHksIHtcbiAgICAgIGhpcmluZ19zaWduYWw6IHNpZ25hbHMsXG4gICAgICBmaXJzdF9uYW1lOiBfLnRpdGxlKHByb3NwZWN0Lm5hbWUuc3BsaXQoJyAnKVswXSlcbiAgICB9KVxuXG4gICAgLy9jb25zb2xlLmxvZyh0ZW1wbGF0ZUJvZHkpXG4gICAgICBcbiAgICByZXR1cm4gdGVtcGxhdGVCb2R5XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkVXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICAvL2NvbnNvbGUubG9nKHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlKVxuICAgIHBhcnNlZFRlbXBsYXRlID0gdGhpcy5wYXJzZVRlbXBsYXRlKHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLmJvZHkpXG4gICAgXG4gICAgLy8kKCcuYm9keScpLmh0bWwodGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUuYm9keSlcbiAgICAkKCcuYm9keScpLmh0bWwocGFyc2VkVGVtcGxhdGUpXG4gIH1cbn0pO1xuXG52YXIgVXNlclBsYWNlSG9sZGVyID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnVXNlclBsYWNlSG9sZGVyJyxcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiYnRuLWdyb3VwXCIsIHN0eWxlOiB7bWFyZ2luUmlnaHQ6NSxtYXJnaW5Cb3R0b206NX19LCBcbiAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiYnRuLWdyb3VwXCJ9LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIFxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi1zbVwifSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdXNlclwifSksIFwiwqDCoFwiLCBcbiAgICAgICAgICAgICAgKHRoaXMucHJvcHMucHJvc3BlY3QpID8gXy50aXRsZSh0aGlzLnByb3BzLnByb3NwZWN0Lm5hbWUpIDogXCJcIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIGNsYXNzTmFtZTogXCJidG4gYnRuLXN1Y2Nlc3MgYnRuLXNtXCJ9LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdHJhc2gtb1wifSlcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICApXG4gIH1cbn0pO1xuIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnZXhwb3J0cycsXG4gIC8vIFNlbnQgTWFpbFxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBzZW50RW1haWxzOiBbXVxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpc3MgPSB0aGlzO1xuICAgICQuYWpheCh7XG4gICAgICB1cmw6ICdodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzL1NlbnRFbWFpbCcsXG4gICAgICBkYXRhOntpbmNsdWRlOiAnY2FtcGFpZ24scHJvc3BlY3QscHJvc3BlY3QuZW1haWxfZ3Vlc3Nlcy5wYXR0ZXJuJ30sXG4gICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykgeyB0aGlzcy5zZXRTdGF0ZSh7c2VudEVtYWlsczogcmVzLnJlc3VsdHN9KSB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkge31cbiAgICB9KVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgc2VudEVtYWlscyA9IFtdXG4gICAgZm9yKGk9MDtpPCB0aGlzLnN0YXRlLnNlbnRFbWFpbHMubGVuZ3RoOyBpKyspIFxuICAgICAgc2VudEVtYWlscy5wdXNoKFNlbnRFbWFpbFJvdyh7c2VudEVtYWlsOiB0aGlzLnN0YXRlLnNlbnRFbWFpbHNbaV19KSlcblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtzdHlsZToge292ZXJmbG93OidhdXRvJyxoZWlnaHQ6NTUwfX0sIFxuICAgICAgICBSZWFjdC5ET00udGFibGUoe2NsYXNzTmFtZTogXCJ0YWJsZSB0YWJsZS1zdHJpcGVkXCIsIHN0eWxlOiB7bWFyZ2luQm90dG9tOjB9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnRoZWFkKG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS50aChudWxsLCBcIlByb3NwZWN0IE5hbWVcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKG51bGwsIFwiUHJvc3BlY3QgRW1haWxcIiksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnRoKHtzdHlsZToge3dpZHRoOjI5MH19LCBcIlN0YXR1c1wiKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00udGgobnVsbCwgXCJDYW1wYWlnblwiKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00udGgobnVsbCwgXCJUZW1wbGF0ZVwiKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS50Ym9keShudWxsLCBcbiAgICAgICAgICAgIHNlbnRFbWFpbHNcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApO1xuICB9XG59KTtcblxudmFyIFNlbnRFbWFpbFJvdyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ1NlbnRFbWFpbFJvdycsXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgc2VudEVtYWlsID0gdGhpcy5wcm9wcy5zZW50RW1haWxcbiAgICAvL2NvbnNvbGUubG9nKHNlbnRFbWFpbClcblxuICAgIGVtYWlsID0gc2VudEVtYWlsLmVtYWlsXG4gICAgaWYoZW1haWwgPT0gXCJub19lbWFpbFwiKXtcbiAgICAgIGZpcnN0ID0gc2VudEVtYWlsLnByb3NwZWN0Lm5hbWUuc3BsaXQoJyAnKVswXVxuICAgICAgbGFzdCA9IF8ubGFzdChzZW50RW1haWwucHJvc3BlY3QubmFtZS5zcGxpdCgnICcpKVxuXG4gICAgICBwYXR0ZXJuID0gXy5maW5kV2hlcmUoc2VudEVtYWlsLnByb3NwZWN0LmVtYWlsX2d1ZXNzZXMsIHsndHJpZWQnOmZhbHNlfSlcbiAgICAgIGRhdGEgPSB7Zmlyc3Q6IGZpcnN0LCBsYXN0OiBsYXN0LCBmaTogZmlyc3RbMF0sIGxpOiBsYXN0WzBdfVxuICAgICAgZW1haWwgPSBNdXN0YWNoZS5yZW5kZXIocGF0dGVybi5wYXR0ZXJuLnBhdHRlcm4sIGRhdGEpLnRvTG93ZXJDYXNlKClcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLnRyKG51bGwsIFxuICAgICAgICBSZWFjdC5ET00udGQobnVsbCwgUmVhY3QuRE9NLmg2KG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jbG9ja1wifSksIFxuICAgICAgICAgICAgbW9tZW50KHNlbnRFbWFpbC5jcmVhdGVkQXQpLmZyb21Ob3coKSkpLCBcbiAgICAgICAgUmVhY3QuRE9NLnRkKG51bGwsIFxuICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHtmb250U2l6ZToxNCxmb250V2VpZ2h0Oidib2xkJyxtYXJnaW5Cb3R0b206MH19LCBzZW50RW1haWwucHJvc3BlY3QubmFtZSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHttYXJnaW5Ub3A6NCxtYXJnaW5Cb3R0b206MH19LCBzZW50RW1haWwucHJvc3BlY3QucG9zLnRyaW0oKSksIFxuICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHttYXJnaW5Ub3A6NH19LCBzZW50RW1haWwucHJvc3BlY3QuY29tcGFueV9uYW1lKVxuICAgICAgICApLCBcbiAgICAgICAgUmVhY3QuRE9NLnRkKG51bGwsIFJlYWN0LkRPTS5oNihudWxsLCBlbWFpbCkpLCBcbiAgICAgICAgUmVhY3QuRE9NLnRkKHtzdHlsZToge3BhZGRpbmdUb3A6MTN9fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1kZWZhdWx0XCJ9LCBcIlF1ZXVlZFwiKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGV2cm9uLWNpcmNsZS1yaWdodCB0ZXh0LW11dGVkXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7cGFkZGluZ0xlZnQ6NSxwYWRkaW5nUmlnaHQ6NX19KSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1zdWNjZXNzXCJ9LCBcIk9wZW5lZFwiKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGV2cm9uLWNpcmNsZS1yaWdodCB0ZXh0LW11dGVkXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7cGFkZGluZ0xlZnQ6NSxwYWRkaW5nUmlnaHQ6NX19KSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1kZWZhdWx0XCJ9LCBcIkRlbGl2ZXJlZFwiKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGV2cm9uLWNpcmNsZS1yaWdodCB0ZXh0LW11dGVkXCIsIFxuICAgICAgICAgICAgIHN0eWxlOiB7cGFkZGluZ0xlZnQ6NSxwYWRkaW5nUmlnaHQ6NX19KSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1kZWZhdWx0XCJ9LCBcIlJlcGxpZWRcIilcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS50ZChudWxsLCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7Y3Vyc29yOidwb2ludGVyJ319LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWxpc3QtYWx0XCJ9KSwgXCIgwqBcIiArICcgJyArXG4gICAgICAgICAgXCJCb3N0b24gVlAgU2FsZXMgLSBSZXRhaWxcIlxuICAgICAgICAgIClcbiAgICAgICAgKSwgXG4gICAgICAgIFJlYWN0LkRPTS50ZChudWxsLCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7Y3Vyc29yOidwb2ludGVyJ319LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWZpbGUtdGV4dC1vXCJ9KSwgXCIgwqBcIiArICcgJyArXG4gICAgICAgICAgXCJGb2xsb3d1cCAjMiAtIFByb3ZpZGUgVmFsdWUgXCIsIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcIiBTdWJqZWN0OiBKdXN0IHdhbnRlZCB0byBmb2xsb3d1cCBvbiB0aGUgbGFzdCBlbWFpbCBcIiksIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcIiBCb2R5OiBKdXN0IHdhbnRlZCB0byBmb2xsb3d1cCBvbiB0aGUgbGFzdCBlbWFpbCBcIilcblxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgfVxufSlcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG52YXIgRWRpdFRlbXBsYXRlVmlldyA9IHJlcXVpcmUoJy4vZWRpdF90ZW1wbGF0ZS5qcy5taW4uanMnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvL1RlbXBsYXRlc1xuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBzZWxlY3RlZFRlbXBsYXRlOiAwLFxuICAgICAgZWRpdE1vZGU6IGZhbHNlXG4gICAgfVxuICB9LFxuXG4gIGNoYW5nZU1vZGU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2VkaXRNb2RlOiAhdGhpcy5zdGF0ZS5lZGl0ZU1vZGV9KVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdGVtcGxhdGVWaWV3ID0gKCF0aGlzLnN0YXRlLmVkaXRNb2RlKSA/IFRlbXBsYXRlVmlldyh7Y2hhbmdlTW9kZTogdGhpcy5jaGFuZ2VNb2RlfSkgOiBFZGl0VGVtcGxhdGVWaWV3KG51bGwpXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYobnVsbCwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe3N0eWxlOiB7aGVpZ2h0OicxMDAlJ319LCBcbiAgICAgICAgICBUZW1wbGF0ZVNpZGVNZW51KG51bGwpLCBcbiAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiY29sLW1kLTlcIiwgc3R5bGU6IHtwYWRkaW5nOjAsaGVpZ2h0OicxMDAlJ319LCBcbiAgICAgICAgICAgICAgdGVtcGxhdGVWaWV3XG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgKTtcbiAgfVxufSk7XG5cblxudmFyIFRlbXBsYXRlVmlldyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ1RlbXBsYXRlVmlldycsXG4gIGNoYW5nZU1vZGU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHJvcHMuY2hhbmdlTW9kZSgpXG4gIH0sXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbCBwYW5lbC1pbmZvXCIsIHN0eWxlOiB7d2lkdGg6JzEwMCUnLGhlaWdodDonMTAwJScsYm9yZGVyOjB9fSwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbC1oZWFkaW5nXCJ9LCBcbiAgICAgICAgICBcIlRlbXBsYXRlIE5hbWVcIiwgIFxuICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuY2hhbmdlTW9kZSwgXG4gICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tcHJpbWFyeSBidG4teHNcIiwgXG4gICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidibG9jaycsZmxvYXQ6J3JpZ2h0JyxtYXJnaW5Ub3A6JzBweCd9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBlbmNpbC1zcXVhcmVcIn0pLCBcIiDCoCBFZGl0IFRlbXBsYXRlXCIpXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtYm9keVwifSwgXG4gICAgICAgIFJlYWN0LkRPTS5oNChudWxsLCBcIkZvbGxvd3VwIC0gUHJvc3BlY3RpbmcgU0FBUyBPdXRyZWFjaFwiKSwgXG4gICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHttYXJnaW5Cb3R0b206JzAnfSwgY2xhc3NOYW1lOiBcInRleHQtbXV0ZWRcIn0sIFwiQ3JlYXRlZCBieSBNYXJrIG9uIEp1bC4gMjEsIDIwMTRcIiksIFxuICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7bWFyZ2luVG9wOicwJ30sIGNsYXNzTmFtZTogXCJ0ZXh0LW11dGVkXCJ9LCBcImxhc3QgdXBkYXRlZCA3IGRheXMgYWdvXCIpLCBcbiAgICAgICAgUmVhY3QuRE9NLmJyKG51bGwpLCBcbiAgICAgICAgUmVhY3QuRE9NLmJyKG51bGwpLCBcblxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwgcGFuZWwtZGVmYXVsdFwifSwgXG5cbiAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtYm9keVwifSwgXG4gICAgICAgICAgXCIxNSBtaW51dGVzIHRvIGdldCBjb21wYW55X25hbWUgbW9yZSBjdXN0b21lcnNcIiArICcgJyArXG4gICAgICAgICAgXCJIZXkgZmlyc3RfbmFtZSxcIiArICcgJyArXG5cbiAgICAgICAgICBcIldvdWxkIHlvdSBsaWtlIHRvIGhlYXIgYW4gaWRlYSBmb3IgYSAxNSBtaW51dGUgaGFjayB0aGF0IGNvdWxkIHNpZ25pZmljYW50bHkgaW5jcmVhc2UgdGhlIG51bWJlciBvZiBwcm9zcGVjdHMgeW91ciBzYWxlcyBwZW9wbGUgaGF2ZSBhY2Nlc3MgdG8gP1wiICsgJyAnICtcbiAgICAgICAgICAgXG4gICAgICAgICAgXCJSZWNlbnRseSBvbmUgb2Ygb3VyIEIyQiBjbGllbnRzIHNhdyBhIGh1Z2UgaW5jcmVhc2UgaW4gdHJpYWwgc2lnbiB1cHMgYWZ0ZXIgd29ya2luZyB3aXRoIHVzLiBmaXJzdF9uYW1lLCBsZXRzIHNjaGVkdWxlIGEgMTUgbWludXRlIGNhbGwgdGhpcyB3ZWVrIHRvIHNlZSBpZiB0aGlzIHdvdWxkIGJlIGEgZ29vZCBmaXQgZm9yIGJvdGggb2YgdXMuXCIgKyAnICcgK1xuICAgICAgICAgICBcbiAgICAgICAgICBcIldoYXQgdGhlIGJlc3QgdGltZSBmb3IgeW91IHRoaXMgd2VlayA/XCIgKyAnICcgK1xuICAgICAgICAgICBcbiAgICAgICAgICBcIi0tXCIgKyAnICcgK1xuICAgICAgICAgIFwiTWFya1wiICsgJyAnICsgXG4gICAgICAgICAgXCJDdXN0b21lcm9cIiArICcgJyArXG4gICAgICAgICAgXCJtYXJrQGN1c3RvbWVyb2hxLmNvbVwiXG4gICAgICAgICAgXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgKVxuICAgICk7XG4gIH0sXG59KTtcblxudmFyIFRlbXBsYXRlU2lkZU1lbnUgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdUZW1wbGF0ZVNpZGVNZW51JyxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGVtcGxhdGVzOiBbXSxcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIC8vQWpheCBSZXF1ZXN0IEZvciBUZW1wbGF0ZXNcbiAgICAvKlxuICAgICAkLmFqYXgoe1xuICAgICAgdXJsOicnLFxuICAgICAgaGVhZGVyczogXCJcIixcbiAgICAgIGRhdGE6IFwiXCIsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHtcbiAgICAgIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oKSB7XG4gICAgICB9XG4gICAgIH0pO1xuICAgICovXG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB0ZW1wbGF0ZXMgPSBbXVxuICAgIGZvcihpPTA7aTwgdGhpcy5zdGF0ZS50ZW1wbGF0ZXMubGVuZ3RoOyBpKyspXG4gICAgICB0ZW1wbGF0ZXMucHVzaChSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBjbGFzc05hbWU6IFwibGlzdC1ncm91cC1pdGVtXCJ9LCBcInRlbXBsYXRlc1tpXS5uYW1lXCIpKVxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiY29sLW1kLTNcIiwgc3R5bGU6IHtwYWRkaW5nOicwJywgYm9yZGVyUmlnaHQ6JzFweCBzb2xpZCAjZGRkJyxoZWlnaHQ6JzEwMCUnLHRleHRBbGlnbjonY2VudGVyJ319LCBcbiAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcInBhbmVsIHBhbmVsLWRlZmF1bHRcIiwgc3R5bGU6IHtib3JkZXI6MH19LCBcbiAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwtaGVhZGluZ1wiLCBzdHlsZToge2hlaWdodDo2MH19LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtzdHlsZToge2Zsb2F0OidsZWZ0Jyxmb250U2l6ZToyMCxmb250V2VpZ2h0Oidib2xkJ319LCBcbiAgICAgICAgICAgICAgXCJUZW1wbGF0ZXNcIlxuICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIFwiLCBcbiAgICAgICAgICAgICAgICBzdHlsZToge2Zsb2F0OidyaWdodCd9fSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGx1c1wifSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00udWwoe2NsYXNzTmFtZTogXCJsaXN0LWdyb3VwXCIsIHN0eWxlOiB7dGV4dEFsaWduOidsZWZ0J319LCBcbiAgICAgICAgICAgIHRlbXBsYXRlc1xuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgfVxufSk7XG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdleHBvcnRzJyxcbiAgLy9UZW1wbGF0ZXNNZW51XG4gIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IGZ1bmN0aW9uKGN1cnJlbnRUZW1wbGF0ZSkge1xuICAgIHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudShjdXJyZW50VGVtcGxhdGUpXG4gIH0sXG5cbiAgY3JlYXRlVGVtcGxhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSh7XG4gICAgICBuYW1lOiAnJyxcbiAgICAgIGJvZHk6JycsXG4gICAgICBzdWJqZWN0OicnLFxuICAgICAgZWRpdE1vZGU6dHJ1ZSxcbiAgICAgIG5ld1RlbXBsYXRlOiB0cnVlXG4gICAgfSwgdHJ1ZSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIC8vY29uc29sZS5sb2codGhpcy5wcm9wcy50ZW1wbGF0ZXMpXG4gICAgdGVtcGxhdGVzID0gW11cbiAgICBmb3IoaT0wO2k8IHRoaXMucHJvcHMudGVtcGxhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0ZW1wbGF0ZXMucHVzaChcbiAgICAgICAgVGVtcGxhdGVMaXN0SXRlbSh7XG4gICAgICAgICAgdG9nZ2xlVGVtcGxhdGVFZGl0TWVudTogdGhpcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51LCBcbiAgICAgICAgICB0ZW1wbGF0ZTogdGhpcy5wcm9wcy50ZW1wbGF0ZXNbaV19KVxuICAgICAgKVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiXCIsIHN0eWxlOiB7cGFkZGluZzonMCcsIGhlaWdodDonMTAwJScsdGV4dEFsaWduOidjZW50ZXInfX0sIFxuICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwicGFuZWwgcGFuZWwtZGVmYXVsdFwiLCBcbiAgICAgICAgICAgICBzdHlsZToge2JvcmRlclJpZ2h0OjAsYm9yZGVyUmFkaXVzOjAsaGVpZ2h0OicxMDAlJywgb3ZlcmZsb3c6J2F1dG8nfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJwYW5lbC1oZWFkaW5nXCIsIHN0eWxlOiB7aGVpZ2h0OjQwfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe3N0eWxlOiB7ZmxvYXQ6J2xlZnQnLGZvbnRTaXplOjE0LGZvbnRXZWlnaHQ6J2JvbGQnfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLWZpbGUtdGV4dC1vXCJ9KSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtzdHlsZToge21hcmdpbkxlZnQ6NX19LCBcIlRlbXBsYXRlc1wiKVxuICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tc3VjY2VzcyBidG4teHNcIiwgXG4gICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuY3JlYXRlVGVtcGxhdGUsIFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7ZmxvYXQ6J3JpZ2h0J319LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wbHVzXCJ9KSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtzdHlsZToge21hcmdpbkxlZnQ6NX19LCBcIkNyZWF0ZSBUZW1wbGF0ZVwiKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS51bCh7Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXBcIiwgXG4gICAgICAgICAgICAgIHN0eWxlOiB7dGV4dEFsaWduOidsZWZ0J319LCBcbiAgICAgICAgICAgIHRlbXBsYXRlc1xuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgfVxufSk7XG5cbnZhciBUZW1wbGF0ZUxpc3RJdGVtID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnVGVtcGxhdGVMaXN0SXRlbScsXG4gIHRvZ2dsZVRlbXBsYXRlRWRpdE1lbnU6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKHRoaXMucHJvcHMudGVtcGxhdGUpXG4gICAgdGVtcGxhdGUgPSB0aGlzLnByb3BzLnRlbXBsYXRlXG4gICAgdGVtcGxhdGUuZWRpdE1vZGUgPSBmYWxzZVxuICAgIHRoaXMucHJvcHMudG9nZ2xlVGVtcGxhdGVFZGl0TWVudSh0ZW1wbGF0ZSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICBzdHlsZToge2JvcmRlckJvdHRvbTogJzFweCBzb2xpZCByZ2IoMjIxLCAyMjEsIDIyMSknLHBhZGRpbmdUb3A6NSxwYWRkaW5nQm90dG9tOjB9LCBcbiAgICAgICAgICAgb25DbGljazogdGhpcy50b2dnbGVUZW1wbGF0ZUVkaXRNZW51LCBcbiAgICAgICAgICAgY2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAtaXRlbVwifSwgXG4gICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKHtjbGFzc05hbWU6IFwibGFiZWwgbGFiZWwtZGVmYXVsdFwifSwgXG4gICAgICAgICAgICAgdGhpcy5wcm9wcy50ZW1wbGF0ZS5uYW1lXG4gICAgICAgICAgICksIFxuICAgICAgICAgICBSZWFjdC5ET00uaDYobnVsbCwgXCJTdWJqZWN0OlwiLCBSZWFjdC5ET00uc3Bhbih7Y2xhc3NOYW1lOiBcInRleHQgdGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgICAgXCIgXCIgKyB0aGlzLnByb3BzLnRlbXBsYXRlLnN1YmplY3RcbiAgICAgICAgICAgKSlcbiAgICAgICAgIClcbiAgICAgIClcbiAgICApO1xuICB9XG59KTtcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvLyBUaW1lbGluZURheUVsZW1lbnRcbiAgLy8gVE9ET1xuICAvLyAtIGFkZCBwcm9zcGVjdCBsaXN0IHByb2dyZXNzaW9uXG4gIC8vIC0gYWRkIHNjaGVkdWxlZCBmb2xsb3d1cFxuICAvL1xuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIC8vIFxuICAgIHJldHVybiB7XG4gICAgICBmb2xsb3d1cENvbXBsZXRlZDogMCxcbiAgICB9XG4gIH0sXG5cbiAgYWRkRm9sbG93dXA6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHJvcHMuYWRkRm9sbG93dXAodGhpcy5wcm9wcy5kYXlDb3VudClcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIGlmKHRoaXMucHJvcHMuYWRkVGVtcGxhdGVNb2RlKSB7XG4gICAgICBtb2RlID0gRWRpdFRlbXBsYXRlKHthZGRGb2xsb3d1cDogdGhpcy5wcm9wcy5hZGRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlRm9sbG93dXA6IHRoaXMucHJvcHMuc2F2ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZvbGxvd3VwOiB0aGlzLnByb3BzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNvdW50OiB0aGlzLnByb3BzLmRheUNvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlczogdGhpcy5wcm9wcy50ZW1wbGF0ZXN9KVxuICAgIH0gZWxzZSB7XG4gICAgICBtb2RlID0gVGVtcGxhdGVGb2xsb3d1cCh7Y3VycmVudFRlbXBsYXRlOiB0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEZvbGxvd3VwOiB0aGlzLnByb3BzLmVkaXRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5Q291bnQ6IHRoaXMucHJvcHMuZGF5Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCYXRjaDogdGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0JhdGNoOiB0eXBlb2YodGhpcy5wcm9wcy5iYXRjaENvdW50KSAhPSBcInVuZGVmaW5lZFwiICYmIHRoaXMucHJvcHMuYmF0Y2hDb3VudCA+IDAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEN1cnJlbnRCYXRjaDogdGhpcy5wcm9wcy5zZXRDdXJyZW50QmF0Y2gsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNvdW50OiB0aGlzLnByb3BzLmRheUNvdW50LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVGb2xsb3d1cDogdGhpcy5wcm9wcy5yZW1vdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudFRlbXBsYXRlOiB0aGlzLnByb3BzLnNldEN1cnJlbnRUZW1wbGF0ZX0pXG4gICAgfVxuICAgIGlmKHRoaXMucHJvcHMuYWxyZWFkeVNlbnQpIHtcbiAgICAgIG1vZGUgPSBGb2xsb3d1cENvbXBsZXRlZCh7Y3VycmVudFRlbXBsYXRlOiB0aGlzLnByb3BzLmN1cnJlbnRUZW1wbGF0ZX0pXG4gICAgfVxuXG4gICAgbW9kZSA9ICh0aGlzLnByb3BzLmVsZW1lbnRUeXBlKSA/IFwiXCIgOiBtb2RlXG4gICAgYWRkRm9sbG93dXAgPSAodGhpcy5wcm9wcy5lbGVtZW50VHlwZSkgPyB0aGlzLmFkZEZvbGxvd3VwIDogXCJcIlxuICAgIGlmKHR5cGVvZih0aGlzLnByb3BzLmJhdGNoQ291bnQpICE9IFwidW5kZWZpbmVkXCIpXG4gICAgICBiYXRjaFN0YWdlID0gQmF0Y2hTdGFnZSh7Y3VycmVudEJhdGNoOiB0aGlzLnByb3BzLmN1cnJlbnRCYXRjaCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UHJvc3BlY3RzOiB0aGlzLnByb3BzLm5ld1Byb3NwZWN0cywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvc3BlY3RMaXN0Q291bnQ6IHRoaXMucHJvcHMucHJvc3BlY3RMaXN0Q291bnQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoQ291bnQ6IHRoaXMucHJvcHMuYmF0Y2hDb3VudCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzU2NoZWR1bGVkRW1haWw6IG1vZGUgIT0gXCJcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5Q291bnQ6IHRoaXMucHJvcHMuZGF5Q291bnR9KVxuICAgIGVsc2VcbiAgICAgIGJhdGNoU3RhZ2UgPSBcIlwiXG5cbiAgICBkYXlDb3VudCA9ICh0aGlzLnByb3BzLmRheUNvdW50ICE9IDAuNSkgPyBcIkRcIit0aGlzLnByb3BzLmRheUNvdW50IDogXCJcIlxuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LkRPTS5kaXYobnVsbCwgXG4gICAgICAgIFJlYWN0LkRPTS5kaXYoe29uQ2xpY2s6IGFkZEZvbGxvd3VwLCBjbGFzc05hbWU6IFwiZGF5XCIsICdkYXRhLXRyaWdnZXInOiBcIm1hbnVhbFwifSwgXG4gICAgICAgICAgZGF5Q291bnRcbiAgICAgICAgKSwgXG4gICAgICAgIG1vZGUsIGJhdGNoU3RhZ2VcbiAgICAgIClcbiAgICApXG4gIH0sXG5cbiAgc2V0Q3VycmVudFRlbXBsYXRlOiBmdW5jdGlvbih0ZW1wbGF0ZSkge1xuICAgIHRoaXMucHJvcHMuc2V0Q3VycmVudFRlbXBsYXRlKHRlbXBsYXRlKVxuICB9XG59KTtcblxudmFyIEZvbGxvd3VwQ29tcGxldGVkID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnRm9sbG93dXBDb21wbGV0ZWQnLFxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiZm9sbG93dXAtcGxhY2VtZW50IGFycm93X2JveF8xIHRtcF8yXCJ9LCBcbiAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge3dpZHRoOjEzMCxkaXNwbGF5OidpbmxpbmUtYmxvY2snfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZmlsZS10ZXh0LW9cIn0pLCBcIsKgwqBcIiwgXG4gICAgICAgICAgKHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlKSA/IHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLm5hbWUgOiBcIlwiXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHtjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLXN1Y2Nlc3MgYnRuLXhzIGRpc2FibGVkXCIsIFxuICAgICAgICAgICAgICAgICdkYXRhLXRhcmdldCc6IFwiLmJzLXNlbmRFbWFpbC1tb2RhbC1sZ1wiLCBcbiAgICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLnNldEN1cnJlbnRUZW1wbGF0ZSwgXG4gICAgICAgICAgICAgICAgJ2RhdGEtdG9nZ2xlJzogXCJtb2RhbFwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1jaGVja1wifSksIFwiwqBTZW50XCIpLCBcIsKgXCIsIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLmVkaXRGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBkaXNhYmxlZFwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wZW5jaWxcIn0pKSwgXCLCoFwiLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5yZW1vdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBkaXNhYmxlZFwifSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS10cmFzaC1vXCJ9KSlcbiAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICB9XG59KVxuXG52YXIgVGVtcGxhdGVGb2xsb3d1cCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ1RlbXBsYXRlRm9sbG93dXAnLFxuICAvLyBFZGl0TW9kZSBGYWxzZVxuXG4gIHNldEN1cnJlbnRUZW1wbGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5wcm9wcy5zZXRDdXJyZW50VGVtcGxhdGUodGhpcy5wcm9wcy5jdXJyZW50VGVtcGxhdGUpXG4gICAgLy8gc2V0Q3VycmVudEJhdGNoXG4gICAgdGhpcy5wcm9wcy5zZXRDdXJyZW50QmF0Y2godGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gpXG4gICAgJCgnLmJzLXNlbmRFbWFpbC1tb2RhbC1sZycpLm1vZGFsKClcbiAgfSxcblxuICB3YWl0Rm9yQmF0Y2g6IGZ1bmN0aW9uKCkge1xuICAgIGFsZXJ0aWZ5LmxvZyhcIllvdSBtdXN0IHdhaXQgZm9yIGEgYmF0Y2ghXCIpO1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdHJhc2ggPSAodGhpcy5wcm9wcy5kYXlDb3VudCA9PSAwKSA/ICBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGRpc2FibGVkXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pKSA6IFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMucmVtb3ZlRm9sbG93dXAsIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHNcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtdHJhc2gtb1wifSkpIFxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiZm9sbG93dXAtcGxhY2VtZW50IGFycm93X2JveF8xIHRtcF8yXCJ9LCBcbiAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge3dpZHRoOjEzMCxkaXNwbGF5OidpbmxpbmUtYmxvY2snfX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtZmlsZS10ZXh0LW9cIn0pLCBcIsKgwqBcIiwgXG4gICAgICAgICAgKHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlKSA/IHRoaXMucHJvcHMuY3VycmVudFRlbXBsYXRlLm5hbWUgOiBcIlwiXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHtjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLXN1Y2Nlc3MgYnRuLXhzXCIsIFxuICAgICAgICAgIG9uQ2xpY2s6ICh0aGlzLnByb3BzLmhhc0JhdGNoKSA/IHRoaXMuc2V0Q3VycmVudFRlbXBsYXRlIDogdGhpcy53YWl0Rm9yQmF0Y2gsIFxuICAgICAgICAgICAgICAgICdkYXRhLXRvZ2dsZSc6IFwibW9kYWxcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGFwZXItcGxhbmVcIn0pLCBcIsKgU2VuZFwiKSwgXCLCoFwiLCBcbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7b25DbGljazogdGhpcy5lZGl0Rm9sbG93dXAsIFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHNcIn0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtcGVuY2lsXCJ9KSksIFwiwqBcIiwgXG4gICAgICAgIHRyYXNoXG4gICAgICApXG4gICAgKTtcbiAgfSxcblxuICBlZGl0Rm9sbG93dXA6IGZ1bmN0aW9uKGUpIHsgXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY29uc29sZS5sb2codGhpcy5wcm9wcy5kYXlDb3VudClcbiAgICB0aGlzLnByb3BzLmVkaXRGb2xsb3d1cCh0aGlzLnByb3BzLmRheUNvdW50KVxuICB9LFxuXG4gIHJlbW92ZUZvbGxvd3VwOiBmdW5jdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZygncmVtb3ZlJylcbiAgICB0aGlzLnByb3BzLnJlbW92ZUZvbGxvd3VwKHRoaXMucHJvcHMuZGF5Q291bnQpXG4gIH1cbn0pO1xuXG52YXIgQmF0Y2hTdGFnZSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ0JhdGNoU3RhZ2UnLFxuICAvLyBEaWZmZXJlbnQgU3RhZ2VzIG9mIFBlb3BsZSBBZGRlZCB0byBQcm9zcGVjdCBMaXN0XG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGluaXRpYWxCYXRjaENvdW50OiB0aGlzLnByb3BzLmJhdGNoQ291bnRcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIC8vIHN0YXRlXG4gICAgLy9jb25zb2xlLmRlYnVnKCdJTlNJREUgQkFUQ0ggJyt0aGlzLnByb3BzLmRheUNvdW50KVxuICAgIGNvbnNvbGUuZGVidWcodGhpcy5wcm9wcy5jdXJyZW50QmF0Y2gpXG4gICAgX2JhdGNoZXMgPSBhcHBDb25maWcucG9pbnRlcignUHJvc3BlY3RCYXRjaCcsIHRoaXMucHJvcHMuY3VycmVudEJhdGNoKVxuICAgIGlmKHRoaXMucHJvcHMuYmF0Y2hDb3VudCA9PSBcIn5cIikge1xuICAgICAgLy8gV2h5IGRvZXNudCB0aGlzIHdvcmsgXG4gICAgICB2YXIgdGhpc3NzcyA9IHRoaXM7XG4gICAgICBjb25zb2xlLmRlYnVnKCdJTlNJREUgQkFUQ0ggJyt0aGlzcy5wcm9wcy5kYXlDb3VudClcbiAgICAgIGNvbnNvbGUuZGVidWcoX2JhdGNoZXMpXG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvUHJvc3BlY3QnLFxuICAgICAgICBiYXRjaGVzOiBfYmF0Y2hlcyxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHdoZXJlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBiYXRjaGVzOiBfYmF0Y2hlc1xuICAgICAgICAgIH0pLFxuICAgICAgICAgIGNvdW50OiB0cnVlLFxuICAgICAgICAgIGxpbWl0OjEwMDAsXG4gICAgICAgIH0sXG4gICAgICAgIGhlYWRlcnM6IGFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgXG4gICAgICAgICAgLy9jb25zb2xlLmRlYnVnKCdTVUNDRVNTIEdFVCBDT1VOVCAnICsgcmVzLmNvdW50KVxuICAgICAgICAgIC8vY29uc29sZS5kZWJ1ZyhyZXMucmVzdWx0cykgXG4gICAgICAgICAgdGhpc3Nzcy5zZXRTdGF0ZSh7aW5pdGlhbEJhdGNoQ291bnQ6IHJlcy5jb3VudH0pXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHsgXG4gICAgICAgICAgdGhpc3Nzcy5zZXRTdGF0ZSh7aW5pdGlhbEJhdGNoQ291bnQ6IDAgfSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24obmV4dFByb3BzKSB7XG4gICAgaWYodGhpcy5wcm9wcy5kYXlDb3VudCA9PSAwKVxuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGluaXRpYWxCYXRjaENvdW50OiBuZXh0UHJvcHMuYmF0Y2hDb3VudCB9KVxuICB9LFxuXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBpZih0aGlzLnByb3BzLmhhc1NjaGVkdWxlZEVtYWlsKVxuICAgICAgYmF0Y2hTdGFnZVN0eWxlID0ge3RvcDotNDIsIGxlZnQ6Nn1cbiAgICBlbHNlXG4gICAgICBiYXRjaFN0YWdlU3R5bGUgPSB7fVxuXG4gICAgaWYodGhpcy5wcm9wcy5kYXlDb3VudCA9PSAwLjUpXG4gICAgICBiYXRjaFN0YWdlU3R5bGUubGVmdCA9IDdcblxuICAgIC8vY29uc29sZS5sb2coJ0JBVENIIFNUQUdFJylcbiAgICAvL2NvbnNvbGUubG9nKHRoaXMucHJvcHMpXG4gICAgLy9jb25zb2xlLmRlYnVnKHRoaXMucHJvcHMuY3VycmVudEJhdGNoKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImZvbGxvd3VwLXBsYWNlbWVudCBhcnJvd19ib3ggdG1wXCIsIHN0eWxlOiBiYXRjaFN0YWdlU3R5bGV9LCBcbiAgICAgICAgUmVhY3QuRE9NLnNwYW4oe2NsYXNzTmFtZTogXCJsYWJlbCBsYWJlbC1wcmltYXJ5XCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXVzZXJcIn0pLCBcIsKgXCIsIFxuICAgICAgICAgIHRoaXMuc3RhdGUuaW5pdGlhbEJhdGNoQ291bnRcbiAgICAgICAgKSwgXCLCoFwiLCBcbiAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jayd9fSwgXG4gICAgICAgICAgXCJwcm9zcGVjdHMgaW4gdGhlIHNhbGVzIGN5Y2xlLlwiKVxuICAgICAgKVxuICAgICk7XG4gIH1cbn0pO1xuXG52YXIgRWRpdFRlbXBsYXRlID0gUmVhY3QuY3JlYXRlQ2xhc3Moe2Rpc3BsYXlOYW1lOiAnRWRpdFRlbXBsYXRlJyxcbiAgLy8gRWRpdCBNb2RlIC0gVHJ1ZVxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIG9wdGlvbnMgPSBbXVxuICAgIGZvcihpPTA7aTwgdGhpcy5wcm9wcy50ZW1wbGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIG9wdGlvbnMucHVzaCggUmVhY3QuRE9NLm9wdGlvbihudWxsLCB0aGlzLnByb3BzLnRlbXBsYXRlc1tpXS5uYW1lKSlcbiAgICB9XG4gICAgdHJhc2ggPSAodGhpcy5wcm9wcy5kYXlDb3VudCA9PSAwKSA/ICBSZWFjdC5ET00uYnV0dG9uKHtvbkNsaWNrOiB0aGlzLnJlbW92ZUZvbGxvd3VwLCBcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwid2luLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGRpc2FibGVkXCJ9LCBcbiAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pKSA6IFJlYWN0LkRPTS5idXR0b24oe29uQ2xpY2s6IHRoaXMucmVtb3ZlRm9sbG93dXAsIGNsYXNzTmFtZTogXCJ3aW4tYnRuIGJ0biBidG4tZGVmYXVsdCBidG4teHNcIn0sIFwiIFwiLCBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXRyYXNoLW9cIn0pKSBcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcImZvbGxvd3VwLXBsYWNlbWVudCBhcnJvd19ib3hfMSB0bXBfMlwifSwgXG4gICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHt3aWR0aDo1NSxkaXNwbGF5OidpbmxpbmUtYmxvY2snfSwgXG4gICAgICAgICAgICBjbGFzc05hbWU6IFwidGV4dC1tdXRlZFwifSwgXG4gICAgICAgICAgXCJDaG9vc2UgOlwiXG4gICAgICAgICksIFxuICAgICAgICBSZWFjdC5ET00uc2VsZWN0KHtjbGFzc05hbWU6IFwiZm9ybS1jb250cm9sIGlucHV0LXNtXCIsIFxuICAgICAgICAgICAgICAgIGlkOiBcImNob29zZVRlbXBsYXRlRm9yRm9sbG93dXBcIiwgXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snLHdpZHRoOjEyNyxtYXJnaW5SaWdodDo1fX0sIFxuICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgKSwgXG5cbiAgICAgICAgUmVhY3QuRE9NLmJ1dHRvbih7Y2xhc3NOYW1lOiBcIndpbi1idG4gYnRuIGJ0bi1zdWNjZXNzIGJ0bi14c1wiLCBcbiAgICAgICAgICAgICAgICBvbkNsaWNrOiB0aGlzLnNhdmVGb2xsb3d1cCwgXG4gICAgICAgICAgICAgICAgc3R5bGU6IHttYXJnaW5SaWdodDo1fX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5pKHtjbGFzc05hbWU6IFwiZmEgZmEtY2hlY2tcIn0pKSwgXG4gICAgICAgIHRyYXNoXG4gICAgICApXG4gICAgKVxuICB9LFxuXG4gIHNhdmVGb2xsb3d1cDogZnVuY3Rpb24oZSkge1xuICAgIC8vZ2V0IHRlbXBsYXRlIGZyb20gY3VycmVudFRlbXBsYXRlXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY2hvc2VuVGVtcGxhdGUgPSAkKCcjY2hvb3NlVGVtcGxhdGVGb3JGb2xsb3d1cCcpLnZhbCgpXG4gICAgY29uc29sZS5sb2coY2hvc2VuVGVtcGxhdGUpXG4gICAgZm9yKGk9MDtpPCB0aGlzLnByb3BzLnRlbXBsYXRlcy5sZW5ndGg7IGkrKyl7XG4gICAgICBpZih0aGlzLnByb3BzLnRlbXBsYXRlc1tpXS5uYW1lID09IGNob3NlblRlbXBsYXRlKXtcbiAgICAgICAgY2hvc2VuVGVtcGxhdGUgPSB0aGlzLnByb3BzLnRlbXBsYXRlc1tpXVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhjaG9zZW5UZW1wbGF0ZSlcbiAgICBcbiAgICB0aGlzLnByb3BzLnNhdmVGb2xsb3d1cCh0aGlzLnByb3BzLmRheUNvdW50LCBjaG9zZW5UZW1wbGF0ZSlcbiAgfSxcblxuICByZW1vdmVGb2xsb3d1cDogZnVuY3Rpb24oZGF5KSB7XG4gICAgdGhpcy5wcm9wcy5yZW1vdmVGb2xsb3d1cCh0aGlzLnByb3BzLmRheUNvdW50KVxuICB9LFxufSk7XG5cbiJdfQ==
