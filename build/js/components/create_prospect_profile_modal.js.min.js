(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

module.exports = React.createClass({displayName: 'exports',
  // createCompanyProfileModal
  createProfile: function() {
    profileName = $(".profileName").val()

    titleProfile = {
      'className': 'ProspectTitleProfile',
      'title_keywords'    : $('.prospect-profile-title').tagsinput('items').reverse()
    }

    /*
    locationProfile = {
      'className': 'LocationProfile',
      'locale'    : $('.prospect-location-profile').tagsinput('items').reverse()
    }

    companySizeProfile = {
      'className':'EmployeeProfile', 
      'employees': _.map($('#prospect-profile-companySizeBtns').find('.active'), 
                        function(revBtn){ return $(revBtn).text().trim() }).reverse()
    }

    revenueProfile = {
      'className':'RevenueProfile', 
      'revenues': _.map($('#prospect-profile-companyRevenueBtns').find('.active'), 
                        function(revBtn){ return $(revBtn).text().trim() }).reverse()
    }

    profiles = [titleProfile, locationProfile,
                companySizeProfile, revenueProfile]
    */
    profiles = [titleProfile]

    nonemptyProfiles = _.filter(profiles, function(profile) {
      if(_.values(profile)[1]){ return _.values(profile)[1].length }
    });

    newProfile = {
      name: profileName,
      //autoProspect: autoProspect,
      profiles: nonemptyProfiles,
      type: 'prospect_profile',
      mining_job:true,
      user:{
        __type:'Pointer',
        className:'_User',
        objectId:JSON.parse(localStorage.currentUser).objectId
      },
      company: JSON.parse(localStorage.currentUser).company
    }

    if(nonemptyProfiles.length) {
      this.persistSignal(nonemptyProfiles, 
                         _.omit(newProfile,'profiles'))
      this.props.addProfile(newProfile)
      $('.modal').click()
      $('.prospect-profile-title').val('')
    }
  },

  persistSignal: function(nonemptyProfiles, newProfile) {
    console.log('NEW PROFILE')
    console.log(newProfile)
    $.ajax({
      url:'https://api.parse.com/1/classes/ProspectProfile',
      headers:appConfig.headers,
      type:'POST',
      data:JSON.stringify(newProfile),
      success:function(ress) {
        // Create Signal List ->  Update Prospect Profile
        newProfile.user = {
          __type: 'Pointer',
          className:'_User',
          objectId: JSON.parse(localStorage.currentUser).objectId
        }
        newProfile.company = JSON.parse(localStorage.currentUser).company
        if(newProfile.type == 'prospect_profile')
          newProfile.mining_job_list = true

        $.ajax({
          url: 'https://api.parse.com/1/classes/ProspectList',
          type: 'POST',
          headers: appConfig.headers,
          data:JSON.stringify(_.pick(newProfile, 'name','user',
                                     'company','mining_job_list')),
          success: function(res) {
            $.ajax({
              url:'https://api.parse.com/1/classes/ProspectProfile/'+ress.objectId,
              type:'PUT',
              headers: appConfig.headers,
              data: JSON.stringify({ 'prospect_list':{ __type:'Pointer',
                                    className:'ProspectList',objectId:res.objectId } }),
              success: function(res){ console.log(res) },
              error: function(err){ console.log(err) }
            })
          },
          error: function() { }
        })

        // Start Mining Job
        if(newProfile.type == 'prospect_profile') {
          $.ajax({
            url:'https://nameless-retreat-3525.herokuapp.com/title_mining_job',
            //url:'http://127.0.0.1:5000/title_mining_job',
            type:'GET',
            data: {prospect_profile: ress.objectId},
            success: function(res) { console.log(res) },
            error: function(err) { console.log(err) }
          })
        }

        // Create Profiles
        _.map(nonemptyProfiles, function(profile) {
          $.ajax({
            url:'https://api.parse.com/1/classes/'+_.values(profile)[0],
            headers:appConfig.headers,
            type:'POST',
            data:JSON.stringify( _.pick(profile, _.keys(profile)[1]) ),
            success:function(res) {
              $.ajax({
                url:'https://api.parse.com/1/classes/ProspectProfile/'+ress.objectId,
                type:'PUT',
                headers:appConfig.headers,
                data:JSON.stringify({profiles:{
                  __op: 'AddUnique',
                  objects:[{
                    __type:'Pointer',
                    className: _.values(profile)[0],
                    objectId:res.objectId
                  }]}
                }),
              })
            }
          })
        });
      }
    })
  },

  render: function() {
    return (
      React.DOM.div({className: "modal fade ", tabIndex: "-1", role: "dialog", 
           'aria-labelledby': "mySmallModalLabel", 'aria-hidden': "true", 
           id: "createProspectProfileModal", 
           style: {top:'50px',overflow:'hidden'}}, 
            React.DOM.div({className: "modal-dialog modal-sm", style: {width:650}}, 
              React.DOM.div({className: "modal-content"}, 
                React.DOM.div({className: "modal-header"}, 
                  React.DOM.h4({className: "modal-title", id: "myModalLabel"}, 
                    "Create Prospect Profile"
                  ), 
                  React.DOM.a({href: "javascript:", className: "btn btn-success btn-sm", 
                     onClick: this.createProfile, 
                     style: {float:'right',marginTop:-28,marginRight:-5}}, 
                    "Create Profile"
                  )
                ), 
                React.DOM.div({className: "modal-body"}, 
                  CreateHiringSignal(null)
                ), 
              React.DOM.div({className: "modal-footer", style: {display:'none'}}, 
                React.DOM.button({type: "button", className: "btn btn-default"}, 
                  "Close"
                ), 
                React.DOM.button({type: "button", className: "btn btn-primary"}, 
                  "Send Email"
                )
              )
              )
            )
          )
    );
  },
  createCompanyProfile: function() {
  },
});

var CreateHiringSignal = React.createClass({displayName: 'CreateHiringSignal',
  getInitialState: function() {
    return {
      addCompany: false,
      addProspect: false,
      hideCompanyDetails: false,
      hideProspectDetails: false,
    }
  },

  componentDidMount: function() {

  },
  
  toggleCompany : function() {
    this.setState({addCompany: !this.state.addCompany})
  },

  toggleProspect : function() {
    this.setState({addProspect: !this.state.addProspect})
  },

  toggleCompanyDetails: function() {
    this.setState({hideCompanyDetails: !this.state.hideCompanyDetails})
  },

  toggleProspectDetails: function() {
    this.setState({hideProspectDetails: !this.state.hideProspectDetails})
  },

  componentDidMount: function() {
    _.map($('.hiring-role'),function(input){$(input).tagsinput()})
    $(this.getDOMNode()).find('.hiring-role').tagsinput()
    $('.bootstrap-tagsinput').width('59.1%')
  },

  render: function(){
    return (
      React.DOM.div(null, 
        React.DOM.form({className: "createSignal", onSubmit: this.createProfile}, 
          React.DOM.span(null, 
            React.DOM.h6({style: {width:140,display:'inline-block',marginBottom:20}}, 
              "Prospect Profile Name:  "), 
            React.DOM.input({type: "text", 
                   style: {display:'inline-block',width:'73.1%'}, 
                   className: "form-control hiring-profile-name profileName", 
                   placeholder: "Prospect Profile Name ..."})
          ), 
          React.DOM.br(null), 
          React.DOM.span({style: {display:'block',marginBottom:-10}}, 
            React.DOM.h6({style: {width:140,display:'inline-block'}}, 
              "Title:  "
            ), 
            React.DOM.input({type: "text", 
                   style: {display:'inline-block',width:'73.1%',marginRight:10}, 
                   'data-role': "tagsinput", 
                   className: "form-control hiring-role prospect-profile-title"}), 

                React.DOM.a({href: "javascript:", 
                   className: "btn btn-xs btn-success", style: {display:'none'}}, 
                  React.DOM.i({className: "fa fa-plus"})
                )
          ), 
          React.DOM.br(null), 
          React.DOM.span({style: {display:'block',marginBottom:-10}}, 
            React.DOM.h6({style: {width:140,display:'none'}}, 
              "Location:  "
            ), 
            React.DOM.input({type: "text", 
                   style: {display:'none',width:'73.1%',marginRight:10}, 
                   'data-role': "tagsinput", 
                   className: "form-control prospect-location-profile-tmp"}), 

                React.DOM.a({href: "javascript:", 
                   className: "btn btn-xs btn-success", style: {display:'none'}}, 
                  React.DOM.i({className: "fa fa-plus"})
                )
          ), 
          React.DOM.span({style: {display:'none',marginBottom:-10}}, 
            React.DOM.h6({style: {width:140,display:'inline-block'}}, 
              "Industries:  "
            ), 
            React.DOM.input({type: "text", 
                   style: {display:'inline-block',width:'73.1%',marginRight:10}, 
                   'data-role': "tagsinput", 
                   className: "form-control "}), 

            React.DOM.a({href: "javascript:", 
               className: "btn btn-xs btn-success", style: {display:'none'}}, 
              React.DOM.i({className: "fa fa-plus"})
            )
          ), 
          CompanyProfile(null), 

          React.DOM.div({style: {display:'none'}}, 
          React.DOM.div({style: {marginTop:10}}, 
            React.DOM.h6({style: {width:140,display:'inline-block'}}, "Auto Prospect:  "), 
            React.DOM.div({className: "btn-group autoprospect", 'data-toggle': "buttons"}, 
              React.DOM.label({className: "btn btn-sm btn-default active"}, 
                React.DOM.input({type: "radio"}), " Yes"
              ), 
              React.DOM.label({className: "btn btn-sm btn-default"}, 
                React.DOM.input({type: "radio"}), " No"
              )
            )
          )
        )
        )
      )
    )
  },
  createSignal: function(e) { e.preventDefault() }
});

var CompanyProfile = React.createClass({displayName: 'CompanyProfile',
  companyFormSubmit: function(e) { e.preventDefault() },

  componentDidMount: function() {
    $(this.getDOMNode()).find('.btn-default').click(function(e) {

      if($(e.target).parent('label').hasClass('active'))
        $(e.target).parent('label').removeClass('active')
      else
        $(e.target).parent('label').addClass('active')

      console.log($(e.target).parent('label'))
    });
  },

  render: function() {
    return (
      React.DOM.div(null, 
          React.DOM.br(null), 
          React.DOM.div({style: {display:'none'}}, 
          React.DOM.h6({style: {display:'inline-block',margin:0,
                      width:140,marginBottom:20}}, "Company Size "), 
                    React.DOM.div({className: "btn-group", 'data-toggle': "buttons", 
                      style: {width:'73.5%'}, id: "prospect-profile-companySizeBtns"}, 
              React.DOM.label({className: "btn btn-sm btn-default employeeBtn"}, 
                React.DOM.input({type: "checkbox"}), " 1 - 50"
              ), 
              React.DOM.label({className: "btn btn-sm btn-default employeeBtn"}, 
                React.DOM.input({type: "checkbox"}), " 50 - 250"
              ), 
              React.DOM.label({className: "btn btn-sm btn-default employeeBtn"}, 
                React.DOM.input({type: "checkbox"}), " 250 - 1000"
              ), 
              React.DOM.label({className: "btn btn-sm btn-default employeeBtn"}, 
                React.DOM.input({type: "checkbox"}), " 1000 +"
              )
            )
          ), 

          React.DOM.div({style: {display:'none'}}, 
            React.DOM.br(null), " ", React.DOM.h6({style: {display:'inline-block',margin:0,width:140}}, 
              "Approx. Revenue  "), 
            React.DOM.div({className: "btn-group", 'data-toggle': "buttons", 
              style: {width:'73.5%'}, id: "prospect-profile-companyRevenueBtns"}, 
              React.DOM.label({className: "btn btn-sm btn-default revenueBtn"}, 
                React.DOM.input({type: "checkbox"}), " ", '< $1M'
              ), 
              React.DOM.label({className: "btn btn-sm btn-default revenueBtn"}, 
                React.DOM.input({type: "checkbox"}), " $1M - $5M"
              ), 
              React.DOM.label({className: "btn btn-sm btn-default revenueBtn"}, 
                React.DOM.input({type: "checkbox"}), " $5M - $25M"
              ), 
              React.DOM.label({className: "btn btn-sm btn-default revenueBtn"}, 
                React.DOM.input({type: "checkbox"}), " $25M +"
              )
            )
          )
      )
    )
  }
});

var ProspectProfile = React.createClass({displayName: 'ProspectProfile',
  prospectFormSubmit: function(e) { e.preventDefault() },

  componentDidMount: function() {
    $('.prospectRoleKeywords').tagsinput({
      maxTags: 5,
    })
    $('.bootstrap-tagsinput').width(400)
  },

  render: function() {
    showDetails = (this.props.hideProspectDetails) ? {display: 'none'} : {display:'block'}
    return (
      React.DOM.div({style: showDetails}, 
        React.DOM.form({className: "createSignal", onSubmit: this.prospectFormSubmit}, 
          React.DOM.span(null, 
            React.DOM.span({style: {width:140,display:'inline-block'}}, 
              React.DOM.h6(null, "Job Title Keyword:  ")
            ), 
            React.DOM.input({type: "text", 
                   'data-role': "tagsinput", 
                   style: {width:'400px !important'}, 
                   className: "form-control prospectRoleKeywords", 
                   placeholder: ""})
          )
        )
      )
    )
  }
})

},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L25vZGVfbW9kdWxlcy9ndWxwLWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9yb2Jpbi9Qcm9qZWN0cy9wcm9zcGVjdGVyL3Byb3NwZWN0ZXItcGFyc2UvZGV2L2J1aWxkL2pzL2NvbXBvbmVudHMvY3JlYXRlX3Byb3NwZWN0X3Byb2ZpbGVfbW9kYWwuanMubWluLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ2V4cG9ydHMnLFxuICAvLyBjcmVhdGVDb21wYW55UHJvZmlsZU1vZGFsXG4gIGNyZWF0ZVByb2ZpbGU6IGZ1bmN0aW9uKCkge1xuICAgIHByb2ZpbGVOYW1lID0gJChcIi5wcm9maWxlTmFtZVwiKS52YWwoKVxuXG4gICAgdGl0bGVQcm9maWxlID0ge1xuICAgICAgJ2NsYXNzTmFtZSc6ICdQcm9zcGVjdFRpdGxlUHJvZmlsZScsXG4gICAgICAndGl0bGVfa2V5d29yZHMnICAgIDogJCgnLnByb3NwZWN0LXByb2ZpbGUtdGl0bGUnKS50YWdzaW5wdXQoJ2l0ZW1zJykucmV2ZXJzZSgpXG4gICAgfVxuXG4gICAgLypcbiAgICBsb2NhdGlvblByb2ZpbGUgPSB7XG4gICAgICAnY2xhc3NOYW1lJzogJ0xvY2F0aW9uUHJvZmlsZScsXG4gICAgICAnbG9jYWxlJyAgICA6ICQoJy5wcm9zcGVjdC1sb2NhdGlvbi1wcm9maWxlJykudGFnc2lucHV0KCdpdGVtcycpLnJldmVyc2UoKVxuICAgIH1cblxuICAgIGNvbXBhbnlTaXplUHJvZmlsZSA9IHtcbiAgICAgICdjbGFzc05hbWUnOidFbXBsb3llZVByb2ZpbGUnLCBcbiAgICAgICdlbXBsb3llZXMnOiBfLm1hcCgkKCcjcHJvc3BlY3QtcHJvZmlsZS1jb21wYW55U2l6ZUJ0bnMnKS5maW5kKCcuYWN0aXZlJyksIFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ocmV2QnRuKXsgcmV0dXJuICQocmV2QnRuKS50ZXh0KCkudHJpbSgpIH0pLnJldmVyc2UoKVxuICAgIH1cblxuICAgIHJldmVudWVQcm9maWxlID0ge1xuICAgICAgJ2NsYXNzTmFtZSc6J1JldmVudWVQcm9maWxlJywgXG4gICAgICAncmV2ZW51ZXMnOiBfLm1hcCgkKCcjcHJvc3BlY3QtcHJvZmlsZS1jb21wYW55UmV2ZW51ZUJ0bnMnKS5maW5kKCcuYWN0aXZlJyksIFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ocmV2QnRuKXsgcmV0dXJuICQocmV2QnRuKS50ZXh0KCkudHJpbSgpIH0pLnJldmVyc2UoKVxuICAgIH1cblxuICAgIHByb2ZpbGVzID0gW3RpdGxlUHJvZmlsZSwgbG9jYXRpb25Qcm9maWxlLFxuICAgICAgICAgICAgICAgIGNvbXBhbnlTaXplUHJvZmlsZSwgcmV2ZW51ZVByb2ZpbGVdXG4gICAgKi9cbiAgICBwcm9maWxlcyA9IFt0aXRsZVByb2ZpbGVdXG5cbiAgICBub25lbXB0eVByb2ZpbGVzID0gXy5maWx0ZXIocHJvZmlsZXMsIGZ1bmN0aW9uKHByb2ZpbGUpIHtcbiAgICAgIGlmKF8udmFsdWVzKHByb2ZpbGUpWzFdKXsgcmV0dXJuIF8udmFsdWVzKHByb2ZpbGUpWzFdLmxlbmd0aCB9XG4gICAgfSk7XG5cbiAgICBuZXdQcm9maWxlID0ge1xuICAgICAgbmFtZTogcHJvZmlsZU5hbWUsXG4gICAgICAvL2F1dG9Qcm9zcGVjdDogYXV0b1Byb3NwZWN0LFxuICAgICAgcHJvZmlsZXM6IG5vbmVtcHR5UHJvZmlsZXMsXG4gICAgICB0eXBlOiAncHJvc3BlY3RfcHJvZmlsZScsXG4gICAgICBtaW5pbmdfam9iOnRydWUsXG4gICAgICB1c2VyOntcbiAgICAgICAgX190eXBlOidQb2ludGVyJyxcbiAgICAgICAgY2xhc3NOYW1lOidfVXNlcicsXG4gICAgICAgIG9iamVjdElkOkpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKS5vYmplY3RJZFxuICAgICAgfSxcbiAgICAgIGNvbXBhbnk6IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKS5jb21wYW55XG4gICAgfVxuXG4gICAgaWYobm9uZW1wdHlQcm9maWxlcy5sZW5ndGgpIHtcbiAgICAgIHRoaXMucGVyc2lzdFNpZ25hbChub25lbXB0eVByb2ZpbGVzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICBfLm9taXQobmV3UHJvZmlsZSwncHJvZmlsZXMnKSlcbiAgICAgIHRoaXMucHJvcHMuYWRkUHJvZmlsZShuZXdQcm9maWxlKVxuICAgICAgJCgnLm1vZGFsJykuY2xpY2soKVxuICAgICAgJCgnLnByb3NwZWN0LXByb2ZpbGUtdGl0bGUnKS52YWwoJycpXG4gICAgfVxuICB9LFxuXG4gIHBlcnNpc3RTaWduYWw6IGZ1bmN0aW9uKG5vbmVtcHR5UHJvZmlsZXMsIG5ld1Byb2ZpbGUpIHtcbiAgICBjb25zb2xlLmxvZygnTkVXIFBST0ZJTEUnKVxuICAgIGNvbnNvbGUubG9nKG5ld1Byb2ZpbGUpXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdFByb2ZpbGUnLFxuICAgICAgaGVhZGVyczphcHBDb25maWcuaGVhZGVycyxcbiAgICAgIHR5cGU6J1BPU1QnLFxuICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeShuZXdQcm9maWxlKSxcbiAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24ocmVzcykge1xuICAgICAgICAvLyBDcmVhdGUgU2lnbmFsIExpc3QgLT4gIFVwZGF0ZSBQcm9zcGVjdCBQcm9maWxlXG4gICAgICAgIG5ld1Byb2ZpbGUudXNlciA9IHtcbiAgICAgICAgICBfX3R5cGU6ICdQb2ludGVyJyxcbiAgICAgICAgICBjbGFzc05hbWU6J19Vc2VyJyxcbiAgICAgICAgICBvYmplY3RJZDogSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIpLm9iamVjdElkXG4gICAgICAgIH1cbiAgICAgICAgbmV3UHJvZmlsZS5jb21wYW55ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIpLmNvbXBhbnlcbiAgICAgICAgaWYobmV3UHJvZmlsZS50eXBlID09ICdwcm9zcGVjdF9wcm9maWxlJylcbiAgICAgICAgICBuZXdQcm9maWxlLm1pbmluZ19qb2JfbGlzdCA9IHRydWVcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgIHVybDogJ2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvUHJvc3BlY3RMaXN0JyxcbiAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgaGVhZGVyczogYXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeShfLnBpY2sobmV3UHJvZmlsZSwgJ25hbWUnLCd1c2VyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29tcGFueScsJ21pbmluZ19qb2JfbGlzdCcpKSxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgIHVybDonaHR0cHM6Ly9hcGkucGFyc2UuY29tLzEvY2xhc3Nlcy9Qcm9zcGVjdFByb2ZpbGUvJytyZXNzLm9iamVjdElkLFxuICAgICAgICAgICAgICB0eXBlOidQVVQnLFxuICAgICAgICAgICAgICBoZWFkZXJzOiBhcHBDb25maWcuaGVhZGVycyxcbiAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoeyAncHJvc3BlY3RfbGlzdCc6eyBfX3R5cGU6J1BvaW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidQcm9zcGVjdExpc3QnLG9iamVjdElkOnJlcy5vYmplY3RJZCB9IH0pLFxuICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpeyBjb25zb2xlLmxvZyhyZXMpIH0sXG4gICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpeyBjb25zb2xlLmxvZyhlcnIpIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7IH1cbiAgICAgICAgfSlcblxuICAgICAgICAvLyBTdGFydCBNaW5pbmcgSm9iXG4gICAgICAgIGlmKG5ld1Byb2ZpbGUudHlwZSA9PSAncHJvc3BlY3RfcHJvZmlsZScpIHtcbiAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOidodHRwczovL25hbWVsZXNzLXJldHJlYXQtMzUyNS5oZXJva3VhcHAuY29tL3RpdGxlX21pbmluZ19qb2InLFxuICAgICAgICAgICAgLy91cmw6J2h0dHA6Ly8xMjcuMC4wLjE6NTAwMC90aXRsZV9taW5pbmdfam9iJyxcbiAgICAgICAgICAgIHR5cGU6J0dFVCcsXG4gICAgICAgICAgICBkYXRhOiB7cHJvc3BlY3RfcHJvZmlsZTogcmVzcy5vYmplY3RJZH0sXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsgY29uc29sZS5sb2cocmVzKSB9LFxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikgeyBjb25zb2xlLmxvZyhlcnIpIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ3JlYXRlIFByb2ZpbGVzXG4gICAgICAgIF8ubWFwKG5vbmVtcHR5UHJvZmlsZXMsIGZ1bmN0aW9uKHByb2ZpbGUpIHtcbiAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOidodHRwczovL2FwaS5wYXJzZS5jb20vMS9jbGFzc2VzLycrXy52YWx1ZXMocHJvZmlsZSlbMF0sXG4gICAgICAgICAgICBoZWFkZXJzOmFwcENvbmZpZy5oZWFkZXJzLFxuICAgICAgICAgICAgdHlwZTonUE9TVCcsXG4gICAgICAgICAgICBkYXRhOkpTT04uc3RyaW5naWZ5KCBfLnBpY2socHJvZmlsZSwgXy5rZXlzKHByb2ZpbGUpWzFdKSApLFxuICAgICAgICAgICAgc3VjY2VzczpmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB1cmw6J2h0dHBzOi8vYXBpLnBhcnNlLmNvbS8xL2NsYXNzZXMvUHJvc3BlY3RQcm9maWxlLycrcmVzcy5vYmplY3RJZCxcbiAgICAgICAgICAgICAgICB0eXBlOidQVVQnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6YXBwQ29uZmlnLmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgZGF0YTpKU09OLnN0cmluZ2lmeSh7cHJvZmlsZXM6e1xuICAgICAgICAgICAgICAgICAgX19vcDogJ0FkZFVuaXF1ZScsXG4gICAgICAgICAgICAgICAgICBvYmplY3RzOlt7XG4gICAgICAgICAgICAgICAgICAgIF9fdHlwZTonUG9pbnRlcicsXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXy52YWx1ZXMocHJvZmlsZSlbMF0sXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdElkOnJlcy5vYmplY3RJZFxuICAgICAgICAgICAgICAgICAgfV19XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSlcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwgZmFkZSBcIiwgdGFiSW5kZXg6IFwiLTFcIiwgcm9sZTogXCJkaWFsb2dcIiwgXG4gICAgICAgICAgICdhcmlhLWxhYmVsbGVkYnknOiBcIm15U21hbGxNb2RhbExhYmVsXCIsICdhcmlhLWhpZGRlbic6IFwidHJ1ZVwiLCBcbiAgICAgICAgICAgaWQ6IFwiY3JlYXRlUHJvc3BlY3RQcm9maWxlTW9kYWxcIiwgXG4gICAgICAgICAgIHN0eWxlOiB7dG9wOic1MHB4JyxvdmVyZmxvdzonaGlkZGVuJ319LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbC1kaWFsb2cgbW9kYWwtc21cIiwgc3R5bGU6IHt3aWR0aDo2NTB9fSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbC1jb250ZW50XCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwibW9kYWwtaGVhZGVyXCJ9LCBcbiAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5oNCh7Y2xhc3NOYW1lOiBcIm1vZGFsLXRpdGxlXCIsIGlkOiBcIm15TW9kYWxMYWJlbFwifSwgXG4gICAgICAgICAgICAgICAgICAgIFwiQ3JlYXRlIFByb3NwZWN0IFByb2ZpbGVcIlxuICAgICAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBjbGFzc05hbWU6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi1zbVwiLCBcbiAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMuY3JlYXRlUHJvZmlsZSwgXG4gICAgICAgICAgICAgICAgICAgICBzdHlsZToge2Zsb2F0OidyaWdodCcsbWFyZ2luVG9wOi0yOCxtYXJnaW5SaWdodDotNX19LCBcbiAgICAgICAgICAgICAgICAgICAgXCJDcmVhdGUgUHJvZmlsZVwiXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmRpdih7Y2xhc3NOYW1lOiBcIm1vZGFsLWJvZHlcIn0sIFxuICAgICAgICAgICAgICAgICAgQ3JlYXRlSGlyaW5nU2lnbmFsKG51bGwpXG4gICAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJtb2RhbC1mb290ZXJcIiwgc3R5bGU6IHtkaXNwbGF5Oidub25lJ319LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uYnV0dG9uKHt0eXBlOiBcImJ1dHRvblwiLCBjbGFzc05hbWU6IFwiYnRuIGJ0bi1kZWZhdWx0XCJ9LCBcbiAgICAgICAgICAgICAgICAgIFwiQ2xvc2VcIlxuICAgICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5idXR0b24oe3R5cGU6IFwiYnV0dG9uXCIsIGNsYXNzTmFtZTogXCJidG4gYnRuLXByaW1hcnlcIn0sIFxuICAgICAgICAgICAgICAgICAgXCJTZW5kIEVtYWlsXCJcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICApO1xuICB9LFxuICBjcmVhdGVDb21wYW55UHJvZmlsZTogZnVuY3Rpb24oKSB7XG4gIH0sXG59KTtcblxudmFyIENyZWF0ZUhpcmluZ1NpZ25hbCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ0NyZWF0ZUhpcmluZ1NpZ25hbCcsXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFkZENvbXBhbnk6IGZhbHNlLFxuICAgICAgYWRkUHJvc3BlY3Q6IGZhbHNlLFxuICAgICAgaGlkZUNvbXBhbnlEZXRhaWxzOiBmYWxzZSxcbiAgICAgIGhpZGVQcm9zcGVjdERldGFpbHM6IGZhbHNlLFxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG5cbiAgfSxcbiAgXG4gIHRvZ2dsZUNvbXBhbnkgOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnNldFN0YXRlKHthZGRDb21wYW55OiAhdGhpcy5zdGF0ZS5hZGRDb21wYW55fSlcbiAgfSxcblxuICB0b2dnbGVQcm9zcGVjdCA6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2FkZFByb3NwZWN0OiAhdGhpcy5zdGF0ZS5hZGRQcm9zcGVjdH0pXG4gIH0sXG5cbiAgdG9nZ2xlQ29tcGFueURldGFpbHM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2hpZGVDb21wYW55RGV0YWlsczogIXRoaXMuc3RhdGUuaGlkZUNvbXBhbnlEZXRhaWxzfSlcbiAgfSxcblxuICB0b2dnbGVQcm9zcGVjdERldGFpbHM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2hpZGVQcm9zcGVjdERldGFpbHM6ICF0aGlzLnN0YXRlLmhpZGVQcm9zcGVjdERldGFpbHN9KVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICBfLm1hcCgkKCcuaGlyaW5nLXJvbGUnKSxmdW5jdGlvbihpbnB1dCl7JChpbnB1dCkudGFnc2lucHV0KCl9KVxuICAgICQodGhpcy5nZXRET01Ob2RlKCkpLmZpbmQoJy5oaXJpbmctcm9sZScpLnRhZ3NpbnB1dCgpXG4gICAgJCgnLmJvb3RzdHJhcC10YWdzaW5wdXQnKS53aWR0aCgnNTkuMSUnKVxuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gKFxuICAgICAgUmVhY3QuRE9NLmRpdihudWxsLCBcbiAgICAgICAgUmVhY3QuRE9NLmZvcm0oe2NsYXNzTmFtZTogXCJjcmVhdGVTaWduYWxcIiwgb25TdWJtaXQ6IHRoaXMuY3JlYXRlUHJvZmlsZX0sIFxuICAgICAgICAgIFJlYWN0LkRPTS5zcGFuKG51bGwsIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge3dpZHRoOjE0MCxkaXNwbGF5OidpbmxpbmUtYmxvY2snLG1hcmdpbkJvdHRvbToyMH19LCBcbiAgICAgICAgICAgICAgXCJQcm9zcGVjdCBQcm9maWxlIE5hbWU6IMKgXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pbnB1dCh7dHlwZTogXCJ0ZXh0XCIsIFxuICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyx3aWR0aDonNzMuMSUnfSwgXG4gICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImZvcm0tY29udHJvbCBoaXJpbmctcHJvZmlsZS1uYW1lIHByb2ZpbGVOYW1lXCIsIFxuICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBcIlByb3NwZWN0IFByb2ZpbGUgTmFtZSAuLi5cIn0pXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmJyKG51bGwpLCBcbiAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHtkaXNwbGF5OidibG9jaycsbWFyZ2luQm90dG9tOi0xMH19LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHt3aWR0aDoxNDAsZGlzcGxheTonaW5saW5lLWJsb2NrJ319LCBcbiAgICAgICAgICAgICAgXCJUaXRsZTogwqBcIlxuICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaW5wdXQoe3R5cGU6IFwidGV4dFwiLCBcbiAgICAgICAgICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6J2lubGluZS1ibG9jaycsd2lkdGg6JzczLjElJyxtYXJnaW5SaWdodDoxMH0sIFxuICAgICAgICAgICAgICAgICAgICdkYXRhLXJvbGUnOiBcInRhZ3NpbnB1dFwiLCBcbiAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiZm9ybS1jb250cm9sIGhpcmluZy1yb2xlIHByb3NwZWN0LXByb2ZpbGUtdGl0bGVcIn0pLCBcblxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5hKHtocmVmOiBcImphdmFzY3JpcHQ6XCIsIFxuICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLXhzIGJ0bi1zdWNjZXNzXCIsIHN0eWxlOiB7ZGlzcGxheTonbm9uZSd9fSwgXG4gICAgICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBsdXNcIn0pXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICksIFxuICAgICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4oe3N0eWxlOiB7ZGlzcGxheTonYmxvY2snLG1hcmdpbkJvdHRvbTotMTB9fSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7d2lkdGg6MTQwLGRpc3BsYXk6J25vbmUnfX0sIFxuICAgICAgICAgICAgICBcIkxvY2F0aW9uOiDCoFwiXG4gICAgICAgICAgICApLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pbnB1dCh7dHlwZTogXCJ0ZXh0XCIsIFxuICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7ZGlzcGxheTonbm9uZScsd2lkdGg6JzczLjElJyxtYXJnaW5SaWdodDoxMH0sIFxuICAgICAgICAgICAgICAgICAgICdkYXRhLXJvbGUnOiBcInRhZ3NpbnB1dFwiLCBcbiAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiZm9ybS1jb250cm9sIHByb3NwZWN0LWxvY2F0aW9uLXByb2ZpbGUtdG1wXCJ9KSwgXG5cbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uYSh7aHJlZjogXCJqYXZhc2NyaXB0OlwiLCBcbiAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi14cyBidG4tc3VjY2Vzc1wiLCBzdHlsZToge2Rpc3BsYXk6J25vbmUnfX0sIFxuICAgICAgICAgICAgICAgICAgUmVhY3QuRE9NLmkoe2NsYXNzTmFtZTogXCJmYSBmYS1wbHVzXCJ9KVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICApLCBcbiAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHtkaXNwbGF5Oidub25lJyxtYXJnaW5Cb3R0b206LTEwfX0sIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmg2KHtzdHlsZToge3dpZHRoOjE0MCxkaXNwbGF5OidpbmxpbmUtYmxvY2snfX0sIFxuICAgICAgICAgICAgICBcIkluZHVzdHJpZXM6IMKgXCJcbiAgICAgICAgICAgICksIFxuICAgICAgICAgICAgUmVhY3QuRE9NLmlucHV0KHt0eXBlOiBcInRleHRcIiwgXG4gICAgICAgICAgICAgICAgICAgc3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snLHdpZHRoOic3My4xJScsbWFyZ2luUmlnaHQ6MTB9LCBcbiAgICAgICAgICAgICAgICAgICAnZGF0YS1yb2xlJzogXCJ0YWdzaW5wdXRcIiwgXG4gICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImZvcm0tY29udHJvbCBcIn0pLCBcblxuICAgICAgICAgICAgUmVhY3QuRE9NLmEoe2hyZWY6IFwiamF2YXNjcmlwdDpcIiwgXG4gICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiYnRuIGJ0bi14cyBidG4tc3VjY2Vzc1wiLCBzdHlsZToge2Rpc3BsYXk6J25vbmUnfX0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00uaSh7Y2xhc3NOYW1lOiBcImZhIGZhLXBsdXNcIn0pXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSwgXG4gICAgICAgICAgQ29tcGFueVByb2ZpbGUobnVsbCksIFxuXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7c3R5bGU6IHtkaXNwbGF5Oidub25lJ319LCBcbiAgICAgICAgICBSZWFjdC5ET00uZGl2KHtzdHlsZToge21hcmdpblRvcDoxMH19LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5oNih7c3R5bGU6IHt3aWR0aDoxNDAsZGlzcGxheTonaW5saW5lLWJsb2NrJ319LCBcIkF1dG8gUHJvc3BlY3Q6IMKgXCIpLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJidG4tZ3JvdXAgYXV0b3Byb3NwZWN0XCIsICdkYXRhLXRvZ2dsZSc6IFwiYnV0dG9uc1wifSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5sYWJlbCh7Y2xhc3NOYW1lOiBcImJ0biBidG4tc20gYnRuLWRlZmF1bHQgYWN0aXZlXCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uaW5wdXQoe3R5cGU6IFwicmFkaW9cIn0pLCBcIiBZZXNcIlxuICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmxhYmVsKHtjbGFzc05hbWU6IFwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdFwifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmlucHV0KHt0eXBlOiBcInJhZGlvXCJ9KSwgXCIgTm9cIlxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gIH0sXG4gIGNyZWF0ZVNpZ25hbDogZnVuY3Rpb24oZSkgeyBlLnByZXZlbnREZWZhdWx0KCkgfVxufSk7XG5cbnZhciBDb21wYW55UHJvZmlsZSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTogJ0NvbXBhbnlQcm9maWxlJyxcbiAgY29tcGFueUZvcm1TdWJtaXQ6IGZ1bmN0aW9uKGUpIHsgZS5wcmV2ZW50RGVmYXVsdCgpIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgICQodGhpcy5nZXRET01Ob2RlKCkpLmZpbmQoJy5idG4tZGVmYXVsdCcpLmNsaWNrKGZ1bmN0aW9uKGUpIHtcblxuICAgICAgaWYoJChlLnRhcmdldCkucGFyZW50KCdsYWJlbCcpLmhhc0NsYXNzKCdhY3RpdmUnKSlcbiAgICAgICAgJChlLnRhcmdldCkucGFyZW50KCdsYWJlbCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxuICAgICAgZWxzZVxuICAgICAgICAkKGUudGFyZ2V0KS5wYXJlbnQoJ2xhYmVsJykuYWRkQ2xhc3MoJ2FjdGl2ZScpXG5cbiAgICAgIGNvbnNvbGUubG9nKCQoZS50YXJnZXQpLnBhcmVudCgnbGFiZWwnKSlcbiAgICB9KTtcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KG51bGwsIFxuICAgICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7c3R5bGU6IHtkaXNwbGF5Oidub25lJ319LCBcbiAgICAgICAgICBSZWFjdC5ET00uaDYoe3N0eWxlOiB7ZGlzcGxheTonaW5saW5lLWJsb2NrJyxtYXJnaW46MCxcbiAgICAgICAgICAgICAgICAgICAgICB3aWR0aDoxNDAsbWFyZ2luQm90dG9tOjIwfX0sIFwiQ29tcGFueSBTaXplIFwiKSwgXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5kaXYoe2NsYXNzTmFtZTogXCJidG4tZ3JvdXBcIiwgJ2RhdGEtdG9nZ2xlJzogXCJidXR0b25zXCIsIFxuICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7d2lkdGg6JzczLjUlJ30sIGlkOiBcInByb3NwZWN0LXByb2ZpbGUtY29tcGFueVNpemVCdG5zXCJ9LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmxhYmVsKHtjbGFzc05hbWU6IFwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCBlbXBsb3llZUJ0blwifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmlucHV0KHt0eXBlOiBcImNoZWNrYm94XCJ9KSwgXCIgMSAtIDUwXCJcbiAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5sYWJlbCh7Y2xhc3NOYW1lOiBcImJ0biBidG4tc20gYnRuLWRlZmF1bHQgZW1wbG95ZWVCdG5cIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pbnB1dCh7dHlwZTogXCJjaGVja2JveFwifSksIFwiIDUwIC0gMjUwXCJcbiAgICAgICAgICAgICAgKSwgXG4gICAgICAgICAgICAgIFJlYWN0LkRPTS5sYWJlbCh7Y2xhc3NOYW1lOiBcImJ0biBidG4tc20gYnRuLWRlZmF1bHQgZW1wbG95ZWVCdG5cIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pbnB1dCh7dHlwZTogXCJjaGVja2JveFwifSksIFwiIDI1MCAtIDEwMDBcIlxuICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmxhYmVsKHtjbGFzc05hbWU6IFwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCBlbXBsb3llZUJ0blwifSwgXG4gICAgICAgICAgICAgICAgUmVhY3QuRE9NLmlucHV0KHt0eXBlOiBcImNoZWNrYm94XCJ9KSwgXCIgMTAwMCArXCJcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICksIFxuXG4gICAgICAgICAgUmVhY3QuRE9NLmRpdih7c3R5bGU6IHtkaXNwbGF5Oidub25lJ319LCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5icihudWxsKSwgXCIgXCIsIFJlYWN0LkRPTS5oNih7c3R5bGU6IHtkaXNwbGF5OidpbmxpbmUtYmxvY2snLG1hcmdpbjowLHdpZHRoOjE0MH19LCBcbiAgICAgICAgICAgICAgXCJBcHByb3guIFJldmVudWUgIFwiKSwgXG4gICAgICAgICAgICBSZWFjdC5ET00uZGl2KHtjbGFzc05hbWU6IFwiYnRuLWdyb3VwXCIsICdkYXRhLXRvZ2dsZSc6IFwiYnV0dG9uc1wiLCBcbiAgICAgICAgICAgICAgc3R5bGU6IHt3aWR0aDonNzMuNSUnfSwgaWQ6IFwicHJvc3BlY3QtcHJvZmlsZS1jb21wYW55UmV2ZW51ZUJ0bnNcIn0sIFxuICAgICAgICAgICAgICBSZWFjdC5ET00ubGFiZWwoe2NsYXNzTmFtZTogXCJidG4gYnRuLXNtIGJ0bi1kZWZhdWx0IHJldmVudWVCdG5cIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pbnB1dCh7dHlwZTogXCJjaGVja2JveFwifSksIFwiIFwiLCAnPCAkMU0nXG4gICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgICBSZWFjdC5ET00ubGFiZWwoe2NsYXNzTmFtZTogXCJidG4gYnRuLXNtIGJ0bi1kZWZhdWx0IHJldmVudWVCdG5cIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pbnB1dCh7dHlwZTogXCJjaGVja2JveFwifSksIFwiICQxTSAtICQ1TVwiXG4gICAgICAgICAgICAgICksIFxuICAgICAgICAgICAgICBSZWFjdC5ET00ubGFiZWwoe2NsYXNzTmFtZTogXCJidG4gYnRuLXNtIGJ0bi1kZWZhdWx0IHJldmVudWVCdG5cIn0sIFxuICAgICAgICAgICAgICAgIFJlYWN0LkRPTS5pbnB1dCh7dHlwZTogXCJjaGVja2JveFwifSksIFwiICQ1TSAtICQyNU1cIlxuICAgICAgICAgICAgICApLCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmxhYmVsKHtjbGFzc05hbWU6IFwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCByZXZlbnVlQnRuXCJ9LCBcbiAgICAgICAgICAgICAgICBSZWFjdC5ET00uaW5wdXQoe3R5cGU6IFwiY2hlY2tib3hcIn0pLCBcIiAkMjVNICtcIlxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgfVxufSk7XG5cbnZhciBQcm9zcGVjdFByb2ZpbGUgPSBSZWFjdC5jcmVhdGVDbGFzcyh7ZGlzcGxheU5hbWU6ICdQcm9zcGVjdFByb2ZpbGUnLFxuICBwcm9zcGVjdEZvcm1TdWJtaXQ6IGZ1bmN0aW9uKGUpIHsgZS5wcmV2ZW50RGVmYXVsdCgpIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgICQoJy5wcm9zcGVjdFJvbGVLZXl3b3JkcycpLnRhZ3NpbnB1dCh7XG4gICAgICBtYXhUYWdzOiA1LFxuICAgIH0pXG4gICAgJCgnLmJvb3RzdHJhcC10YWdzaW5wdXQnKS53aWR0aCg0MDApXG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBzaG93RGV0YWlscyA9ICh0aGlzLnByb3BzLmhpZGVQcm9zcGVjdERldGFpbHMpID8ge2Rpc3BsYXk6ICdub25lJ30gOiB7ZGlzcGxheTonYmxvY2snfVxuICAgIHJldHVybiAoXG4gICAgICBSZWFjdC5ET00uZGl2KHtzdHlsZTogc2hvd0RldGFpbHN9LCBcbiAgICAgICAgUmVhY3QuRE9NLmZvcm0oe2NsYXNzTmFtZTogXCJjcmVhdGVTaWduYWxcIiwgb25TdWJtaXQ6IHRoaXMucHJvc3BlY3RGb3JtU3VibWl0fSwgXG4gICAgICAgICAgUmVhY3QuRE9NLnNwYW4obnVsbCwgXG4gICAgICAgICAgICBSZWFjdC5ET00uc3Bhbih7c3R5bGU6IHt3aWR0aDoxNDAsZGlzcGxheTonaW5saW5lLWJsb2NrJ319LCBcbiAgICAgICAgICAgICAgUmVhY3QuRE9NLmg2KG51bGwsIFwiSm9iIFRpdGxlIEtleXdvcmQ6IMKgXCIpXG4gICAgICAgICAgICApLCBcbiAgICAgICAgICAgIFJlYWN0LkRPTS5pbnB1dCh7dHlwZTogXCJ0ZXh0XCIsIFxuICAgICAgICAgICAgICAgICAgICdkYXRhLXJvbGUnOiBcInRhZ3NpbnB1dFwiLCBcbiAgICAgICAgICAgICAgICAgICBzdHlsZToge3dpZHRoOic0MDBweCAhaW1wb3J0YW50J30sIFxuICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJmb3JtLWNvbnRyb2wgcHJvc3BlY3RSb2xlS2V5d29yZHNcIiwgXG4gICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IFwiXCJ9KVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgfVxufSlcbiJdfQ==
